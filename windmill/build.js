(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(global){"use strict";if(global._babelPolyfill){throw new Error("only one instance of babel/polyfill is allowed")}global._babelPolyfill=true;require("core-js/shim");require("regenerator-babel/runtime")}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"core-js/shim":2,"regenerator-babel/runtime":3}],2:[function(require,module,exports){!function(global,framework,undefined){"use strict";var OBJECT="Object",FUNCTION="Function",ARRAY="Array",STRING="String",NUMBER="Number",REGEXP="RegExp",DATE="Date",MAP="Map",SET="Set",WEAKMAP="WeakMap",WEAKSET="WeakSet",SYMBOL="Symbol",PROMISE="Promise",MATH="Math",ARGUMENTS="Arguments",PROTOTYPE="prototype",CONSTRUCTOR="constructor",TO_STRING="toString",TO_STRING_TAG=TO_STRING+"Tag",TO_LOCALE="toLocaleString",HAS_OWN="hasOwnProperty",FOR_EACH="forEach",ITERATOR="iterator",FF_ITERATOR="@@"+ITERATOR,PROCESS="process",CREATE_ELEMENT="createElement",Function=global[FUNCTION],Object=global[OBJECT],Array=global[ARRAY],String=global[STRING],Number=global[NUMBER],RegExp=global[REGEXP],Date=global[DATE],Map=global[MAP],Set=global[SET],WeakMap=global[WEAKMAP],WeakSet=global[WEAKSET],Symbol=global[SYMBOL],Math=global[MATH],TypeError=global.TypeError,RangeError=global.RangeError,setTimeout=global.setTimeout,setImmediate=global.setImmediate,clearImmediate=global.clearImmediate,parseInt=global.parseInt,isFinite=global.isFinite,process=global[PROCESS],nextTick=process&&process.nextTick,document=global.document,html=document&&document.documentElement,navigator=global.navigator,define=global.define,console=global.console||{},ArrayProto=Array[PROTOTYPE],ObjectProto=Object[PROTOTYPE],FunctionProto=Function[PROTOTYPE],Infinity=1/0,DOT=".";function isObject(it){return it!==null&&(typeof it=="object"||typeof it=="function")}function isFunction(it){return typeof it=="function"}var isNative=ctx(/./.test,/\[native code\]\s*\}\s*$/,1);var toString=ObjectProto[TO_STRING];function setToStringTag(it,tag,stat){if(it&&!has(it=stat?it:it[PROTOTYPE],SYMBOL_TAG))hidden(it,SYMBOL_TAG,tag)}function cof(it){return toString.call(it).slice(8,-1)}function classof(it){var O,T;return it==undefined?it===undefined?"Undefined":"Null":typeof(T=(O=Object(it))[SYMBOL_TAG])=="string"?T:cof(O)}var call=FunctionProto.call,apply=FunctionProto.apply,REFERENCE_GET;function part(){var fn=assertFunction(this),length=arguments.length,args=Array(length),i=0,_=path._,holder=false;while(length>i)if((args[i]=arguments[i++])===_)holder=true;return function(){var that=this,_length=arguments.length,i=0,j=0,_args;if(!holder&&!_length)return invoke(fn,args,that);_args=args.slice();if(holder)for(;length>i;i++)if(_args[i]===_)_args[i]=arguments[j++];while(_length>j)_args.push(arguments[j++]);return invoke(fn,_args,that)}}function ctx(fn,that,length){assertFunction(fn);if(~length&&that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}function invoke(fn,args,that){var un=that===undefined;switch(args.length|0){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3]);case 5:return un?fn(args[0],args[1],args[2],args[3],args[4]):fn.call(that,args[0],args[1],args[2],args[3],args[4])}return fn.apply(that,args)}var create=Object.create,getPrototypeOf=Object.getPrototypeOf,setPrototypeOf=Object.setPrototypeOf,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,getOwnDescriptor=Object.getOwnPropertyDescriptor,getKeys=Object.keys,getNames=Object.getOwnPropertyNames,getSymbols=Object.getOwnPropertySymbols,isFrozen=Object.isFrozen,has=ctx(call,ObjectProto[HAS_OWN],2),ES5Object=Object,Dict;function toObject(it){return ES5Object(assertDefined(it))}function returnIt(it){return it}function returnThis(){return this}function get(object,key){if(has(object,key))return object[key]}function ownKeys(it){assertObject(it);return getSymbols?getNames(it).concat(getSymbols(it)):getNames(it)}var assign=Object.assign||function(target,source){var T=Object(assertDefined(target)),l=arguments.length,i=1;while(l>i){var S=ES5Object(arguments[i++]),keys=getKeys(S),length=keys.length,j=0,key;while(length>j)T[key=keys[j++]]=S[key]}return T};function keyOf(object,el){var O=toObject(object),keys=getKeys(O),length=keys.length,index=0,key;while(length>index)if(O[key=keys[index++]]===el)return key}function array(it){return String(it).split(",")}var push=ArrayProto.push,unshift=ArrayProto.unshift,slice=ArrayProto.slice,splice=ArrayProto.splice,indexOf=ArrayProto.indexOf,forEach=ArrayProto[FOR_EACH];function createArrayMethod(type){var isMap=type==1,isFilter=type==2,isSome=type==3,isEvery=type==4,isFindIndex=type==6,noholes=type==5||isFindIndex;return function(callbackfn){var O=Object(assertDefined(this)),that=arguments[1],self=ES5Object(O),f=ctx(callbackfn,that,3),length=toLength(self.length),index=0,result=isMap?Array(length):isFilter?[]:undefined,val,res;for(;length>index;index++)if(noholes||index in self){val=self[index];res=f(val,index,O);if(type){if(isMap)result[index]=res;else if(res)switch(type){case 3:return true;case 5:return val;case 6:return index;case 2:result.push(val)}else if(isEvery)return false}}return isFindIndex?-1:isSome||isEvery?isEvery:result}}function createArrayContains(isContains){return function(el){var O=toObject(this),length=toLength(O.length),index=toIndex(arguments[1],length);if(isContains&&el!=el){for(;length>index;index++)if(sameNaN(O[index]))return isContains||index}else for(;length>index;index++)if(isContains||index in O){if(O[index]===el)return isContains||index}return!isContains&&-1}}function generic(A,B){return typeof A=="function"?A:B}var MAX_SAFE_INTEGER=9007199254740991,pow=Math.pow,abs=Math.abs,ceil=Math.ceil,floor=Math.floor,max=Math.max,min=Math.min,random=Math.random,trunc=Math.trunc||function(it){return(it>0?floor:ceil)(it)};function sameNaN(number){return number!=number}function toInteger(it){return isNaN(it)?0:trunc(it)}function toLength(it){return it>0?min(toInteger(it),MAX_SAFE_INTEGER):0}function toIndex(index,length){var index=toInteger(index);return index<0?max(index+length,0):min(index,length)}function lz(num){return num>9?num:"0"+num}function createReplacer(regExp,replace,isStatic){var replacer=isObject(replace)?function(part){return replace[part]}:replace;return function(it){return String(isStatic?it:this).replace(regExp,replacer)}}function createPointAt(toString){return function(pos){var s=String(assertDefined(this)),i=toInteger(pos),l=s.length,a,b;if(i<0||i>=l)return toString?"":undefined;a=s.charCodeAt(i);return a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?toString?s.charAt(i):a:toString?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536}}var REDUCE_ERROR="Reduce of empty object with no initial value";function assert(condition,msg1,msg2){if(!condition)throw TypeError(msg2?msg1+msg2:msg1)}function assertDefined(it){if(it==undefined)throw TypeError("Function called on null or undefined");return it}function assertFunction(it){assert(isFunction(it),it," is not a function!");return it}function assertObject(it){assert(isObject(it),it," is not an object!");return it}function assertInstance(it,Constructor,name){assert(it instanceof Constructor,name,": use the 'new' operator!")}function descriptor(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}function simpleSet(object,key,value){object[key]=value;return object}function createDefiner(bitmap){return DESC?function(object,key,value){return defineProperty(object,key,descriptor(bitmap,value))}:simpleSet}function uid(key){return SYMBOL+"("+key+")_"+(++sid+random())[TO_STRING](36)}function getWellKnownSymbol(name,setter){return Symbol&&Symbol[name]||(setter?Symbol:safeSymbol)(SYMBOL+DOT+name)}var DESC=!!function(){try{return defineProperty({},"a",{get:function(){return 2}}).a==2}catch(e){}}(),sid=0,hidden=createDefiner(1),set=Symbol?simpleSet:hidden,safeSymbol=Symbol||uid;function assignHidden(target,src){for(var key in src)hidden(target,key,src[key]);return target}var SYMBOL_UNSCOPABLES=getWellKnownSymbol("unscopables"),ArrayUnscopables=ArrayProto[SYMBOL_UNSCOPABLES]||{},SYMBOL_TAG=getWellKnownSymbol(TO_STRING_TAG),SYMBOL_SPECIES=getWellKnownSymbol("species"),SYMBOL_ITERATOR;function setSpecies(C){if(DESC&&(framework||!isNative(C)))defineProperty(C,SYMBOL_SPECIES,{configurable:true,get:returnThis})}var NODE=cof(process)==PROCESS,core={},path=framework?global:core,old=global.core,exportGlobal,FORCED=1,GLOBAL=2,STATIC=4,PROTO=8,BIND=16,WRAP=32;function $define(type,name,source){var key,own,out,exp,isGlobal=type&GLOBAL,target=isGlobal?global:type&STATIC?global[name]:(global[name]||ObjectProto)[PROTOTYPE],exports=isGlobal?core:core[name]||(core[name]={});if(isGlobal)source=name;for(key in source){own=!(type&FORCED)&&target&&key in target&&(!isFunction(target[key])||isNative(target[key]));out=(own?target:source)[key];if(!framework&&isGlobal&&!isFunction(target[key]))exp=source[key];else if(type&BIND&&own)exp=ctx(out,global);else if(type&WRAP&&!framework&&target[key]==out){exp=function(param){return this instanceof out?new out(param):out(param)};exp[PROTOTYPE]=out[PROTOTYPE]}else exp=type&PROTO&&isFunction(out)?ctx(call,out):out;if(framework&&target&&!own){if(isGlobal)target[key]=out;else delete target[key]&&hidden(target,key,out)}if(exports[key]!=out)hidden(exports,key,exp)}}if(typeof module!="undefined"&&module.exports)module.exports=core;else if(isFunction(define)&&define.amd)define(function(){return core});else exportGlobal=true;if(exportGlobal||framework){core.noConflict=function(){global.core=old;return core};global.core=core}SYMBOL_ITERATOR=getWellKnownSymbol(ITERATOR);var ITER=safeSymbol("iter"),KEY=1,VALUE=2,Iterators={},IteratorPrototype={},BUGGY_ITERATORS="keys"in ArrayProto&&!("next"in[].keys());setIterator(IteratorPrototype,returnThis);function setIterator(O,value){hidden(O,SYMBOL_ITERATOR,value);FF_ITERATOR in ArrayProto&&hidden(O,FF_ITERATOR,value)}function createIterator(Constructor,NAME,next,proto){Constructor[PROTOTYPE]=create(proto||IteratorPrototype,{next:descriptor(1,next)});setToStringTag(Constructor,NAME+" Iterator")}function defineIterator(Constructor,NAME,value,DEFAULT){var proto=Constructor[PROTOTYPE],iter=get(proto,SYMBOL_ITERATOR)||get(proto,FF_ITERATOR)||DEFAULT&&get(proto,DEFAULT)||value;if(framework){setIterator(proto,iter);if(iter!==value){var iterProto=getPrototypeOf(iter.call(new Constructor));setToStringTag(iterProto,NAME+" Iterator",true);has(proto,FF_ITERATOR)&&setIterator(iterProto,returnThis)}}Iterators[NAME]=iter;Iterators[NAME+" Iterator"]=returnThis;return iter}function defineStdIterators(Base,NAME,Constructor,next,DEFAULT,IS_SET){function createIter(kind){return function(){return new Constructor(this,kind)}}createIterator(Constructor,NAME,next);var entries=createIter(KEY+VALUE),values=createIter(VALUE);if(DEFAULT==VALUE)values=defineIterator(Base,NAME,values,"values");else entries=defineIterator(Base,NAME,entries,"entries");if(DEFAULT){$define(PROTO+FORCED*BUGGY_ITERATORS,NAME,{entries:entries,keys:IS_SET?values:createIter(KEY),values:values})}}function iterResult(done,value){return{value:value,done:!!done}}function isIterable(it){var O=Object(it),Symbol=global[SYMBOL],hasExt=(Symbol&&Symbol[ITERATOR]||FF_ITERATOR)in O;return hasExt||SYMBOL_ITERATOR in O||has(Iterators,classof(O))}function getIterator(it){var Symbol=global[SYMBOL],ext=it[Symbol&&Symbol[ITERATOR]||FF_ITERATOR],getIter=ext||it[SYMBOL_ITERATOR]||Iterators[classof(it)];return assertObject(getIter.call(it))}function stepCall(fn,value,entries){return entries?invoke(fn,value):fn(value)}function checkDangerIterClosing(fn){var danger=true;var O={next:function(){throw 1},"return":function(){danger=false}};O[SYMBOL_ITERATOR]=returnThis;try{fn(O)}catch(e){}return danger}function closeIterator(iterator){var ret=iterator["return"];if(ret!==undefined)ret.call(iterator)}function safeIterClose(exec,iterator){try{exec(iterator)}catch(e){closeIterator(iterator);throw e}}function forOf(iterable,entries,fn,that){safeIterClose(function(iterator){var f=ctx(fn,that,entries?2:1),step;while(!(step=iterator.next()).done)if(stepCall(f,step.value,entries)===false){return closeIterator(iterator)}},getIterator(iterable))}!function(TAG,SymbolRegistry,AllSymbols,setter){if(!isNative(Symbol)){Symbol=function(description){assert(!(this instanceof Symbol),SYMBOL+" is not a "+CONSTRUCTOR);var tag=uid(description),sym=set(create(Symbol[PROTOTYPE]),TAG,tag);AllSymbols[tag]=sym;DESC&&setter&&defineProperty(ObjectProto,tag,{configurable:true,set:function(value){hidden(this,tag,value)}});return sym};hidden(Symbol[PROTOTYPE],TO_STRING,function(){return this[TAG]})}$define(GLOBAL+WRAP,{Symbol:Symbol});var symbolStatics={"for":function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=Symbol(key)},iterator:SYMBOL_ITERATOR||getWellKnownSymbol(ITERATOR),keyFor:part.call(keyOf,SymbolRegistry),species:SYMBOL_SPECIES,toStringTag:SYMBOL_TAG=getWellKnownSymbol(TO_STRING_TAG,true),unscopables:SYMBOL_UNSCOPABLES,pure:safeSymbol,set:set,useSetter:function(){setter=true},useSimple:function(){setter=false}};forEach.call(array("hasInstance,isConcatSpreadable,match,replace,search,split,toPrimitive"),function(it){symbolStatics[it]=getWellKnownSymbol(it)});$define(STATIC,SYMBOL,symbolStatics);setToStringTag(Symbol,SYMBOL);$define(STATIC+FORCED*!isNative(Symbol),OBJECT,{getOwnPropertyNames:function(it){var names=getNames(toObject(it)),result=[],key,i=0;while(names.length>i)has(AllSymbols,key=names[i++])||result.push(key);return result},getOwnPropertySymbols:function(it){var names=getNames(toObject(it)),result=[],key,i=0;while(names.length>i)has(AllSymbols,key=names[i++])&&result.push(AllSymbols[key]);return result}});setToStringTag(Math,MATH,true);setToStringTag(global.JSON,"JSON",true)}(safeSymbol("tag"),{},{},true);!function(){var objectStatic={assign:assign,is:function(x,y){return x===y?x!==0||1/x===1/y:x!=x&&y!=y}};"__proto__"in ObjectProto&&function(buggy,set){try{set=ctx(call,getOwnDescriptor(ObjectProto,"__proto__").set,2);set({},ArrayProto)}catch(e){buggy=true}objectStatic.setPrototypeOf=setPrototypeOf=setPrototypeOf||function(O,proto){assertObject(O);assert(proto===null||isObject(proto),proto,": can't set as prototype!");if(buggy)O.__proto__=proto;else set(O,proto);return O}}();$define(STATIC,OBJECT,objectStatic)}();!function(tmp){tmp[SYMBOL_TAG]=DOT;if(cof(tmp)!=DOT)hidden(ObjectProto,TO_STRING,function(){return"[object "+classof(this)+"]"})}({});!function(){function wrapObjectMethod(key,MODE){var fn=Object[key],exp=core[OBJECT][key],f=0,o={};if(!exp||isNative(exp)){o[key]=MODE==1?function(it){return isObject(it)?fn(it):it}:MODE==2?function(it){return isObject(it)?fn(it):true}:MODE==3?function(it){return isObject(it)?fn(it):false}:MODE==4?function(it,key){return fn(toObject(it),key)}:function(it){return fn(toObject(it))};try{fn(DOT)}catch(e){f=1}$define(STATIC+FORCED*f,OBJECT,o)}}wrapObjectMethod("freeze",1);wrapObjectMethod("seal",1);wrapObjectMethod("preventExtensions",1);wrapObjectMethod("isFrozen",2);wrapObjectMethod("isSealed",2);wrapObjectMethod("isExtensible",3);wrapObjectMethod("getOwnPropertyDescriptor",4);wrapObjectMethod("getPrototypeOf");wrapObjectMethod("keys");wrapObjectMethod("getOwnPropertyNames")}();!function(NAME){NAME in FunctionProto||DESC&&defineProperty(FunctionProto,NAME,{configurable:true,get:function(){var match=String(this).match(/^\s*function ([^ (]*)/),name=match?match[1]:"";has(this,NAME)||defineProperty(this,NAME,descriptor(5,name));return name},set:function(value){has(this,NAME)||defineProperty(this,NAME,descriptor(0,value))}})}("name");Number("0o1")&&Number("0b1")||function(_Number,NumberProto){function toNumber(it){if(isObject(it))it=toPrimitive(it);if(typeof it=="string"&&it.length>2&&it.charCodeAt(0)==48){var binary=false;switch(it.charCodeAt(1)){case 66:case 98:binary=true;case 79:case 111:return parseInt(it.slice(2),binary?2:8)}}return+it}function toPrimitive(it){var fn,val;if(isFunction(fn=it.valueOf)&&!isObject(val=fn.call(it)))return val;if(isFunction(fn=it[TO_STRING])&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to number")}Number=function Number(it){return this instanceof Number?new _Number(toNumber(it)):toNumber(it)};forEach.call(DESC?getNames(_Number):array("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY"),function(key){key in Number||defineProperty(Number,key,getOwnDescriptor(_Number,key))});Number[PROTOTYPE]=NumberProto;NumberProto[CONSTRUCTOR]=Number;hidden(global,NUMBER,Number)}(Number,Number[PROTOTYPE]);!function(isInteger){$define(STATIC,NUMBER,{EPSILON:pow(2,-52),isFinite:function(it){return typeof it=="number"&&isFinite(it)},isInteger:isInteger,isNaN:sameNaN,isSafeInteger:function(number){return isInteger(number)&&abs(number)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER:MAX_SAFE_INTEGER,MIN_SAFE_INTEGER:-MAX_SAFE_INTEGER,parseFloat:parseFloat,parseInt:parseInt})}(Number.isInteger||function(it){return!isObject(it)&&isFinite(it)&&floor(it)===it});!function(){var E=Math.E,exp=Math.exp,log=Math.log,sqrt=Math.sqrt,sign=Math.sign||function(x){return(x=+x)==0||x!=x?x:x<0?-1:1};function asinh(x){return!isFinite(x=+x)||x==0?x:x<0?-asinh(-x):log(x+sqrt(x*x+1))}function expm1(x){return(x=+x)==0?x:x>-1e-6&&x<1e-6?x+x*x/2:exp(x)-1}$define(STATIC,MATH,{acosh:function(x){return(x=+x)<1?NaN:isFinite(x)?log(x/E+sqrt(x+1)*sqrt(x-1)/E)+1:x},asinh:asinh,atanh:function(x){return(x=+x)==0?x:log((1+x)/(1-x))/2},cbrt:function(x){return sign(x=+x)*pow(abs(x),1/3)},clz32:function(x){return(x>>>=0)?32-x[TO_STRING](2).length:32},cosh:function(x){return(exp(x=+x)+exp(-x))/2},expm1:expm1,fround:function(x){return new Float32Array([x])[0]},hypot:function(value1,value2){var sum=0,len1=arguments.length,len2=len1,args=Array(len1),larg=-Infinity,arg;while(len1--){arg=args[len1]=+arguments[len1];if(arg==Infinity||arg==-Infinity)return Infinity;if(arg>larg)larg=arg}larg=arg||1;while(len2--)sum+=pow(args[len2]/larg,2);return larg*sqrt(sum)},imul:function(x,y){var UInt16=65535,xn=+x,yn=+y,xl=UInt16&xn,yl=UInt16&yn;return 0|xl*yl+((UInt16&xn>>>16)*yl+xl*(UInt16&yn>>>16)<<16>>>0)},log1p:function(x){return(x=+x)>-1e-8&&x<1e-8?x-x*x/2:log(1+x)},log10:function(x){return log(x)/Math.LN10},log2:function(x){return log(x)/Math.LN2},sign:sign,sinh:function(x){return abs(x=+x)<1?(expm1(x)-expm1(-x))/2:(exp(x-1)-exp(-x-1))*(E/2)},tanh:function(x){var a=expm1(x=+x),b=expm1(-x);return a==Infinity?1:b==Infinity?-1:(a-b)/(exp(x)+exp(-x))},trunc:trunc})}();!function(fromCharCode){function assertNotRegExp(it){if(cof(it)==REGEXP)throw TypeError()}$define(STATIC,STRING,{fromCodePoint:function(x){var res=[],len=arguments.length,i=0,code;while(len>i){code=+arguments[i++];if(toIndex(code,1114111)!==code)throw RangeError(code+" is not a valid code point");res.push(code<65536?fromCharCode(code):fromCharCode(((code-=65536)>>10)+55296,code%1024+56320))}return res.join("")},raw:function(callSite){var raw=toObject(callSite.raw),len=toLength(raw.length),sln=arguments.length,res=[],i=0;while(len>i){res.push(String(raw[i++]));if(i<sln)res.push(String(arguments[i]))}return res.join("")}});$define(PROTO,STRING,{codePointAt:createPointAt(false),endsWith:function(searchString){assertNotRegExp(searchString);var that=String(assertDefined(this)),endPosition=arguments[1],len=toLength(that.length),end=endPosition===undefined?len:min(toLength(endPosition),len);searchString+="";return that.slice(end-searchString.length,end)===searchString},includes:function(searchString){assertNotRegExp(searchString);return!!~String(assertDefined(this)).indexOf(searchString,arguments[1])},repeat:function(count){var str=String(assertDefined(this)),res="",n=toInteger(count);if(0>n||n==Infinity)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(str+=str))if(n&1)res+=str;return res},startsWith:function(searchString){assertNotRegExp(searchString);var that=String(assertDefined(this)),index=toLength(min(arguments[1],that.length));searchString+="";return that.slice(index,index+searchString.length)===searchString}})}(String.fromCharCode);!function(){$define(STATIC+FORCED*checkDangerIterClosing(Array.from),ARRAY,{from:function(arrayLike){var O=Object(assertDefined(arrayLike)),mapfn=arguments[1],mapping=mapfn!==undefined,f=mapping?ctx(mapfn,arguments[2],2):undefined,index=0,length,result,step;if(isIterable(O)){result=new(generic(this,Array));safeIterClose(function(iterator){for(;!(step=iterator.next()).done;index++){result[index]=mapping?f(step.value,index):step.value}},getIterator(O))}else{result=new(generic(this,Array))(length=toLength(O.length));for(;length>index;index++){result[index]=mapping?f(O[index],index):O[index]}}result.length=index;return result}});$define(STATIC,ARRAY,{of:function(){var index=0,length=arguments.length,result=new(generic(this,Array))(length);while(length>index)result[index]=arguments[index++];result.length=length;return result}});setSpecies(Array)}();!function(){$define(PROTO,ARRAY,{copyWithin:function(target,start){var O=Object(assertDefined(this)),len=toLength(O.length),to=toIndex(target,len),from=toIndex(start,len),end=arguments[2],fin=end===undefined?len:toIndex(end,len),count=min(fin-from,len-to),inc=1;if(from<to&&to<from+count){inc=-1;from=from+count-1;to=to+count-1}while(count-->0){if(from in O)O[to]=O[from];else delete O[to];to+=inc;from+=inc}return O},fill:function(value){var O=Object(assertDefined(this)),length=toLength(O.length),index=toIndex(arguments[1],length),end=arguments[2],endPos=end===undefined?length:toIndex(end,length);while(endPos>index)O[index++]=value;return O},find:createArrayMethod(5),findIndex:createArrayMethod(6)});if(framework){forEach.call(array("find,findIndex,fill,copyWithin,entries,keys,values"),function(it){ArrayUnscopables[it]=true});SYMBOL_UNSCOPABLES in ArrayProto||hidden(ArrayProto,SYMBOL_UNSCOPABLES,ArrayUnscopables)}}();!function(at){defineStdIterators(Array,ARRAY,function(iterated,kind){set(this,ITER,{o:toObject(iterated),i:0,k:kind})},function(){var iter=this[ITER],O=iter.o,kind=iter.k,index=iter.i++;if(!O||index>=O.length){iter.o=undefined;return iterResult(1)}if(kind==KEY)return iterResult(0,index);if(kind==VALUE)return iterResult(0,O[index]);return iterResult(0,[index,O[index]])},VALUE);Iterators[ARGUMENTS]=Iterators[ARRAY];defineStdIterators(String,STRING,function(iterated){set(this,ITER,{o:String(iterated),i:0})},function(){var iter=this[ITER],O=iter.o,index=iter.i,point;if(index>=O.length)return iterResult(1);point=at.call(O,index);iter.i+=point.length;return iterResult(0,point)})}(createPointAt(true));DESC&&!function(RegExpProto,_RegExp){if(!function(){try{return RegExp(/a/g,"i")=="/a/i"}catch(e){}}()){RegExp=function RegExp(pattern,flags){return new _RegExp(cof(pattern)==REGEXP&&flags!==undefined?pattern.source:pattern,flags)};forEach.call(getNames(_RegExp),function(key){key in RegExp||defineProperty(RegExp,key,{configurable:true,get:function(){return _RegExp[key]},set:function(it){_RegExp[key]=it}})});RegExpProto[CONSTRUCTOR]=RegExp;RegExp[PROTOTYPE]=RegExpProto;hidden(global,REGEXP,RegExp)}if(/./g.flags!="g")defineProperty(RegExpProto,"flags",{configurable:true,get:createReplacer(/^.*\/(\w*)$/,"$1")});setSpecies(RegExp)}(RegExp[PROTOTYPE],RegExp);isFunction(setImmediate)&&isFunction(clearImmediate)||function(ONREADYSTATECHANGE){var postMessage=global.postMessage,addEventListener=global.addEventListener,MessageChannel=global.MessageChannel,counter=0,queue={},defer,channel,port;setImmediate=function(fn){var args=[],i=1;while(arguments.length>i)args.push(arguments[i++]);queue[++counter]=function(){invoke(isFunction(fn)?fn:Function(fn),args)};defer(counter);return counter};clearImmediate=function(id){delete queue[id]};function run(id){if(has(queue,id)){var fn=queue[id];delete queue[id];fn()}}function listner(event){run(event.data)}if(NODE){defer=function(id){nextTick(part.call(run,id))}}else if(addEventListener&&isFunction(postMessage)&&!global.importScripts){defer=function(id){postMessage(id,"*")};addEventListener("message",listner,false)}else if(isFunction(MessageChannel)){channel=new MessageChannel;port=channel.port2;channel.port1.onmessage=listner;defer=ctx(port.postMessage,port,1)}else if(document&&ONREADYSTATECHANGE in document[CREATE_ELEMENT]("script")){defer=function(id){html.appendChild(document[CREATE_ELEMENT]("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this);run(id)}}}else{defer=function(id){setTimeout(run,0,id)}}}("onreadystatechange");$define(GLOBAL+BIND,{setImmediate:setImmediate,clearImmediate:clearImmediate});!function(Promise,test){isFunction(Promise)&&isFunction(Promise.resolve)&&Promise.resolve(test=new Promise(function(){}))==test||function(asap,RECORD){function isThenable(it){var then;if(isObject(it))then=it.then;return isFunction(then)?then:false}function handledRejectionOrHasOnRejected(promise){var record=promise[RECORD],chain=record.c,i=0,react;if(record.h)return true;while(chain.length>i){react=chain[i++];if(react.fail||handledRejectionOrHasOnRejected(react.P))return true}}function notify(record,reject){var chain=record.c;if(reject||chain.length)asap(function(){var promise=record.p,value=record.v,ok=record.s==1,i=0;if(reject&&!handledRejectionOrHasOnRejected(promise)){setTimeout(function(){if(!handledRejectionOrHasOnRejected(promise)){if(NODE){if(!process.emit("unhandledRejection",value,promise)){}}else if(isFunction(console.error)){console.error("Unhandled promise rejection",value)}}},1e3)}else while(chain.length>i)!function(react){var cb=ok?react.ok:react.fail,ret,then;try{if(cb){if(!ok)record.h=true;ret=cb===true?value:cb(value);if(ret===react.P){react.rej(TypeError(PROMISE+"-chain cycle"))}else if(then=isThenable(ret)){then.call(ret,react.res,react.rej)}else react.res(ret)}else react.rej(value)}catch(err){react.rej(err)}}(chain[i++]);chain.length=0})}function resolve(value){var record=this,then,wrapper;if(record.d)return;record.d=true;record=record.r||record;try{if(then=isThenable(value)){wrapper={r:record,d:false};then.call(value,ctx(resolve,wrapper,1),ctx(reject,wrapper,1))}else{record.v=value;record.s=1;notify(record)}}catch(err){reject.call(wrapper||{r:record,d:false},err)}}function reject(value){var record=this;if(record.d)return;record.d=true;record=record.r||record;record.v=value;record.s=2;notify(record,true)}function getConstructor(C){var S=assertObject(C)[SYMBOL_SPECIES];return S!=undefined?S:C}Promise=function(executor){assertFunction(executor);assertInstance(this,Promise,PROMISE);var record={p:this,c:[],s:0,d:false,v:undefined,h:false};hidden(this,RECORD,record);try{executor(ctx(resolve,record,1),ctx(reject,record,1))}catch(err){reject.call(record,err)}};assignHidden(Promise[PROTOTYPE],{then:function(onFulfilled,onRejected){var S=assertObject(assertObject(this)[CONSTRUCTOR])[SYMBOL_SPECIES];var react={ok:isFunction(onFulfilled)?onFulfilled:true,fail:isFunction(onRejected)?onRejected:false},P=react.P=new(S!=undefined?S:Promise)(function(resolve,reject){react.res=assertFunction(resolve);react.rej=assertFunction(reject)}),record=this[RECORD];record.c.push(react);record.s&&notify(record);return P},"catch":function(onRejected){return this.then(undefined,onRejected)}});assignHidden(Promise,{all:function(iterable){var Promise=getConstructor(this),values=[];return new Promise(function(resolve,reject){forOf(iterable,false,push,values);var remaining=values.length,results=Array(remaining);if(remaining)forEach.call(values,function(promise,index){Promise.resolve(promise).then(function(value){results[index]=value;--remaining||resolve(results)},reject)});else resolve(results)})},race:function(iterable){var Promise=getConstructor(this);return new Promise(function(resolve,reject){forOf(iterable,false,function(promise){Promise.resolve(promise).then(resolve,reject)})})},reject:function(r){return new(getConstructor(this))(function(resolve,reject){reject(r)})},resolve:function(x){return isObject(x)&&RECORD in x&&getPrototypeOf(x)===this[PROTOTYPE]?x:new(getConstructor(this))(function(resolve,reject){resolve(x)})}})}(nextTick||setImmediate,safeSymbol("record"));setToStringTag(Promise,PROMISE);setSpecies(Promise);$define(GLOBAL+FORCED*!isNative(Promise),{Promise:Promise})}(global[PROMISE]);!function(){var UID=safeSymbol("uid"),O1=safeSymbol("O1"),WEAK=safeSymbol("weak"),LEAK=safeSymbol("leak"),LAST=safeSymbol("last"),FIRST=safeSymbol("first"),SIZE=DESC?safeSymbol("size"):"size",uid=0,tmp={};function getCollection(C,NAME,methods,commonMethods,isMap,isWeak){var ADDER=isMap?"set":"add",proto=C&&C[PROTOTYPE],O={};function initFromIterable(that,iterable){if(iterable!=undefined)forOf(iterable,isMap,that[ADDER],that);return that}function fixSVZ(key,chain){var method=proto[key];if(framework)proto[key]=function(a,b){var result=method.call(this,a===0?0:a,b);return chain?this:result}}if(!isNative(C)||!(isWeak||!BUGGY_ITERATORS&&has(proto,FOR_EACH)&&has(proto,"entries"))){C=isWeak?function(iterable){assertInstance(this,C,NAME);set(this,UID,uid++);initFromIterable(this,iterable)}:function(iterable){var that=this;assertInstance(that,C,NAME);set(that,O1,create(null));set(that,SIZE,0);set(that,LAST,undefined);set(that,FIRST,undefined);initFromIterable(that,iterable)};assignHidden(assignHidden(C[PROTOTYPE],methods),commonMethods);isWeak||!DESC||defineProperty(C[PROTOTYPE],"size",{get:function(){return assertDefined(this[SIZE])}})}else{var Native=C,inst=new C,chain=inst[ADDER](isWeak?{}:-0,1),buggyZero;if(checkDangerIterClosing(function(O){new C(O)})){C=function(iterable){assertInstance(this,C,NAME);return initFromIterable(new Native,iterable)};C[PROTOTYPE]=proto;if(framework)proto[CONSTRUCTOR]=C}isWeak||inst[FOR_EACH](function(val,key){buggyZero=1/key===-Infinity});if(buggyZero){fixSVZ("delete");fixSVZ("has");isMap&&fixSVZ("get")}if(buggyZero||chain!==inst)fixSVZ(ADDER,true)}setToStringTag(C,NAME);setSpecies(C);O[NAME]=C;$define(GLOBAL+WRAP+FORCED*!isNative(C),O);isWeak||defineStdIterators(C,NAME,function(iterated,kind){set(this,ITER,{o:iterated,k:kind})},function(){var iter=this[ITER],kind=iter.k,entry=iter.l;while(entry&&entry.r)entry=entry.p;if(!iter.o||!(iter.l=entry=entry?entry.n:iter.o[FIRST])){iter.o=undefined;return iterResult(1)}if(kind==KEY)return iterResult(0,entry.k);if(kind==VALUE)return iterResult(0,entry.v);return iterResult(0,[entry.k,entry.v])},isMap?KEY+VALUE:VALUE,!isMap);return C}function fastKey(it,create){if(!isObject(it))return(typeof it=="string"?"S":"P")+it;if(isFrozen(it))return"F";if(!has(it,UID)){if(!create)return"E";hidden(it,UID,++uid)}return"O"+it[UID]}function getEntry(that,key){var index=fastKey(key),entry;if(index!="F")return that[O1][index];for(entry=that[FIRST];entry;entry=entry.n){if(entry.k==key)return entry}}function def(that,key,value){var entry=getEntry(that,key),prev,index;if(entry)entry.v=value;else{that[LAST]=entry={i:index=fastKey(key,true),k:key,v:value,p:prev=that[LAST],n:undefined,r:false};if(!that[FIRST])that[FIRST]=entry;if(prev)prev.n=entry;that[SIZE]++;if(index!="F")that[O1][index]=entry}return that}var collectionMethods={clear:function(){for(var that=this,data=that[O1],entry=that[FIRST];entry;entry=entry.n){entry.r=true;
if(entry.p)entry.p=entry.p.n=undefined;delete data[entry.i]}that[FIRST]=that[LAST]=undefined;that[SIZE]=0},"delete":function(key){var that=this,entry=getEntry(that,key);if(entry){var next=entry.n,prev=entry.p;delete that[O1][entry.i];entry.r=true;if(prev)prev.n=next;if(next)next.p=prev;if(that[FIRST]==entry)that[FIRST]=next;if(that[LAST]==entry)that[LAST]=prev;that[SIZE]--}return!!entry},forEach:function(callbackfn){var f=ctx(callbackfn,arguments[1],3),entry;while(entry=entry?entry.n:this[FIRST]){f(entry.v,entry.k,this);while(entry&&entry.r)entry=entry.p}},has:function(key){return!!getEntry(this,key)}};Map=getCollection(Map,MAP,{get:function(key){var entry=getEntry(this,key);return entry&&entry.v},set:function(key,value){return def(this,key===0?0:key,value)}},collectionMethods,true);Set=getCollection(Set,SET,{add:function(value){return def(this,value=value===0?0:value,value)}},collectionMethods);function defWeak(that,key,value){if(isFrozen(assertObject(key)))leakStore(that).set(key,value);else{has(key,WEAK)||hidden(key,WEAK,{});key[WEAK][that[UID]]=value}return that}function leakStore(that){return that[LEAK]||hidden(that,LEAK,new Map)[LEAK]}var weakMethods={"delete":function(key){if(!isObject(key))return false;if(isFrozen(key))return leakStore(this)["delete"](key);return has(key,WEAK)&&has(key[WEAK],this[UID])&&delete key[WEAK][this[UID]]},has:function(key){if(!isObject(key))return false;if(isFrozen(key))return leakStore(this).has(key);return has(key,WEAK)&&has(key[WEAK],this[UID])}};WeakMap=getCollection(WeakMap,WEAKMAP,{get:function(key){if(isObject(key)){if(isFrozen(key))return leakStore(this).get(key);if(has(key,WEAK))return key[WEAK][this[UID]]}},set:function(key,value){return defWeak(this,key,value)}},weakMethods,true,true);if(framework&&(new WeakMap).set(Object.freeze(tmp),7).get(tmp)!=7){forEach.call(array("delete,has,get,set"),function(key){var method=WeakMap[PROTOTYPE][key];WeakMap[PROTOTYPE][key]=function(a,b){if(isObject(a)&&isFrozen(a)){var result=leakStore(this)[key](a,b);return key=="set"?this:result}return method.call(this,a,b)}})}WeakSet=getCollection(WeakSet,WEAKSET,{add:function(value){return defWeak(this,value,true)}},weakMethods,false,true)}();!function(){function Enumerate(iterated){var keys=[],key;for(key in iterated)keys.push(key);set(this,ITER,{o:iterated,a:keys,i:0})}createIterator(Enumerate,OBJECT,function(){var iter=this[ITER],keys=iter.a,key;do{if(iter.i>=keys.length)return iterResult(1)}while(!((key=keys[iter.i++])in iter.o));return iterResult(0,key)});function wrap(fn){return function(it){assertObject(it);try{return fn.apply(undefined,arguments),true}catch(e){return false}}}function reflectGet(target,propertyKey){var receiver=arguments.length<3?target:arguments[2],desc=getOwnDescriptor(assertObject(target),propertyKey),proto;if(desc)return has(desc,"value")?desc.value:desc.get===undefined?undefined:desc.get.call(receiver);return isObject(proto=getPrototypeOf(target))?reflectGet(proto,propertyKey,receiver):undefined}function reflectSet(target,propertyKey,V){var receiver=arguments.length<4?target:arguments[3],ownDesc=getOwnDescriptor(assertObject(target),propertyKey),existingDescriptor,proto;if(!ownDesc){if(isObject(proto=getPrototypeOf(target))){return reflectSet(proto,propertyKey,V,receiver)}ownDesc=descriptor(0)}if(has(ownDesc,"value")){if(ownDesc.writable===false||!isObject(receiver))return false;existingDescriptor=getOwnDescriptor(receiver,propertyKey)||descriptor(0);existingDescriptor.value=V;return defineProperty(receiver,propertyKey,existingDescriptor),true}return ownDesc.set===undefined?false:(ownDesc.set.call(receiver,V),true)}var isExtensible=Object.isExtensible||returnIt;var reflect={apply:ctx(call,apply,3),construct:function(target,argumentsList){var proto=assertFunction(arguments.length<3?target:arguments[2])[PROTOTYPE],instance=create(isObject(proto)?proto:ObjectProto),result=apply.call(target,instance,argumentsList);return isObject(result)?result:instance},defineProperty:wrap(defineProperty),deleteProperty:function(target,propertyKey){var desc=getOwnDescriptor(assertObject(target),propertyKey);return desc&&!desc.configurable?false:delete target[propertyKey]},enumerate:function(target){return new Enumerate(assertObject(target))},get:reflectGet,getOwnPropertyDescriptor:function(target,propertyKey){return getOwnDescriptor(assertObject(target),propertyKey)},getPrototypeOf:function(target){return getPrototypeOf(assertObject(target))},has:function(target,propertyKey){return propertyKey in target},isExtensible:function(target){return!!isExtensible(assertObject(target))},ownKeys:ownKeys,preventExtensions:wrap(Object.preventExtensions||returnIt),set:reflectSet};if(setPrototypeOf)reflect.setPrototypeOf=function(target,proto){return setPrototypeOf(assertObject(target),proto),true};$define(GLOBAL,{Reflect:{}});$define(STATIC,"Reflect",reflect)}();!function(){$define(PROTO,ARRAY,{includes:createArrayContains(true)});$define(PROTO,STRING,{at:createPointAt(true)});function createObjectToArray(isEntries){return function(object){var O=toObject(object),keys=getKeys(object),length=keys.length,i=0,result=Array(length),key;if(isEntries)while(length>i)result[i]=[key=keys[i++],O[key]];else while(length>i)result[i]=O[keys[i++]];return result}}$define(STATIC,OBJECT,{getOwnPropertyDescriptors:function(object){var O=toObject(object),result={};forEach.call(ownKeys(O),function(key){defineProperty(result,key,descriptor(0,getOwnDescriptor(O,key)))});return result},values:createObjectToArray(false),entries:createObjectToArray(true)});$define(STATIC,REGEXP,{escape:createReplacer(/([\\\-[\]{}()*+?.,^$|])/g,"\\$1",true)})}();!function(REFERENCE){REFERENCE_GET=getWellKnownSymbol(REFERENCE+"Get",true);var REFERENCE_SET=getWellKnownSymbol(REFERENCE+SET,true),REFERENCE_DELETE=getWellKnownSymbol(REFERENCE+"Delete",true);$define(STATIC,SYMBOL,{referenceGet:REFERENCE_GET,referenceSet:REFERENCE_SET,referenceDelete:REFERENCE_DELETE});hidden(FunctionProto,REFERENCE_GET,returnThis);function setMapMethods(Constructor){if(Constructor){var MapProto=Constructor[PROTOTYPE];hidden(MapProto,REFERENCE_GET,MapProto.get);hidden(MapProto,REFERENCE_SET,MapProto.set);hidden(MapProto,REFERENCE_DELETE,MapProto["delete"])}}setMapMethods(Map);setMapMethods(WeakMap)}("reference");!function(arrayStatics){function setArrayStatics(keys,length){forEach.call(array(keys),function(key){if(key in ArrayProto)arrayStatics[key]=ctx(call,ArrayProto[key],length)})}setArrayStatics("pop,reverse,shift,keys,values,entries",1);setArrayStatics("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3);setArrayStatics("join,slice,concat,push,splice,unshift,sort,lastIndexOf,"+"reduce,reduceRight,copyWithin,fill,turn");$define(STATIC,ARRAY,arrayStatics)}({});!function(NodeList){if(framework&&NodeList&&!(SYMBOL_ITERATOR in NodeList[PROTOTYPE])){hidden(NodeList[PROTOTYPE],SYMBOL_ITERATOR,Iterators[ARRAY])}Iterators.NodeList=Iterators[ARRAY]}(global.NodeList)}(typeof self!="undefined"&&self.Math===Math?self:Function("return this")(),true)},{}],3:[function(require,module,exports){(function(global){!function(global){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var undefined;var iteratorSymbol=typeof Symbol==="function"&&Symbol.iterator||"@@iterator";var inModule=typeof module==="object";var runtime=global.regeneratorRuntime;if(runtime){if(inModule){module.exports=runtime}return}runtime=global.regeneratorRuntime=inModule?module.exports:{};function wrap(innerFn,outerFn,self,tryLocsList){return new Generator(innerFn,outerFn,self||null,tryLocsList||[])}runtime.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype;GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunction.displayName="GeneratorFunction";runtime.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};runtime.mark=function(genFun){genFun.__proto__=GeneratorFunctionPrototype;genFun.prototype=Object.create(Gp);return genFun};runtime.async=function(innerFn,outerFn,self,tryLocsList){return new Promise(function(resolve,reject){var generator=wrap(innerFn,outerFn,self,tryLocsList);var callNext=step.bind(generator.next);var callThrow=step.bind(generator["throw"]);function step(arg){var record=tryCatch(this,null,arg);if(record.type==="throw"){reject(record.arg);return}var info=record.arg;if(info.done){resolve(info.value)}else{Promise.resolve(info.value).then(callNext,callThrow)}}callNext()})};function Generator(innerFn,outerFn,self,tryLocsList){var generator=outerFn?Object.create(outerFn.prototype):this;var context=new Context(tryLocsList);var state=GenStateSuspendedStart;function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){return doneResult()}while(true){var delegate=context.delegate;if(delegate){var record=tryCatch(delegate.iterator[method],delegate.iterator,arg);if(record.type==="throw"){context.delegate=null;method="throw";arg=record.arg;continue}method="next";arg=undefined;var info=record.arg;if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc}else{state=GenStateSuspendedYield;return info}context.delegate=null}if(method==="next"){if(state===GenStateSuspendedStart&&typeof arg!=="undefined"){throw new TypeError("attempt to send "+JSON.stringify(arg)+" to newborn generator")}if(state===GenStateSuspendedYield){context.sent=arg}else{delete context.sent}}else if(method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw arg}if(context.dispatchException(arg)){method="next";arg=undefined}}else if(method==="return"){context.abrupt("return",arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;var info={value:record.arg,done:context.done};if(record.arg===ContinueSentinel){if(context.delegate&&method==="next"){arg=undefined}}else{return info}}else if(record.type==="throw"){state=GenStateCompleted;if(method==="next"){context.dispatchException(record.arg)}else{arg=record.arg}}}}generator.next=invoke.bind(generator,"next");generator["throw"]=invoke.bind(generator,"throw");generator["return"]=invoke.bind(generator,"return");return generator}Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset()}runtime.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}runtime.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(){this.prev=0;this.next=0;this.sent=undefined;this.done=false;this.delegate=null;this.tryEntries.forEach(resetTryEntry);for(var tempIndex=0,tempName;hasOwn.call(this,tempName="t"+tempIndex)||tempIndex<20;++tempIndex){this[tempName]=null}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.next=finallyEntry.finallyLoc}else{this.complete(record)}return ContinueSentinel},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=record.arg;this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){return this.complete(entry.completion,entry.afterLoc)}}},"catch":function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};return ContinueSentinel}}}(typeof global==="object"?global:typeof window==="object"?window:this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[1]);"format register";!function(t){function e(t){for(var e=[],n=0,r=t.length;r>n;n++)-1==p.call(e,t[n])&&e.push(t[n]);return e}function n(t,n,r,i){if("string"!=typeof t)throw"System.register provided no module name";var o;o="boolean"==typeof r?{declarative:!1,deps:n,execute:i,executingRequire:r}:{declarative:!0,deps:n,declare:r},o.name=t,f[t]||(f[t]=o),o.deps=e(o.deps),o.normalizedDeps=o.deps}function r(t,e){if(e[t.groupIndex]=e[t.groupIndex]||[],-1==p.call(e[t.groupIndex],t)){e[t.groupIndex].push(t);for(var n=0,i=t.normalizedDeps.length;i>n;n++){var o=t.normalizedDeps[n],a=f[o];if(a&&!a.evaluated){var u=t.groupIndex+(a.declarative!=t.declarative);if(void 0===a.groupIndex||a.groupIndex<u){if(void 0!==a.groupIndex&&(e[a.groupIndex].splice(p.call(e[a.groupIndex],a),1),0==e[a.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");a.groupIndex=u}r(a,e)}}}}function i(t){var e=f[t];e.groupIndex=0;var n=[];r(e,n);for(var i=!!e.declarative==n.length%2,o=n.length-1;o>=0;o--){for(var u=n[o],c=0;c<u.length;c++){var l=u[c];i?a(l):s(l)}i=!i}}function o(t){return m[t]||(m[t]={name:t,dependencies:[],exports:{},importers:[]})}function a(e){if(!e.module){var n=e.module=o(e.name),r=e.module.exports,i=e.declare.call(t,function(t,e){n.locked=!0,r[t]=e;for(var i=0,o=n.importers.length;o>i;i++){var a=n.importers[i];if(!a.locked){var u=p.call(a.dependencies,n);a.setters[u](r)}}return n.locked=!1,e});if(n.setters=i.setters,n.execute=i.execute,!n.setters||!n.execute)throw new TypeError("Invalid System.register form for "+e.name);for(var u=0,s=e.normalizedDeps.length;s>u;u++){var c,h=e.normalizedDeps[u],d=f[h],g=m[h];g?c=g.exports:d&&!d.declarative?c={"default":d.module.exports,__useDefault:!0}:d?(a(d),g=d.module,c=g.exports):c=l(h),g&&g.importers?(g.importers.push(n),n.dependencies.push(g)):n.dependencies.push(null),n.setters[u]&&n.setters[u](c)}}}function u(t){var e,n=f[t];if(n)n.declarative?c(t,[]):n.evaluated||s(n),e=n.module.exports;else if(e=l(t),!e)throw new Error("Unable to load dependency "+t+".");return(!n||n.declarative)&&e&&e.__useDefault?e["default"]:e}function s(e){if(!e.module){var n={},r=e.module={exports:n,id:e.name};if(!e.executingRequire)for(var i=0,o=e.normalizedDeps.length;o>i;i++){var a=e.normalizedDeps[i],c=f[a];c&&s(c)}e.evaluated=!0;var l=e.execute.call(t,function(t){for(var n=0,r=e.deps.length;r>n;n++)if(e.deps[n]==t)return u(e.normalizedDeps[n]);throw new TypeError("Module "+t+" not declared as a dependency.")},n,r);l&&(r.exports=l)}}function c(e,n){var r=f[e];if(!r.evaluated&&r.declarative){n.push(e);for(var i=0,o=r.normalizedDeps.length;o>i;i++){var a=r.normalizedDeps[i];-1==p.call(n,a)&&(f[a]?c(a,n):l(a))}r.evaluated||(r.evaluated=!0,r.module.execute.call(t))}}function l(t){if(h[t])return h[t];var e=f[t];if(!e)throw"Module "+t+" not present.";i(t),c(t,[]),f[t]=void 0;var n=e.declarative?e.module.exports:{"default":e.module.exports,__useDefault:!0};return h[t]=n}var f={},p=Array.prototype.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},m={},h={};return function(e,r){var i;"undefined"!=typeof i&&i.register?(r(i),i["import"](e)):(r(i={register:n,get:l,set:function(t,e){h[t]=e},newModule:function(t){return t},global:t}),i.set("@empty",i.newModule({})),l(e))}}("undefined"!=typeof window?window:global)("main",function(t){t.register("github:maxdavidson/tribus@master/extra/webgl-debug",[],function(t){function e(t){if(null==h){h={},d={};for(var e in t)"number"==typeof t[e]&&(h[t[e]]=e,d[e]=t[e])}}function n(){if(null==h)throw"WebGLDebugUtils.init(ctx) not called"}function r(t){return n(),void 0!==h[t]}function i(t){n();var e=h[t];return void 0!==e?"gl."+e:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function o(t,e,n,r){var o=m[t];if(void 0!==o){var o=o[e];if(void 0!==o&&o[n]){if("object"==typeof o[n]&&void 0!==o[n].enumBitwiseOr){for(var a=o[n].enumBitwiseOr,u=0,s=[],c=0;c<a.length;++c){var l=d[a[c]];0!==(r&l)&&(u|=l,s.push(i(l)))}return u===r?s.join(" | "):i(r)}return i(r)}}return null===r?"null":void 0===r?"undefined":r.toString()}function a(t,e){for(var n="",r=e.length,i=0;r>i;++i)n+=(0==i?"":", ")+o(t,r,i,e[i]);return n}function u(t,e,n){t.__defineGetter__(n,function(){return e[n]}),t.__defineSetter__(n,function(t){e[n]=t})}function s(t,n,r,a){function c(t,e){return function(){r&&r(e,arguments);var i=t[e].apply(t,arguments),o=a.getError();return 0!=o&&(l[o]=!0,n(o,e,arguments)),i}}a=a||t,e(t),n=n||function(t,e,n){for(var r="",a=n.length,u=0;a>u;++u)r+=(0==u?"":", ")+o(e,a,u,n[u]);p("WebGL error "+i(t)+" in "+e+"("+r+")")};var l={},f={};for(var m in t)if("function"==typeof t[m])if("getExtension"!=m)f[m]=c(t,m);else{var h=c(t,m);f[m]=function(){var e=h.apply(t,arguments);return s(e,n,r,a)}}else u(f,t,m);return f.getError=function(){for(var e in l)if(l.hasOwnProperty(e)&&l[e])return l[e]=!1,e;return t.NO_ERROR},f}function c(t){var e=t.getParameter(t.MAX_VERTEX_ATTRIBS),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n);for(var r=0;e>r;++r)t.disableVertexAttribArray(r),t.vertexAttribPointer(r,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(r,0);t.deleteBuffer(n);for(var i=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r=0;i>r;++r)t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null);for(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT);t.getError(););}function l(t){function e(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}function n(t){var e=t.addEventListener;t.addEventListener=function(n,r){switch(n){case"webglcontextlost":T(r);break;case"webglcontextrestored":_(r);break;default:e.apply(t,arguments)}}}function r(){for(var t=Object.keys(E),e=0;e<t.length;++e)delete E[t]}function i(){++y,g||b==y&&t.loseContext()}function o(t,e){var n=t[e];return function(){if(i(),!g){var e=n.apply(t,arguments);return e}}}function a(){for(var t=0;t<v.length;++t){var e=v[t];e instanceof WebGLBuffer?f.deleteBuffer(e):e instanceof WebGLFramebuffer?f.deleteFramebuffer(e):e instanceof WebGLProgram?f.deleteProgram(e):e instanceof WebGLRenderbuffer?f.deleteRenderbuffer(e):e instanceof WebGLShader?f.deleteShader(e):e instanceof WebGLTexture&&f.deleteTexture(e)}}function s(t){return{statusMessage:t,preventDefault:function(){x=!0}}}function l(t){for(var e in t)"function"==typeof t[e]?p[e]=o(t,e):u(p,t,e);p.getError=function(){if(i(),!g)for(var t;t=f.getError();)E[t]=!0;for(var t in E)if(E[t])return delete E[t],t;return p.NO_ERROR};for(var n=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],r=0;r<n.length;++r){var a=n[r];p[a]=function(e){return function(){if(i(),g)return null;var n=e.apply(t,arguments);return n.__webglDebugContextLostId__=d,v.push(n),n}}(t[a])}for(var s=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],r=0;r<s.length;++r){var a=s[r];p[a]=function(e){return function(){return i(),g?null:e.apply(t,arguments)}}(p[a])}for(var c=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],r=0;r<c.length;++r){var a=c[r];p[a]=function(e){return function(){return i(),g?!1:e.apply(t,arguments)}}(p[a])}return p.checkFramebufferStatus=function(e){return function(){return i(),g?p.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(p.checkFramebufferStatus),p.getAttribLocation=function(e){return function(){return i(),g?-1:e.apply(t,arguments)}}(p.getAttribLocation),p.getVertexAttribOffset=function(e){return function(){return i(),g?0:e.apply(t,arguments)}}(p.getVertexAttribOffset),p.isContextLost=function(){return g},p}var f,p,m=[],h=[],p={},d=1,g=!1,v=[],b=0,y=0,x=!1,w=0,E={};t.getContext=function(e){return function(){var n=e.apply(t,arguments);if(n instanceof WebGLRenderingContext){if(n!=f){if(f)throw"got different context";f=n,p=l(f)}return p}return n}}(t.getContext);var T=function(t){m.push(e(t))},_=function(t){h.push(e(t))};return n(t),t.loseContext=function(){if(!g){for(g=!0,b=0,++d;f.getError(););r(),E[f.CONTEXT_LOST_WEBGL]=!0;var e=s("context lost"),n=m.slice();setTimeout(function(){for(var r=0;r<n.length;++r)n[r](e);w>=0&&setTimeout(function(){t.restoreContext()},w)},0)}},t.restoreContext=function(){g&&h.length&&setTimeout(function(){if(!x)throw"can not restore. webglcontestlost listener did not call event.preventDefault";a(),c(f),g=!1,y=0,x=!1;for(var t=h.slice(),e=s("context restored"),n=0;n<t.length;++n)t[n](e)},0)},t.loseContextInNCalls=function(t){if(g)throw"You can not ask a lost contet to be lost";b=y+t},t.getNumCalls=function(){return y},t.setRestoreTimeout=function(t){w=t},t}var f,p,m,h,d;return{setters:[],execute:function(){"use strict";f=function(t){window.console&&window.console.log&&window.console.log(t)},p=function(t){window.console&&window.console.error?window.console.error(t):f(t)},m={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},h=null,d=null,t("default",{init:e,mightBeEnum:r,glEnumToString:i,glFunctionArgToString:o,glFunctionArgsToString:a,makeDebugContext:s,makeLostContextSimulatingCanvas:l,resetToInitialState:c})}}}),function(){function e(){}e.amd={},function(n){"use strict";var r={};"undefined"==typeof exports?"function"==typeof e&&"object"==typeof e.amd&&e.amd?(r.exports={},t.register("github:toji/gl-matrix@2.2.1/dist/gl-matrix",[],!1,function(){return r.exports})):r.exports="undefined"!=typeof window?window:n:r.exports=exports,function(t){if(!e)var e=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!r)var r=Math.random;var i={};i.setMatrixArrayType=function(t){n=t},"undefined"!=typeof t&&(t.glMatrix=i);var o=Math.PI/180;i.toRadian=function(t){return t*o};var a={};a.create=function(){var t=new n(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new n(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var r=new n(2);return r[0]=t,r[1]=e,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,n){return t[0]=e,t[1]=n,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},a.div=a.divide,a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},a.lerp=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t},a.random=function(t,e){e=e||1;var n=2*r()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},a.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},a.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},a.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},a.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},a.forEach=function(){var t=a.create();return function(e,n,r,i,o,a){var u,s;for(n||(n=2),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;s>u;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,a),e[u]=t[0],e[u+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=a);var u={};u.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},u.clone=function(t){var e=new n(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},u.fromValues=function(t,e,r){var i=new n(3);return i[0]=t,i[1]=e,i[2]=r,i},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},u.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},u.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},u.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},u.sub=u.subtract,u.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},u.mul=u.multiply,u.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},u.div=u.divide,u.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},u.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},u.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},u.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},u.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},u.dist=u.distance,u.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i},u.sqrDist=u.squaredDistance,u.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},u.len=u.length,u.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},u.sqrLen=u.squaredLength,u.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},u.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},u.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},u.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2];return t[0]=i*s-o*u,t[1]=o*a-r*s,t[2]=r*u-i*a,t},u.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t},u.random=function(t,e){e=e||1;var n=2*r()*Math.PI,i=2*r()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t},u.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12],t[1]=n[1]*r+n[5]*i+n[9]*o+n[13],t[2]=n[2]*r+n[6]*i+n[10]*o+n[14],t},u.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},u.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2],c=n[3],l=c*r+u*o-s*i,f=c*i+s*r-a*o,p=c*o+a*i-u*r,m=-a*r-u*i-s*o;return t[0]=l*c+m*-a+f*-s-p*-u,t[1]=f*c+m*-u+p*-a-l*-s,t[2]=p*c+m*-s+l*-u-f*-a,t},u.rotateX=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},u.rotateY=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},u.rotateZ=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},u.forEach=function(){var t=u.create();return function(e,n,r,i,o,a){var u,s;for(n||(n=3),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;s>u;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),u.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=u);var s={};s.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},s.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},s.fromValues=function(t,e,r,i){var o=new n(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},s.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},s.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},s.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},s.sub=s.subtract,s.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},s.mul=s.multiply,s.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},s.div=s.divide,s.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},s.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},s.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},s.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},s.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)},s.dist=s.distance,s.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)},s.len=s.length,s.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},s.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},s.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=u+r*(n[3]-u),t},s.random=function(t,e){return e=e||1,t[0]=r(),t[1]=r(),t[2]=r(),t[3]=r(),s.normalize(t,t),s.scale(t,t,e),t},s.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t},s.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2],c=n[3],l=c*r+u*o-s*i,f=c*i+s*r-a*o,p=c*o+a*i-u*r,m=-a*r-u*i-s*o;return t[0]=l*c+m*-a+f*-s-p*-u,t[1]=f*c+m*-u+p*-a-l*-s,t[2]=p*c+m*-s+l*-u-f*-a,t},s.forEach=function(){var t=s.create();return function(e,n,r,i,o,a){var u,s;for(n||(n=4),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;s>u;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),s.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=s);var c={};c.create=function(){var t=new n(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},c.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null},c.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},c.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},c.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1],c=n[2],l=n[3];return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*c+o*l,t[3]=i*c+a*l,t},c.mul=c.multiply,c.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*-u+o*s,t[3]=i*-u+a*s,t},c.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1];return t[0]=r*u,t[1]=i*u,t[2]=o*s,t[3]=a*s,t},c.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},c.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},"undefined"!=typeof t&&(t.mat2=c);var l={};l.create=function(){var t=new n(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.clone=function(t){var e=new n(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=n*o-r*i;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-i*s,t[3]=n*s,t[4]=(i*u-o*a)*s,t[5]=(r*a-n*u)*s,t):null},l.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},l.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=n[0],l=n[1],f=n[2],p=n[3],m=n[4],h=n[5];return t[0]=r*c+o*l,t[1]=i*c+a*l,t[2]=r*f+o*p,t[3]=i*f+a*p,t[4]=r*m+o*h+u,t[5]=i*m+a*h+s,t},l.mul=l.multiply,l.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*c,t[1]=i*l+a*c,t[2]=r*-c+o*l,t[3]=i*-c+a*l,t[4]=u,t[5]=s,t},l.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=n[0],l=n[1];return t[0]=r*c,t[1]=i*c,t[2]=o*l,t[3]=a*l,t[4]=u,t[5]=s,t},l.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=n[0],l=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*l+u,t[5]=i*c+a*l+s,t},l.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=l);var f={};f.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},f.clone=function(t){var e=new n(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},f.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=l*a-u*c,p=-l*o+u*s,m=c*o-a*s,h=n*f+r*p+i*m;return h?(h=1/h,t[0]=f*h,t[1]=(-l*r+i*c)*h,t[2]=(u*r-i*a)*h,t[3]=p*h,t[4]=(l*n-i*s)*h,t[5]=(-u*n+i*o)*h,t[6]=m*h,t[7]=(-c*n+r*s)*h,t[8]=(a*n-r*o)*h,t):null},f.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8];return t[0]=a*l-u*c,t[1]=i*c-r*l,t[2]=r*u-i*a,t[3]=u*s-o*l,t[4]=n*l-i*s,t[5]=i*o-n*u,t[6]=o*c-a*s,t[7]=r*s-n*c,t[8]=n*a-r*o,t},f.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return e*(c*o-a*s)+n*(-c*i+a*u)+r*(s*i-o*u)},f.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],p=n[0],m=n[1],h=n[2],d=n[3],g=n[4],v=n[5],b=n[6],y=n[7],x=n[8];return t[0]=p*r+m*a+h*c,t[1]=p*i+m*u+h*l,t[2]=p*o+m*s+h*f,t[3]=d*r+g*a+v*c,t[4]=d*i+g*u+v*l,t[5]=d*o+g*s+v*f,t[6]=b*r+y*a+x*c,t[7]=b*i+y*u+x*l,t[8]=b*o+y*s+x*f,t},f.mul=f.multiply,f.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],p=n[0],m=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=p*r+m*a+c,t[7]=p*i+m*u+l,t[8]=p*o+m*s+f,t},f.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],p=Math.sin(n),m=Math.cos(n);return t[0]=m*r+p*a,t[1]=m*i+p*u,t[2]=m*o+p*s,t[3]=m*a-p*r,t[4]=m*u-p*i,t[5]=m*s-p*o,t[6]=c,t[7]=l,t[8]=f,t},f.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},f.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},f.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,c=n*a,l=r*a,f=r*u,p=i*a,m=i*u,h=i*s,d=o*a,g=o*u,v=o*s;return t[0]=1-f-h,t[3]=l-v,t[6]=p+g,t[1]=l+v,t[4]=1-c-h,t[7]=m-d,t[2]=p-g,t[5]=m+d,t[8]=1-c-f,t},f.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=e[9],p=e[10],m=e[11],h=e[12],d=e[13],g=e[14],v=e[15],b=n*u-r*a,y=n*s-i*a,x=n*c-o*a,w=r*s-i*u,E=r*c-o*u,T=i*c-o*s,_=l*d-f*h,A=l*g-p*h,M=l*v-m*h,S=f*g-p*d,R=f*v-m*d,D=p*v-m*g,I=b*D-y*R+x*S+w*M-E*A+T*_;return I?(I=1/I,t[0]=(u*D-s*R+c*S)*I,t[1]=(s*M-a*D-c*A)*I,t[2]=(a*R-u*M+c*_)*I,t[3]=(i*R-r*D-o*S)*I,t[4]=(n*D-i*M+o*A)*I,t[5]=(r*M-n*R-o*_)*I,t[6]=(d*T-g*E+v*w)*I,t[7]=(g*x-h*T-v*y)*I,t[8]=(h*E-d*x+v*b)*I,t):null},f.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},f.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=f);var p={};p.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.clone=function(t){var e=new n(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},p.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},p.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=e[9],p=e[10],m=e[11],h=e[12],d=e[13],g=e[14],v=e[15],b=n*u-r*a,y=n*s-i*a,x=n*c-o*a,w=r*s-i*u,E=r*c-o*u,T=i*c-o*s,_=l*d-f*h,A=l*g-p*h,M=l*v-m*h,S=f*g-p*d,R=f*v-m*d,D=p*v-m*g,I=b*D-y*R+x*S+w*M-E*A+T*_;return I?(I=1/I,t[0]=(u*D-s*R+c*S)*I,t[1]=(i*R-r*D-o*S)*I,t[2]=(d*T-g*E+v*w)*I,t[3]=(p*E-f*T-m*w)*I,t[4]=(s*M-a*D-c*A)*I,t[5]=(n*D-i*M+o*A)*I,t[6]=(g*x-h*T-v*y)*I,t[7]=(l*T-p*x+m*y)*I,t[8]=(a*R-u*M+c*_)*I,t[9]=(r*M-n*R-o*_)*I,t[10]=(h*E-d*x+v*b)*I,t[11]=(f*x-l*E-m*b)*I,t[12]=(u*A-a*S-s*_)*I,t[13]=(n*S-r*A+i*_)*I,t[14]=(d*y-h*w-g*b)*I,t[15]=(l*w-f*y+p*b)*I,t):null},p.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=e[9],p=e[10],m=e[11],h=e[12],d=e[13],g=e[14],v=e[15];return t[0]=u*(p*v-m*g)-f*(s*v-c*g)+d*(s*m-c*p),t[1]=-(r*(p*v-m*g)-f*(i*v-o*g)+d*(i*m-o*p)),t[2]=r*(s*v-c*g)-u*(i*v-o*g)+d*(i*c-o*s),t[3]=-(r*(s*m-c*p)-u*(i*m-o*p)+f*(i*c-o*s)),t[4]=-(a*(p*v-m*g)-l*(s*v-c*g)+h*(s*m-c*p)),t[5]=n*(p*v-m*g)-l*(i*v-o*g)+h*(i*m-o*p),t[6]=-(n*(s*v-c*g)-a*(i*v-o*g)+h*(i*c-o*s)),t[7]=n*(s*m-c*p)-a*(i*m-o*p)+l*(i*c-o*s),t[8]=a*(f*v-m*d)-l*(u*v-c*d)+h*(u*m-c*f),t[9]=-(n*(f*v-m*d)-l*(r*v-o*d)+h*(r*m-o*f)),t[10]=n*(u*v-c*d)-a*(r*v-o*d)+h*(r*c-o*u),t[11]=-(n*(u*m-c*f)-a*(r*m-o*f)+l*(r*c-o*u)),t[12]=-(a*(f*g-p*d)-l*(u*g-s*d)+h*(u*p-s*f)),t[13]=n*(f*g-p*d)-l*(r*g-i*d)+h*(r*p-i*f),t[14]=-(n*(u*g-s*d)-a*(r*g-i*d)+h*(r*s-i*u)),t[15]=n*(u*p-s*f)-a*(r*p-i*f)+l*(r*s-i*u),t},p.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],l=t[9],f=t[10],p=t[11],m=t[12],h=t[13],d=t[14],g=t[15],v=e*a-n*o,b=e*u-r*o,y=e*s-i*o,x=n*u-r*a,w=n*s-i*a,E=r*s-i*u,T=c*h-l*m,_=c*d-f*m,A=c*g-p*m,M=l*d-f*h,S=l*g-p*h,R=f*g-p*d;return v*R-b*S+y*M+x*A-w*_+E*T},p.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],p=e[9],m=e[10],h=e[11],d=e[12],g=e[13],v=e[14],b=e[15],y=n[0],x=n[1],w=n[2],E=n[3];return t[0]=y*r+x*u+w*f+E*d,t[1]=y*i+x*s+w*p+E*g,t[2]=y*o+x*c+w*m+E*v,t[3]=y*a+x*l+w*h+E*b,y=n[4],x=n[5],w=n[6],E=n[7],t[4]=y*r+x*u+w*f+E*d,t[5]=y*i+x*s+w*p+E*g,t[6]=y*o+x*c+w*m+E*v,t[7]=y*a+x*l+w*h+E*b,y=n[8],x=n[9],w=n[10],E=n[11],t[8]=y*r+x*u+w*f+E*d,t[9]=y*i+x*s+w*p+E*g,t[10]=y*o+x*c+w*m+E*v,t[11]=y*a+x*l+w*h+E*b,y=n[12],x=n[13],w=n[14],E=n[15],t[12]=y*r+x*u+w*f+E*d,t[13]=y*i+x*s+w*p+E*g,t[14]=y*o+x*c+w*m+E*v,t[15]=y*a+x*l+w*h+E*b,t
},p.mul=p.multiply,p.translate=function(t,e,n){var r,i,o,a,u,s,c,l,f,p,m,h,d=n[0],g=n[1],v=n[2];return e===t?(t[12]=e[0]*d+e[4]*g+e[8]*v+e[12],t[13]=e[1]*d+e[5]*g+e[9]*v+e[13],t[14]=e[2]*d+e[6]*g+e[10]*v+e[14],t[15]=e[3]*d+e[7]*g+e[11]*v+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],f=e[8],p=e[9],m=e[10],h=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=l,t[8]=f,t[9]=p,t[10]=m,t[11]=h,t[12]=r*d+u*g+f*v+e[12],t[13]=i*d+s*g+p*v+e[13],t[14]=o*d+c*g+m*v+e[14],t[15]=a*d+l*g+h*v+e[15]),t},p.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.rotate=function(t,n,r,i){var o,a,u,s,c,l,f,p,m,h,d,g,v,b,y,x,w,E,T,_,A,M,S,R,D=i[0],I=i[1],O=i[2],L=Math.sqrt(D*D+I*I+O*O);return Math.abs(L)<e?null:(L=1/L,D*=L,I*=L,O*=L,o=Math.sin(r),a=Math.cos(r),u=1-a,s=n[0],c=n[1],l=n[2],f=n[3],p=n[4],m=n[5],h=n[6],d=n[7],g=n[8],v=n[9],b=n[10],y=n[11],x=D*D*u+a,w=I*D*u+O*o,E=O*D*u-I*o,T=D*I*u-O*o,_=I*I*u+a,A=O*I*u+D*o,M=D*O*u+I*o,S=I*O*u-D*o,R=O*O*u+a,t[0]=s*x+p*w+g*E,t[1]=c*x+m*w+v*E,t[2]=l*x+h*w+b*E,t[3]=f*x+d*w+y*E,t[4]=s*T+p*_+g*A,t[5]=c*T+m*_+v*A,t[6]=l*T+h*_+b*A,t[7]=f*T+d*_+y*A,t[8]=s*M+p*S+g*R,t[9]=c*M+m*S+v*R,t[10]=l*M+h*S+b*R,t[11]=f*M+d*S+y*R,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},p.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],u=e[6],s=e[7],c=e[8],l=e[9],f=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=u*i+f*r,t[7]=s*i+p*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-u*r,t[11]=p*i-s*r,t},p.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],c=e[8],l=e[9],f=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=u*i-f*r,t[3]=s*i-p*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=u*r+f*i,t[11]=s*r+p*i,t},p.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],c=e[4],l=e[5],f=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=u*i+f*r,t[3]=s*i+p*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-u*r,t[7]=p*i-s*r,t},p.fromRotationTranslation=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=r+r,s=i+i,c=o+o,l=r*u,f=r*s,p=r*c,m=i*s,h=i*c,d=o*c,g=a*u,v=a*s,b=a*c;return t[0]=1-(m+d),t[1]=f+b,t[2]=p-v,t[3]=0,t[4]=f-b,t[5]=1-(l+d),t[6]=h+g,t[7]=0,t[8]=p+v,t[9]=h-g,t[10]=1-(l+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},p.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,c=n*a,l=r*a,f=r*u,p=i*a,m=i*u,h=i*s,d=o*a,g=o*u,v=o*s;return t[0]=1-f-h,t[1]=l+v,t[2]=p-g,t[3]=0,t[4]=l-v,t[5]=1-c-h,t[6]=m+d,t[7]=0,t[8]=p+g,t[9]=m-d,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.frustum=function(t,e,n,r,i,o,a){var u=1/(n-e),s=1/(i-r),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},p.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},p.ortho=function(t,e,n,r,i,o,a){var u=1/(e-n),s=1/(r-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=(a+o)*c,t[15]=1,t},p.lookAt=function(t,n,r,i){var o,a,u,s,c,l,f,m,h,d,g=n[0],v=n[1],b=n[2],y=i[0],x=i[1],w=i[2],E=r[0],T=r[1],_=r[2];return Math.abs(g-E)<e&&Math.abs(v-T)<e&&Math.abs(b-_)<e?p.identity(t):(f=g-E,m=v-T,h=b-_,d=1/Math.sqrt(f*f+m*m+h*h),f*=d,m*=d,h*=d,o=x*h-w*m,a=w*f-y*h,u=y*m-x*f,d=Math.sqrt(o*o+a*a+u*u),d?(d=1/d,o*=d,a*=d,u*=d):(o=0,a=0,u=0),s=m*u-h*a,c=h*o-f*u,l=f*a-m*o,d=Math.sqrt(s*s+c*c+l*l),d?(d=1/d,s*=d,c*=d,l*=d):(s=0,c=0,l=0),t[0]=o,t[1]=s,t[2]=f,t[3]=0,t[4]=a,t[5]=c,t[6]=m,t[7]=0,t[8]=u,t[9]=l,t[10]=h,t[11]=0,t[12]=-(o*g+a*v+u*b),t[13]=-(s*g+c*v+l*b),t[14]=-(f*g+m*v+h*b),t[15]=1,t)},p.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},p.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=p);var m={};m.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},m.rotationTo=function(){var t=u.create(),e=u.fromValues(1,0,0),n=u.fromValues(0,1,0);return function(r,i,o){var a=u.dot(i,o);return-.999999>a?(u.cross(t,e,i),u.length(t)<1e-6&&u.cross(t,n,i),u.normalize(t,t),m.setAxisAngle(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(u.cross(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,m.normalize(r,r))}}(),m.setAxes=function(){var t=f.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],m.normalize(e,m.fromMat3(e,t))}}(),m.clone=s.clone,m.fromValues=s.fromValues,m.copy=s.copy,m.set=s.set,m.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},m.setAxisAngle=function(t,e,n){n=.5*n;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},m.add=s.add,m.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1],c=n[2],l=n[3];return t[0]=r*l+a*u+i*c-o*s,t[1]=i*l+a*s+o*u-r*c,t[2]=o*l+a*c+r*s-i*u,t[3]=a*l-r*u-i*s-o*c,t},m.mul=m.multiply,m.scale=s.scale,m.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-r*u,t},m.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s-o*u,t[1]=i*s+a*u,t[2]=o*s+r*u,t[3]=a*s-i*u,t},m.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t},m.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},m.dot=s.dot,m.lerp=s.lerp,m.slerp=function(t,e,n,r){var i,o,a,u,s,c=e[0],l=e[1],f=e[2],p=e[3],m=n[0],h=n[1],d=n[2],g=n[3];return o=c*m+l*h+f*d+p*g,0>o&&(o=-o,m=-m,h=-h,d=-d,g=-g),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,s=Math.sin(r*i)/a):(u=1-r,s=r),t[0]=u*c+s*m,t[1]=u*l+s*h,t[2]=u*f+s*d,t[3]=u*p+s*g,t},m.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=o*u,t},m.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},m.length=s.length,m.len=m.length,m.squaredLength=s.squaredLength,m.sqrLen=m.squaredLength,m.normalize=s.normalize,m.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[7]-e[5])*n,t[1]=(e[2]-e[6])*n,t[2]=(e[3]-e[1])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t},m.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=m)}(r.exports)}(this)}(),t.register("github:maxdavidson/tribus@master/extra/event-aggregator",[],function(t){var e,n,r,i,o;return{setters:[],execute:function(){"use strict";e=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},n=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=!1,o=function(){function t(){var e=void 0===arguments[0]?null:arguments[0];r(this,t),t.privates.set(this,{callbacks:new Map,buffers:new Map,bubbleTarget:e})}return t.prototype.on=function(t){var n=void 0===arguments[1]?null:arguments[1];this._callbacks.has(t)||this._callbacks.set(t,new Set),i&&console.log(""+this.constructor.name+" bound handler to: "+t),this._callbacks.get(t).add(n);var r=this._buffers.get(t);if(void 0!==r){for(var o=r,a=Array.isArray(o),u=0,o=a?o:o[Symbol.iterator]();;){var s,c;if(a){if(u>=o.length)break;c=o[u++]}else{if(u=o.next(),u.done)break;c=u.value}var l=c.args,f=c.options;(s=this).trigger.apply(s,[t,optinos].concat(e(l))),i&&console.log(""+this.constructor.name+" ("+f.target.constructor.name+") released: "+t)}this._buffers["delete"](t)}},t.prototype.off=function(t){var e=void 0===arguments[1]?null:arguments[1];this._callbacks.has(t)&&(null===e&&this._callbacks["delete"](t),this._callbacks.get(t)["delete"](e),0===this._callbacks.get(t).size&&this._callbacks["delete"](t))},t.prototype.once=function(t,e){var n=this,r=function(){for(var i=arguments.length,o=Array(i),a=0;i>a;a++)o[a]=arguments[a];e.apply(void 0,o),n.off(t,r)};this.on(t,r)},t.prototype.trigger=function(e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;n>i;i++)r[i-2]=arguments[i];var o=void 0===arguments[1]?{}:arguments[1],a=o.bubble,u=void 0===a?!1:a,s=o.buffer,c=void 0===s?!1:s,l=o.sync,f=void 0===l?!1:l,p=o.target,m=void 0===p?this:p,h=o.delay,d=void 0===h?0:h;if(this._callbacks.has(e))if(f)for(var g=this._callbacks.get(e),v=Array.isArray(g),b=0,g=v?g:g[Symbol.iterator]();;){var y;if(v){if(b>=g.length)break;y=g[b++]}else{if(b=g.next(),b.done)break;y=b.value}var x=y;x.apply(void 0,r.concat([m]))}else for(var w=this._callbacks.get(e),E=Array.isArray(w),T=0,w=E?w:w[Symbol.iterator]();;){var _,A=function(){if(E){if(T>=w.length)return"break";_=w[T++]}else{if(T=w.next(),T.done)return"break";_=T.value}var t=_;window.setTimeout(function(){return t.apply(void 0,r.concat([m]))},d)}();if("break"===A)break}else if(u&&null!==t.privates.get(this).bubbleTarget){var M;(M=t.privates.get(this).bubbleTarget).trigger.apply(M,[e,o].concat(r))}else c&&(this._buffers.has(e)||this._buffers.set(e,[]),this._buffers.get(e).push({args:r,options:o}))},n(t,null,{_callbacks:{get:function(){return t.privates.get(this).callbacks||(t.privates.get(this).callbacks=new Map)},configurable:!0},_buffers:{get:function(){return t.privates.get(this).buffers||(t.privates.get(this).buffers=new Map)},configurable:!0}}),t}(),t("default",o),o.privates=new WeakMap}}}),t.register("npm:process@0.10.1/browser",[],!0,function(require,e,n){function r(){if(!c){c=!0;for(var t,e=s.length;e;){t=s,s=[];for(var n=-1;++n<e;)t[n]();e=s.length}c=!1}}function i(){}var o=t.global,a=o.define;o.define=void 0;var u=n.exports={},s=[],c=!1;return u.nextTick=function(t){s.push(t),c||setTimeout(r,0)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(){throw new Error("process.chdir is not supported")},u.umask=function(){return 0},o.define=a,n.exports}),t.register("npm:es5-ext@0.10.6/math/sign/is-implemented",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(){var t=Math.sign;return"function"!=typeof t?!1:1===t(10)&&-1===t(-20)},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/math/sign/shim",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/valid-callable",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/is-callable",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){return"function"==typeof t},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/valid-value",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){if(null==t)throw new TypeError("Cannot use null or undefined");return t},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/lib/registered-extensions",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/assign/is-implemented",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(){var t,e=Object.assign;return"function"!=typeof e?!1:(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/keys/is-implemented",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/keys/shim",[],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=Object.keys;return n.exports=function(t){return o(null==t?t:Object(t))},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/mixin",["npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-value"),a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames;return n.exports=function(t,e){var n;if(t=Object(o(t)),s(Object(o(e))).forEach(function(r){try{a(t,r,u(e,r))}catch(i){n=i}}),void 0!==n)throw n;return t},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/assign",["npm:es5-ext@0.10.6/object/assign/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/assign/index"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/string/#/contains/is-implemented",[],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o="razdwatrzy";return n.exports=function(){return"function"!=typeof o.contains?!1:o.contains("dwa")===!0&&o.contains("foo")===!1},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/string/#/contains/shim",[],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=String.prototype.indexOf;return n.exports=function(t){return o.call(this,t,arguments[1])>-1},r.define=i,n.exports}),t.register("npm:event-emitter@0.3.3/index",["npm:d@0.1.1","npm:es5-ext@0.10.6/object/valid-callable"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o,a,u,s,c,l,f,p=require("npm:d@0.1.1"),m=require("npm:es5-ext@0.10.6/object/valid-callable"),h=Function.prototype.apply,d=Function.prototype.call,g=Object.create,v=Object.defineProperty,b=Object.defineProperties,y=Object.prototype.hasOwnProperty,x={configurable:!0,enumerable:!1,writable:!0};return o=function(t,e){var n;return m(e),y.call(this,"__ee__")?n=this.__ee__:(n=x.value=g(null),v(this,"__ee__",x),x.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},a=function(t,e){var n,r;return m(e),r=this,o.call(this,t,n=function(){u.call(r,t,n),h.call(e,this,arguments)}),n.__eeOnceListener__=e,this},u=function(t,e){var n,r,i,o;if(m(e),!y.call(this,"__ee__"))return this;if(n=this.__ee__,!n[t])return this;if(r=n[t],"object"==typeof r)for(o=0;i=r[o];++o)(i===e||i.__eeOnceListener__===e)&&(2===r.length?n[t]=r[o?0:1]:r.splice(o,1));else(r===e||r.__eeOnceListener__===e)&&delete n[t];return this},s=function(t){var e,n,r,i,o;if(y.call(this,"__ee__")&&(i=this.__ee__[t]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),e=1;n>e;++e)o[e-1]=arguments[e];for(i=i.slice(),e=0;r=i[e];++e)h.call(r,this,o)}else switch(arguments.length){case 1:d.call(i,this);break;case 2:d.call(i,this,arguments[1]);break;case 3:d.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;n>e;++e)o[e-1]=arguments[e];h.call(i,this,o)}},c={on:o,once:a,off:u,emit:s},l={on:p(o),once:p(a),off:p(u),emit:p(s)},f=b({},l),n.exports=e=function(t){return null==t?g(f):b(Object(t),l)},e.methods=c,r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/array/from/is-implemented",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(){var t,e,n=Array.from;return"function"!=typeof n?!1:(t=["raz","dwa"],e=n(t),Boolean(e&&e!==t&&"dwa"===e[1]))},r.define=i,n.exports}),t.register("npm:es6-symbol@2.0.1/is-implemented",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(e){return!1}return"symbol"==typeof Symbol.iterator?!0:"object"!=typeof Symbol.isConcatSpreadable?!1:"object"!=typeof Symbol.iterator?!1:"object"!=typeof Symbol.toPrimitive?!1:"object"!=typeof Symbol.toStringTag?!1:"object"!=typeof Symbol.unscopables?!1:!0},r.define=i,n.exports}),t.register("npm:es6-symbol@2.0.1/is-symbol",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){return t&&("symbol"==typeof t||"Symbol"===t["@@toStringTag"])||!1},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/function/is-arguments",[],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call(function(){return arguments}());return n.exports=function(t){return o.call(t)===a},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/function/noop",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(){},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/string/is-string",[],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call("");return n.exports=function(t){return"string"==typeof t||t&&"object"==typeof t&&(t instanceof String||o.call(t)===a)||!1},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/lib/resolve-normalize",["npm:es5-ext@0.10.6/object/valid-callable"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-callable");return n.exports=function(t){var e;return"function"==typeof t?{set:t,get:t}:(e={get:o(t.get)},void 0!==t.set?(e.set=o(t.set),e["delete"]=o(t["delete"]),e.clear=o(t.clear),e):(e.set=e.get,e))},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/normalizers/primitive",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){var e,n,r=t.length;if(!r)return"";for(e=String(t[n=0]);--r;)e+=""+t[++n];return e},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/normalizers/get-primitive-fixed",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){return t?function(e){for(var n=String(e[0]),r=0,i=t;--i;)n+=""+e[++r];return n}:function(){return""}},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/array/#/e-index-of",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=require("npm:es5-ext@0.10.6/object/valid-value"),u=Array.prototype.indexOf,s=Object.prototype.hasOwnProperty,c=Math.abs,l=Math.floor;return n.exports=function(t){var e,n,r,i;if(t===t)return u.apply(this,arguments);for(n=o(a(this).length),r=arguments[1],r=isNaN(r)?0:r>=0?l(r):o(this.length)-l(c(r)),e=r;n>e;++e)if(s.call(this,e)&&(i=this[e],i!==i))return e;return-1},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/normalizers/get-1",["npm:es5-ext@0.10.6/array/#/e-index-of"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/#/e-index-of");return n.exports=function(){var t=0,e=[],n=[];return{get:function(t){var r=o.call(e,t[0]);return-1===r?null:n[r]},set:function(r){return e.push(r[0]),n.push(++t),t},"delete":function(t){var r=o.call(n,t);-1!==r&&(e.splice(r,1),n.splice(r,1))},clear:function(){e=[],n=[]}}},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/normalizers/get-fixed",["npm:es5-ext@0.10.6/array/#/e-index-of"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/#/e-index-of"),a=Object.create;return n.exports=function(t){var e=0,n=[[],[]],r=a(null);return{get:function(e){for(var r,i=0,a=n;t-1>i;){if(r=o.call(a[0],e[i]),-1===r)return null;a=a[1][r],++i}return r=o.call(a[0],e[i]),-1===r?null:a[1][r]||null},set:function(i){for(var a,u=0,s=n;t-1>u;)a=o.call(s[0],i[u]),-1===a&&(a=s[0].push(i[u])-1,s[1].push([[],[]])),s=s[1][a],++u;return a=o.call(s[0],i[u]),-1===a&&(a=s[0].push(i[u])-1),s[1][a]=++e,r[e]=i,e},"delete":function(e){for(var i,a=0,u=n,s=[],c=r[e];t-1>a;){if(i=o.call(u[0],c[a]),-1===i)return;s.push(u,i),u=u[1][i],++a}if(i=o.call(u[0],c[a]),-1!==i){for(e=u[1][i],u[0].splice(i,1),u[1].splice(i,1);!u[0].length&&s.length;)i=s.pop(),u=s.pop(),u[0].splice(i,1),u[1].splice(i,1);delete r[e]}},clear:function(){n=[[],[]],r=a(null)}}},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/array/from",["npm:es5-ext@0.10.6/array/from/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/array/from/index"),r.define=i,n.exports}),t.register("npm:next-tick@0.2.2/index",["github:jspm/nodelibs-process@0.1.1"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,function(t){"use strict";var e,r;e=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t},r=function(t){var n,r=document.createTextNode(""),i=0;return new t(function(){var t;if(n)return t=n,n=null,"function"==typeof t?void t():void t.forEach(function(t){t()})}).observe(r,{characterData:!0}),function(t){return e(t),n?void("function"==typeof n?n=[n,t]:n.push(t)):(n=t,void(r.data=i=++i%2))}},n.exports=function(){if("undefined"!=typeof t&&t&&"function"==typeof t.nextTick)return t.nextTick;if("object"==typeof document&&document){if("function"==typeof MutationObserver)return r(MutationObserver);if("function"==typeof WebKitMutationObserver)return r(WebKitMutationObserver)}return"function"==typeof setImmediate?function(t){setImmediate(e(t))}:"function"==typeof setTimeout?function(t){setTimeout(e(t),0)}:null}()}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/ext/dispose",["npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/for-each","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-callable"),a=require("npm:es5-ext@0.10.6/object/for-each"),u=require("npm:memoizee@0.3.8/lib/registered-extensions"),s=Array.prototype.slice,c=Function.prototype.apply;return u.dispose=function(t,e,n){var r;return o(t),n.async&&u.async?(e.on("deleteasync",r=function(e,n){c.call(t,null,s.call(n.args,1))}),void e.on("clearasync",function(t){a(t,function(t,e){r(e,t)})})):(e.on("delete",r=function(e,n){t(n)}),void e.on("clear",function(t){a(t,function(t,e){r(e,t)})}))},r.define=i,n.exports}),t.register("npm:timers-ext@0.1.0/max-timeout",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=2147483647,r.define=i,n.exports}),t.register("npm:lru-queue@0.1.0/index",["npm:es5-ext@0.10.6/number/to-pos-integer"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=Object.create,u=Object.prototype.hasOwnProperty;return n.exports=function(t){var e,n=0,r=1,i=a(null),s=a(null),c=0;return t=o(t),{hit:function(o){var a=s[o],l=++c;if(i[l]=o,s[o]=l,!a){if(++n,t>=n)return;return o=i[r],e(o),o}if(delete i[a],r===a)for(;!u.call(i,++r);)continue},"delete":e=function(t){var e=s[t];if(e&&(delete i[e],delete s[t],--n,r===e)){if(!n)return c=0,void(r=1);for(;!u.call(i,++r);)continue}},clear:function(){n=0,r=1,i=a(null),s=a(null),c=0}}},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/ext/ref-counter",["npm:d@0.1.1","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:d@0.1.1"),a=require("npm:memoizee@0.3.8/lib/registered-extensions"),u=Object.create,s=Object.defineProperties;return a.refCounter=function(t,e,n){var r,i;r=u(null),i=n.async&&a.async?"async":"",e.on("set"+i,function(t,e){r[t]=e||1}),e.on("get"+i,function(t){++r[t]}),e.on("delete"+i,function(t){delete r[t]}),e.on("clear"+i,function(){r={}}),s(e.memoized,{deleteRef:o(function(){var t=e.get(arguments);return null===t?null:r[t]?--r[t]?!1:(e["delete"](t),!0):null}),getRefCount:o(function(){var t=e.get(arguments);return null===t?0:r[t]?r[t]:0})})},r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/webgl/buffer",[],function(t){var e,n,r;return{setters:[],execute:function(){"use strict";e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=WebGLRenderingContext,r=function(){function t(r,i,o){var a=void 0===arguments[3]?{}:arguments[3],u=a.mode,s=void 0===u?n.STATIC_DRAW:u,c=a.size,l=void 0===c?3:c,f=a.bufferType,p=void 0===f?n.ARRAY_BUFFER:f,m=a.dataType,h=void 0===m?n.FLOAT:m;if(this.data=null,e(this,t),this.gl=r,this.vaoExtension=r.getExtension("OES_vertex_array_object"),void 0===this.vaoExtension)throw"Your browser's implementation of WebGL does not support Vertex Array Objects! Too bad!";this.vao=o,this.size=l,this.mode=s,this.bufferType=p,this.dataType=h,this.vbo=r.createBuffer(),this.updateData(i)}return t.prototype._executeBound=function(t){this.vaoExtension.bindVertexArrayOES(this.vao),this.gl.bindBuffer(this.bufferType,this.vbo),t(),this.vaoExtension.bindVertexArrayOES(null)},t.prototype.updateData=function(t){var e=this;this.data=t,this._executeBound(function(){e.gl.bufferData(e.bufferType,e.data,e.mode)})},t.prototype.updateSubData=function(t,e){var n=this;this.data.set(t,e),this._executeBound(function(){n.gl.bufferSubData(n.bufferType,t,n.mode)})},t.prototype.setAttribLocation=function(t,e){var n=this;e.gl!==this.gl&&console.error("Couldn't set attribute location: the program's WebGL context is not the same as the buffer's!");var r=e.getAttribLocation(t);-1===r&&console.error("Couldn't bind buffer to location: \""+t+'"'),this._executeBound(function(){n.gl.vertexAttribPointer(r,n.size,n.dataType,!1,0,0),n.gl.enableVertexAttribArray(r)})},t.prototype.destroy=function(){var t=this;this._executeBound(function(){t.gl.deleteBuffer(t.vbo)})},t}(),t("default",r)}}}),t.register("github:maxdavidson/tribus@master/extra/ajax",[],function(t){function e(t){return i(t)}function n(t){return i(t,{responseType:"json"})}function r(t){return i(t,{responseType:"arraybuffer"})}function i(t){var e=void 0===arguments[1]?{}:arguments[1],n=e.responseType,r=void 0===n?"text":n,i=new XMLHttpRequest;return new Promise(function(e,n){i.open("GET",t),i.responseType=r,i.onload=function(){200==i.status?e(i.response):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()})}return t("getString",e),t("getJson",n),t("getArrayBuffer",r),t("ajax",i),{setters:[],execute:function(){"use strict"}}}),t.register("github:maxdavidson/tribus@master/extra/functional",[],function(t){var e,n,r;return{setters:[],execute:function(){"use strict";e=function(t,e){var n=Object.create(t.prototype),r=t.apply(n,e);return null==r||"object"!=typeof r&&"function"!=typeof r?n:r},n=t("construct",function(t){return function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];return e(t,r)}}),r=t("delegate",function(t){return function(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];return t.apply(void 0,n).apply(void 0,n)}})}}}),t.register("github:maxdavidson/tribus@master/workers/worker-pool",[],function(t){var e,n,r,i,o,a;return{setters:[],execute:function(){"use strict";e=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],i=t[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=0,o=0,a=function(){function t(e){var n=void 0===arguments[1]?{}:arguments[1],i=n.poolSize,o=void 0===i?2:i,a=n.spawnLazily,u=void 0===a?!0:a,s=n.timeout,c=void 0===s?5:s;if(r(this,t),this._workerState=new Map,this._timeout=c,this._sourceURL=e,this.poolSize=o,this._completers=new Map,this._taskQueue=[],!u)for(var l=0;o>l;++l)this.spawnWorker()}return t.prototype._grabWork=function(t){var e=this._workerState.get(t);window.clearTimeout(e.timeout),e.ready=!1;var n=this._taskQueue.shift(),r=n.id,i=n.message,o=n.transfers;t.postMessage({id:r,message:i},o)},t.prototype.spawnWorker=function(){var t=this;if(this._workerState.size<this.poolSize){var e=function(){var e=new Worker(t._sourceURL),n=t,r=function(t){{var r=t.data,i=r.id,a=r.message,u=n._workerState.get(e),s=n._completers.get(i),c=s.resolve;s.reject}c(a),n._completers["delete"](i),u.ready=!0,u.timeout=o(),0!==n._taskQueue.length&&n._grabWork(e)},o=function(){return window.setTimeout(function(){n._workerState["delete"](e),e.removeEventListener("message",r,!1),e.terminate()},1e3*n._timeout)};return e.addEventListener("message",r,!1),t._workerState.set(e,{ready:!0,timeout:o(),id:++i}),{v:e}}();if("object"==typeof e)return e.v}},t.prototype.run=function(t){var n=this,r=void 0===arguments[1]?{}:arguments[1],i=r.transfers,a=++o;return new Promise(function(r,o){n._completers.set(a,{resolve:r,reject:o}),n._taskQueue.push({id:a,message:t,transfers:i});for(var u=void 0,s=n._workerState.entries(),c=Array.isArray(s),l=0,s=c?s:s[Symbol.iterator]();;){var f;if(c){if(l>=s.length)break;f=s[l++]}else{if(l=s.next(),l.done)break;f=l.value}var p=e(f,2),m=p[0],h=p[1];if(h.ready){u=m,!c&&s["return"]&&s["return"]();break}}void 0===u&&(u=n.spawnWorker()),void 0!==u&&n._grabWork(u)})},t.fromFunction=function(e){for(var r=void 0===arguments[1]?[]:arguments[1],i=void 0===arguments[2]?{}:arguments[2],o={location:window.location},a=0;a<r.length;++a)switch(typeof r[a]){case"function":r[a]=r[a].toString();break;case"object":for(var u=Object.keys(r[a]),s=Array.isArray(u),c=0,u=s?u:u[Symbol.iterator]();;){var l;if(s){if(c>=u.length)break;l=u[c++]}else{if(c=u.next(),c.done)break;l=c.value}var f=l;o[f]=r[a][f]}}var p=Object.keys(o).map(function(t){return"var "+t+" = "+JSON.stringify(o[t])+";"}),m="self.onmessage = function(event) {\n                ("+e.toString()+")(event.data.message, function resolve(message, transfers) {\n                    self.postMessage({ id: event.data.id, message: message }, transfers);\n                });\n            };",h=new Blob([[].concat(n(p),n(r),[m]).join(";\n")],{type:"application/javascript"}),d=window.URL.createObjectURL(h);return new t(d,i)},t}(),t("default",a)}}}),t.register("github:toji/gl-matrix@2.2.1/src/gl-matrix/vec3.js!github:systemjs/plugin-text@0.0.2",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports="/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation \n    and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\n\n/**\n * @class 3 Dimensional Vector\n * @name vec3\n */\nvar vec3 = {};\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nvec3.create = function() {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nvec3.clone = function(a) {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nvec3.fromValues = function(x, y, z) {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nvec3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nvec3.set = function(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nvec3.sub = vec3.subtract;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    out[2] = a[2] * b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nvec3.mul = vec3.multiply;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    out[2] = a[2] / b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nvec3.div = vec3.divide;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    out[2] = Math.min(a[2], b[2]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    out[2] = Math.max(a[2], b[2]);\n    return out;\n};\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nvec3.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n};\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nvec3.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nvec3.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nvec3.dist = vec3.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec3.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nvec3.sqrDist = vec3.squaredDistance;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec3.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nvec3.len = vec3.length;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec3.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nvec3.sqrLen = vec3.squaredLength;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nvec3.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    return out;\n};\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nvec3.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    var len = x*x + y*y + z*z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.cross = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n};\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    out[2] = az + t * (b[2] - az);\n    return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nvec3.random = function (out, scale) {\n    scale = scale || 1.0;\n\n    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\n    var z = (GLMAT_RANDOM() * 2.0) - 1.0;\n    var zScale = Math.sqrt(1.0-z*z) * scale;\n\n    out[0] = Math.cos(r) * zScale;\n    out[1] = Math.sin(r) * zScale;\n    out[2] = z * scale;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat4 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = m[0] * x + m[4] * y + m[8] * z + m[12];\n    out[1] = m[1] * x + m[5] * y + m[9] * z + m[13];\n    out[2] = m[2] * x + m[6] * y + m[10] * z + m[14];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat3 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = x * m[0] + y * m[3] + z * m[6];\n    out[1] = x * m[1] + y * m[4] + z * m[7];\n    out[2] = x * m[2] + y * m[5] + z * m[8];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nvec3.transformQuat = function(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return out;\n};\n\n/*\n* Rotate a 3D vector around the x-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateX = function(out, a, b, c){\n   var p = [], r=[];\n	  //Translate point to the origin\n	  p[0] = a[0] - b[0];\n	  p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n\n	  //perform rotation\n	  r[0] = p[0];\n	  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\n	  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\n\n	  //translate to correct position\n	  out[0] = r[0] + b[0];\n	  out[1] = r[1] + b[1];\n	  out[2] = r[2] + b[2];\n\n  	return out;\n};\n\n/*\n* Rotate a 3D vector around the y-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateY = function(out, a, b, c){\n  	var p = [], r=[];\n  	//Translate point to the origin\n  	p[0] = a[0] - b[0];\n  	p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n  \n  	//perform rotation\n  	r[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\n  	r[1] = p[1];\n  	r[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\n  \n  	//translate to correct position\n  	out[0] = r[0] + b[0];\n  	out[1] = r[1] + b[1];\n  	out[2] = r[2] + b[2];\n  \n  	return out;\n};\n\n/*\n* Rotate a 3D vector around the z-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateZ = function(out, a, b, c){\n  	var p = [], r=[];\n  	//Translate point to the origin\n  	p[0] = a[0] - b[0];\n  	p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n  \n  	//perform rotation\n  	r[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\n  	r[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\n  	r[2] = p[2];\n  \n  	//translate to correct position\n  	out[0] = r[0] + b[0];\n  	out[1] = r[1] + b[1];\n  	out[2] = r[2] + b[2];\n  \n  	return out;\n};\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec3.forEach = (function() {\n    var vec = vec3.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 3;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec3} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec3.str = function (a) {\n    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n};\n\nif(typeof(exports) !== 'undefined') {\n    exports.vec3 = vec3;\n}\n",r.define=i,n.exports
}),t.register("github:maxdavidson/tribus@master/extra/errors",[],function(t){var e,n,r,i;return{setters:[],execute:function(){"use strict";e=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},n=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=t("UnimplementedMethodError",function(t){function i(){var e=void 0===arguments[0]?"Method not implemented!":arguments[0];r(this,i),t.call(this,e)}return n(i,t),e(i,null,{name:{get:function(){return"UnimplementedMethod"},configurable:!0}}),i}(Error))}}}),t.register("github:maxdavidson/jsTGALoader@master/tga.js!github:systemjs/plugin-text@0.0.2",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=" /**\n * @fileoverview jsTGALoader - Javascript loader for TGA file\n * @author Vincent Thibault\n * @version 1.2.1\n * @blog http://blog.robrowser.com/javascript-tga-loader.html\n */\n\n/* Copyright (c) 2013, Vincent Thibault. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation \n    and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\n\n(function(_global)\n{\n	'use strict';\n\n\n	/**\n	 * TGA Namespace\n	 * @constructor\n	 */\n	function Targa()\n	{\n	}\n\n\n	/**\n	 * @var {object} TGA type constants\n	 */\n	Targa.Type = {\n		NO_DATA:      0,\n		INDEXED:      1,\n		RGB:          2,\n		GREY:         3,\n		RLE_INDEXED:  9,\n		RLE_RGB:     10,\n		RLE_GREY:    11\n	};\n\n\n	/**\n	 * @var {object} TGA origin constants\n	 */\n	Targa.Origin = {\n		BOTTOM_LEFT:  0x00,\n		BOTTOM_RIGHT: 0x01,\n		TOP_LEFT:     0x02,\n		TOP_RIGHT:    0x03,\n		SHIFT:        0x04,\n		MASK:         0x30\n	};\n\n\n	/**\n	 * Check the header of TGA file to detect errors\n	 *\n	 * @param {object} tga header structure\n	 * @throws Error\n	 */\n	function checkHeader( header )\n	{\n		// What the need of a file without data ?\n		if (header.imageType === Targa.Type.NO_DATA) {\n			throw new Error('Targa::checkHeader() - No data');\n		}\n\n		// Indexed type\n		if (header.hasColorMap) {\n			if (header.colorMapLength > 256 || header.colorMapSize !== 24 || header.colorMapType !== 1) {\n				throw new Error('Targa::checkHeader() - Invalid colormap for indexed type');\n			}\n		}\n		else {\n			if (header.colorMapType) {\n				throw new Error('Targa::checkHeader() - Why does the image contain a palette ?');\n			}\n		}\n\n		// Check image size\n		if (header.width <= 0 || header.height <= 0) {\n			throw new Error('Targa::checkHeader() - Invalid image size');\n		}\n\n		// Check pixel size\n		if (header.pixelDepth !== 8  &&\n		    header.pixelDepth !== 16 &&\n		    header.pixelDepth !== 24 &&\n		    header.pixelDepth !== 32) {\n			throw new Error('Targa::checkHeader() - Invalid pixel size \"' + header.pixelDepth + '\"');\n		}\n	}\n\n\n	/**\n	 * Decode RLE compression\n	 *\n	 * @param {Uint8Array} data\n	 * @param {number} offset in data to start loading RLE\n	 * @param {number} pixel count\n	 * @param {number} output buffer size\n	 */\n	function decodeRLE( data, offset, pixelSize, outputSize)\n	{\n		var pos, c, count, i;\n		var pixels, output;\n\n		output = new Uint8Array(outputSize);\n		pixels = new Uint8Array(pixelSize);\n		pos    = 0;\n\n		while (pos < outputSize) {\n			c     = data[offset++];\n			count = (c & 0x7f) + 1;\n\n			// RLE pixels.\n			if (c & 0x80) {\n				// Bind pixel tmp array\n				for (i = 0; i < pixelSize; ++i) {\n					pixels[i] = data[offset++];\n				}\n\n				// Copy pixel array\n				for (i = 0; i < count; ++i) {\n					output.set(pixels, pos);\n					pos += pixelSize;\n				}\n			}\n\n			// Raw pixels.\n			else {\n				count *= pixelSize;\n				for (i = 0; i < count; ++i) {\n					output[pos++] = data[offset++];\n				}\n			}\n		}\n\n		return output;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (8bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} indexes - index to colormap\n	 * @param {Array} colormap\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData8bits(imageData, indexes, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i++) {\n				color = indexes[i];\n				imageData[(x + width * y) * 4 + 3] = 255;\n				imageData[(x + width * y) * 4 + 2] = colormap[(color * 3) + 0];\n				imageData[(x + width * y) * 4 + 1] = colormap[(color * 3) + 1];\n				imageData[(x + width * y) * 4 + 0] = colormap[(color * 3) + 2];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (16bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData16bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 2) {\n				color = pixels[i + 0] | (pixels[i + 1] << 8);\n				imageData[(x + width * y) * 4 + 0] = (color & 0x7C00) >> 7;\n				imageData[(x + width * y) * 4 + 1] = (color & 0x03E0) >> 2;\n				imageData[(x + width * y) * 4 + 2] = (color & 0x001F) >> 3;\n				imageData[(x + width * y) * 4 + 3] = (color & 0x8000) ? 0 : 255;\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (24bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData24bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 3) {\n				imageData[(x + width * y) * 4 + 3] = 255;\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 1];\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 2];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (32bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData32bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 4) {\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 1];\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 2];\n				imageData[(x + width * y) * 4 + 3] = pixels[i + 3];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (8bits grey)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageDataGrey8bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i++) {\n				color = pixels[i];\n				imageData[(x + width * y) * 4 + 0] = color;\n				imageData[(x + width * y) * 4 + 1] = color;\n				imageData[(x + width * y) * 4 + 2] = color;\n				imageData[(x + width * y) * 4 + 3] = 255;\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (16bits grey)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageDataGrey16bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 2) {\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 3] = pixels[i + 1];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Open a targa file using XHR, be aware with Cross Domain files...\n	 *\n	 * @param {string} path - Path of the filename to load\n	 * @param {function} callback - callback to trigger when the file is loaded\n	 */\n	Targa.prototype.open = function targaOpen(path, callback)\n	{\n		var req, tga = this;\n		req = new XMLHttpRequest();\n		req.open('GET', path, true);\n		req.responseType = 'arraybuffer';\n		req.onload = function() {\n			if (this.status === 200) {\n				tga.load(new Uint8Array(req.response));\n				if (callback) {\n					callback.call(tga);\n				}\n			}\n		};\n		req.send(null);\n	};\n\n\n	/**\n	 * Load and parse a TGA file\n	 *\n	 * @param {Uint8Array} data - TGA file buffer array\n	 */\n	Targa.prototype.load = function targaLoad( data )\n	{\n		var offset = 0;\n\n		// Not enough data to contain header ?\n		if (data.length < 0x12) {\n			throw new Error('Targa::load() - Not enough data to contain header');\n		}\n\n		// Read TgaHeader\n		this.header = {\n			/* 0x00  BYTE */  idLength:       data[offset++],\n			/* 0x01  BYTE */  colorMapType:   data[offset++],\n			/* 0x02  BYTE */  imageType:      data[offset++],\n			/* 0x03  WORD */  colorMapIndex:  data[offset++] | data[offset++] << 8,\n			/* 0x05  WORD */  colorMapLength: data[offset++] | data[offset++] << 8,\n			/* 0x07  BYTE */  colorMapDepth:  data[offset++],\n			/* 0x08  WORD */  offsetX:        data[offset++] | data[offset++] << 8,\n			/* 0x0a  WORD */  offsetY:        data[offset++] | data[offset++] << 8,\n			/* 0x0c  WORD */  width:          data[offset++] | data[offset++] << 8,\n			/* 0x0e  WORD */  height:         data[offset++] | data[offset++] << 8,\n			/* 0x10  BYTE */  pixelDepth:     data[offset++],\n			/* 0x11  BYTE */  flags:          data[offset++]\n		};\n\n		// Set shortcut\n		this.header.hasEncoding = (this.header.imageType === Targa.Type.RLE_INDEXED || this.header.imageType === Targa.Type.RLE_RGB   || this.header.imageType === Targa.Type.RLE_GREY);\n		this.header.hasColorMap = (this.header.imageType === Targa.Type.RLE_INDEXED || this.header.imageType === Targa.Type.INDEXED);\n		this.header.isGreyColor = (this.header.imageType === Targa.Type.RLE_GREY    || this.header.imageType === Targa.Type.GREY);\n\n		// Check if a valid TGA file (or if we can load it)\n		checkHeader(this.header);\n\n		// Move to data\n		offset += this.header.idLength;\n		if (offset >= data.length) {\n			throw new Error('Targa::load() - No data');\n		}\n\n		// Read palette\n		if (this.header.hasColorMap) {\n			var colorMapSize  = this.header.colorMapLength * (this.header.colorMapDepth >> 3);\n			this.palette      = data.subarray( offset, offset + colorMapSize);\n			offset           += colorMapSize;\n		}\n\n		var pixelSize  = this.header.pixelDepth >> 3;\n		var imageSize  = this.header.width * this.header.height;\n		var pixelTotal = imageSize * pixelSize;\n\n		// RLE encoded\n		if (this.header.hasEncoding) {\n			this.imageData = decodeRLE(data, offset, pixelSize, pixelTotal);\n		}\n\n		// RAW pixels\n		else {\n			this.imageData = data.subarray( offset, offset + (this.header.hasColorMap ? imageSize : pixelTotal) );\n		}\n	};\n\n\n	/**\n	 * Return a ImageData object from a TGA file\n	 *\n	 * @param {object} imageData - Optional ImageData to work with\n	 * @returns {object} imageData\n	 */\n	Targa.prototype.getImageData = function targaGetImageData( imageData )\n	{\n		var width  = this.header.width;\n		var height = this.header.height;\n		var origin = (this.header.flags & Targa.Origin.MASK) >> Targa.Origin.SHIFT;\n		var x_start, x_step, x_end, y_start, y_step, y_end;\n		var getImageData;\n\n			// Create an imageData\n		if (!imageData) {\n			if (typeof(window) === 'object') {\n				imageData = document.createElement('canvas').getContext('2d').createImageData(width, height);\n			}\n			// In Thread context ?\n			else {\n				imageData = {\n					width:  width,\n					height: height,\n					data: new Uint8ClampedArray(width * height * 4)\n				};\n			}\n		}\n\n		if (origin === Targa.Origin.TOP_LEFT || origin === Targa.Origin.TOP_RIGHT) {\n			y_start = 0;\n			y_step  = 1;\n			y_end   = height;\n		}\n		else {\n			y_start = height - 1;\n			y_step  = -1;\n			y_end   = -1;\n		}\n\n		if (origin === Targa.Origin.TOP_LEFT || origin === Targa.Origin.BOTTOM_LEFT) {\n			x_start = 0;\n			x_step  = 1;\n			x_end   = width;\n		}\n		else {\n			x_start = width - 1;\n			x_step  = -1;\n			x_end   = -1;\n		}\n\n		// TODO: use this.header.offsetX and this.header.offsetY ?\n\n		switch (this.header.pixelDepth) {\n			case 8:\n				getImageData = this.header.isGreyColor ? getImageDataGrey8bits : getImageData8bits;\n				break;\n\n			case 16:\n				getImageData = this.header.isGreyColor ? getImageDataGrey16bits : getImageData16bits;\n				break;\n\n			case 24:\n				getImageData = getImageData24bits;\n				break;\n\n			case 32:\n				getImageData = getImageData32bits;\n				break;\n		}\n\n		getImageData(imageData.data, this.imageData, this.palette, width, y_start, y_step, y_end, x_start, x_step, x_end);\n		return imageData;\n	};\n\n\n	/**\n	 * Return a canvas with the TGA render on it\n	 *\n	 * @returns {object} CanvasElement\n	 */\n	Targa.prototype.getCanvas = function targaGetCanvas()\n	{\n		var canvas, ctx, imageData;\n\n		canvas    = document.createElement('canvas');\n		ctx       = canvas.getContext('2d');\n		imageData = ctx.createImageData(this.header.width, this.header.height);\n\n		canvas.width  = this.header.width;\n		canvas.height = this.header.height;\n\n		ctx.putImageData(this.getImageData(imageData), 0, 0);\n\n		return canvas;\n	};\n\n\n	/**\n	 * Return a dataURI of the TGA file\n	 *\n	 * @param {string} type - Optional image content-type to output (default: image/png)\n	 * @returns {string} url\n	 */\n	Targa.prototype.getDataURL = function targaGetDatURL( type )\n	{\n		return this.getCanvas().toDataURL(type || 'image/png');\n	};\n\n\n	// Find Context\n	var shim = {};\n	if (typeof(exports) === 'undefined') {\n		if (typeof(define) === 'function' && typeof(define.amd) === 'object' && define.amd) {\n			define(function(){\n				return Targa;\n			});\n		} else {\n			// Browser\n			shim.exports = typeof(window) !== 'undefined' ? window : _global;\n		}\n	} \n	else {\n		// Commonjs\n		shim.exports = exports;\n	}\n\n\n	// Export\n	if (shim.exports) {\n		shim.exports.TGA = Targa;\n	}\n\n})(this);\n",r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/material/shaders/phong.vert.dot!github:maxdavidson/tribus@master/plugins/dot",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){var e="uniform mat4 mvpMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nattribute highp vec3 vertex;\nattribute highp vec3 normal;\n";return("texture"===t.ambient||"texture"===t.diffuse||"texture"===t.specular)&&(e+="\nattribute mediump vec2 texcoord;\n"),e+="\n\nvarying highp vec3 worldFragPos;\nvarying mediump vec3 worldNormal;\n\n","texture"===t.ambient&&(e+="\nuniform mediump vec4 ambientTexcoordBounds;\nvarying mediump vec2 ambientTexcoord;\n"),e+="\n\n","texture"===t.diffuse&&(e+="\nuniform mediump vec4 diffuseTexcoordBounds;\nvarying mediump vec2 diffuseTexcoord;\n"),e+="\n\n","texture"===t.specular&&(e+="\nuniform mediump vec4 specularTexcoordBounds;\nvarying mediump vec2 specularTexcoord;\n"),e+="\n\n\nvoid main() {\n\n    worldFragPos = vec3(modelMatrix * vec4(vertex, 1.0));\n    worldNormal = normalize(normalMatrix * normal);\n\n    ","texture"===t.ambient&&(e+="\n    ambientTexcoord = ambientTexcoordBounds.xy + texcoord * ambientTexcoordBounds.zw;\n    "),e+="\n\n    ","texture"===t.diffuse&&(e+="\n    diffuseTexcoord = diffuseTexcoordBounds.xy + texcoord * diffuseTexcoordBounds.zw;\n    "),e+="\n\n    ","texture"===t.specular&&(e+="\n    specularTexcoord = specularTexcoordBounds.xy + texcoord * specularTexcoordBounds.zw;\n    "),e+="\n\n    gl_Position = mvpMatrix * vec4(vertex, 1.0);\n}\n"},r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/material/shaders/phong.frag.dot!github:maxdavidson/tribus@master/plugins/dot",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=function(t){var e="\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nprecision highp float;\n\nstruct DirectionalLight {\n    bool enabled;\n    highp   vec3  direction;\n    mediump vec3  diffuse, specular;\n};\n\nstruct PointLight {\n    bool enabled;\n    highp   vec3  position;\n    mediump vec3  diffuse, specular;\n    mediump float constant, linear, quadratic;\n};\n\nstruct SpotLight {\n    bool enabled;\n    highp   vec3  position, direction;\n    mediump vec3  diffuse, specular;\n    mediump float cutoff, outerCutoff;\n    mediump float constant, linear, quadratic;\n};\n\nstruct Material {\n    lowp float shininess;\n    ";return"static"===t.ambient&&(e+=" mediump vec3 ambient; "),e+="\n    ","static"===t.diffuse&&(e+=" mediump vec3 diffuse; "),e+="\n    ","static"===t.specular&&(e+=" mediump vec3 specular; "),e+="\n};\n\n\nvarying highp vec3 worldFragPos;\nvarying highp vec3 worldNormal;\n\nuniform highp vec3 viewPos;\n\n","texture"===t.ambient&&(e+="\nuniform sampler2D ambientSampler;\nvarying mediump vec2 ambientTexcoord;\n"),e+="\n\n","texture"===t.diffuse&&(e+="\nuniform sampler2D diffuseSampler;\nvarying mediump vec2 diffuseTexcoord;\n"),e+="\n\n","texture"===t.specular&&(e+="\nuniform sampler2D specularSampler;\nvarying mediump vec2 specularTexcoord;\n"),e+="\n\n\nuniform Material material;\n\nuniform DirectionalLight directionalLights[ "+(t.MAX_DIRECTIONAL_LIGHTS||2)+" ];\nuniform PointLight pointLights[ "+(t.MAX_POINT_LIGHTS||5)+" ];\nuniform SpotLight spotLights[ "+(t.MAX_SPOT_LIGHTS||5)+" ];\n\n\nvoid main() {\n\n    vec3 worldNormal2 = normalize(worldNormal);\n\n    // Direction from fragment to camera\n    vec3 viewDir = normalize(viewPos - worldFragPos);\n    vec3 color =  ",e+="texture"===t.ambient?" texture2D(ambientSampler, ambientTexcoord).stp ":" material.ambient ",e+=" ;\n\n    for (int i = 0; i <  "+(t.MAX_DIRECTIONAL_LIGHTS||2)+" ; ++i) {\n        DirectionalLight light = directionalLights[i];\n        if (light.enabled) {\n            \n    vec3 lightDir = -light.direction;\n\n    \n\n    vec3 diffuse  = light.diffuse *  ",e+="texture"===t.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",e+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",e+="texture"===t.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",e+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",e+="texture"===t.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",e+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n            color += shade;\n        }\n    }\n\n    for (int i = 0; i <  "+(t.MAX_POINT_LIGHTS||5)+" ; ++i) {\n        PointLight light = pointLights[i];\n        if (light.enabled) {\n            \n    vec3 direction = light.position - worldFragPos;\n    float distance = length(direction);\n\n    vec3 lightDir = direction / distance;\n\n    \n\n    vec3 diffuse  = light.diffuse *  ",e+="texture"===t.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",e+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",e+="texture"===t.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",e+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",e+="texture"===t.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",e+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n    float attenuation = 1.0 / (light.constant + distance * (light.linear + distance * light.quadratic));\n\n    shade += attenuation;\n\n            color += shade;\n        }\n    }\n\n    for (int i = 0; i <  "+(t.MAX_SPOT_LIGHTS||5)+" ; ++i) {\n        SpotLight light = spotLights[i];\n        if (light.enabled) {\n            \n    \n    vec3 direction = light.position - worldFragPos;\n    float distance = length(direction);\n\n    vec3 lightDir = direction / distance;\n\n    \n\n    vec3 diffuse  = light.diffuse *  ",e+="texture"===t.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",e+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",e+="texture"===t.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",e+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",e+="texture"===t.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",e+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n    float attenuation = 1.0 / (light.constant + distance * (light.linear + distance * light.quadratic));\n\n    shade += attenuation;\n\n\n    float theta = dot(lightDir, light.direction);\n    float epsilon = light.cutoff - light.outerCutoff;\n    float intensity = clamp((theta - light.outerCutoff) / epsilon, 0.0, 1.0);\n\n    shade *= intensity;\n\n            color += shade;\n        }\n    }\n\n    gl_FragColor = vec4(color, 1.0);\n    //gl_FragColor = vec4(abs(worldNormal2), 1.0);\n}\n"},r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/light/base",["github:maxdavidson/tribus@master/scene/base","npm:memoizee@0.3.8","github:toji/gl-matrix@2.2.1"],function(t){var e,n,r,i,o,a,u,s;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t["default"]}],execute:function(){"use strict";i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=t("Light",function(t){function e(i,a){var u=this,s=void 0===arguments[2]?{}:arguments[2];o(this,e),t.call(this,i,s);var c=s.diffuse,l=void 0===c?r.vec3.fromValues(1,1,1):c,f=s.specular,p=void 0===f?l:f;this.diffuse=l,this.specular=p,this.getRenderer=n(function(t){return new a(u,t)})}return i(e,t),e}(e)),u=new WeakMap,s=t("LightRenderer",function(){function t(e,r){o(this,t),this.light=e,this.gl=r,this.id=t.allocateLight(e.constructor),this.getLocations=n(this.getLocations.bind(this))}return t.allocateLight=function(t){var e=u.get(t)||0;return u.set(t,e+1),e},t.prototype.getLocations=function(){},t.prototype.render=function(){},t}())}}}),t.register("github:maxdavidson/tribus@master/camera/base",["github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/scene/base"],function(t){var e,n,r,i,o,a;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]}],execute:function(){"use strict";r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=e.mat4,a=function(t){function e(){var n=void 0===arguments[0]?{}:arguments[0];this.cameraMatrix=o.create(),this.viewMatrix=o.create(),this.projectionMatrix=o.create(),this.mvpMatrix=o.create(),i(this,e),t.call(this,"camera",n)}return r(e,t),e.prototype.recalculate=function(){t.prototype.recalculate.call(this),o.invert(this.viewMatrix,this.worldTransform),o.multiply(this.cameraMatrix,this.projectionMatrix,this.viewMatrix)},e.prototype.calculateMvpMatrix=function(t){return o.multiply(this.mvpMatrix,this.cameraMatrix,t.worldTransform)},e.prototype.canSee=function(){return!0},e}(n),t("default",a)}}}),t.register("github:maxdavidson/tribus@master/light/directional-light",["github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base"],function(t){var e,n,r,i,o,a,u,s,c,l;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t.construct},function(t){i=t.Light,o=t.LightRenderer}],execute:function(){"use strict";a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(t){return"number"==typeof t?e.vec3.fromValues(t,t,t):e.vec3.clone(t)},c=function(t){function e(){var n=void 0===arguments[0]?{}:arguments[0];u(this,e),t.call(this,"directional-light",l,n)}return a(e,t),e}(i),t("default",c),l=function(t){function e(n,r){u(this,e),t.call(this,n,r)}return a(e,t),e.prototype.getLocations=function(t){return Object.freeze({enabled:t.getUniformLocation("directionalLights["+this.id+"].enabled"),direction:t.getUniformLocation("directionalLights["+this.id+"].direction"),diffuse:t.getUniformLocation("directionalLights["+this.id+"].diffuse"),specular:t.getUniformLocation("directionalLights["+this.id+"].specular")})},e.prototype.render=function(t){var e=this.gl,n=this.light,r=this.getLocations(t);e.uniform1i(r.enabled,!0),e.uniform3fv(r.direction,n.direction),e.uniform3fv(r.diffuse,s(n.diffuse)),e.uniform3fv(r.specular,s(n.specular))},e}(o)}}}),t.register("github:maxdavidson/tribus@master/light/pointlight",["github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8"],function(t){var e,n,r,i,o,a,u,s,c,l,f,p;return{setters:[function(t){e=t.construct},function(t){n=t.Light,r=t.LightRenderer},function(t){i=t["default"]},function(t){o=t["default"]}],execute:function(){"use strict";a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=i.vec3,c=s.create(),l=function(t){return"number"==typeof t?s.set(c,t,t,t):s.copy(c,t)},f=function(t){function e(){var n=void 0===arguments[0]?{}:arguments[0];u(this,e),t.call(this,"pointlight",p,n);var r=n.constant,i=void 0===r?1:r,o=n.linear,a=void 0===o?.7:o,s=n.quadratic,c=void 0===s?1.8:s;this.constant=i,this.linear=a,this.quadratic=c}return a(e,t),e}(n),t("default",f),p=function(t){function e(n,r){u(this,e),t.call(this,n,r)}return a(e,t),e.prototype.getLocations=function(t){return Object.freeze({enabled:t.getUniformLocation("pointLights["+this.id+"].enabled"),position:t.getUniformLocation("pointLights["+this.id+"].position"),diffuse:t.getUniformLocation("pointLights["+this.id+"].diffuse"),specular:t.getUniformLocation("pointLights["+this.id+"].specular"),constant:t.getUniformLocation("pointLights["+this.id+"].constant"),linear:t.getUniformLocation("pointLights["+this.id+"].linear"),quadratic:t.getUniformLocation("pointLights["+this.id+"].quadratic")})},e.prototype.render=function(t){var e=this.gl,n=this.light,r=this.getLocations(t);e.uniform1i(r.enabled,!0),e.uniform3fv(r.position,n.worldPosition),e.uniform3fv(r.diffuse,l(n.diffuse)),e.uniform3fv(r.specular,l(n.specular)),e.uniform1f(r.constant,n.constant),e.uniform1f(r.linear,n.linear),e.uniform1f(r.quadratic,n.quadratic)
},e}(r)}}}),function(){function e(){}e.amd={},function(){var n,r,i,o,a,u,s,c,l,f,p,m,h,d,g,v,b,y,x,w,E,T,_,A,M,S,R,D,I,O,L,k,C,j,z,N,P,U,F,B,q,G,W,H,V,Y,X,K,Q,Z,J,$,te,ee,ne,re,ie,oe,ae,ue,se,ce,le,fe,pe,me,he,de,ge,ve,be={}.hasOwnProperty,ye=function(t,e){function n(){this.constructor=t}for(var r in e)be.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},xe=[].slice,we=function(t,e){return function(){return t.apply(e,arguments)}};n={toString:function(){return"Bacon"}},n.version="0.7.53",m=("undefined"!=typeof global&&null!==global?global:this).Error,re=function(){},K=function(t,e){return e},G=function(t){return t},L=function(t){return t.slice(0)},A=function(t,e){if(!e)throw new m(t)},S=function(t){if(!(t instanceof p))throw new m("not an EventStream : "+t)},I=function(t){if(!(t instanceof v))throw new m("not an Observable : "+t)},R=function(t){return A("not a function : "+t,T.isFunction(t))},V=function(t){return t instanceof Array},X=function(t){return t instanceof v},M=function(t){if(!V(t))throw new m("not an array : "+t)},D=function(t){return A("no arguments supported",0===t.length)},O=function(t){if("string"!=typeof t)throw new m("not a string : "+t)},T={indexOf:Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){var n,r,i,o;for(n=r=0,i=t.length;i>r;n=++r)if(o=t[n],e===o)return n;return-1},indexWhere:function(t,e){var n,r,i,o;for(n=r=0,i=t.length;i>r;n=++r)if(o=t[n],e(o))return n;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(e){return!t(e)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,e){var n,r,i,o;for(n=[],r=0,i=e.length;i>r;r++)o=e[r],t(o)&&n.push(o);return n},map:function(t,e){var n,r,i,o;for(i=[],n=0,r=e.length;r>n;n++)o=e[n],i.push(t(o));return i},each:function(t,e){var n,r;for(n in t)r=t[n],e(n,r);return void 0},toArray:function(t){return V(t)?t:[t]},contains:function(t,e){return-1!==T.indexOf(t,e)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t,e){var n,r,i;for(null==e&&(e=T.id),n=0,r=t.length;r>n;n++)if(i=t[n],!e(i))return!1;return!0},any:function(t,e){var n,r,i;for(null==e&&(e=T.id),n=0,r=t.length;r>n;n++)if(i=t[n],e(i))return!0;return!1},without:function(t,e){return T.filter(function(e){return e!==t},e)},remove:function(t,e){var n;return n=T.indexOf(e,t),n>=0?e.splice(n,1):void 0},fold:function(t,e,n){var r,i,o;for(r=0,i=t.length;i>r;r++)o=t[r],e=n(e,o);return e},flatMap:function(t,e){return T.fold(e,[],function(e,n){return e.concat(t(n))})},cached:function(t){var e;return e=g,function(){return e===g&&(e=t(),t=void 0),e}},isFunction:function(t){return"function"==typeof t},toString:function(t){var e,n,r,i;try{return oe++,null==t?"undefined":T.isFunction(t)?"function":V(t)?oe>5?"[..]":"["+T.map(T.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?oe>5?"{..}":(n=function(){var n;n=[];for(r in t)be.call(t,r)&&(i=function(){try{return t[r]}catch(n){return e=n}}(),n.push(T.toString(r)+":"+T.toString(i)));return n}(),"{"+n+"}"):t}finally{oe--}}},oe=0,n._=T,E=n.UpdateBarrier=function(){var t,e,r,i,o,a,u,s,c,l,f,p,m,h;return l=void 0,f=[],p={},e=[],r=0,t=function(t){return l?e.push(t):t()},m=function(t,e){var n;return l?(n=p[t.id],null==n?(n=p[t.id]=[e],f.push(t)):n.push(e)):e()},o=function(){for(;f.length>0;)u(0);return void 0},u=function(t){var e,n,r,i,o,u;for(i=f[t],o=i.id,u=p[o],f.splice(t,1),delete p[o],a(i),n=0,r=u.length;r>n;n++)(e=u[n])();return void 0},a=function(t){var e,n,r,i,o;for(n=t.internalDeps(),i=0,o=n.length;o>i;i++)e=n[i],a(e),p[e.id]&&(r=T.indexOf(f,e),u(r));return void 0},c=function(t,n,i,a){var u,s;if(l)return i.apply(n,a);l=t;try{s=i.apply(n,a),o()}finally{for(l=void 0;r<e.length;)u=e[r],r++,u();r=0,e=[]}return s},i=function(){return l?l.id:void 0},h=function(e,r){var i,o,a,u;return u=!1,o=!1,i=function(){return o=!0},a=function(){return u=!0,i()},i=e.dispatcher.subscribe(function(e){return t(function(){var t;return u||(t=r(e),t!==n.noMore)?void 0:a()})}),o&&i(),a},s=function(){return f.length>0},{whenDoneWith:m,hasWaiters:s,inTransaction:c,currentEventId:i,wrappedSubscribe:h,afterTransaction:t}}(),w=function(){function t(t,e,n){this.obs=t,this.sync=e,this.lazy=null!=n?n:!1,this.queue=[]}return t.prototype.subscribe=function(t){return this.obs.dispatcher.subscribe(t)},t.prototype.toString=function(){return this.obs.toString()},t.prototype.markEnded=function(){return this.ended=!0},t.prototype.consume=function(){return this.lazy?{value:T.always(this.queue[0])}:this.queue[0]},t.prototype.push=function(t){return this.queue=[t]},t.prototype.mayHave=function(){return!0},t.prototype.hasAtLeast=function(){return this.queue.length},t.prototype.flatten=!0,t}(),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ye(e,t),e.prototype.consume=function(){return this.queue.shift()},e.prototype.push=function(t){return this.queue.push(t)},e.prototype.mayHave=function(t){return!this.ended||this.queue.length>=t},e.prototype.hasAtLeast=function(t){return this.queue.length>=t},e.prototype.flatten=!1,e}(w),r=function(t){function e(t){e.__super__.constructor.call(this,t,!0)}return ye(e,t),e.prototype.consume=function(){var t;return t=this.queue,this.queue=[],{value:function(){return t}}},e.prototype.push=function(t){return this.queue.push(t.value())},e.prototype.hasAtLeast=function(){return!0},e}(w),w.isTrigger=function(t){return t instanceof w?t.sync:t instanceof p},w.fromObservable=function(t){return t instanceof w?t:t instanceof b?new w(t,!1):new a(t,!0)},u=function(){function t(t,e,n){this.context=t,this.method=e,this.args=n,this.cached=void 0}return t.prototype.deps=function(){return this.cached||(this.cached=F([this.context].concat(this.args)))},t.prototype.apply=function(t){return t.desc=this,t},t.prototype.toString=function(){return T.toString(this.context)+"."+T.toString(this.method)+"("+T.map(T.toString,this.args)+")"},t}(),z=function(){var t,e,n;return e=arguments[0],n=arguments[1],t=3<=arguments.length?xe.call(arguments,2):[],(e||n)instanceof u?e||n:new u(e,n,t)},ge=function(){var t,e,n;return t=2<=arguments.length?xe.call(arguments,0,e=arguments.length-1):(e=0,[]),n=arguments[e++],z.apply(null,t).apply(n)},F=function(t){return V(t)?T.flatMap(F,t):X(t)?[t]:t instanceof w?[t.obs]:[]},ve=function(t){return function(){var e,n,r,i;return r=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],"object"==typeof r&&e.length&&(n=r,i=e[0],r=function(){return n[i].apply(n,arguments)},e=e.slice(1)),t.apply(null,[r].concat(xe.call(e)))}},J=function(t){return t=Array.prototype.slice.call(t),$.apply(null,t)},ie=function(t,e){return function(){var n;return n=1<=arguments.length?xe.call(arguments,0):[],t.apply(null,e.concat(n))}},he=function(t){return function(e){return function(n){var r;return null==n?void 0:(r=n[e],T.isFunction(r)?r.apply(n,t):r)}}},fe=function(t,e){var n,r;return r=t.slice(1).split("."),n=T.map(he(e),r),function(e){var r,i;for(r=0,i=n.length;i>r;r++)t=n[r],e=t(e);return e}},Y=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},$=ve(function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],T.isFunction(e)?t.length?ie(e,t):e:Y(e)?fe(e,t):T.always(e)}),Z=function(t,e){return $.apply(null,[t].concat(xe.call(e)))},j=function(t,e,n,r){var i;return e instanceof b?(i=e.sampledBy(t,function(t,e){return[t,e]}),r.call(i,function(t){var e,n;return e=t[0],n=t[1],e}).map(function(t){var e,n;return e=t[0],n=t[1]})):(e=Z(e,n),r.call(t,e))},ce=function(t){var e;if(T.isFunction(t))return t;if(Y(t))return e=pe(t),function(t,n){return t[e](n)};throw new m("not a function or a field key: "+t)},pe=function(t){return t.slice(1)},x=function(){function t(t){this.value=t}return t.prototype.getOrElse=function(){return this.value},t.prototype.get=function(){return this.value},t.prototype.filter=function(e){return e(this.value)?new t(this.value):g},t.prototype.map=function(e){return new t(e(this.value))},t.prototype.forEach=function(t){return t(this.value)},t.prototype.isDefined=!0,t.prototype.toArray=function(){return[this.value]},t.prototype.inspect=function(){return"Some("+this.value+")"},t.prototype.toString=function(){return this.inspect()},t}(),g={getOrElse:function(t){return t},filter:function(){return g},map:function(){return g},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},me=function(t){return t instanceof x||t===g?t:new x(t)},n.noMore=["<no-more>"],n.more=["<more>"],P=0,f=function(){function t(){this.id=++P}return t.prototype.isEvent=function(){return!0},t.prototype.isEnd=function(){return!1},t.prototype.isInitial=function(){return!1},t.prototype.isNext=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.hasValue=function(){return!1},t.prototype.filter=function(){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t}(),d=function(t){function e(t,n){e.__super__.constructor.call(this),!n&&T.isFunction(t)||t instanceof e?(this.valueF=t,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=t)}return ye(e,t),e.prototype.isNext=function(){return!0},e.prototype.hasValue=function(){return!0},e.prototype.value=function(){return this.valueF instanceof e?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},e.prototype.fmap=function(t){var e,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return t(n)})):(e=this,this.apply(function(){return t(e.value())}))},e.prototype.apply=function(t){return new e(t)},e.prototype.filter=function(t){return t(this.value())},e.prototype.toString=function(){return T.toString(this.value())},e.prototype.log=function(){return this.value()},e}(f),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ye(e,t),e.prototype.isInitial=function(){return!0},e.prototype.isNext=function(){return!1},e.prototype.apply=function(t){return new e(t)},e.prototype.toNext=function(){return new d(this)},e}(d),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ye(e,t),e.prototype.isEnd=function(){return!0},e.prototype.fmap=function(){return this},e.prototype.apply=function(){return this},e.prototype.toString=function(){return"<end>"},e}(f),l=function(t){function e(t){this.error=t}return ye(e,t),e.prototype.isError=function(){return!0},e.prototype.fmap=function(){return this},e.prototype.apply=function(){return this},e.prototype.toString=function(){return"<error> "+T.toString(this.error)},e}(f),n.Event=f,n.Initial=h,n.Next=d,n.End=c,n.Error=l,H=function(t){return new h(t,!0)},ne=function(t){return new d(t,!0)},N=function(){return new c},le=function(t){return t instanceof f?t:ne(t)},W=0,ue=function(){},v=function(){function t(t){this.id=++W,ge(t,this),this.initialDesc=this.desc}return t.prototype.subscribe=function(t){return E.wrappedSubscribe(this,t)},t.prototype.subscribeInternal=function(t){return this.dispatcher.subscribe(t)},t.prototype.onValue=function(){var t;return t=J(arguments),this.subscribe(function(e){return e.hasValue()?t(e.value()):void 0})},t.prototype.onValues=function(t){return this.onValue(function(e){return t.apply(null,e)})},t.prototype.onError=function(){var t;return t=J(arguments),this.subscribe(function(e){return e.isError()?t(e.error):void 0})},t.prototype.onEnd=function(){var t;return t=J(arguments),this.subscribe(function(e){return e.isEnd()?t():void 0})},t.prototype.name=function(t){return this._name=t,this},t.prototype.withDescription=function(){return z.apply(null,arguments).apply(this)},t.prototype.toString=function(){return this._name?this._name:this.desc.toString()},t.prototype.internalDeps=function(){return this.initialDesc.deps()},t}(),v.prototype.assign=v.prototype.onValue,v.prototype.forEach=v.prototype.onValue,v.prototype.inspect=v.prototype.toString,n.Observable=v,o=function(){function t(t){var e,n,r;for(null==t&&(t=[]),this.unsubscribe=we(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],e=0,n=t.length;n>e;e++)r=t[e],this.add(r)}return t.prototype.add=function(t){var e,n,r;if(!this.unsubscribed)return e=!1,n=re,this.starting.push(t),r=function(r){return function(){return r.unsubscribed?void 0:(e=!0,r.remove(n),T.remove(t,r.starting))}}(this),n=t(this.unsubscribe,r),this.unsubscribed||e?n():this.subscriptions.push(n),T.remove(t,this.starting),n},t.prototype.remove=function(t){return this.unsubscribed?void 0:void 0!==T.remove(t,this.subscriptions)?t():void 0},t.prototype.unsubscribe=function(){var t,e,n,r;if(!this.unsubscribed){for(this.unsubscribed=!0,n=this.subscriptions,t=0,e=n.length;e>t;t++)(r=n[t])();return this.subscriptions=[],this.starting=[]}},t.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},t.prototype.empty=function(){return 0===this.count()},t}(),n.CompositeUnsubscribe=o,s=function(){function t(t,e){this._subscribe=t,this._handleEvent=e,this.subscribe=we(this.subscribe,this),this.handleEvent=we(this.handleEvent,this),this.subscriptions=[],this.queue=[],this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0}return t.prototype.hasSubscribers=function(){return this.subscriptions.length>0},t.prototype.removeSub=function(t){return this.subscriptions=T.without(t,this.subscriptions)},t.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),E.inTransaction(t,this,this.pushIt,[t])},t.prototype.pushToSubscriptions=function(t){var e,r,i,o,a,u;try{for(u=this.subscriptions,r=0,i=u.length;i>r;r++)a=u[r],o=a.sink(t),(o===n.noMore||t.isEnd())&&this.removeSub(a);return!0}catch(s){throw e=s,this.pushing=!1,this.queue=[],e}},t.prototype.pushIt=function(t){if(this.pushing)return this.queue.push(t),n.more;if(t!==this.prevError){for(t.isError()&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;this.queue.length;)t=this.queue.shift(),this.push(t);return this.hasSubscribers()?n.more:(this.unsubscribeFromSource(),n.noMore)}},t.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},t.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},t.prototype.subscribe=function(t){var e;return this.ended?(t(N()),re):(R(t),e={sink:t},this.subscriptions.push(e),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),R(this.unsubSrc)),function(t){return function(){return t.removeSub(e),t.hasSubscribers()?void 0:t.unsubscribeFromSource()}}(this))},t}(),p=function(t){function e(t,n,r){T.isFunction(t)&&(r=n,n=t,t=[]),e.__super__.constructor.call(this,t),R(n),this.dispatcher=new s(n,r),ue(this)}return ye(e,t),e.prototype.toProperty=function(t){var e,r;return r=0===arguments.length?g:me(function(){return t}),e=this.dispatcher,new b(z(this,"toProperty",t),function(t){var i,o,a,u;return i=!1,u=re,o=n.more,a=function(){return i?void 0:r.forEach(function(e){return i=!0,o=t(new h(e)),o===n.noMore?(u(),u=re):void 0})},u=e.subscribe(function(e){return e.hasValue()?i&&e.isInitial()?n.more:(e.isInitial()||a(),i=!0,r=new x(e),t(e)):(e.isEnd()&&(o=a()),o!==n.noMore?t(e):void 0)}),a(),u})},e.prototype.toEventStream=function(){return this},e.prototype.withHandler=function(t){return new e(z(this,"withHandler",t),this.dispatcher.subscribe,t)},e}(v),n.EventStream=p,n.never=function(){return new p(z(n,"never"),function(t){return t(N()),re})},n.when=function(){var t,e,r,i,o,a,u,s,c,l,f,m,h,d,g,v,b,y,x,_;if(0===arguments.length)return n.never();for(u=arguments.length,_="when: expecting arguments in the form (Observable+,function)+",A(_,u%2===0),y=[],h=[],e=0,d=[];u>e;){for(d[e]=arguments[e],d[e+1]=arguments[e+1],m=T.toArray(arguments[e]),t=k(arguments[e+1]),f={f:t,ixs:[]},x=!1,o=0,s=m.length;s>o;o++){for(b=m[o],r=T.indexOf(y,b),x||(x=w.isTrigger(b)),0>r&&(y.push(b),r=y.length-1),g=f.ixs,a=0,c=g.length;c>a;a++)i=g[a],i.index===r&&i.count++;f.ixs.push({index:r,count:1})}A("At least one EventStream required",x||!m.length),m.length>0&&h.push(f),e+=2}return y.length?(y=T.map(w.fromObservable,y),l=T.any(y,function(t){return t.flatten})&&C(T.map(function(t){return t.obs},y)),v=new p(z.apply(null,[n,"when"].concat(xe.call(d))),function(t){var r,i,o,a,u,s,c;return c=[],o=!1,a=function(t){var n,r,i;for(i=t.ixs,n=0,r=i.length;r>n;n++)if(e=i[n],!y[e.index].hasAtLeast(e.count))return!1;return!0},i=function(t){return!t.sync||t.ended},r=function(t){var n,r,i;for(i=t.ixs,n=0,r=i.length;r>n;n++)if(e=i[n],!y[e.index].mayHave(e.count))return!0},u=function(t){return!t.source.flatten},s=function(s){return function(f){var p,m,d;return m=function(){return E.whenDoneWith(v,p)},d=function(){var r,i,o,s,l,f;if(!(c.length>0))return n.more;for(l=n.more,f=c.pop(),i=0,o=h.length;o>i;i++)if(s=h[i],a(s))return r=function(){var t,n,r,i;for(r=s.ixs,i=[],n=0,t=r.length;t>n;n++)e=r[n],i.push(y[e.index].consume());return i}(),l=t(f.e.apply(function(){var t,e;return e=function(){var e,n,i;for(i=[],n=0,e=r.length;e>n;n++)t=r[n],i.push(t.value());return i}(),s.f.apply(s,e)})),c.length&&(c=T.filter(u,c)),l===n.noMore?l:d()},p=function(){var e;return e=d(),o&&(o=!1,(T.all(y,i)||T.all(h,r))&&(e=n.noMore,t(N()))),e===n.noMore&&f(),e},s.subscribe(function(e){var r;return e.isEnd()?(o=!0,s.markEnded(),m()):e.isError()?r=t(e):(s.push(e),s.sync&&(c.push({source:s,e:e}),l||E.hasWaiters()?m():p())),r===n.noMore&&f(),r||n.more})}},new n.CompositeUnsubscribe(function(){var t,e,n;for(n=[],t=0,e=y.length;e>t;t++)b=y[t],n.push(s(b));return n}()).unsubscribe})):n.never()},C=function(t,e){var n;return null==e&&(e=[]),n=function(t){var r;return T.contains(e,t)?!0:(r=t.internalDeps(),r.length?(e.push(t),T.any(r,n)):(e.push(t),!1))},T.any(t,n)},k=function(t){return T.isFunction(t)?t:T.always(t)},n.groupSimultaneous=function(){var t,e,i;return i=1<=arguments.length?xe.call(arguments,0):[],1===i.length&&V(i[0])&&(i=i[0]),e=function(){var e,n,o;for(o=[],e=0,n=i.length;n>e;e++)t=i[e],o.push(new r(t));return o}(),ge.apply(null,[n,"groupSimultaneous"].concat(xe.call(i),[n.when(e,function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[]})]))},y=function(t){function e(t,n,r){this.property=t,this.subscribe=we(this.subscribe,this),e.__super__.constructor.call(this,n,r),this.current=g,this.currentValueRootId=void 0,this.propertyEnded=!1}return ye(e,t),e.prototype.push=function(t){return t.isEnd()&&(this.propertyEnded=!0),t.hasValue()&&(this.current=new x(t),this.currentValueRootId=E.currentEventId()),e.__super__.push.call(this,t)},e.prototype.maybeSubSource=function(t,e){return e===n.noMore?re:this.propertyEnded?(t(N()),re):s.prototype.subscribe.call(this,t)},e.prototype.subscribe=function(t){var e,r,i,o;return r=!1,i=n.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(e=E.currentEventId(),o=this.currentValueRootId,!this.propertyEnded&&o&&e&&e!==o?(E.whenDoneWith(this.property,function(e){return function(){return e.currentValueRootId===o?t(H(e.current.get().value())):void 0}}(this)),this.maybeSubSource(t,i)):(E.inTransaction(void 0,this,function(){return i=t(H(this.current.get().value()))},[]),this.maybeSubSource(t,i))):this.maybeSubSource(t,i)},e}(s),b=function(t){function e(t,n,r){T.isFunction(t)&&(r=n,n=t,t=[]),e.__super__.constructor.call(this,t),R(n),this.dispatcher=new y(this,n,r),ue(this)}return ye(e,t),e.prototype.changes=function(){return new p(z(this,"changes"),function(t){return function(e){return t.dispatcher.subscribe(function(t){return t.isInitial()?void 0:e(t)})}}(this))},e.prototype.withHandler=function(t){return new e(z(this,"withHandler",t),this.dispatcher.subscribe,t)},e.prototype.toProperty=function(){return D(arguments),this},e.prototype.toEventStream=function(){return new p(z(this,"toEventStream"),function(t){return function(e){return t.dispatcher.subscribe(function(t){return t.isInitial()&&(t=t.toNext()),e(t)})}}(this))},e}(v),n.Property=b,n.constant=function(t){return new b(z(n,"constant",t),function(e){return e(H(t)),e(N()),re})},n.fromBinder=function(t,e){return null==e&&(e=T.id),new p(z(n,"fromBinder",t,e),function(r){var i,o,a,u;return u=!1,i=!1,o=function(){return u?void 0:"undefined"!=typeof a&&null!==a?(a(),u=!0):i=!0},a=t(function(){var t,i,a,u,s,c;for(t=1<=arguments.length?xe.call(arguments,0):[],c=e.apply(this,t),V(c)&&T.last(c)instanceof f||(c=[c]),s=n.more,a=0,u=c.length;u>a;a++)if(i=c[a],s=r(i=le(i)),s===n.noMore||i.isEnd())return o(),s;return s}),i&&o(),o})},U=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],B=function(t){var e,n,r,i;for(e=0,n=U.length;n>e;e++)if(i=U[e],r=[t[i[0]],t[i[1]]],r[0]&&r[1])return r;throw new l("No suitable event methods in "+t)},n.fromEventTarget=function(t,e,r){var i,o,a;return i=B(t),o=i[0],a=i[1],ge(n,"fromEvent",t,e,n.fromBinder(function(n){return o.call(t,e,n),function(){return a.call(t,e,n)}},r))},n.fromEvent=n.fromEventTarget,n.Observable.prototype.map=function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],j(this,e,t,function(t){return ge(this,"map",t,this.withHandler(function(e){return this.push(e.fmap(t))}))})},n.combineAsArray=function(){var t,e,r,i,o,a,u;for(u=1<=arguments.length?xe.call(arguments,0):[],1===u.length&&V(u[0])&&(u=u[0]),t=e=0,r=u.length;r>e;t=++e)a=u[t],X(a)||(u[t]=n.constant(a));return u.length?(o=function(){var t,e,n;for(n=[],t=0,e=u.length;e>t;t++)i=u[t],n.push(new w(i,!0));return n}(),ge.apply(null,[n,"combineAsArray"].concat(xe.call(u),[n.when(o,function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[]}).toProperty()]))):n.constant([])},n.onValues=function(){var t,e,r;return r=2<=arguments.length?xe.call(arguments,0,e=arguments.length-1):(e=0,[]),t=arguments[e++],n.combineAsArray(r).onValues(t)},n.combineWith=function(){var t,e;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],ge.apply(null,[n,"combineWith",t].concat(xe.call(e),[n.combineAsArray(e).map(function(e){return t.apply(null,e)})]))},n.combineTemplate=function(t){var e,r,i,o,a,u,s,c,l,f;return s=[],f=[],u=function(t){return t[t.length-1]},l=function(t,e,n){return u(t)[e]=n},e=function(t,e){return function(n,r){return l(n,t,r[e])}},a=function(t,e){return function(n){return l(n,t,e)}},c=function(t){return V(t)?[]:{}},i=function(t,n){var r,i;return X(n)?(f.push(n),s.push(e(t,f.length-1))):n!==Object(n)||"function"==typeof n||n instanceof RegExp||n instanceof Date?s.push(a(t,n)):(i=function(t){return function(e){var r;return r=c(n),l(e,t,r),e.push(r)}},r=function(t){return t.pop()},s.push(i(t)),o(n),s.push(r))},o=function(t){return T.each(t,i)},o(t),r=function(e){var n,r,i,o,a;for(a=c(t),n=[a],i=0,o=s.length;o>i;i++)(r=s[i])(n,e);return a},ge(n,"combineTemplate",t,n.combineAsArray(f).map(r))},n.Observable.prototype.combine=function(t,e){var r;return r=ce(e),ge(this,"combine",t,e,n.combineAsArray(this,t).map(function(t){return r(t[0],t[1])}))},n.Observable.prototype.decode=function(t){return ge(this,"decode",t,this.combine(n.combineTemplate(t),function(t,e){return e[t]}))},n.Observable.prototype.withStateMachine=function(t,e){var r;return r=t,ge(this,"withStateMachine",t,e,this.withHandler(function(t){var i,o,a,u,s,c,l;for(i=e(r,t),u=i[0],c=i[1],r=u,l=n.more,o=0,a=c.length;a>o;o++)if(s=c[o],l=this.push(s),l===n.noMore)return l;return l}))},n.Observable.prototype.skipDuplicates=function(t){return null==t&&(t=function(t,e){return t===e}),ge(this,"skipDuplicates",this.withStateMachine(g,function(e,n){return n.hasValue()?n.isInitial()||e===g||!t(e.get(),n.value())?[new x(n.value()),[n]]:[e,[]]:[e,[n]]}))},n.Observable.prototype.awaiting=function(t){return ge(this,"awaiting",t,n.groupSimultaneous(this,t).map(function(t){var e,n;return e=t[0],n=t[1],0===n.length}).toProperty(!1).skipDuplicates())},n.Observable.prototype.not=function(){return ge(this,"not",this.map(function(t){return!t}))},n.Property.prototype.and=function(t){return ge(this,"and",t,this.combine(t,function(t,e){return t&&e}))},n.Property.prototype.or=function(t){return ge(this,"or",t,this.combine(t,function(t,e){return t||e}))},n.scheduler={setTimeout:function(t,e){return setTimeout(t,e)},setInterval:function(t,e){return setInterval(t,e)},clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)},now:function(){return(new Date).getTime()}},n.EventStream.prototype.bufferWithTime=function(t){return ge(this,"bufferWithTime",t,this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},n.EventStream.prototype.bufferWithCount=function(t){return ge(this,"bufferWithCount",t,this.bufferWithTimeOrCount(void 0,t))},n.EventStream.prototype.bufferWithTimeOrCount=function(t,e){var n;return n=function(n){return n.values.length===e?n.flush():void 0!==t?n.schedule():void 0},ge(this,"bufferWithTimeOrCount",t,e,this.buffer(t,n,n))},n.EventStream.prototype.buffer=function(t,e,r){var i,o,a;return null==e&&(e=re),null==r&&(r=re),i={scheduled:null,end:void 0,values:[],flush:function(){var t;if(this.scheduled&&(n.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){if(t=this.push(ne(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(t!==n.noMore)return r(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:this.scheduled=t(function(t){return function(){return t.flush()}}(this))}},a=n.more,T.isFunction(t)||(o=t,t=function(t){return n.scheduler.setTimeout(t,o)}),ge(this,"buffer",this.withHandler(function(t){return i.push=function(t){return function(e){return t.push(e)}}(this),t.isError()?a=this.push(t):t.isEnd()?(i.end=t,i.scheduled||i.flush()):(i.values.push(t.value()),e(i)),a}))},n.Observable.prototype.filter=function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],j(this,e,t,function(t){return ge(this,"filter",t,this.withHandler(function(e){return e.filter(t)?this.push(e):n.more}))})},n.once=function(t){return new p(z(n,"once",t),function(e){return e(le(t)),e(N()),re})},n.EventStream.prototype.concat=function(t){var e;return e=this,new p(z(e,"concat",t),function(n){var r,i;return i=re,r=e.dispatcher.subscribe(function(e){return e.isEnd()?i=t.dispatcher.subscribe(n):n(e)}),function(){return r(),i()}})},n.Observable.prototype.flatMap=function(){return q(this,ee(arguments))},n.Observable.prototype.flatMapFirst=function(){return q(this,ee(arguments),!0)},q=function(t,e,r,i){var a,u,s;return s=[t],a=[],u=new p(z(t,"flatMap"+(r?"First":""),e),function(u){var s,c,l,f,p;return l=new o,f=[],p=function(t){var r;return r=te(e(t.value())),a.push(r),l.add(function(t,e){return r.dispatcher.subscribe(function(i){var o;return i.isEnd()?(T.remove(r,a),c(),s(e),n.noMore):(i instanceof h&&(i=i.toNext()),o=u(i),o===n.noMore&&t(),o)})})},c=function(){var t;return t=f.shift(),t?p(t):void 0},s=function(t){return t(),l.empty()?u(N()):void 0},l.add(function(e,o){return t.dispatcher.subscribe(function(t){return t.isEnd()?s(o):t.isError()?u(t):r&&l.count()>1?n.more:l.unsubscribed?n.noMore:i&&l.count()>i?f.push(t):p(t)})}),l.unsubscribe}),u.internalDeps=function(){return a.length?s.concat(a):s},u},ee=function(t){return 1===t.length&&X(t[0])?T.always(t[0]):J(t)},te=function(t){return X(t)?t:n.once(t)},n.Observable.prototype.flatMapWithConcurrencyLimit=function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],ge.apply(null,[this,"flatMapWithConcurrencyLimit",e].concat(xe.call(t),[q(this,ee(t),!1,e)]))},n.Observable.prototype.flatMapConcat=function(){return ge.apply(null,[this,"flatMapConcat"].concat(xe.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(xe.call(arguments)))]))},_=function(t,e){var r;return r=new p(z(t,"justInitValue"),function(e){var i,o;return o=void 0,i=t.dispatcher.subscribe(function(t){return t.isEnd()||(o=t),n.noMore}),E.whenDoneWith(r,function(){return null!=o&&e(o),e(N())}),i}),r.concat(e).toProperty()},n.Observable.prototype.mapEnd=function(){var t;return t=J(arguments),ge(this,"mapEnd",t,this.withHandler(function(e){return e.isEnd()?(this.push(ne(t(e))),this.push(N()),n.noMore):this.push(e)}))},n.Observable.prototype.skipErrors=function(){return ge(this,"skipErrors",this.withHandler(function(t){return t.isError()?n.more:this.push(t)}))},n.EventStream.prototype.takeUntil=function(t){var e;return e={},ge(this,"takeUntil",t,n.groupSimultaneous(this.mapEnd(e),t.skipErrors()).withHandler(function(r){var i,o,a,u,s,c;if(r.hasValue()){if(u=r.value(),i=u[0],t=u[1],t.length)return this.push(N());for(s=n.more,o=0,a=i.length;a>o;o++)c=i[o],s=this.push(c===e?N():ne(c));return s}return this.push(r)}))},n.Property.prototype.takeUntil=function(t){var e;return e=this.changes().takeUntil(t),ge(this,"takeUntil",t,_(this,e))},n.Observable.prototype.flatMapLatest=function(){var t,e;return t=ee(arguments),e=this.toEventStream(),ge(this,"flatMapLatest",t,e.flatMap(function(n){return te(t(n)).takeUntil(e)}))},n.fromPoll=function(t,e){return ge(n,"fromPoll",t,e,n.fromBinder(function(e){var r;return r=n.scheduler.setInterval(e,t),function(){return n.scheduler.clearInterval(r)}},e))},n.later=function(t,e){return ge(n,"later",t,e,n.fromBinder(function(r){var i,o;return o=function(){return r([e,N()])},i=n.scheduler.setTimeout(o,t),function(){return n.scheduler.clearTimeout(i)}}))},n.sequentially=function(t,e){var r;return r=0,ge(n,"sequentially",t,e,n.fromPoll(t,function(){var t;return t=e[r++],r<e.length?t:r===e.length?[t,N()]:N()}))},n.repeatedly=function(t,e){var r;return r=0,ge(n,"repeatedly",t,e,n.fromPoll(t,function(){return e[r++%e.length]}))},n.interval=function(t,e){return null==e&&(e={}),ge(n,"interval",t,e,n.fromPoll(t,function(){return ne(e)}))},n.EventStream.prototype.delay=function(t){return ge(this,"delay",t,this.flatMap(function(e){return n.later(t,e)}))},n.Property.prototype.delay=function(t){return this.delayChanges("delay",t,function(e){return e.delay(t)})},n.Property.prototype.delayChanges=function(){var t,e,n;return t=2<=arguments.length?xe.call(arguments,0,n=arguments.length-1):(n=0,[]),e=arguments[n++],ge.apply(null,[this].concat(xe.call(t),[_(this,e(this.changes()))]))},n.Observable.prototype.bufferingThrottle=function(t){return ge(this,"bufferingThrottle",t,this.flatMapConcat(function(e){return n.once(e).concat(n.later(t).filter(!1))}))},n.Property.prototype.bufferingThrottle=function(){return n.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},i=function(t){function e(){this.guardedSink=we(this.guardedSink,this),this.subscribeAll=we(this.subscribeAll,this),this.unsubAll=we(this.unsubAll,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,e.__super__.constructor.call(this,z(n,"Bus"),this.subscribeAll)}return ye(e,t),e.prototype.unsubAll=function(){var t,e,n,r;for(n=this.subscriptions,t=0,e=n.length;e>t;t++)r=n[t],"function"==typeof r.unsub&&r.unsub();return void 0},e.prototype.subscribeAll=function(t){var e,n,r,i;for(this.sink=t,r=L(this.subscriptions),e=0,n=r.length;n>e;e++)i=r[e],this.subscribeInput(i);return this.unsubAll},e.prototype.guardedSink=function(t){return function(e){return function(r){return r.isEnd()?(e.unsubscribeInput(t),n.noMore):e.sink(r)}}(this)},e.prototype.subscribeInput=function(t){return t.unsub=t.input.dispatcher.subscribe(this.guardedSink(t.input))},e.prototype.unsubscribeInput=function(t){var e,n,r,i,o;for(i=this.subscriptions,e=n=0,r=i.length;r>n;e=++n)if(o=i[e],o.input===t)return"function"==typeof o.unsub&&o.unsub(),void this.subscriptions.splice(e,1)},e.prototype.plug=function(t){var e;return I(t),this.ended?void 0:(e={input:t},this.subscriptions.push(e),null!=this.sink&&this.subscribeInput(e),function(e){return function(){return e.unsubscribeInput(t)
}}(this))},e.prototype.end=function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(N()):void 0},e.prototype.push=function(t){return"function"==typeof this.sink?this.sink(ne(t)):void 0},e.prototype.error=function(t){return"function"==typeof this.sink?this.sink(new l(t)):void 0},e}(p),n.Bus=i,Q=function(t,e){return ve(function(){var r,i,o;return i=arguments[0],r=2<=arguments.length?xe.call(arguments,1):[],o=ie(e,[function(t,e){return i.apply(null,xe.call(t).concat([e]))}]),ge.apply(null,[n,t,i].concat(xe.call(r),[n.combineAsArray(r).flatMap(o)]))})},n.fromCallback=Q("fromCallback",function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],n.fromBinder(function(n){return Z(e,t)(n),re},function(t){return[t,N()]})}),n.fromNodeCallback=Q("fromNodeCallback",function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],n.fromBinder(function(n){return Z(e,t)(n),re},function(t,e){return t?[new l(t),N()]:[e,N()]})}),n.EventStream.prototype.debounce=function(t){return ge(this,"debounce",t,this.flatMapLatest(function(e){return n.later(t,e)}))},n.Property.prototype.debounce=function(t){return this.delayChanges("debounce",t,function(e){return e.debounce(t)})},n.EventStream.prototype.debounceImmediate=function(t){return ge(this,"debounceImmediate",t,this.flatMapFirst(function(e){return n.once(e).concat(n.later(t).filter(!1))}))},n.Observable.prototype.scan=function(t,e){var r,i,o;return e=ce(e),r=me(t),o=function(t){return function(o){var a,u,s,c;return a=!1,c=re,u=n.more,s=function(){return a?void 0:r.forEach(function(t){return a=!0,u=o(new h(function(){return t})),u===n.noMore?(c(),c=re):void 0})},c=t.dispatcher.subscribe(function(t){var i,c;return t.hasValue()?a&&t.isInitial()?n.more:(t.isInitial()||s(),a=!0,c=r.getOrElse(void 0),i=e(c,t.value()),r=new x(i),o(t.apply(function(){return i}))):(t.isEnd()&&(u=s()),u!==n.noMore?o(t):void 0)}),E.whenDoneWith(i,s),c}}(this),i=new b(z(this,"scan",t,e),o)},n.Observable.prototype.diff=function(t,e){return e=ce(e),ge(this,"diff",t,e,this.scan([t],function(t,n){return[n,e(t[0],n)]}).filter(function(t){return 2===t.length}).map(function(t){return t[1]}))},n.Observable.prototype.doAction=function(){var t;return t=J(arguments),ge(this,"doAction",t,this.withHandler(function(e){return e.hasValue()&&t(e.value()),this.push(e)}))},n.Observable.prototype.endOnError=function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],null==e&&(e=!0),j(this,e,t,function(t){return ge(this,"endOnError",this.withHandler(function(e){return e.isError()&&t(e.error)?(this.push(e),this.push(N())):this.push(e)}))})},v.prototype.errors=function(){return ge(this,"errors",this.filter(function(){return!1}))},de=function(t){return[t,N()]},n.fromPromise=function(t,e){return ge(n,"fromPromise",t,n.fromBinder(function(n){var r;return null!=(r=t.then(n,function(t){return n(new l(t))}))&&"function"==typeof r.done&&r.done(),function(){return e&&"function"==typeof t.abort?t.abort():void 0}},de))},n.Observable.prototype.mapError=function(){var t;return t=J(arguments),ge(this,"mapError",t,this.withHandler(function(e){return this.push(e.isError()?ne(t(e.error)):e)}))},n.Observable.prototype.flatMapError=function(t){return ge(this,"flatMapError",t,this.mapError(function(t){return new l(t)}).flatMap(function(e){return e instanceof l?t(e.error):n.once(e)}))},n.EventStream.prototype.sampledBy=function(t,e){return ge(this,"sampledBy",t,e,this.toProperty().sampledBy(t,e))},n.Property.prototype.sampledBy=function(t,e){var r,i,o,a,u;return null!=e?e=ce(e):(r=!0,e=function(t){return t.value()}),u=new w(this,!1,r),o=new w(t,!0,r),a=n.when([u,o],e),i=t instanceof b?a.toProperty():a,ge(this,"sampledBy",t,e,i)},n.Property.prototype.sample=function(t){return ge(this,"sample",t,this.sampledBy(n.interval(t,{})))},n.Observable.prototype.map=function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],e instanceof b?e.sampledBy(this,G):j(this,e,t,function(t){return ge(this,"map",t,this.withHandler(function(e){return this.push(e.fmap(t))}))})},n.Observable.prototype.fold=function(t,e){return ge(this,"fold",t,e,this.scan(t,e).sampledBy(this.filter(!1).mapEnd().toProperty()))},v.prototype.reduce=v.prototype.fold,n.EventStream.prototype.merge=function(t){var e;return S(t),e=this,ge(e,"merge",t,n.mergeAll(this,t))},n.mergeAll=function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[],V(t[0])&&(t=t[0]),t.length?new p(z.apply(null,[n,"mergeAll"].concat(xe.call(t))),function(e){var r,i,o;return r=0,o=function(i){return function(o){return i.dispatcher.subscribe(function(i){var a;return i.isEnd()?(r++,r===t.length?e(N()):n.more):(a=e(i),a===n.noMore&&o(),a)})}},i=T.map(o,t),new n.CompositeUnsubscribe(i).unsubscribe}):n.never()},n.Observable.prototype.take=function(t){return 0>=t?n.never():ge(this,"take",t,this.withHandler(function(e){return e.hasValue()?(t--,t>0?this.push(e):(0===t&&this.push(e),this.push(N()),n.noMore)):this.push(e)}))},n.fromArray=function(t){var e;return M(t),t.length?(e=0,new p(z(n,"fromArray",t),function(r){var i,o,a;return a=!1,o=n.more,i=function(){var u;return o===n.noMore||a||(u=t[e++],o=r(le(u)),o===n.noMore)?void 0:e===t.length?r(N()):E.afterTransaction(i)},i(),function(){return a=!0}})):ge(n,"fromArray",t,n.never())},n.EventStream.prototype.holdWhen=function(t){var e,r,i;return i=t.startWith(!1),r=i.filter(function(t){return!t}),e=i.filter(T.id),ge(this,"holdWhen",t,this.filter(!1).merge(i.flatMapConcat(function(t){return function(i){return i?t.scan([],function(t,e){return t.concat([e])}).sampledBy(r).take(1).flatMap(n.fromArray):t.takeUntil(e)}}(this))))},n.$={},n.$.asEventStream=function(t,e,r){var i;return T.isFunction(e)&&(i=[e,void 0],r=i[0],e=i[1]),ge(this.selector||this,"asEventStream",t,n.fromBinder(function(n){return function(r){return n.on(t,e,r),function(){return n.off(t,e,r)}}}(this),r))},null!=(ae="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:void 0)&&(ae.fn.asEventStream=n.$.asEventStream),n.Observable.prototype.log=function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[],this.subscribe(function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log.apply(console,xe.call(t).concat([e.log()])):void 0}),this},n.repeat=function(t){var e;return e=0,n.fromBinder(function(r){var i,o,a,u,s;return i=!1,a=n.more,s=function(){},o=function(t){return t.isEnd()?i?u():i=!0:a=r(t)},u=function(){var u;for(i=!0;i&&a!==n.noMore;)u=t(e++),i=!1,u?s=u.subscribeInternal(o):r(N());return i=!0},u(),function(){return s()}})},n.retry=function(t){var e,r,i,o,a,u,s;if(!T.isFunction(t.source))throw new m("'source' option has to be a function");return s=t.source,u=t.retries||0,a=t.maxRetries||u,e=t.delay||function(){return 0},o=t.isRetryable||function(){return!0},i=!1,r=null,ge(n,"retry",t,n.repeat(function(){var t,c,l;return i?null:(l=function(){return s().endOnError().withHandler(function(t){return t.isError()?(r=t,o(r.error)&&u>0?void 0:(i=!0,this.push(t))):(t.hasValue()&&(r=null,i=!0),this.push(t))})},r?(t={error:r.error,retriesDone:a-u},c=n.later(e(t)).filter(!1),u-=1,c.concat(n.once().flatMap(l))):l())}))},n.Observable.prototype.skip=function(t){return ge(this,"skip",t,this.withHandler(function(e){return e.hasValue()&&t>0?(t--,n.more):this.push(e)}))},n.EventStream.prototype.skipUntil=function(t){var e;return e=t.take(1).map(!0).toProperty(!1),ge(this,"skipUntil",t,this.filter(e))},n.EventStream.prototype.skipWhile=function(){var t,e,r;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],r=!1,j(this,e,t,function(t){return ge(this,"skipWhile",t,this.withHandler(function(e){return!r&&e.hasValue()&&t(e.value())?n.more:(e.hasValue()&&(r=!0),this.push(e))}))})},n.Observable.prototype.slidingWindow=function(t,e){return null==e&&(e=0),ge(this,"slidingWindow",t,e,this.scan([],function(e,n){return e.concat([n]).slice(-t)}).filter(function(t){return t.length>=e}))},n.spy=function(t){return se.push(t)},se=[],ue=function(t){var e,n,r;if(se.length&&!ue.running)try{for(ue.running=!0,e=0,n=se.length;n>e;e++)(r=se[e])(t)}finally{delete ue.running}return void 0},n.Property.prototype.startWith=function(t){return ge(this,"startWith",t,this.scan(t,function(t,e){return e}))},n.EventStream.prototype.startWith=function(t){return ge(this,"startWith",t,n.once(t).concat(this))},n.Observable.prototype.takeWhile=function(){var t,e;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],j(this,e,t,function(t){return ge(this,"takeWhile",t,this.withHandler(function(e){return e.filter(t)?this.push(e):(this.push(N()),n.noMore)}))})},n.update=function(){var t,e,r,i;for(e=arguments[0],i=2<=arguments.length?xe.call(arguments,1):[],r=function(t){return function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[],function(n){return t.apply(null,[n].concat(e))}}},t=i.length-1;t>0;)i[t]instanceof Function||(i[t]=function(t){return function(){return t}}(i[t])),i[t]=r(i[t]),t-=2;return ge.apply(null,[n,"update",e].concat(xe.call(i),[n.when.apply(n,i).scan(e,function(t,e){return e(t)})]))},n.zipAsArray=function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[],V(t[0])&&(t=t[0]),ge.apply(null,[n,"zipAsArray"].concat(xe.call(t),[n.zipWith(t,function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[]})]))},n.zipWith=function(){var t,e,r;return t=arguments[0],r=2<=arguments.length?xe.call(arguments,1):[],T.isFunction(t)||(e=[t,r[0]],r=e[0],t=e[1]),r=T.map(function(t){return t.toEventStream()},r),ge.apply(null,[n,"zipWith",t].concat(xe.call(r),[n.when(r,t)]))},n.Observable.prototype.zip=function(t,e){return null==e&&(e=Array),ge(this,"zip",t,n.zipWith([this,t],e))},n.Observable.prototype.first=function(){return ge(this,"first",this.take(1))},n.Observable.prototype.last=function(){var t;return ge(this,"last",this.withHandler(function(e){return e.isEnd()?(t&&this.push(t),this.push(N()),n.noMore):void(t=e)}))},n.EventStream.prototype.throttle=function(t){return ge(this,"throttle",t,this.bufferWithTime(t).map(function(t){return t[t.length-1]}))},n.Property.prototype.throttle=function(t){return this.delayChanges("throttle",t,function(e){return e.throttle(t)})},v.prototype.firstToPromise=function(t){var e=this;if("function"!=typeof t){if("function"!=typeof Promise)throw new m("There isn't default Promise, use shim or parameter");t=Promise}return new t(function(t,r){return e.subscribe(function(e){return e.hasValue()&&t(e.value()),e.isError()&&r(e.error),n.noMore})})},v.prototype.toPromise=function(t){return this.last().firstToPromise(t)},"undefined"!=typeof e&&null!==e&&null!=e.amd?(t.register("github:baconjs/bacon.js@0.7.53/dist/Bacon",[],!1,function(){return function(){return n}.call(this)}),this.Bacon=n):"undefined"!=typeof module&&null!==module&&null!=module.exports?(module.exports=n,n.Bacon=n):this.Bacon=n}.call(this)}(),t.register("github:maxdavidson/tribus@master/scene/group",["github:maxdavidson/tribus@master/scene/base"],function(t){function e(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return r(a,e)}var n,r,i,o,a;return t("group",e),{setters:[function(t){n=t["default"]}],execute:function(){"use strict";r=function(t,e){var n=Object.create(t.prototype),r=t.apply(n,e);return null==r||"object"!=typeof r&&"function"!=typeof r?n:r},i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(t){function e(n){var r=void 0===arguments[1]?{}:arguments[1],i=void 0===arguments[2]?[]:arguments[2];this.children=[],o(this,e),t.call(this,n,r);for(var a=i,u=Array.isArray(a),s=0,a=u?a:a[Symbol.iterator]();;){var c;if(u){if(s>=a.length)break;c=a[s++]}else{if(s=a.next(),s.done)break;c=s.value}var l=c;this.add(l)}}return i(e,t),e.prototype.forEach=function(t){t(this);for(var e=this.children,n=0,r=e.length;r>n;++n)e[n].forEach(t)},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e);for(var n=this.children,r=0,i=n.length;i>r;++r)n[r].recalculate(e)},e.prototype.add=function(t){t.parent=this,this.children.push(t),this.trigger("didAddNode",{bubble:!0},t)},e.prototype.remove=function(t){t.parent=null,this.trigger("didRemoveNode",{bubble:!0},t)},e}(n),t("default",a),a.prototype[Symbol.iterator]=regeneratorRuntime.mark(function e(){var t,n,r,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a;case 2:t=a.children,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();case 3:if(!n){e.next=9;break}if(!(r>=t.length)){e.next=6;break}return e.abrupt("break",17);case 6:i=t[r++],e.next=13;break;case 9:if(r=t.next(),!r.done){e.next=12;break}return e.abrupt("break",17);case 12:i=r.value;case 13:return o=i,e.delegateYield(o,"t0",15);case 15:e.next=3;break;case 17:case"end":return e.stop()}},e,this)})}}}),t.register("github:maxdavidson/tribus@master/texture/cubemap",["github:maxdavidson/tribus@master/texture/common"],function(t){var e,n,r,i,o;return{setters:[function(t){e=t.getImage}],execute:function(){"use strict";n=function(t,e){var n=Object.create(t.prototype),r=t.apply(n,e);return null==r||"object"!=typeof r&&"function"!=typeof r?n:r},r=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(){function t(e,n,r,o,a,u){i(this,t),this.right=e,this.left=n,this.top=r,this.bottom=o,this.front=a,this.back=u}return t.fromFiles=function(i,o,a,u,s,c,l){return Promise.all([i,o,a,u,s,c].map(function(t){return e(t,l)})).then(function(e){return n(t,r(e))})},t}(),t("default",o)}}}),t.register("github:maxdavidson/tribus@master/material/shaders/skybox.vert!github:systemjs/plugin-text@0.0.2",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports="uniform mat4 cameraMatrix;\n\nattribute highp vec3 vertex;\nvarying highp vec3 texcoord;\n\nvoid main() {\n    gl_Position = cameraMatrix * vec4(vertex, 1.0);\n    texcoord = vertex;\n}\n",r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/material/shaders/skybox.frag!github:systemjs/plugin-text@0.0.2",[],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports="precision highp float;\n\nvarying vec3 texcoord;\nuniform samplerCube skybox;\n\nvoid main() {\n    gl_FragColor = textureCube(skybox, texcoord);\n}\n",r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/geometry/shapes",["github:maxdavidson/tribus@master/geometry/geometry","github:toji/gl-matrix@2.2.1"],function(t){var e,n,r,i,o,a,u,s,c,l;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]}],execute:function(){"use strict";r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=n.vec3,a=n.mat4,u=o.create(),s=a.create(),c=t("Cube",function(t){function e(){i(this,e);var n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,-1];t.call(this,{vertices:n.map(function(t){return.5*t}),normals:n.map(function(t){return Math.sqrt(3)/3*t}),texcoords:[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,0,0,1,1,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,1,9,8,9,10,11,12,13,11,13,14,15,16,2,15,2,17,15,18,19,15,19,10]})}return r(e,t),e}(e)),l=t("Plane",function(t){function e(){var n=void 0===arguments[0]?{}:arguments[0],r=n.size,o=void 0===r?8:r,a=n.heightmap,u=void 0===a?null:a;i(this,e);var s=null,c=void 0,l=void 0;this.heightmap=u,null===u?(c=o,l=o):(c=u.width,l=u.height,s=u.imageData.data);var f=c*l,p=(c-1)*l*2,m=new Float32Array(3*f),h=new Float32Array(2*f),d=new Uint16Array(3*p),g=void 0,v=void 0,b=void 0;for(g=0;c>g;++g)for(v=0;l>v;++v)b=g+v*c,m[3*b+0]=g/(c-1)-.5,m[3*b+1]=null!==s?s[4*b]/255:0,m[3*b+2]=v/(l-1)-.5,h[2*b+0]=g/c,h[2*b+1]=1-v/l;for(g=0;c-1>g;++g)for(v=0;l-1>v;++v)b=6*(g+v*(c-1)),d[b+0]=g+v*c,d[b+1]=g+(v+1)*c,d[b+2]=g+1+v*c,d[b+3]=g+1+v*c,d[b+4]=g+(v+1)*c,d[b+5]=g+1+(v+1)*c;t.call(this,{vertices:m,texcoords:h,indices:d})}return r(e,t),e.prototype.getHeightAtWorldPosition=function(t,e){var n=this,r=o.transformMat4(u,t.worldPosition,a.invert(s,e.worldTransform));null===this.heightmap?r[1]=0:!function(){var t=function(t,e,n){return Math.min(Math.max(t,e),n)},e=n.heightmap.imageData.width,i=n.heightmap.imageData.height,o=t(e*(r[0]+.5),0,e-1),a=t(i*(r[2]+.5),0,i-1),u=Math.floor(o),s=Math.ceil(o),c=Math.floor(a),l=(Math.ceil(a),function(t,r){return n.heightmap.imageData.data[4*(t+r*e)]/256}),f=function(t,e,n){return t+n*(e-t)};r[1]=f(l(u,c),l(s,c),o%1)}();var i=o.transformMat4(u,r,e.worldTransform);return i[1]},e}(e))}}}),function(){function e(){}e.amd={},!function(n,r){"undefined"!=typeof module?module.exports=r():"function"==typeof e&&"object"==typeof e.amd?t.register("github:ded/domready@1.0.7/ready",[],!1,"function"==typeof r?r:function(){return r}):this[n]=r()}("domready",function(){var t,e=[],n=document,r=n.documentElement.doScroll,i="DOMContentLoaded",o=(r?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);return o||n.addEventListener(i,t=function(){for(n.removeEventListener(i,t),o=1;t=e.shift();)t()}),function(t){o?t():e.push(t)}})}(),function(){function e(){}e.amd={},t.register("github:toji/gl-matrix@2.2.1",["github:toji/gl-matrix@2.2.1/dist/gl-matrix"],!1,function(t){return function(t){return t}.call(this,t("github:toji/gl-matrix@2.2.1/dist/gl-matrix"))})}(),t.register("npm:process@0.10.1",["npm:process@0.10.1/browser"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:process@0.10.1/browser"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/math/sign/index",["npm:es5-ext@0.10.6/math/sign/is-implemented","npm:es5-ext@0.10.6/math/sign/shim"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/math/sign/is-implemented")()?Math.sign:require("npm:es5-ext@0.10.6/math/sign/shim"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/_iterate",["npm:es5-ext@0.10.6/object/is-callable","npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/is-callable"),a=require("npm:es5-ext@0.10.6/object/valid-callable"),u=require("npm:es5-ext@0.10.6/object/valid-value"),s=Function.prototype.call,c=Object.keys,l=Object.prototype.propertyIsEnumerable;return n.exports=function(t,e){return function(n,r){var i,f=arguments[2],p=arguments[3];return n=Object(u(n)),a(r),i=c(n),p&&i.sort(o(p)?p.bind(n):void 0),i[t](function(t,i){return l.call(n,t)?s.call(r,f,n[t],t,n,i):e})}},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/keys/index",["npm:es5-ext@0.10.6/object/keys/is-implemented","npm:es5-ext@0.10.6/object/keys/shim"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/keys/is-implemented")()?Object.keys:require("npm:es5-ext@0.10.6/object/keys/shim"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/function/_define-length",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:es5-ext@0.10.6/object/mixin"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o,a,u,s,c=require("npm:es5-ext@0.10.6/number/to-pos-integer"),l=function(){};try{Object.defineProperty(l,"length",{configurable:!0,writable:!1,enumerable:!1,value:1})}catch(f){}return 1===l.length?(o={configurable:!0,writable:!1,enumerable:!1},a=Object.defineProperty,n.exports=function(t,e){return e=c(e),t.length===e?t:(o.value=e,a(t,"length",o))}):(s=require("npm:es5-ext@0.10.6/object/mixin"),u=function(){var t=[];return function(e){var n,r=0;if(t[e])return t[e];for(n=[];e--;)n.push("a"+(++r).toString(36));return new Function("fn","return function ("+n.join(", ")+") { return fn.apply(this, arguments); };")}}(),n.exports=function(t,e){var n;if(e=c(e),t.length===e)return t;n=u(e)(t);try{s(n,t)}catch(r){}return n}),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/string/#/contains/index",["npm:es5-ext@0.10.6/string/#/contains/is-implemented","npm:es5-ext@0.10.6/string/#/contains/shim"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/string/#/contains/is-implemented")()?String.prototype.contains:require("npm:es5-ext@0.10.6/string/#/contains/shim"),r.define=i,n.exports}),t.register("npm:event-emitter@0.3.3",["npm:event-emitter@0.3.3/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:event-emitter@0.3.3/index"),r.define=i,n.exports}),t.register("npm:es6-symbol@2.0.1/validate-symbol",["npm:es6-symbol@2.0.1/is-symbol"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es6-symbol@2.0.1/is-symbol");return n.exports=function(t){if(!o(t))throw new TypeError(t+" is not a symbol");return t},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/function/is-function",["npm:es5-ext@0.10.6/function/noop"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call(require("npm:es5-ext@0.10.6/function/noop"));return n.exports=function(t){return"function"==typeof t&&o.call(t)===a},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/normalizers/get",["npm:es5-ext@0.10.6/array/#/e-index-of"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/#/e-index-of"),a=Object.create;return n.exports=function(){var t=0,e=[],n=a(null);return{get:function(t){var n,r=0,i=e,a=t.length;if(0===a)return i[a]||null;if(i=i[a]){for(;a-1>r;){if(n=o.call(i[0],t[r]),-1===n)return null;i=i[1][n],++r}return n=o.call(i[0],t[r]),-1===n?null:i[1][n]||null}return null},set:function(r){var i,a=0,u=e,s=r.length;if(0===s)u[s]=++t;else{for(u[s]||(u[s]=[[],[]]),u=u[s];s-1>a;)i=o.call(u[0],r[a]),-1===i&&(i=u[0].push(r[a])-1,u[1].push([[],[]])),u=u[1][i],++a;i=o.call(u[0],r[a]),-1===i&&(i=u[0].push(r[a])-1),u[1][i]=++t}return n[t]=r,t},"delete":function(t){var r,i=0,a=e,u=n[t],s=u.length,c=[];if(0===s)delete a[s];else if(a=a[s]){for(;s-1>i;){if(r=o.call(a[0],u[i]),-1===r)return;c.push(a,r),a=a[1][r],++i}if(r=o.call(a[0],u[i]),-1===r)return;for(t=a[1][r],a[0].splice(r,1),a[1].splice(r,1);!a[0].length&&c.length;)r=c.pop(),a=c.pop(),a[0].splice(r,1),a[1].splice(r,1)}delete n[t]},clear:function(){e=[],n=a(null)}}},r.define=i,n.exports}),t.register("npm:next-tick@0.2.2",["npm:next-tick@0.2.2/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:next-tick@0.2.2/index"),r.define=i,n.exports}),t.register("npm:timers-ext@0.1.0/valid-timeout",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:timers-ext@0.1.0/max-timeout"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=require("npm:timers-ext@0.1.0/max-timeout");return n.exports=function(t){if(t=o(t),t>a)throw new TypeError(t+" exceeds maximum possible timeout");return t},r.define=i,n.exports}),t.register("npm:lru-queue@0.1.0",["npm:lru-queue@0.1.0/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:lru-queue@0.1.0/index"),r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/webgl/shader",["github:maxdavidson/tribus@master/extra/ajax"],function(t){var e,n,r,i;return{setters:[function(t){e=t.getString}],execute:function(){"use strict";n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=WebGLRenderingContext,i=function(){function t(e,r,i){n(this,t),this.gl=e,this.type=i,this.handle=e.createShader(i),e.shaderSource(this.handle,r),e.compileShader(this.handle);var o=this.getInfoLog();""!==o&&console.error(o)}return t.prototype.getInfoLog=function(){return this.gl.getShaderInfoLog(this.handle)},t.prototype.getSource=function(){return this.gl.getShaderSource(this.handle)},t.prototype.getTranslatedSource=function(){return this.gl.getExtension("WEBGL_debug_shaders").getTranslatedShaderSource(this.handle)},t.fromFile=function(n,i){var o={vert:r.VERTEX_SHADER,frag:r.FRAGMENT_SHADER}[i.split(".").pop()];return e(i).then(function(e){return new t(n,e,o)})},t}(),t("default",i)}}}),t.register("github:maxdavidson/tribus@master/workers/wavefront",["github:maxdavidson/tribus@master/workers/worker-pool"],function(t){function e(t,e){var n="Parsing OBJ file";console.time(n);for(var r,i,o,a,u,s={v:[],vt:[],vn:[],i:[]},c=new Uint8Array(t),l=[],f=c.length,p=0;f>p;){switch(i=c[p++],i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r=i;break;case 12:case 13:o=c[p++],r=(31&i)<<6|63&o;break;case 14:o=c[p++],a=c[p++],r=(15&i)<<12|(63&o)<<6|(63&a)<<0}if(10===r){var m=String.fromCharCode.apply(void 0,l).trim().split(/\s+/),h=m[0],d=m.slice(1);switch(h){case"v":case"vn":case"vt":Array.prototype.push.apply(s[h],d.map(parseFloat));break;case"f":var g=d.map(function(t){return t.split("/").map(function(t,e){return t=parseInt(t),0>t?t+s[["v","vt","vn"][e]].length:t-1})});if(g.length<3)for(var v=g.length;3>=v;++v)g[v]=g[g.length-1];for(var v=1,b=g.length;b-1>v;++v)s.i.push(g[0],g[v],g[v+1])}l=[]}else l.push(r)}var y={},x=0,w=[],E=[],T=[],_=[];for(p=0,f=s.i.length;f>p;p+=3)for(var v=0;3>v;++v){var A=s.i[p+v],M=A[0],S=A[1],R=A[2],D=A.join(":"),I=y[D];void 0===I&&(I=y[D]=x++,E.push(M),void 0!==S&&T.push(S),void 0!==R&&_.push(R)),w.push(I)}var g=new Uint16Array(w),O=new Float32Array(3*E.length),L=new Float32Array(3*_.length),k=new Float32Array(2*T.length);for(p=0,f=E.length;f>p;++p){u=3*p;var C=3*E[p];O[u]=s.v[C],O[u+1]=s.v[C+1],O[u+2]=s.v[C+2]}for(p=0,f=_.length;f>p;++p){u=3*p;var j=3*_[p];L[u]=s.vn[j],L[u+1]=s.vn[j+1],L[u+2]=s.vn[j+2]}for(p=0,f=T.length;f>p;++p){u=2*p;var z=2*T[p];k[u]=s.vt[z],k[u+1]=s.vt[z+1]}console.timeEnd(n),e({indices:g,vertices:O,normals:L,texcoords:k},[g.buffer,O.buffer,L.buffer,k.buffer])}var n,r;return{setters:[function(t){n=t["default"]}],execute:function(){"use strict";r=t("workerpool",n.fromFunction(e))}}}),t.register("github:maxdavidson/tribus@master/workers/normal-vectors",["github:maxdavidson/tribus@master/workers/worker-pool","github:toji/gl-matrix@2.2.1/src/gl-matrix/vec3.js!github:systemjs/plugin-text@0.0.2"],function(t){function e(t,e){console.time("Calculating normals");for(var n=t.vertices,r=t.indices,i=new Float32Array(n.length),o=new Array(n.length/3),a=new Float32Array(r.length),u=0,s=o.length;s>u;++u)o[u]=[];for(var c=0,s=r.length;s>c;c+=3){var l=r[c],f=r[c+1],p=r[c+2],m=3*l,h=3*f,d=3*p,g=vec3.set(tmp0,n[m],n[m+1],n[m+2]),v=vec3.set(tmp1,n[h],n[h+1],n[h+2]),b=vec3.set(tmp2,n[d],n[d+1],n[d+2]);o[l].push(c),o[f].push(c),o[p].push(c);var y=vec3.cross(tmp0,vec3.subtract(tmp1,v,g),vec3.subtract(tmp2,b,g));a[c]=y[0],a[c+1]=y[1],a[c+2]=y[2]}for(var x=0,w=o.length;w>x;++x){for(var E=vec3.set(tmp0,0,0,0),T=o[x],_=0,A=T.length;A>_;++_){var M=T[_];E[0]+=a[M],E[1]+=a[M+1],E[2]+=a[M+2]}vec3.normalize(E,E);var c=3*x;i[c]=E[0],i[c+1]=E[1],i[c+2]=E[2]}console.timeEnd("Calculating normals"),e({indices:r,vertices:n,normals:i},[r.buffer,n.buffer,i.buffer])}var n,r,i;return{setters:[function(t){n=t["default"]},function(t){r=t["default"]}],execute:function(){"use strict";i=t("workerpool",n.fromFunction(e,["var GLMAT_ARRAY_TYPE = Float32Array;",r,"var tmp0 = vec3.create(), tmp1 = vec3.create(), tmp2 = vec3.create();"]))}}}),t.register("github:maxdavidson/tribus@master/material/base",["github:maxdavidson/tribus@master/extra/errors"],function(t){var e,n,r,i,o,a;return{setters:[function(t){e=t.UnimplementedMethodError}],execute:function(){"use strict";n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=WebGLRenderingContext,i=new Map,o=t("Material",function(){function t(){var e=void 0===arguments[0]?1:arguments[0];n(this,t),this.priority=e}return t.prototype.getRenderer=function(){throw new e},t}()),a=t("MaterialRenderer",function(){function t(e,r){n(this,t),this.material=e,this.program=r}return t.allocateTextureUnit=function(t){var e=i.get(t)||0;return i.set(t,e+1),e},t.prototype.didInitGeometry=function(){},t.prototype.willDraw=function(){},t.prototype.draw=function(){},t.prototype.didDraw=function(){},t}())}}}),t.register("github:maxdavidson/tribus@master/workers/tga",["github:maxdavidson/tribus@master/workers/worker-pool","github:maxdavidson/jsTGALoader@master/tga.js!github:systemjs/plugin-text@0.0.2"],function(t){function e(t,e){var n=new TGA;n.load(new Uint8Array(t));var r=n.getImageData(),i=r.data.buffer;e({buffer:i,height:r.height,width:r.width},[i])}var n,r,i;return{setters:[function(t){n=t["default"]},function(t){r=t["default"]}],execute:function(){"use strict";i=t("workerpool",n.fromFunction(e,[r]))}}}),t.register("github:maxdavidson/tribus@master/camera/perspective-camera",["github:maxdavidson/tribus@master/camera/base","github:toji/gl-matrix@2.2.1"],function(t){var e,n,r,i,o,a;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]}],execute:function(){"use strict";r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=Math.PI/180,a=function(t){function e(){var n=void 0===arguments[0]?{}:arguments[0];i(this,e),t.call(this,n);var r=n.fov,o=void 0===r?60:r,a=n.aspect,u=void 0===a?4/3:a,s=n.near,c=void 0===s?.1:s,l=n.far,f=void 0===l?100:l;this.fov=o,this.aspect=u,this.near=c,this.far=f}return r(e,t),e.prototype.recalculate=function(){n.mat4.perspective(this.projectionMatrix,this.fov*o,this.aspect,this.near,this.far),t.prototype.recalculate.call(this)},e}(e),t("default",a)}}}),function(){function e(){}e.amd={},t.register("github:baconjs/bacon.js@0.7.53",["github:baconjs/bacon.js@0.7.53/dist/Bacon"],!1,function(t){return function(t){return t}.call(this,t("github:baconjs/bacon.js@0.7.53/dist/Bacon"))})}(),t.register("github:maxdavidson/tribus@master/material/skybox",["npm:memoizee@0.3.8","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/material/shaders/skybox.vert!github:systemjs/plugin-text@0.0.2","github:maxdavidson/tribus@master/material/shaders/skybox.frag!github:systemjs/plugin-text@0.0.2"],function(t){var e,n,r,i,o,a,u,s,c,l,f,p,m,h,d,g;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t.Material,i=t.MaterialRenderer},function(t){o=t["default"]},function(t){a=t.construct},function(t){u=t["default"]},function(t){s=t["default"]},function(t){c=t["default"]},function(t){l=t["default"]}],execute:function(){"use strict";f=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},p=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")
},m=n.mat4,h=WebGLRenderingContext,d=function(t){function e(n){p(this,e),t.call(this,1/0),this.cubemap=n}return f(e,t),e.prototype.getRenderer=function(t){return g.create(this,t)},e}(r),t("default",d),g=function(t){function n(e,r){this.cameraMatrix=m.create(),this.locations={},p(this,n),t.call(this,e,n.createProgram(r)),this.unit=t.allocateTextureUnit(r),this.handle=r.createTexture(),r.activeTexture(h.TEXTURE0+this.unit),r.bindTexture(h.TEXTURE_CUBE_MAP,this.handle),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MAG_FILTER,h.LINEAR),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),r.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.cubemap.right),r.texImage2D(h.TEXTURE_CUBE_MAP_NEGATIVE_X,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.cubemap.left),r.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_Y,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.cubemap.top),r.texImage2D(h.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.cubemap.bottom),r.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_Z,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.cubemap.back),r.texImage2D(h.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e.cubemap.front),r.generateMipmap(h.TEXTURE_CUBE_MAP),r.bindTexture(h.TEXTURE_CUBE_MAP,null)}return f(n,t),n.create=e(a(n),{length:2}),n.createProgram=e(function(t){return new u(t,new s(t,c,h.VERTEX_SHADER),new s(t,l,h.FRAGMENT_SHADER))}),n.prototype.didInitGeometry=function(t){var e=this.program,n=this.locations;n.sampler=e.getUniformLocation("skybox"),n.cameraMatrix=e.getUniformLocation("cameraMatrix"),t.vertexBuffer.setAttribLocation("vertex",e)},n.prototype.willDraw=function(){var t=this.program.gl;t.depthMask(!1),t.disable(h.CULL_FACE),t.uniform1i(this.locations.sampler,this.unit),t.activeTexture(h.TEXTURE0+this.unit),t.bindTexture(h.TEXTURE_CUBE_MAP,this.handle)},n.prototype.draw=function(t){var e=this.program.gl,n=this.cameraMatrix;m.copy(n,t.viewMatrix),n[12]=0,n[13]=0,n[14]=0,m.multiply(n,t.projectionMatrix,n),e.uniformMatrix4fv(this.locations.cameraMatrix,!1,n)},n.prototype.didDraw=function(){var t=this.program.gl;t.depthMask(!0),t.enable(h.CULL_FACE)},n}(i)}}}),function(){function e(){}e.amd={},t.register("github:ded/domready@1.0.7",["github:ded/domready@1.0.7/ready"],!1,function(t){return function(t){return t}.call(this,t("github:ded/domready@1.0.7/ready"))})}(),t.register("github:maxdavidson/tribus@master/scene/base",["github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/extra/event-aggregator"],function(t){var e,n,r,i,o,a,u,s,c,l,f,p;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]}],execute:function(){"use strict";r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=e.vec3,a=e.mat3,u=e.mat4,s=e.quat,c=Math.PI/180,l=o.fromValues(0,0,-1),f=o.create(),p=function(t){function e(n){var r=void 0===arguments[1]?{}:arguments[1],c=r.parent,l=void 0===c?null:c,f=r.position,p=void 0===f?[0,0,0]:f,m=r.rotateX,h=void 0===m?0:m,d=r.rotateY,g=void 0===d?0:d,v=r.rotateZ,b=void 0===v?0:v,y=r.scale,x=void 0===y?1:y;i(this,e),t.call(this,l),this.name=n,this.parent=l,this.orientation=s.create(),this.position=o.create(),this.scale=o.fromValues(1,1,1),this.localTransform=u.create(),this.worldTransform=u.create(),this.direction=o.create(),this.normalMatrix=a.create(),this.worldDirection=o.create(),this.worldPosition=o.create(),this.resize(x),this.rotateX(h),this.rotateZ(b),this.rotateY(g),this.translate(p)}return r(e,t),e.prototype.toString=function(){return""+this.constructor.name+"@"+this.name},e.prototype.query=function(t){for(var e=this,n=Array.isArray(e),r=0,e=n?e:e[Symbol.iterator]();;){var i;if(n){if(r>=e.length)break;i=e[r++]}else{if(r=e.next(),r.done)break;i=r.value}var o=i;if(o.name===t)return o}},e.prototype.forEach=function(t){t(this)},e.prototype.recalculate=function(){o.transformQuat(this.direction,l,this.orientation),u.fromRotationTranslation(this.localTransform,this.orientation,this.position),u.scale(this.localTransform,this.localTransform,this.scale),null!==this.parent?(u.multiply(this.worldTransform,this.parent.worldTransform,this.localTransform),o.transformMat3(this.worldDirection,this.direction,this.parent.normalMatrix),o.transformMat4(this.worldPosition,this.position,this.parent.worldTransform)):(u.copy(this.worldTransform,this.localTransform),o.copy(this.worldDirection,this.direction),o.copy(this.worldPosition,this.position)),a.normalFromMat4(this.normalMatrix,this.worldTransform)},e.prototype.resize=function(t){"number"==typeof t?o.scale(this.scale,this.scale,t):o.multiply(this.scale,this.scale,t)},e.prototype.rotateX=function(t){s.rotateX(this.orientation,this.orientation,t*c)},e.prototype.rotateY=function(t){s.rotateY(this.orientation,this.orientation,t*c)},e.prototype.rotateZ=function(t){s.rotateZ(this.orientation,this.orientation,t*c)},e.prototype.lookForward=function(){s.identity(this.orientation)},e.prototype.translate=function(t){o.add(this.position,this.position,t)},e.prototype.translateRelatively=function(t){o.add(this.position,this.position,o.transformQuat(f,t,this.orientation))},e.prototype.getEulerAngles=function(){var t=this.orientation,e=Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),1-2*(t[1]*t[1]+t[2]*t[2])),n=Math.asin(2*(t[0]*t[2]-t[3]*t[1])),r=Math.atan2(2*(t[0]*t[3]+t[1]*t[2]),1-2*(t[2]*t[2]+t[3]*t[3]));return{roll:e,pitch:n,yaw:r}},e}(n),t("default",p),p.prototype[Symbol.iterator]=regeneratorRuntime.mark(function m(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}},m,this)})}}}),t.register("github:jspm/nodelibs-process@0.1.1/index",["npm:process@0.10.1"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=t._nodeRequire?process:require("npm:process@0.10.1"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/number/to-integer",["npm:es5-ext@0.10.6/math/sign/index"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/math/sign/index"),a=Math.abs,u=Math.floor;return n.exports=function(t){return isNaN(t)?0:(t=Number(t),0!==t&&isFinite(t)?o(t)*u(a(t)):t)},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/for-each",["npm:es5-ext@0.10.6/object/_iterate"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/_iterate")("forEach"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/assign/shim",["npm:es5-ext@0.10.6/object/keys/index","npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/keys/index"),a=require("npm:es5-ext@0.10.6/object/valid-value"),u=Math.max;return n.exports=function(t,e){var n,r,i,s=u(arguments.length,2);for(t=Object(a(t)),i=function(r){try{t[r]=e[r]}catch(i){n||(n=i)}},r=1;s>r;++r)e=arguments[r],o(e).forEach(i);if(void 0!==n)throw n;return t},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/string/#/contains",["npm:es5-ext@0.10.6/string/#/contains/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/string/#/contains/index"),r.define=i,n.exports}),t.register("npm:es6-symbol@2.0.1/polyfill",["npm:d@0.1.1","npm:es6-symbol@2.0.1/validate-symbol"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o,a,u=require("npm:d@0.1.1"),s=require("npm:es6-symbol@2.0.1/validate-symbol"),c=Object.create,l=Object.defineProperties,f=Object.defineProperty,p=Object.prototype,m=c(null),h=function(){var t=c(null);return function(e){for(var n,r=0;t[e+(r||"")];)++r;return e+=r||"",t[e]=!0,n="@@"+e,f(p,n,u.gs(null,function(t){f(this,n,u(t))})),n}}();return a=function d(t){if(this instanceof a)throw new TypeError("TypeError: Symbol is not a constructor");return d(t)},n.exports=o=function g(t){var e;if(this instanceof g)throw new TypeError("TypeError: Symbol is not a constructor");return e=c(a.prototype),t=void 0===t?"":String(t),l(e,{__description__:u("",t),__name__:u("",h(t))})},l(o,{"for":u(function(t){return m[t]?m[t]:m[t]=o(String(t))}),keyFor:u(function(t){var e;s(t);for(e in m)if(m[e]===t)return e}),hasInstance:u("",o("hasInstance")),isConcatSpreadable:u("",o("isConcatSpreadable")),iterator:u("",o("iterator")),match:u("",o("match")),replace:u("",o("replace")),search:u("",o("search")),species:u("",o("species")),split:u("",o("split")),toPrimitive:u("",o("toPrimitive")),toStringTag:u("",o("toStringTag")),unscopables:u("",o("unscopables"))}),l(a.prototype,{constructor:u(o),toString:u("",function(){return this.__name__})}),l(o.prototype,{toString:u(function(){return"Symbol ("+s(this).__description__+")"}),valueOf:u(function(){return s(this)})}),f(o.prototype,o.toPrimitive,u("",function(){return s(this)})),f(o.prototype,o.toStringTag,u("c","Symbol")),f(a.prototype,o.toPrimitive,u("c",o.prototype[o.toPrimitive])),f(a.prototype,o.toStringTag,u("c",o.prototype[o.toStringTag])),r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/ext/async",["npm:es5-ext@0.10.6/array/from","npm:es5-ext@0.10.6/object/mixin","npm:es5-ext@0.10.6/function/_define-length","npm:next-tick@0.2.2","npm:memoizee@0.3.8/lib/registered-extensions","github:jspm/nodelibs-process@0.1.1"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,function(){"use strict";var t=require("npm:es5-ext@0.10.6/array/from"),e=require("npm:es5-ext@0.10.6/object/mixin"),n=require("npm:es5-ext@0.10.6/function/_define-length"),r=require("npm:next-tick@0.2.2"),i=Array.prototype.slice,o=Function.prototype.apply,a=Object.create,u=Object.prototype.hasOwnProperty;require("npm:memoizee@0.3.8/lib/registered-extensions").async=function(s,c){var l,f,p,m=a(null),h=a(null),d=c.memoized,g=c.original;c.memoized=n(function(){var t=arguments,e=t[t.length-1];return"function"==typeof e&&(l=e,t=i.call(t,0,-1)),d.apply(f=this,p=t)},d);try{e(c.memoized,d)}catch(v){}c.on("get",function(t){var e,n,i;if(l){if(m[t])return"function"==typeof m[t]?m[t]=[m[t],l]:m[t].push(l),void(l=null);e=l,n=f,i=p,l=f=p=null,r(function(){var r;u.call(h,t)?(r=h[t],c.emit("getasync",t,i,n),o.call(e,r.context,r.args)):(l=e,f=n,p=i,d.apply(n,i))})}}),c.original=function(){var e,n,i,a;return l?(e=t(arguments),n=function u(e){var n,i,s=u.id;return null==s?void r(o.bind(u,this,arguments)):(delete u.id,n=m[s],delete m[s],n?(i=t(arguments),c.has(s)&&(e?c["delete"](s):(h[s]={context:this,args:i},c.emit("setasync",s,"function"==typeof n?1:n.length))),"function"==typeof n?a=o.call(n,this,i):n.forEach(function(t){a=o.call(t,this,i)},this),a):void 0)},i=l,l=f=p=null,e.push(n),a=o.call(g,this,e),n.cb=i,l=n,a):o.call(g,this,arguments)},c.on("set",function(t){return l?(m[t]?"function"==typeof m[t]?m[t]=[m[t],l.cb]:m[t].push(l.cb):m[t]=l.cb,delete l.cb,l.id=t,void(l=null)):void c["delete"](t)}),c.on("delete",function(t){var e;u.call(m,t)||h[t]&&(e=h[t],delete h[t],c.emit("deleteasync",t,e))}),c.on("clear",function(){var t=h;h=a(null),c.emit("clearasync",t)})}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/ext/max-age",["npm:es5-ext@0.10.6/array/from","npm:es5-ext@0.10.6/function/noop","npm:es5-ext@0.10.6/object/for-each","npm:timers-ext@0.1.0/valid-timeout","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/from"),a=require("npm:es5-ext@0.10.6/function/noop"),u=require("npm:es5-ext@0.10.6/object/for-each"),s=require("npm:timers-ext@0.1.0/valid-timeout"),c=require("npm:memoizee@0.3.8/lib/registered-extensions"),l=Math.max,f=Math.min,p=Object.create;return c.maxAge=function(t,e,n){var r,i,m,h;t=s(t),t&&(r=p(null),i=n.async&&c.async?"async":"",e.on("set"+i,function(n){r[n]=setTimeout(function(){e["delete"](n)},t),h&&(h[n]&&clearTimeout(h[n]),h[n]=setTimeout(function(){delete h[n]},m))}),e.on("delete"+i,function(t){clearTimeout(r[t]),delete r[t],h&&(clearTimeout(h[t]),delete h[t])}),n.preFetch&&(m=n.preFetch===!0||isNaN(n.preFetch)?.333:l(f(Number(n.preFetch),1),0),m&&(h={},m=(1-m)*t,e.on("get"+i,function(t,r,i){h[t]||(h[t]=setTimeout(function(){delete h[t],e["delete"](t),n.async&&(r=o(r),r.push(a)),e.memoized.apply(i,r)},0))}))),e.on("clear"+i,function(){u(r,function(t){clearTimeout(t)}),r={},h&&(u(h,function(t){clearTimeout(t)}),h={})}))},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/ext/max",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:lru-queue@0.1.0","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=require("npm:lru-queue@0.1.0"),u=require("npm:memoizee@0.3.8/lib/registered-extensions");return u.max=function(t,e,n){var r,i,s;t=o(t),t&&(i=a(t),r=n.async&&u.async?"async":"",e.on("set"+r,s=function(t){t=i.hit(t),void 0!==t&&e["delete"](t)}),e.on("get"+r,s),e.on("delete"+r,i["delete"]),e.on("clear"+r,i.clear))},r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/webgl/program",["github:maxdavidson/tribus@master/webgl/shader"],function(t){var e,n,r,i,o,a,u;return{setters:[function(t){e=t["default"]}],execute:function(){"use strict";n=function(t,e){var n=Object.create(t.prototype),r=t.apply(n,e);return null==r||"object"!=typeof r&&"function"!=typeof r?n:r},r=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=WebGLRenderingContext,a={35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT"},u=function(){function t(e){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;n>a;a++)r[a-1]=arguments[a];if(i(this,t),this.gl=e,this.handle=e.createProgram(),this.vertexShader=r.filter(function(t){return t.type===o.VERTEX_SHADER})[0]||null,this.fragmentShader=r.filter(function(t){return t.type===o.FRAGMENT_SHADER})[0]||null,this._attribLocationCache=new Map,this._uniformLocationCache=new Map,[this.vertexShader,this.fragmentShader].some(function(t){return null===t}))throw"You need to supply both a vertex and a fragment shader!";e.attachShader(this.handle,this.vertexShader.handle),e.attachShader(this.handle,this.fragmentShader.handle),e.linkProgram(this.handle);var u=this.getInfoLog();""!==u&&console.error(u)}return t.prototype.use=function(){this.gl.useProgram(this.handle)},t.prototype.getUniformLocation=function(t){var e=this._uniformLocationCache.get(t);return void 0===e&&(e=this.gl.getUniformLocation(this.handle,t),null===e&&console.error("Couldn't get uniform location: "+t),this._uniformLocationCache.set(t,e)),e},t.prototype.getAttribLocation=function(t){var e=this._attribLocationCache.get(t);return void 0===e&&(e=this.gl.getAttribLocation(this.handle,t),null===e&&console.error("Couldn't get attribute location: "+t),this._attribLocationCache.set(t,e)),e},t.prototype.getInfoLog=function(){return this.gl.getProgramInfoLog(this.handle)},t.prototype.getActiveUniforms=function(){for(var t=[],e=0;e<this.gl.getProgramParameter(this.handle,o.ACTIVE_UNIFORMS);++e){var n=this.gl.getActiveUniform(this.handle,e);n.typeName=a[n.type],n.value=this.gl.getUniform(this.handle,this.gl.getUniformLocation(this.handle,n.name)),t.push(n)}return t},t.prototype.getActiveAttributes=function(){for(var t=[],e=0;e<this.gl.getProgramParameter(this.handle,o.ACTIVE_ATTRIBUTES);++e){var n=this.gl.getActiveAttrib(this.handle,e);n.typeName=a[n.type],t.push(n)}return t},t.fromShaderPromises=function(e){for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;i>a;a++)o[a-1]=arguments[a];return Promise.all(o).then(function(i){return n(t,[e].concat(r(i)))})},t.fromShaderFiles=function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;r>o;o++)i[o-1]=arguments[o];return t.fromShaderPromises(n,i.map(function(t){return e.fromFile(n,t)}))},t.prototype.setUniform=function(t,e){this.gl.uniform1f(this.getUniformLocation(t),e)},t.prototype.setUniformInt=function(t,e){this.gl.uniform1i(this.getUniformLocation(t),e)},t.prototype.setUniformVector=function(t,e){var n=this.getUniformLocation(t);switch(e.length){case 1:this.gl.uniform1fv(n,e);break;case 2:this.gl.uniform2fv(n,e);break;case 3:this.gl.uniform3fv(n,e);break;case 4:this.gl.uniform4fv(n,e)}},t.prototype.setUniformIntVector=function(t,e){var n=this.getUniformLocation(t);switch(e.length){case 1:this.gl.uniform1iv(n,e);break;case 2:this.gl.uniform2iv(n,e);break;case 3:this.gl.uniform3iv(n,e);break;case 4:this.gl.uniform4iv(n,e)}},t.prototype.setUniformMatrix=function(t,e){var n=void 0===arguments[2]?!1:arguments[2],r=this.getUniformLocation(t);switch(e.length){case 4:this.gl.uniformMatrix2fv(r,n,e);break;case 9:this.gl.uniformMatrix3fv(r,n,e);break;case 16:this.gl.uniformMatrix4fv(r,n,e)}},t}(),t("default",u)}}}),t.register("github:maxdavidson/tribus@master/texture/common",["github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/workers/tga"],function(t){function e(t){var e=void 0===arguments[1]?t.split(".").pop():arguments[1];return function(){return function(){switch(e){case"tga":return r(t);default:return n(t)}}().then(function(t){var e=t.width,n=t.height;if(e!==n||e>1024||!a(e)||!a(n)){var r=document.createElement("canvas");r.width=e,r.height=n,r.getContext("2d").putImageData(t,0,0);var i=document.createElement("canvas"),o=Math.pow(2,Math.min(10,Math.ceil(Math.log(Math.max(e,n))/Math.log(2))));i.width=o,i.height=o;var u=i.getContext("2d");u.drawImage(r,0,0,o,o),t=u.getImageData(0,0,o,o)}return t})}()}function n(t){return new Promise(function(e,n){var r=document.createElement("img"),i=function(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height;var n=t.getContext("2d");n.drawImage(r,0,0);var i=n.getImageData(0,0,r.width,r.height);a(),e(i)},o=function(t){n(t),a()},a=function(){r.removeEventListener("load",i),r.removeEventListener("error",o)};r.addEventListener("error",o,!1),r.addEventListener("load",i,!1),r.src=t})}function r(t){return i(t).then(function(t){return o.run(t,{transfers:[t]})}).then(function(t){var e=t.buffer,n=t.width,r=t.height,i=new Uint8ClampedArray(e),o=void 0;try{o=new ImageData(i,n,r)}catch(a){var u=document.createElement("canvas");u.height=r,u.width=n,o=u.getContext("2d").createImageData(n,r),o.data=i}return o})}var i,o,a;return t("getImage",e),{setters:[function(t){i=t.getArrayBuffer},function(t){o=t.workerpool}],execute:function(){"use strict";a=function(t){return 0!=t&&!(t&t-1)}}}}),t.register("github:maxdavidson/tribus@master/control/mouseview",["github:baconjs/bacon.js@0.7.53","github:toji/gl-matrix@2.2.1"],function(t){var e,n,r,i,o,a,u,s,c;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]}],execute:function(){"use strict";r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],i=t[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=n.vec3,a=n.mat4,u=n.quat,s=function(t){return function(e){return t===e}},c=function(){function t(n,o){function a(t){var e=void 0!==t.movementX?t.movementX:t.mozMovementX,n=void 0!==t.movementY?t.movementY:t.mozMovementY;I.pitch=Math.max(-90,Math.min(90,I.pitch+D*n)),I.yaw+=D*e,I.yaw=I.yaw%360}function u(){document.pointerLockElement===o||document.mozPointerLockElement===o?(console.log("The pointer lock status is now locked"),document.addEventListener("mousemove",a,!1)):(console.log("The pointer lock status is now unlocked"),document.removeEventListener("mousemove",a,!1))}var c=this,l=void 0===arguments[2]?function(){return 0}:arguments[2];i(this,t),this.target=n,this.yaw=0,this.pitch=0,this.roll=0,this.forward=0,this.sideways=0,this.turn=0,this.getHeight=l;var f=["keydown","keyup"].map(function(t){return e.fromEventTarget(document.body,t).map(function(t){return t.keyCode})}),p=r(f,2),m=p[0],h=p[1],d=function(t){return e.mergeAll(m.filter(s(t)).map(function(){return!0}),h.filter(s(t)).map(function(){return!1})).skipDuplicates().toProperty(!1)},g="WASDQE".split("").map(function(t){return t.charCodeAt(0)}).map(d),v=r(g,6),b=v[0],y=v[1],x=v[2],w=v[3],E=v[4],T=v[5],_=[[w,y],[x,b],[E,T]].map(function(t){var n=r(t,2),i=n[0],o=n[1];return e.combineWith(function(t,e){return t+e},i.map(function(t){return+t}),o.map(function(t){return-t}))}),A=r(_,3),M=A[0],S=A[1],R=A[2];M.onValue(function(t){c.sideways=t}),S.onValue(function(t){c.forward=t}),R.onValue(function(t){c.turn=t}),m.filter(s("F".charCodeAt(0))).onValue(function(){o.requestFullscreen?o.requestFullscreen():o.msRequestFullscreen?o.msRequestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.webkitRequestFullscreen&&o.webkitRequestFullscreen()}),o.requestPointerLock=o.requestPointerLock||o.mozRequestPointerLock,o.addEventListener("click",function(){o.requestPointerLock()},!1);var D=.1,I=this;document.addEventListener("pointerlockchange",u,!1),document.addEventListener("mozpointerlockchange",u,!1),n.on("tick",this.tick.bind(this))}return t.prototype.tick=function(t){var e=this.target;e.lookForward(),e.rotateY(-this.yaw),e.translateRelatively(o.fromValues(t/200*this.sideways,0,t/200*this.forward)),e.rotateX(-this.pitch),e.rotateZ(-this.roll)},t}(),t("default",c)}}}),t.register("github:maxdavidson/tribus@master/extra/helpers",["github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/scene/group","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/phong","github:maxdavidson/tribus@master/material/skybox","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/geometry/shapes"],function(t){function e(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var i=w.fromFiles.apply(w,e).then(function(t){return new y(t)});return p("skybox",{},r(),i)}function n(t){return x.fromFile(t).then(function(t){return new E({heightmap:t})}).then(function(t){return t.generateNormals()})}function r(){return new T}function i(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return A(E,e)}function o(){var t=void 0===arguments[0]?{}:arguments[0];return new g(t)}function a(){var t=void 0===arguments[0]?{}:arguments[0];return new PointLight(t)}function u(){var t=void 0===arguments[0]?{}:arguments[0];return new SpotLight(t)}function s(t){return v.fromFile(t)}function c(t){return x.fromFile(t)}function l(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return w.fromFiles.apply(w,e)}function f(){var t=void 0===arguments[0]?{}:arguments[0];return Promise.all(Object.keys(t).map(function(e){return Promise.resolve(t[e]).then(function(t){return function(){var n={};return n[e]=t,n}()})})).then(function(t){return Object.assign.apply(Object,[{}].concat(_(t)))}).then(function(t){return new b(t)})}function p(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return A(h,e)}function m(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return A(d,e)}var h,d,g,v,b,y,x,w,E,T,_,A;return t("skybox",e),t("terrain",n),t("cube",r),t("plane",i),t("camera",o),t("pointlight",a),t("spotlight",u),t("geometry",s),t("texture2d",c),t("cubemap",l),t("phong",f),t("model",p),t("group",m),{setters:[function(t){h=t["default"]},function(t){d=t["default"]},function(t){g=t["default"]},function(t){v=t["default"]},function(t){b=t["default"]},function(t){y=t["default"]},function(t){x=t["default"]},function(t){w=t["default"]},function(t){E=t.Plane,T=t.Cube}],execute:function(){"use strict";_=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},A=function(t,e){var n=Object.create(t.prototype),r=t.apply(n,e);return null==r||"object"!=typeof r&&"function"!=typeof r?n:r}}}}),t.register("github:jspm/nodelibs-process@0.1.1",["github:jspm/nodelibs-process@0.1.1/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("github:jspm/nodelibs-process@0.1.1/index"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/number/to-pos-integer",["npm:es5-ext@0.10.6/number/to-integer"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-integer"),a=Math.max;return n.exports=function(t){return a(0,o(t))},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/object/assign/index",["npm:es5-ext@0.10.6/object/assign/is-implemented","npm:es5-ext@0.10.6/object/assign/shim"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/assign/is-implemented")()?Object.assign:require("npm:es5-ext@0.10.6/object/assign/shim"),r.define=i,n.exports}),t.register("npm:d@0.1.1/index",["npm:es5-ext@0.10.6/object/assign","npm:es5-ext@0.10.6/object/normalize-options","npm:es5-ext@0.10.6/object/is-callable","npm:es5-ext@0.10.6/string/#/contains"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o,a=require("npm:es5-ext@0.10.6/object/assign"),u=require("npm:es5-ext@0.10.6/object/normalize-options"),s=require("npm:es5-ext@0.10.6/object/is-callable"),c=require("npm:es5-ext@0.10.6/string/#/contains");return o=n.exports=function(t,e){var n,r,i,o,s;return arguments.length<2||"string"!=typeof t?(o=e,e=t,t=null):o=arguments[2],null==t?(n=i=!0,r=!1):(n=c.call(t,"c"),r=c.call(t,"e"),i=c.call(t,"w")),s={value:e,configurable:n,enumerable:r,writable:i},o?a(u(o),s):s},o.gs=function(t,e,n){var r,i,o,l;return"string"!=typeof t?(o=n,n=e,e=t,t=null):o=arguments[3],null==e?e=void 0:s(e)?null==n?n=void 0:s(n)||(o=n,n=void 0):(o=e,e=n=void 0),null==t?(r=!0,i=!1):(r=c.call(t,"c"),i=c.call(t,"e")),l={get:e,set:n,configurable:r,enumerable:i},o?a(u(o),l):l},r.define=i,n.exports}),t.register("npm:es6-symbol@2.0.1/index",["npm:es6-symbol@2.0.1/is-implemented","npm:es6-symbol@2.0.1/polyfill"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es6-symbol@2.0.1/is-implemented")()?Symbol:require("npm:es6-symbol@2.0.1/polyfill"),r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/texture/texture2d",["github:maxdavidson/tribus@master/texture/common"],function(t){var e,n,r,i;return{setters:[function(t){e=t.getImage}],execute:function(){"use strict";n=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(e){r(this,t),this.imageData=e}return t.fromFile=function(n,r){return e(n,r).then(function(e){return new t(e)})},n(t,null,{width:{get:function(){return this.imageData.width},configurable:!0},height:{get:function(){return this.imageData.height},configurable:!0}}),t}(),t("default",i)}}}),t.register("npm:es5-ext@0.10.6/object/normalize-options",["github:jspm/nodelibs-process@0.1.1"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,function(t){"use strict";var e=Array.prototype.forEach,r=Object.create,t=function(t,e){var n;for(n in t)e[n]=t[n]};n.exports=function(){var n=r(null);return e.call(arguments,function(e){null!=e&&t(Object(e),n)}),n}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/lib/resolve-length",["npm:es5-ext@0.10.6/number/to-pos-integer"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer");return n.exports=function(t,e,n){var r;return isNaN(t)?(r=e,r>=0?n&&r?r-1:r:1):t===!1?!1:o(t)},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/error/custom",["npm:es5-ext@0.10.6/object/assign/index"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/assign/index"),a=Error.captureStackTrace;return e=n.exports=function(t){var n=new Error,r=arguments[1],i=arguments[2];return null==i&&r&&"object"==typeof r&&(i=r,r=null),null!=i&&o(n,i),n.message=String(t),null!=r&&(n.code=String(r)),a&&a(n,e),n},r.define=i,n.exports}),t.register("npm:d@0.1.1",["npm:d@0.1.1/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:d@0.1.1/index"),r.define=i,n.exports}),t.register("npm:es6-symbol@2.0.1",["npm:es6-symbol@2.0.1/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es6-symbol@2.0.1/index"),r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/material/phong",["github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/material/shaders/phong.vert.dot!github:maxdavidson/tribus@master/plugins/dot","github:maxdavidson/tribus@master/material/shaders/phong.frag.dot!github:maxdavidson/tribus@master/plugins/dot"],function(t){var e,n,r,i,o,a,u,s,c,l,f,p,m,h,d,g,v,b,y,x,w,E,T,_,A,M;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t.Material,i=t.MaterialRenderer},function(t){o=t["default"]},function(t){a=t.construct,u=t.delegate},function(t){s=t["default"]},function(t){c=t["default"]},function(t){l=t["default"]},function(t){f=t["default"]}],execute:function(){"use strict";p=function(t,e,n){e&&Object.defineProperties(t,e),n&&Object.defineProperties(t.prototype,n)},m=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},h=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},d=e.vec3,g=e.vec4,v=e.mat3,b=e.mat4,y=WebGLRenderingContext,x=function(t){function e(){var n=void 0===arguments[0]?{}:arguments[0],r=n.shininess,i=void 0===r?40:r,o=n.ambient,a=void 0===o?0:o,u=n.diffuse,s=void 0===u?.5:u,c=n.specular,l=void 0===c?s:c;h(this,e),t.call(this),this.shininess=i,this.ambient=a,this.diffuse=s,this.specular=l}return m(e,t),e.prototype.getRenderer=function(t){return w.create(this,t)},e.getSourceType=function(t){switch(t.constructor){case Number:case Array:case Float32Array:return"static";case o:return"texture";default:console.error("Incompatible material source color type")}},p(e,null,{config:{get:function(){return{ambient:e.getSourceType(this.ambient),diffuse:e.getSourceType(this.diffuse),specular:e.getSourceType(this.specular)}},configurable:!0}}),e}(r),t("default",x),w=function(t){function e(n,r){this.locations=null,h(this,e),t.call(this,n,e.createProgram(r,JSON.stringify(n.config),n.config)),this.ambientStrategy=E.select("ambient",n.ambient,this.program),this.diffuseStrategy=E.select("diffuse",n.diffuse,this.program),this.specularStrategy=E.select("specular",n.specular,this.program)}return m(e,t),e.create=n(a(e),{length:2}),e.createProgram=n(function(t,e,n){return new s(t,new c(t,l(n),y.VERTEX_SHADER),new c(t,f(n),y.FRAGMENT_SHADER))
},{length:2}),e.prototype.didInitGeometry=function(t){var e=t.vertexBuffer,n=t.normalBuffer,r=t.texcoordBuffer;e.setAttribLocation("vertex",this.program),n.setAttribLocation("normal",this.program),this.locations=Object.freeze({mvpMatrix:this.program.getUniformLocation("mvpMatrix"),modelMatrix:this.program.getUniformLocation("modelMatrix"),normalMatrix:this.program.getUniformLocation("normalMatrix"),viewPos:this.program.getUniformLocation("viewPos"),shininess:this.program.getUniformLocation("material.shininess")}),this.ambientStrategy.init(r),this.diffuseStrategy.init(r),this.specularStrategy.init(r)},e.prototype.willDraw=function(t,e){for(var n=this.program.gl,r=this.locations,i=0,o=e.length;o>i;++i)e[i].render(this.program);n.uniform3fv(r.viewPos,t.worldPosition),n.uniform1f(r.shininess,this.material.shininess),this.ambientStrategy.update(),this.diffuseStrategy.update(),this.specularStrategy.update()},e.prototype.draw=function(t,e){var n=this.program.gl,r=this.locations;n.uniformMatrix4fv(r.mvpMatrix,!1,t.calculateMvpMatrix(e)),n.uniformMatrix4fv(r.modelMatrix,!1,e.worldTransform),n.uniformMatrix3fv(r.normalMatrix,!1,e.normalMatrix)},e}(i),E=function(){function t(e,n,r){this.locations={},h(this,t),this.target=e,this.source=n,this.program=r}return t.prototype.init=function(){},t.prototype.update=function(){},t.select=u(function(t,e){switch(x.getSourceType(e)){case"static":return T.create;case"texture":return _.create}}),t}(),T=function(t){function e(n,r,i){h(this,e),t.call(this,n,r,i),this.color="number"==typeof r?d.fromValues(r,r,r):d.clone(r)}return m(e,t),e.create=n(a(e),{length:3}),e.prototype.init=function(){this.locations.target=this.program.getUniformLocation("material."+this.target)},e.prototype.update=function(){this.program.gl.uniform3fv(this.locations.target,this.color)},e}(E),_=function(t){function e(n,r,i){h(this,e),t.call(this,n,r,i);var o=e.getConfig(i.gl),a=o.unit,u=o.handle,s=o.insert;this.unit=a,this.handle=u,s(this)}return m(e,t),e.getConfig=n(function(t){var e=new A,n=new Map,r=i.allocateTextureUnit(t),o=t.createTexture(),a=void 0,u=function(){var t=document.createElement("canvas"),n=Math.pow(2,e.size);t.height=n,t.width=n,a=t.getContext("2d")};u();var s=function(t){for(var r=Math.pow(2,e.size),i=g.fromValues(t.left/r,(t.top+t.innerHeight)/r,t.innerWidth/r,-(t.innerHeight/r)),o=n.get(t.image),a=Array.isArray(o),u=0,o=a?o:o[Symbol.iterator]();;){var s;if(a){if(u>=o.length)break;s=o[u++]}else{if(u=o.next(),u.done)break;s=u.value}var c=s;c.texcoordBounds=i}};return{unit:r,handle:o,insert:function(i){var c=i.source,l=n.get(c.imageData);void 0===l&&(l=new Set,n.set(c.imageData,l)),l.add(i),t.activeTexture(y.TEXTURE0+r),t.bindTexture(y.TEXTURE_2D,o);var f=e.insert(c.imageData);if(1===f.length&&f[0].outerWidth<Math.pow(2,e.size)){var p=f[0];s(p),a.putImageData(p.image,p.left,p.top),t.texSubImage2D(y.TEXTURE_2D,0,p.left,p.top,y.RGBA,y.UNSIGNED_BYTE,p.image),t.generateMipmap(y.TEXTURE_2D)}else{u();for(var m=f,h=Array.isArray(m),d=0,m=h?m:m[Symbol.iterator]();;){var g;if(h){if(d>=m.length)break;g=m[d++]}else{if(d=m.next(),d.done)break;g=d.value}var v=g;s(v),a.putImageData(v.image,v.left,v.top)}t.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,a.canvas),t.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR),t.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),t.generateMipmap(y.TEXTURE_2D)}}}}),e.create=n(a(e),{length:3}),e.prototype.init=function(t){t.setAttribLocation("texcoord",this.program),this.locations.sampler=this.program.getUniformLocation(""+this.target+"Sampler"),this.locations.bounds=this.program.getUniformLocation(""+this.target+"TexcoordBounds")},e.prototype.update=function(){var t=this.program.gl;t.uniform1i(this.locations.sampler,this.unit),t.uniform4fv(this.locations.bounds,this.texcoordBounds),t.activeTexture(y.TEXTURE0+this.unit),t.bindTexture(y.TEXTURE_2D,this.handle)},e}(E),A=function(){function t(){this.region=null,this.size=0,h(this,t),this.reset()}return t.prototype.reset=function(){var t=void 0===arguments[0]?this.size:arguments[0];this.size=t;var e=Math.pow(2,this.size);this.region=new M(0,0,e,e)},t.prototype.insert=function(t){var e=function(t){return Math.max(t.height,t.width)},n=this.region.insert(t);if(void 0!==n)return[n];var r=function(t){return function(e,n){return t(e)-t(n)}},i=function(t){return function(e,n){return t(n,e)}},o=new Set(this.region.images());o.add(t);var a=Array.from(o).sort(i(r(e)));this.reset();var u=void 0,s=void 0;do{u=!0,s=[];for(var c=a,l=Array.isArray(c),f=0,c=l?c:c[Symbol.iterator]();;){var p;if(l){if(f>=c.length)break;p=c[f++]}else{if(f=c.next(),f.done)break;p=f.value}var m=p,h=this.region.insert(m);if(void 0===h){this.reset(this.size+1),u=!1,!l&&c["return"]&&c["return"]();break}s.push(h)}}while(!u);return s},t}(),M=function(){function t(){var e=void 0===arguments[0]?0:arguments[0],n=void 0===arguments[1]?0:arguments[1],r=void 0===arguments[2]?0:arguments[2],i=void 0===arguments[3]?0:arguments[3];this.rightRegion=null,this.downRegion=null,this.image=null,h(this,t),this.left=e,this.top=n,this.right=r,this.bottom=i}return t.prototype.toString=function(){return""+this.constructor.name+"("+this.left+", "+this.top+", "+this.right+", "+this.bottom+")"},t.prototype.images=regeneratorRuntime.mark(function e(){var t,n,r,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();case 1:if(!n){e.next=7;break}if(!(r>=t.length)){e.next=4;break}return e.abrupt("break",16);case 4:i=t[r++],e.next=11;break;case 7:if(r=t.next(),!r.done){e.next=10;break}return e.abrupt("break",16);case 10:i=r.value;case 11:return o=i,e.next=14,o.image;case 14:e.next=1;break;case 16:case"end":return e.stop()}},e,this)}),t.prototype.insert=function(e){if(this.isFilled)return this.downRegion.insert(e)||this.rightRegion.insert(e);if(e.height>this.outerHeight||e.width>this.outerWidth)return void 0;this.image=e;var n=this.outerWidth-this.innerWidth,r=this.outerHeight-this.innerHeight;return n>r?(this.downRegion=new t(this.left,this.top+this.innerHeight,this.right,this.bottom),this.rightRegion=new t(this.left+this.innerWidth,this.top,this.right,this.top+this.innerHeight)):(this.downRegion=new t(this.left,this.top+this.innerHeight,this.left+this.innerWidth,this.bottom),this.rightRegion=new t(this.left+this.innerWidth,this.top,this.right,this.bottom)),this},p(t,null,{outerWidth:{get:function(){return this.right-this.left},configurable:!0},outerHeight:{get:function(){return this.bottom-this.top},configurable:!0},innerWidth:{get:function(){return this.image.width},configurable:!0},innerHeight:{get:function(){return this.image.height},configurable:!0},isFilled:{get:function(){return null!==this.image},configurable:!0}}),t}(),M.prototype[Symbol.iterator]=regeneratorRuntime.mark(function S(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isFilled){e.next=5;break}return e.next=3,t;case 3:return e.delegateYield(t.downRegion,"t1",4);case 4:return e.delegateYield(t.rightRegion,"t2",5);case 5:case"end":return e.stop()}},S,this)})}}}),t.register("npm:es5-ext@0.10.6/array/from/shim",["npm:es6-symbol@2.0.1","npm:es5-ext@0.10.6/function/is-arguments","npm:es5-ext@0.10.6/function/is-function","npm:es5-ext@0.10.6/number/to-pos-integer","npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/valid-value","npm:es5-ext@0.10.6/string/is-string"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es6-symbol@2.0.1").iterator,a=require("npm:es5-ext@0.10.6/function/is-arguments"),u=require("npm:es5-ext@0.10.6/function/is-function"),s=require("npm:es5-ext@0.10.6/number/to-pos-integer"),c=require("npm:es5-ext@0.10.6/object/valid-callable"),l=require("npm:es5-ext@0.10.6/object/valid-value"),f=require("npm:es5-ext@0.10.6/string/is-string"),p=Array.isArray,m=Function.prototype.call,h={configurable:!0,enumerable:!0,writable:!0,value:null},d=Object.defineProperty;return n.exports=function(t){var e,n,r,i,g,v,b,y,x,w,E=arguments[1],T=arguments[2];if(t=Object(l(t)),null!=E&&c(E),this&&this!==Array&&u(this))e=this;else{if(!E){if(a(t))return g=t.length,1!==g?Array.apply(null,t):(i=new Array(1),i[0]=t[0],i);if(p(t)){for(i=new Array(g=t.length),n=0;g>n;++n)i[n]=t[n];return i}}i=[]}if(!p(t))if(void 0!==(x=t[o])){for(b=c(x).call(t),e&&(i=new e),y=b.next(),n=0;!y.done;)w=E?m.call(E,T,y.value,n):y.value,e?(h.value=w,d(i,n,h)):i[n]=w,y=b.next(),++n;g=n}else if(f(t)){for(g=t.length,e&&(i=new e),n=0,r=0;g>n;++n)w=t[n],g>n+1&&(v=w.charCodeAt(0),v>=55296&&56319>=v&&(w+=t[++n])),w=E?m.call(E,T,w,r):w,e?(h.value=w,d(i,r,h)):i[r]=w,++r;g=r}if(void 0===g)for(g=s(t.length),e&&(i=new e(g)),n=0;g>n;++n)w=E?m.call(E,T,t[n],n):t[n],e?(h.value=w,d(i,n,h)):i[n]=w;return e&&(h.value=null,i.length=g),i},r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/array/from/index",["npm:es5-ext@0.10.6/array/from/is-implemented","npm:es5-ext@0.10.6/array/from/shim"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/array/from/is-implemented")()?Array.from:require("npm:es5-ext@0.10.6/array/from/shim"),r.define=i,n.exports}),t.register("npm:es5-ext@0.10.6/array/to-array",["npm:es5-ext@0.10.6/array/from/index"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/from/index"),a=Array.isArray;return n.exports=function(t){return a(t)?t:o(t)},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/lib/resolve-resolve",["npm:es5-ext@0.10.6/array/to-array","npm:es5-ext@0.10.6/object/valid-callable"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o,a=require("npm:es5-ext@0.10.6/array/to-array"),u=require("npm:es5-ext@0.10.6/object/valid-callable"),s=Array.prototype.slice;return o=function(t){return this.map(function(e,n){return e?e(t[n]):t[n]}).concat(s.call(t,this.length))},n.exports=function(t){return t=a(t),t.forEach(function(t){null!=t&&u(t)}),o.bind(t)},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/lib/configure-map",["npm:es5-ext@0.10.6/error/custom","npm:es5-ext@0.10.6/function/_define-length","npm:d@0.1.1","npm:event-emitter@0.3.3","npm:memoizee@0.3.8/lib/resolve-resolve","npm:memoizee@0.3.8/lib/resolve-normalize"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/error/custom"),a=require("npm:es5-ext@0.10.6/function/_define-length"),u=require("npm:d@0.1.1"),s=require("npm:event-emitter@0.3.3").methods,c=require("npm:memoizee@0.3.8/lib/resolve-resolve"),l=require("npm:memoizee@0.3.8/lib/resolve-normalize"),f=Function.prototype.apply,p=Function.prototype.call,m=Object.create,h=Object.prototype.hasOwnProperty,d=Object.defineProperties,g=s.on,v=s.emit;return n.exports=function(t,e,n){var r,i,s,b,y,x,w,E,T,_,A,M,S,R=m(null);return i=e!==!1?e:isNaN(t.length)?1:t.length,n.normalizer&&(E=l(n.normalizer),s=E.get,b=E.set,y=E["delete"],x=E.clear),null!=n.resolvers&&(S=c(n.resolvers)),M=s?a(function(e){var n,i,a=arguments;if(S&&(a=S(a)),n=s(a),null!==n&&h.call(R,n))return T&&r.emit("get",n,a,this),R[n];if(i=1===a.length?p.call(t,this,e):f.call(t,this,a),null===n){if(n=s(a),null!==n)throw o("Circular invocation","CIRCULAR_INVOCATION");n=b(a)}else if(h.call(R,n))throw o("Circular invocation","CIRCULAR_INVOCATION");return R[n]=i,_&&r.emit("set",n),i},i):0===e?function(){var e;if(h.call(R,"data"))return T&&r.emit("get","data",arguments,this),R.data;if(e=arguments.length?f.call(t,this,arguments):p.call(t,this),h.call(R,"data"))throw o("Circular invocation","CIRCULAR_INVOCATION");return R.data=e,_&&r.emit("set","data"),e}:function(){var e,n,i=arguments;if(S&&(i=S(arguments)),n=String(i[0]),h.call(R,n))return T&&r.emit("get",n,i,this),R[n];if(e=1===i.length?p.call(t,this,i[0]):f.call(t,this,i),h.call(R,n))throw o("Circular invocation","CIRCULAR_INVOCATION");return R[n]=e,_&&r.emit("set",n),e},r={original:t,memoized:M,get:function(t){return S&&(t=S(t)),s?s(t):String(t[0])},has:function(t){return h.call(R,t)},"delete":function(t){var e;h.call(R,t)&&(y&&y(t),e=R[t],delete R[t],A&&r.emit("delete",t,e))},clear:function(){var t=R;x&&x(),R=m(null),r.emit("clear",t)},on:function(t,e){return"get"===t?T=!0:"set"===t?_=!0:"delete"===t&&(A=!0),g.call(this,t,e)},emit:v,updateEnv:function(){t=r.original}},w=s?a(function(){var t,e=arguments;S&&(e=S(e)),t=s(e),null!==t&&r["delete"](t)},i):0===e?function(){return r["delete"]("data")}:function(t){return S&&(t=S(arguments)[0]),r["delete"](t)},d(M,{__memoized__:u(!0),"delete":u(w),clear:u(r.clear)}),r},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/plain",["npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/for-each","npm:memoizee@0.3.8/lib/registered-extensions","npm:memoizee@0.3.8/lib/configure-map","npm:memoizee@0.3.8/lib/resolve-length"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-callable"),a=require("npm:es5-ext@0.10.6/object/for-each"),u=require("npm:memoizee@0.3.8/lib/registered-extensions"),s=require("npm:memoizee@0.3.8/lib/configure-map"),c=require("npm:memoizee@0.3.8/lib/resolve-length"),l=Object.prototype.hasOwnProperty;return n.exports=function f(t){var e,n,r;return o(t),e=Object(arguments[1]),l.call(t,"__memoized__")&&!e.force?t:(n=c(e.length,t.length,e.async&&u.async),r=s(t,n,e),a(u,function(t,n){e[n]&&t(e[n],r,e)}),f.__profiler__&&f.__profiler__(r),r.updateEnv(),r.memoized)},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8/index",["npm:es5-ext@0.10.6/object/normalize-options","npm:memoizee@0.3.8/lib/resolve-length","npm:memoizee@0.3.8/plain","npm:memoizee@0.3.8/normalizers/primitive","npm:memoizee@0.3.8/normalizers/get-primitive-fixed","npm:memoizee@0.3.8/normalizers/get","npm:memoizee@0.3.8/normalizers/get-1","npm:memoizee@0.3.8/normalizers/get-fixed","npm:memoizee@0.3.8/ext/async","npm:memoizee@0.3.8/ext/dispose","npm:memoizee@0.3.8/ext/max-age","npm:memoizee@0.3.8/ext/max","npm:memoizee@0.3.8/ext/ref-counter"],!0,function(require,e,n){var r=t.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/normalize-options"),a=require("npm:memoizee@0.3.8/lib/resolve-length"),u=require("npm:memoizee@0.3.8/plain");return n.exports=function(t){var e,n=o(arguments[1]);return n.normalizer||(e=n.length=a(n.length,t.length,n.async),0!==e&&(n.primitive?e===!1?n.normalizer=require("npm:memoizee@0.3.8/normalizers/primitive"):e>1&&(n.normalizer=require("npm:memoizee@0.3.8/normalizers/get-primitive-fixed")(e)):n.normalizer=e===!1?require("npm:memoizee@0.3.8/normalizers/get")():1===e?require("npm:memoizee@0.3.8/normalizers/get-1")():require("npm:memoizee@0.3.8/normalizers/get-fixed")(e))),n.async&&require("npm:memoizee@0.3.8/ext/async"),n.dispose&&require("npm:memoizee@0.3.8/ext/dispose"),n.maxAge&&require("npm:memoizee@0.3.8/ext/max-age"),n.max&&require("npm:memoizee@0.3.8/ext/max"),n.refCounter&&require("npm:memoizee@0.3.8/ext/ref-counter"),u(t,n)},r.define=i,n.exports}),t.register("npm:memoizee@0.3.8",["npm:memoizee@0.3.8/index"],!0,function(require,e,n){var r=t.global,i=r.define;return r.define=void 0,n.exports=require("npm:memoizee@0.3.8/index"),r.define=i,n.exports}),t.register("github:maxdavidson/tribus@master/geometry/geometry",["npm:memoizee@0.3.8","github:maxdavidson/tribus@master/webgl/buffer","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/workers/wavefront","github:maxdavidson/tribus@master/workers/normal-vectors"],function(t){var e,n,r,i,o,a,u,s,c,l,f;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t["default"]},function(t){i=t.construct},function(t){o=t.getArrayBuffer},function(t){a=t.workerpool},function(t){u=t.workerpool}],execute:function(){"use strict";s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=WebGLRenderingContext,l=function(){function t(){var e=void 0===arguments[0]?{}:arguments[0],n=e.vertices,r=e.indices,i=e.texcoords,o=e.normals,a=void 0===o?new Float32Array(n.length):o;s(this,t);var u=function(t,e){return t instanceof e?t:new e(t)};this.vertices=u(n,Float32Array),this.indices=u(r,Uint16Array),this.normals=u(a,Float32Array),this.texcoords=u(i,Float32Array)}return t.fromFile=function(e){var n=e.split(".").pop();switch(n){case"obj":return o(e).then(function(t){return a.run(t,{transfers:[t]})}).then(function(e){return new t(e)}).then(function(t){return 0===t.normals.length?t.generateNormals():t});default:throw new Error('Unsupported geometry file extension: ".'+n+'"')}},t.prototype.generateNormals=function(){var t=this;return u.run({vertices:this.vertices,indices:this.indices},{transfers:[this.vertices.buffer,this.indices.buffer]}).then(function(e){var n=e.vertices,r=e.indices,i=e.normals;return t.vertices=n,t.indices=r,t.normals=i,t})},t.prototype.getRenderer=function(t){return f.create(this,t)},t}(),t("default",l),f=t("GeometryRenderer",function(){function t(e,r){s(this,t),this.gl=r,this.geometry=e,this.vaoExtension=r.getExtension("OES_vertex_array_object"),this.vao=this.vaoExtension.createVertexArrayOES(),this.vertexBuffer=new n(r,e.vertices,this.vao),this.normalBuffer=new n(r,e.normals,this.vao),this.texcoordBuffer=new n(r,e.texcoords,this.vao,{size:2}),this.indexBuffer=new n(r,e.indices,this.vao,{bufferType:c.ELEMENT_ARRAY_BUFFER})}return t.create=e(i(t),{length:2}),t.prototype.draw=function(){var t=this.vaoExtension;t.bindVertexArrayOES(this.vao),this.gl.drawElements(c.TRIANGLES,this.indexBuffer.data.length,c.UNSIGNED_SHORT,0),t.bindVertexArrayOES(null)},t}())}}}),t.register("github:maxdavidson/tribus@master/scene/model",["github:maxdavidson/tribus@master/scene/base","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/material/phong"],function(t){var e,n,r,i,o,a,u;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t.Material},function(t){i=t["default"]}],execute:function(){"use strict";o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=function(t){function e(o,u,s){var c=this,l=void 0===arguments[3]?new i:arguments[3];this.material=null,this.geometry=null,a(this,e),t.call(this,o,u),s instanceof n&&(this.geometry=s),l instanceof r&&(this.material=l),this.onGeometryLoaded=Promise.resolve(s).then(function(t){return c.geometry=t}),this.onMaterialLoaded=Promise.resolve(l).then(function(t){return c.material=t})}return o(e,t),e}(e),t("default",u)}}}),t.register("github:maxdavidson/tribus@master/renderer",["github:maxdavidson/tribus@master/extra/webgl-debug","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/light/base"],function(t){function e(t,e,n,r,i){for(var o=!0;o;){o=!1;var a=t,u=e,s=n,c=r,l=i;f=void 0,c=c||0,l=l||u.length;var f=Math.floor(c+(l-c)/2);if(u[f]===a)return f;if(1>=l-c)return u[f]>a?f-1:f;s(u[f],a)<0?(t=a,e=u,n=s,r=f,i=l,o=!0):(t=a,e=u,n=s,r=c,i=f,o=!0)}}function n(t,n,r){return n.splice(e(t,n,r)+1,0,t),n}function r(t){return i.makeDebugContext(t,function(t,e){console.error(""+i.glEnumToString(t)+" was caused by call to: "+e)},function(t,e){console.log("gl."+t+"("+i.glFunctionArgsToString(t,e)+")");for(var n=e,r=Array.isArray(n),o=0,n=r?n:n[Symbol.iterator]();;){var a;if(r){if(o>=n.length)break;a=n[o++]}else{if(o=n.next(),o.done)break;a=o.value}var u=a;void 0===u&&console.error("undefined passed to gl."+t+"("+i.glFunctionArgsToString(t,e)+")")}})}var i,o,a,u,s,c,l;return{setters:[function(t){i=t["default"]},function(t){o=t["default"]},function(t){a=t.Light}],execute:function(){"use strict";u=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],i=t[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=WebGLRenderingContext,l=function(){function t(e,n,i){var o=this,a=void 0===arguments[3]?{}:arguments[3],u=a.debug,l=void 0===u?!1:u;this._lightRenderers=[],this._materialRenderers=new WeakMap,this._geometryRenderers=new WeakMap,this._materialsUsingGeometry=new WeakMap,this._modelsBeingProcessed=new WeakMap,this._activeModels=[],s(this,t),this.scene=e,this.camera=n,i.width=i.clientWidth,i.height=i.clientHeight;var f=i.getContext("webgl")||i.getContext("experimental-webgl");if(void 0===f)throw"Your browser does not seem to support WebGL! Too bad!";l&&(f=r(f)),n.aspect=i.clientWidth/i.clientHeight,window.addEventListener("resize",function(){i.width=i.clientWidth,i.height=i.clientHeight,f.viewport(0,0,i.clientWidth,i.clientHeight),n.aspect=i.clientWidth/i.clientHeight}),this.gl=f;var p=function(t){return t.thenBy=function(e){return p(function(n,r){return t(n,r)||e(n,r)})},t},m=function(t){var e=void 0===arguments[1]?function(t,e){return e-t}:arguments[1];return function(n,r){return e(t(n),t(r))}},h=function(t,e){return t===e?0:-1};this._modelComparator=p(m(function(t){return o._materialRenderers.get(t).material.priority}),function(t,e){return t-e}).thenBy(m(function(t){return o._materialRenderers.get(t).program},h)).thenBy(m(function(t){return t.material},h));var d=this._processNode.bind(this);this.scene.forEach(d),e.on("didAddNode",d),f.clearColor(0,0,0,1),f.enable(c.DEPTH_TEST),f.enable(c.CULL_FACE),f.cullFace(c.BACK)}return t.prototype.start=function(){var t=this,e=void 0===arguments[0]?0:arguments[0];this.isRunning=!0,window.requestAnimationFrame(function(n){t.isRunning&&(t.render(n-e,n),t.start(n))})},t.prototype.stop=function(){this.isRunning=!1},t.prototype._processNode=function(t){t instanceof o?this._processModel(t):t instanceof a&&this._lightRenderers.push(t.getRenderer(this.gl))},t.prototype._processModel=function(t){var e=this,r=this._modelsBeingProcessed.get(t);return void 0===r&&(r=Promise.all([t.onGeometryLoaded,t.onMaterialLoaded]).then(function(r){var i=u(r,2),o=i[0],a=i[1],s=o.getRenderer(e.gl),c=a.getRenderer(e.gl);return e._geometryRenderers.set(t,s),e._materialRenderers.set(t,c),e._materialsUsingGeometry.has(o)||e._materialsUsingGeometry.set(o,new WeakSet),e._materialsUsingGeometry.get(o).has(a)||(c.didInitGeometry(s),e._materialsUsingGeometry.get(o).add(a)),-1===e._activeModels.indexOf(t)&&n(t,e._activeModels,e._modelComparator),t})),r},t.prototype.render=function(t,e){this.gl.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);var n=this.scene,r=this.camera,i=this._lightRenderers,o=this._geometryRenderers,a=this._materialRenderers,u=this._activeModels;n.recalculate(),n.forEach(function(n){n.trigger("tick",{sync:!0},t,e)});for(var s=null,l=null,f=0,p=u.length;p>f;++f){var m=u[f],h=o.get(m),d=a.get(m),g=d.program;g!==s&&g.use(),d!==l&&d.willDraw(r,i),d.draw(r,m),h.draw(),d!==l&&d.didDraw(),s=g,l=d}},t}(),t("default",l)}}}),t.register("main",["github:maxdavidson/tribus@master/renderer","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/light/directional-light","github:maxdavidson/tribus@master/light/pointlight","github:maxdavidson/tribus@master/control/mouseview","github:maxdavidson/tribus@master/extra/helpers","github:ded/domready@1.0.7"],function(){var t,e,n,r,i,o,a,u,s,c,l,f,p,m,h,d,g,v,b,y,x,w;return{setters:[function(e){t=e["default"]},function(t){e=t["default"]},function(t){n=t["default"]},function(t){r=t["default"]},function(t){i=t["default"]},function(t){o=t.model,a=t.group,u=t.geometry,s=t.phong},function(t){c=t["default"]}],execute:function(){"use strict";l=u("models/blade.obj"),f=u("models/windmill-balcony.obj"),p=u("models/windmill-roof.obj"),m=u("models/windmill-walls.obj"),h=s({shininess:10,ambient:.2,diffuse:[.5,0,.5]}),d=s({shininess:15,diffuse:[.5,.5,.5]}),g=s({diffuse:[1,0,0],specular:1}),v=s({ambient:.1}),b=a("windmill",{scale:.6,rotateY:-90},[o("walls",{},m,d),o("roof",{},p,v),o("balcony",{},f,g),a("blades",{position:[4.5,9.2,0],scale:.8},[o("blade0",{rotateX:0},l,h),o("blade1",{rotateX:90},l,h),o("blade2",{rotateX:180},l,h),o("blade3",{rotateX:270},l,h),new r({position:[-1,10,0],diffuse:[1,0,0]})])]),b.query("blades").on("tick",function(t,e,n){n.rotateX(60*t/1e3)}),y=new e({position:[0,3.5,10]}),x=a("world",{},[b,y,new n({rotateX:-45,rotateY:45})]),w=document.createElement("canvas"),c(function(){document.body.appendChild(w);var e=(new i(y,w),new t(x,y,w,{debug:!1}));e.start()})}}})});
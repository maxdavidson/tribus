!function(e){function t(e){for(var t=[],n=0,r=e.length;r>n;n++)-1==m.call(t,e[n])&&t.push(e[n]);return t}function n(e,n,r,i){if("string"!=typeof e)throw"System.register provided no module name";var o;o="boolean"==typeof r?{declarative:!1,deps:n,execute:i,executingRequire:r}:{declarative:!0,deps:n,declare:r},o.name=e,e in f||(f[e]=o),o.deps=t(o.deps),o.normalizedDeps=o.deps}function r(e,t){if(t[e.groupIndex]=t[e.groupIndex]||[],-1==m.call(t[e.groupIndex],e)){t[e.groupIndex].push(e);for(var n=0,i=e.normalizedDeps.length;i>n;n++){var o=e.normalizedDeps[n],a=f[o];if(a&&!a.evaluated){var s=e.groupIndex+(a.declarative!=e.declarative);if(void 0===a.groupIndex||a.groupIndex<s){if(void 0!==a.groupIndex&&(t[a.groupIndex].splice(m.call(t[a.groupIndex],a),1),0==t[a.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");a.groupIndex=s}r(a,t)}}}}function i(e){var t=f[e];t.groupIndex=0;var n=[];r(t,n);for(var i=!!t.declarative==n.length%2,o=n.length-1;o>=0;o--){for(var s=n[o],c=0;c<s.length;c++){var l=s[c];i?a(l):u(l)}i=!i}}function o(e){return p[e]||(p[e]={name:e,dependencies:[],exports:{},importers:[]})}function a(t){if(!t.module){var n=t.module=o(t.name),r=t.module.exports,i=t.declare.call(e,function(e,t){n.locked=!0,r[e]=t;for(var i=0,o=n.importers.length;o>i;i++){var a=n.importers[i];if(!a.locked){var s=m.call(a.dependencies,n);a.setters[s](r)}}return n.locked=!1,t});if(n.setters=i.setters,n.execute=i.execute,!n.setters||!n.execute)throw new TypeError("Invalid System.register form for "+t.name);for(var s=0,u=t.normalizedDeps.length;u>s;s++){var c,d=t.normalizedDeps[s],h=f[d],b=p[d];b?c=b.exports:h&&!h.declarative?c=h.module.exports&&h.module.exports.__esModule?h.module.exports:{"default":h.module.exports,__useDefault:!0}:h?(a(h),b=h.module,c=b.exports):c=l(d),b&&b.importers?(b.importers.push(n),n.dependencies.push(b)):n.dependencies.push(null),n.setters[s]&&n.setters[s](c)}}}function s(e){var t,n=f[e];if(n)n.declarative?c(e,[]):n.evaluated||u(n),t=n.module.exports;else if(t=l(e),!t)throw new Error("Unable to load dependency "+e+".");return(!n||n.declarative)&&t&&t.__useDefault?t["default"]:t}function u(t){if(!t.module){var n={},r=t.module={exports:n,id:t.name};if(!t.executingRequire)for(var i=0,o=t.normalizedDeps.length;o>i;i++){var a=t.normalizedDeps[i],c=f[a];c&&u(c)}t.evaluated=!0;var l=t.execute.call(e,function(e){for(var n=0,r=t.deps.length;r>n;n++)if(t.deps[n]==e)return s(t.normalizedDeps[n]);throw new TypeError("Module "+e+" not declared as a dependency.")},n,r);l&&(r.exports=l)}}function c(t,n){var r=f[t];if(r&&!r.evaluated&&r.declarative){n.push(t);for(var i=0,o=r.normalizedDeps.length;o>i;i++){var a=r.normalizedDeps[i];-1==m.call(n,a)&&(f[a]?c(a,n):l(a))}r.evaluated||(r.evaluated=!0,r.module.execute.call(e))}}function l(e){if(d[e])return d[e];var t=f[e];if(!t)throw"Module "+e+" not present.";i(e),c(e,[]),f[e]=void 0;var n=t.module.exports;return(!n||!t.declarative&&n.__esModule!==!0)&&(n={"default":n,__useDefault:!0}),d[e]=n}var f={},m=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},p={},d={};return function(t,r){var i,i={register:n,get:l,set:function(e,t){d[e]=t},newModule:function(e){return e},global:e};i.set("@empty",{}),r(i);for(var o=0;o<t.length;o++)l(t[o])}}("undefined"!=typeof window?window:global)(["main"],function(e){e.register("npm:core-js@0.9.12/library/modules/$.fw",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e.FW=!1,e.path=e.core,e},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/helpers/class-call-check",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.__esModule=!0,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.shared",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a="__core-js_shared__",s=o.g[a]||o.hide(o.g,a,{})[a];return n.exports=function(e){return s[e]||(s[e]={})},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.uid",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){function r(e){return"Symbol(".concat(void 0===e?"":e,")_",(++a+Math.random()).toString(36))}var i=e.global,o=i.define;i.define=void 0;var a=0;return r.safe=require("npm:core-js@0.9.12/library/modules/$").g.Symbol||r,n.exports=r,i.define=o,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.redef",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:core-js@0.9.12/library/modules/$").hide,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.string-at",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$");return n.exports=function(e){return function(t,n){var r,i,a=String(o.assertDefined(t)),s=o.toInteger(n),u=a.length;return 0>s||s>=u?e?"":void 0:(r=a.charCodeAt(s),55296>r||r>56319||s+1===u||(i=a.charCodeAt(s+1))<56320||i>57343?e?a.charAt(s):r:e?a.slice(s,s+2):(r-55296<<10)+(i-56320)+65536)}},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.assert",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){function r(e,t,n){if(!e)throw TypeError(n?t+n:t)}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.9.12/library/modules/$");return r.def=a.assertDefined,r.fn=function(e){if(!a.isFunction(e))throw TypeError(e+" is not a function!");return e},r.obj=function(e){if(!a.isObject(e))throw TypeError(e+" is not an object!");return e},r.inst=function(e,t,n){if(!(e instanceof t))throw TypeError(n+": use the 'new' operator!");return e},n.exports=r,i.define=o,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.def",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){function r(e,t){return function(){return e.apply(t,arguments)}}function i(e,t,n){var a,s,l,f,m=e&i.G,p=e&i.P,d=m?o:e&i.S?o[t]:(o[t]||{}).prototype,h=m?u:u[t]||(u[t]={});m&&(n=t);for(a in n)s=!(e&i.F)&&d&&a in d,s&&a in h||(l=s?d[a]:n[a],m&&!c(d[a])?f=n[a]:e&i.B&&s?f=r(l,o):e&i.W&&d[a]==l?!function(e){f=function(t){return this instanceof e?new e(t):e(t)},f.prototype=e.prototype}(l):f=p&&c(l)?r(Function.call,l):l,h[a]=f,p&&((h.prototype||(h.prototype={}))[a]=l))}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.9.12/library/modules/$"),o=s.g,u=s.core,c=s.isFunction;return i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,n.exports=i,o.define=a,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.unscope",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.wks")("unscopables");return!o.FW||a in[]||o.hide(Array.prototype,a,{}),n.exports=function(e){o.FW&&([][a][e]=!0)},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.ctx",["npm:core-js@0.9.12/library/modules/$.assert"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.assert").fn;return n.exports=function(e,t,n){if(o(e),~n&&void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.iter-call",["npm:core-js@0.9.12/library/modules/$.assert"],!0,function(require,t,n){function r(e){var t=e["return"];void 0!==t&&s(t.call(e))}function i(e,t,n,i){try{return i?t(s(n)[0],n[1]):t(n)}catch(o){throw r(e),o}}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.9.12/library/modules/$.assert").obj;return i.close=r,n.exports=i,o.define=a,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.set-proto",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.ctx"],!0,function(require,t,n){function r(e,t){s.obj(e),s(null===t||a.isObject(t),t,": can't set as prototype!")}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.9.12/library/modules/$"),s=require("npm:core-js@0.9.12/library/modules/$.assert");return n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t){try{t=require("npm:core-js@0.9.12/library/modules/$.ctx")(Function.call,a.getDesc(Object.prototype,"__proto__").set,2),t({},[])}catch(n){e=!0}return function(n,i){return r(n,i),e?n.__proto__=i:t(n,i),n}}():void 0),check:r},i.define=o,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.species",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.wks")("species");return n.exports=function(e){!o.DESC||a in e||o.setDesc(e,a,{configurable:!0,get:o.that})},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.invoke",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3]);case 5:return r?e(t[0],t[1],t[2],t[3],t[4]):e.call(n,t[0],t[1],t[2],t[3],t[4])}return e.apply(n,t)},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.dom-create",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=o.g.document,s=o.isObject,u=s(a)&&s(a.createElement);return n.exports=function(e){return u?a.createElement(e):{}},r.define=i,n.exports}),e.register("npm:process@0.10.1/browser",[],!0,function(require,t,n){function r(){if(!c){c=!0;for(var e,t=u.length;t;){e=u,u=[];for(var n=-1;++n<t;)e[n]();t=u.length}c=!1}}function i(){}var o=e.global,a=o.define;o.define=void 0;var s=n.exports={},u=[],c=!1;return s.nextTick=function(e){u.push(e),c||setTimeout(r,0)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=i,s.addListener=i,s.once=i,s.off=i,s.removeListener=i,s.removeAllListeners=i,s.emit=i,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0},o.define=a,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.mix",["npm:core-js@0.9.12/library/modules/$.redef"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.redef");return n.exports=function(e,t){for(var n in t)o(e,n,t[n]);return e},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.iter-detect",["npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.wks")("iterator"),a=!1;try{var s=[7][o]();s["return"]=function(){a=!0},Array.from(s,function(){throw 2})}catch(u){}return n.exports=function(e){if(!a)return!1;var t=!1;try{var n=[7],r=n[o]();r.next=function(){t=!0},n[o]=function(){return r},e(n)}catch(i){}return t},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.array-methods",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.ctx"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.ctx");return n.exports=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,u=5==e||s;return function(c,l,f){for(var m,p,d=Object(o.assertDefined(c)),h=o.ES5Object(d),b=a(l,f,3),g=o.toLength(h.length),v=0,y=t?Array(g):n?[]:void 0;g>v;v++)if((u||v in h)&&(m=h[v],p=b(m,v,d),e))if(t)y[v]=p;else if(p)switch(e){case 3:return!0;case 5:return m;case 6:return v;case 2:y.push(m)}else if(i)return!1;return s?-1:r||i?i:y}},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.collection",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.for-of","npm:core-js@0.9.12/library/modules/$.species","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.redef","npm:core-js@0.9.12/library/modules/$.mix","npm:core-js@0.9.12/library/modules/$.iter-detect","npm:core-js@0.9.12/library/modules/$.cof"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.def"),s=require("npm:core-js@0.9.12/library/modules/$.iter").BUGGY,u=require("npm:core-js@0.9.12/library/modules/$.for-of"),c=require("npm:core-js@0.9.12/library/modules/$.species"),l=require("npm:core-js@0.9.12/library/modules/$.assert").inst;return n.exports=function(e,t,n,r,i){function f(e,t){if(o.FW){var n=h[e];require("npm:core-js@0.9.12/library/modules/$.redef")(h,e,function(e,r){var i=n.call(this,0===e?0:e,r);return t?this:i})}}var m=o.g[e],p=m,d=r?"set":"add",h=p&&p.prototype,b={};if(o.isFunction(p)&&(i||!s&&h.forEach&&h.entries)){var g,v=new p,y=v[d](i?{}:-0,1);require("npm:core-js@0.9.12/library/modules/$.iter-detect")(function(e){new p(e)})||(p=function(){l(this,p,e);var t=new m,n=arguments[0];return void 0!=n&&u(n,r,t[d],t),t},p.prototype=h,o.FW&&(h.constructor=p)),i||v.forEach(function(e,t){g=1/t===-(1/0)}),g&&(f("delete"),f("has"),r&&f("get")),(g||y!==v)&&f(d,!0)}else p=n.getConstructor(e,r,d),require("npm:core-js@0.9.12/library/modules/$.mix")(p.prototype,t);return require("npm:core-js@0.9.12/library/modules/$.cof").set(p,e),b[e]=p,a(a.G+a.W+a.F*(p!=m),b),c(p),c(o.core[e]),i||n.setIter(p,e,r),p},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.weak-set",["npm:core-js@0.9.12/library/modules/$.collection-weak","npm:core-js@0.9.12/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.collection-weak");return require("npm:core-js@0.9.12/library/modules/$.collection")("WeakSet",{add:function(e){return o.def(this,e,!0)}},o,!1,!0),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/core.iter-helpers",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.iter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$").core,a=require("npm:core-js@0.9.12/library/modules/$.iter");return o.isIterable=a.is,o.getIterator=a.get,r.define=i,n.exports}),function(){function t(){}t.amd={},function(n){"use strict";var r={};"undefined"==typeof exports?"function"==typeof t&&"object"==typeof t.amd&&t.amd?(r.exports={},e.register("github:toji/gl-matrix@2.2.1/dist/gl-matrix",[],!1,function(){return r.exports})):r.exports="undefined"!=typeof window?window:n:r.exports=exports,function(e){if(!t)var t=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!r)var r=Math.random;var i={};i.setMatrixArrayType=function(e){n=e},"undefined"!=typeof e&&(e.glMatrix=i);var o=Math.PI/180;i.toRadian=function(e){return e*o};var a={};a.create=function(){var e=new n(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var r=new n(2);return r[0]=e,r[1]=t,r},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,n){return e[0]=t,e[1]=n,e},a.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},a.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},a.sub=a.subtract,a.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},a.mul=a.multiply,a.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},a.div=a.divide,a.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},a.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},a.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},a.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},a.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},a.len=a.length,a.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},a.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},a.random=function(e,t){t=t||1;var n=2*r()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},a.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},a.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},a.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},a.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},a.forEach=function(){var e=a.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;u>s;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},"undefined"!=typeof e&&(e.vec2=a);var s={};s.create=function(){var e=new n(3);return e[0]=0,e[1]=0,e[2]=0,e},s.clone=function(e){var t=new n(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.fromValues=function(e,t,r){var i=new n(3);return i[0]=e,i[1]=t,i[2]=r,i},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},s.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},s.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},s.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},s.sub=s.subtract,s.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},s.mul=s.multiply,s.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},s.div=s.divide,s.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},s.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},s.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},s.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},s.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)},s.dist=s.distance,s.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i},s.sqrDist=s.squaredDistance,s.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},s.len=s.length,s.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},s.sqrLen=s.squaredLength,s.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},s.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},s.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},s.random=function(e,t){t=t||1;var n=2*r()*Math.PI,i=2*r()-1,o=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=i*t,e},s.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12],e[1]=n[1]*r+n[5]*i+n[9]*o+n[13],e[2]=n[2]*r+n[6]*i+n[10]*o+n[14],e},s.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},s.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,m=c*o+a*i-s*r,p=-a*r-s*i-u*o;return e[0]=l*c+p*-a+f*-u-m*-s,e[1]=f*c+p*-s+m*-a-l*-u,e[2]=m*c+p*-u+l*-s-f*-a,e},s.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.forEach=function(){var e=s.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;u>s;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),s.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},"undefined"!=typeof e&&(e.vec3=s);var u={};u.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},u.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.fromValues=function(e,t,r,i){var o=new n(4);return o[0]=e,o[1]=t,o[2]=r,o[3]=i,o},u.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},u.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},u.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e},u.sub=u.subtract,u.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},u.mul=u.multiply,u.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},u.div=u.divide,u.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},u.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},u.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},u.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},u.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)},u.dist=u.distance,u.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o},u.sqrDist=u.squaredDistance,u.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},u.len=u.length,u.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},u.sqrLen=u.squaredLength,u.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},u.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e},u.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},u.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e},u.random=function(e,t){return t=t||1,e[0]=r(),e[1]=r(),e[2]=r(),e[3]=r(),u.normalize(e,e),u.scale(e,e,t),e},u.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},u.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,m=c*o+a*i-s*r,p=-a*r-s*i-u*o;return e[0]=l*c+p*-a+f*-u-m*-s,e[1]=f*c+p*-s+m*-a-l*-u,e[2]=m*c+p*-u+l*-s-f*-a,e},u.forEach=function(){var e=u.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;u>s;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),u.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},"undefined"!=typeof e&&(e.vec4=u);var c={};c.create=function(){var e=new n(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},c.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},c.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},c.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},c.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},c.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*o-i*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e):null},c.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},c.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},c.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*s+o*u,e[1]=i*s+a*u,e[2]=r*c+o*l,e[3]=i*c+a*l,e},c.mul=c.multiply,c.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=r*-s+o*u,e[3]=i*-s+a*u,e},c.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1];return e[0]=r*s,e[1]=i*s,e[2]=o*u,e[3]=a*u,e},c.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},c.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},c.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},"undefined"!=typeof e&&(e.mat2=c);var l={};l.create=function(){var e=new n(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},l.clone=function(e){var t=new n(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},l.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},l.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=n*o-r*i;return u?(u=1/u,e[0]=o*u,e[1]=-r*u,e[2]=-i*u,e[3]=n*u,e[4]=(i*s-o*a)*u,e[5]=(r*a-n*s)*u,e):null},l.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},l.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=n[0],l=n[1],f=n[2],m=n[3],p=n[4],d=n[5];return e[0]=r*c+o*l,e[1]=i*c+a*l,e[2]=r*f+o*m,e[3]=i*f+a*m,e[4]=r*p+o*d+s,e[5]=i*p+a*d+u,e},l.mul=l.multiply,l.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*c,e[1]=i*l+a*c,e[2]=r*-c+o*l,e[3]=i*-c+a*l,e[4]=s,e[5]=u,e},l.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=n[0],l=n[1];return e[0]=r*c,e[1]=i*c,e[2]=o*l,e[3]=a*l,e[4]=s,e[5]=u,e},l.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=n[0],l=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*c+o*l+s,e[5]=i*c+a*l+u,e},l.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},l.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},"undefined"!=typeof e&&(e.mat2d=l);var f={};f.create=function(){var e=new n(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},f.clone=function(e){var t=new n(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},f.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},f.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=l*a-s*c,m=-l*o+s*u,p=c*o-a*u,d=n*f+r*m+i*p;return d?(d=1/d,e[0]=f*d,e[1]=(-l*r+i*c)*d,e[2]=(s*r-i*a)*d,e[3]=m*d,e[4]=(l*n-i*u)*d,e[5]=(-s*n+i*o)*d,e[6]=p*d,e[7]=(-c*n+r*u)*d,e[8]=(a*n-r*o)*d,e):null},f.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=a*l-s*c,e[1]=i*c-r*l,e[2]=r*s-i*a,e[3]=s*u-o*l,e[4]=n*l-i*u,e[5]=i*o-n*s,e[6]=o*c-a*u,e[7]=r*u-n*c,e[8]=n*a-r*o,e},f.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)},f.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=n[0],p=n[1],d=n[2],h=n[3],b=n[4],g=n[5],v=n[6],y=n[7],x=n[8];return e[0]=m*r+p*a+d*c,e[1]=m*i+p*s+d*l,e[2]=m*o+p*u+d*f,e[3]=h*r+b*a+g*c,e[4]=h*i+b*s+g*l,e[5]=h*o+b*u+g*f,e[6]=v*r+y*a+x*c,e[7]=v*i+y*s+x*l,e[8]=v*o+y*u+x*f,e},f.mul=f.multiply,f.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=m*r+p*a+c,e[7]=m*i+p*s+l,e[8]=m*o+p*u+f,e},f.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=Math.sin(n),p=Math.cos(n);return e[0]=p*r+m*a,e[1]=p*i+m*s,e[2]=p*o+m*u,e[3]=p*a-m*r,e[4]=p*s-m*i,e[5]=p*u-m*o,e[6]=c,e[7]=l,e[8]=f,e},f.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},f.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,m=i*a,p=i*s,d=i*u,h=o*a,b=o*s,g=o*u;return e[0]=1-f-d,e[3]=l-g,e[6]=m+b,e[1]=l+g,e[4]=1-c-d,e[7]=p-h,e[2]=m-b,e[5]=p+h,e[8]=1-c-f,e},f.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],m=t[10],p=t[11],d=t[12],h=t[13],b=t[14],g=t[15],v=n*s-r*a,y=n*u-i*a,x=n*c-o*a,w=r*u-i*s,j=r*c-o*s,_=i*c-o*u,E=l*h-f*d,T=l*b-m*d,A=l*g-p*d,S=f*b-m*h,M=f*g-p*h,k=m*g-p*b,L=v*k-y*M+x*S+w*A-j*T+_*E;return L?(L=1/L,e[0]=(s*k-u*M+c*S)*L,e[1]=(u*A-a*k-c*T)*L,e[2]=(a*M-s*A+c*E)*L,e[3]=(i*M-r*k-o*S)*L,e[4]=(n*k-i*A+o*T)*L,e[5]=(r*A-n*M-o*E)*L,e[6]=(h*_-b*j+g*w)*L,e[7]=(b*x-d*_-g*y)*L,e[8]=(d*j-h*x+g*v)*L,e):null},f.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},f.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},"undefined"!=typeof e&&(e.mat3=f);var m={};m.create=function(){var e=new n(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.clone=function(e){var t=new n(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],
t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},m.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},m.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},m.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],m=t[10],p=t[11],d=t[12],h=t[13],b=t[14],g=t[15],v=n*s-r*a,y=n*u-i*a,x=n*c-o*a,w=r*u-i*s,j=r*c-o*s,_=i*c-o*u,E=l*h-f*d,T=l*b-m*d,A=l*g-p*d,S=f*b-m*h,M=f*g-p*h,k=m*g-p*b,L=v*k-y*M+x*S+w*A-j*T+_*E;return L?(L=1/L,e[0]=(s*k-u*M+c*S)*L,e[1]=(i*M-r*k-o*S)*L,e[2]=(h*_-b*j+g*w)*L,e[3]=(m*j-f*_-p*w)*L,e[4]=(u*A-a*k-c*T)*L,e[5]=(n*k-i*A+o*T)*L,e[6]=(b*x-d*_-g*y)*L,e[7]=(l*_-m*x+p*y)*L,e[8]=(a*M-s*A+c*E)*L,e[9]=(r*A-n*M-o*E)*L,e[10]=(d*j-h*x+g*v)*L,e[11]=(f*x-l*j-p*v)*L,e[12]=(s*T-a*S-u*E)*L,e[13]=(n*S-r*T+i*E)*L,e[14]=(h*y-d*w-b*v)*L,e[15]=(l*w-f*y+m*v)*L,e):null},m.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],m=t[10],p=t[11],d=t[12],h=t[13],b=t[14],g=t[15];return e[0]=s*(m*g-p*b)-f*(u*g-c*b)+h*(u*p-c*m),e[1]=-(r*(m*g-p*b)-f*(i*g-o*b)+h*(i*p-o*m)),e[2]=r*(u*g-c*b)-s*(i*g-o*b)+h*(i*c-o*u),e[3]=-(r*(u*p-c*m)-s*(i*p-o*m)+f*(i*c-o*u)),e[4]=-(a*(m*g-p*b)-l*(u*g-c*b)+d*(u*p-c*m)),e[5]=n*(m*g-p*b)-l*(i*g-o*b)+d*(i*p-o*m),e[6]=-(n*(u*g-c*b)-a*(i*g-o*b)+d*(i*c-o*u)),e[7]=n*(u*p-c*m)-a*(i*p-o*m)+l*(i*c-o*u),e[8]=a*(f*g-p*h)-l*(s*g-c*h)+d*(s*p-c*f),e[9]=-(n*(f*g-p*h)-l*(r*g-o*h)+d*(r*p-o*f)),e[10]=n*(s*g-c*h)-a*(r*g-o*h)+d*(r*c-o*s),e[11]=-(n*(s*p-c*f)-a*(r*p-o*f)+l*(r*c-o*s)),e[12]=-(a*(f*b-m*h)-l*(s*b-u*h)+d*(s*m-u*f)),e[13]=n*(f*b-m*h)-l*(r*b-i*h)+d*(r*m-i*f),e[14]=-(n*(s*b-u*h)-a*(r*b-i*h)+d*(r*u-i*s)),e[15]=n*(s*m-u*f)-a*(r*m-i*f)+l*(r*u-i*s),e},m.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],m=e[11],p=e[12],d=e[13],h=e[14],b=e[15],g=t*a-n*o,v=t*s-r*o,y=t*u-i*o,x=n*s-r*a,w=n*u-i*a,j=r*u-i*s,_=c*d-l*p,E=c*h-f*p,T=c*b-m*p,A=l*h-f*d,S=l*b-m*d,M=f*b-m*h;return g*M-v*S+y*A+x*T-w*E+j*_},m.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=t[9],p=t[10],d=t[11],h=t[12],b=t[13],g=t[14],v=t[15],y=n[0],x=n[1],w=n[2],j=n[3];return e[0]=y*r+x*s+w*f+j*h,e[1]=y*i+x*u+w*m+j*b,e[2]=y*o+x*c+w*p+j*g,e[3]=y*a+x*l+w*d+j*v,y=n[4],x=n[5],w=n[6],j=n[7],e[4]=y*r+x*s+w*f+j*h,e[5]=y*i+x*u+w*m+j*b,e[6]=y*o+x*c+w*p+j*g,e[7]=y*a+x*l+w*d+j*v,y=n[8],x=n[9],w=n[10],j=n[11],e[8]=y*r+x*s+w*f+j*h,e[9]=y*i+x*u+w*m+j*b,e[10]=y*o+x*c+w*p+j*g,e[11]=y*a+x*l+w*d+j*v,y=n[12],x=n[13],w=n[14],j=n[15],e[12]=y*r+x*s+w*f+j*h,e[13]=y*i+x*u+w*m+j*b,e[14]=y*o+x*c+w*p+j*g,e[15]=y*a+x*l+w*d+j*v,e},m.mul=m.multiply,m.translate=function(e,t,n){var r,i,o,a,s,u,c,l,f,m,p,d,h=n[0],b=n[1],g=n[2];return t===e?(e[12]=t[0]*h+t[4]*b+t[8]*g+t[12],e[13]=t[1]*h+t[5]*b+t[9]*g+t[13],e[14]=t[2]*h+t[6]*b+t[10]*g+t[14],e[15]=t[3]*h+t[7]*b+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=t[9],p=t[10],d=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=m,e[10]=p,e[11]=d,e[12]=r*h+s*b+f*g+t[12],e[13]=i*h+u*b+m*g+t[13],e[14]=o*h+c*b+p*g+t[14],e[15]=a*h+l*b+d*g+t[15]),e},m.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},m.rotate=function(e,n,r,i){var o,a,s,u,c,l,f,m,p,d,h,b,g,v,y,x,w,j,_,E,T,A,S,M,k=i[0],L=i[1],I=i[2],R=Math.sqrt(k*k+L*L+I*I);return Math.abs(R)<t?null:(R=1/R,k*=R,L*=R,I*=R,o=Math.sin(r),a=Math.cos(r),s=1-a,u=n[0],c=n[1],l=n[2],f=n[3],m=n[4],p=n[5],d=n[6],h=n[7],b=n[8],g=n[9],v=n[10],y=n[11],x=k*k*s+a,w=L*k*s+I*o,j=I*k*s-L*o,_=k*L*s-I*o,E=L*L*s+a,T=I*L*s+k*o,A=k*I*s+L*o,S=L*I*s-k*o,M=I*I*s+a,e[0]=u*x+m*w+b*j,e[1]=c*x+p*w+g*j,e[2]=l*x+d*w+v*j,e[3]=f*x+h*w+y*j,e[4]=u*_+m*E+b*T,e[5]=c*_+p*E+g*T,e[6]=l*_+d*E+v*T,e[7]=f*_+h*E+y*T,e[8]=u*A+m*S+b*M,e[9]=c*A+p*S+g*M,e[10]=l*A+d*S+v*M,e[11]=f*A+h*S+y*M,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},m.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+f*r,e[7]=u*i+m*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=f*i-s*r,e[11]=m*i-u*r,e},m.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-f*r,e[3]=u*i-m*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+f*i,e[11]=u*r+m*i,e},m.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+f*r,e[3]=u*i+m*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=f*i-s*r,e[7]=m*i-u*r,e},m.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,m=r*c,p=i*u,d=i*c,h=o*c,b=a*s,g=a*u,v=a*c;return e[0]=1-(p+h),e[1]=f+v,e[2]=m-g,e[3]=0,e[4]=f-v,e[5]=1-(l+h),e[6]=d+b,e[7]=0,e[8]=m+g,e[9]=d-b,e[10]=1-(l+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},m.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,m=i*a,p=i*s,d=i*u,h=o*a,b=o*s,g=o*u;return e[0]=1-f-d,e[1]=l+g,e[2]=m-b,e[3]=0,e[4]=l-g,e[5]=1-c-d,e[6]=p+h,e[7]=0,e[8]=m+b,e[9]=p-h,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e},m.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e},m.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e},m.lookAt=function(e,n,r,i){var o,a,s,u,c,l,f,p,d,h,b=n[0],g=n[1],v=n[2],y=i[0],x=i[1],w=i[2],j=r[0],_=r[1],E=r[2];return Math.abs(b-j)<t&&Math.abs(g-_)<t&&Math.abs(v-E)<t?m.identity(e):(f=b-j,p=g-_,d=v-E,h=1/Math.sqrt(f*f+p*p+d*d),f*=h,p*=h,d*=h,o=x*d-w*p,a=w*f-y*d,s=y*p-x*f,h=Math.sqrt(o*o+a*a+s*s),h?(h=1/h,o*=h,a*=h,s*=h):(o=0,a=0,s=0),u=p*s-d*a,c=d*o-f*s,l=f*a-p*o,h=Math.sqrt(u*u+c*c+l*l),h?(h=1/h,u*=h,c*=h,l*=h):(u=0,c=0,l=0),e[0]=o,e[1]=u,e[2]=f,e[3]=0,e[4]=a,e[5]=c,e[6]=p,e[7]=0,e[8]=s,e[9]=l,e[10]=d,e[11]=0,e[12]=-(o*b+a*g+s*v),e[13]=-(u*b+c*g+l*v),e[14]=-(f*b+p*g+d*v),e[15]=1,e)},m.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},m.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},"undefined"!=typeof e&&(e.mat4=m);var p={};p.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.rotationTo=function(){var e=s.create(),t=s.fromValues(1,0,0),n=s.fromValues(0,1,0);return function(r,i,o){var a=s.dot(i,o);return-.999999>a?(s.cross(e,t,i),s.length(e)<1e-6&&s.cross(e,n,i),s.normalize(e,e),p.setAxisAngle(r,e,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(s.cross(e,i,o),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+a,p.normalize(r,r))}}(),p.setAxes=function(){var e=f.create();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],p.normalize(t,p.fromMat3(t,e))}}(),p.clone=u.clone,p.fromValues=u.fromValues,p.copy=u.copy,p.set=u.set,p.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.setAxisAngle=function(e,t,n){n=.5*n;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},p.add=u.add,p.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,e},p.mul=p.multiply,p.scale=u.scale,p.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e},p.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e},p.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e},p.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},p.dot=u.dot,p.lerp=u.lerp,p.slerp=function(e,t,n,r){var i,o,a,s,u,c=t[0],l=t[1],f=t[2],m=t[3],p=n[0],d=n[1],h=n[2],b=n[3];return o=c*p+l*d+f*h+m*b,0>o&&(o=-o,p=-p,d=-d,h=-h,b=-b),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*c+u*p,e[1]=s*l+u*d,e[2]=s*f+u*h,e[3]=s*m+u*b,e},p.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},p.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},p.length=u.length,p.len=p.length,p.squaredLength=u.squaredLength,p.sqrLen=p.squaredLength,p.normalize=u.normalize,p.fromMat3=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[7]-t[5])*n,e[1]=(t[2]-t[6])*n,e[2]=(t[3]-t[1])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e},p.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},"undefined"!=typeof e&&(e.quat=p)}(r.exports)}(this)}(),e.register("npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.def"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.def"),s=o.isObject,u=o.toObject;return o.each.call("freeze,seal,preventExtensions,isFrozen,isSealed,isExtensible,getOwnPropertyDescriptor,getPrototypeOf,keys,getOwnPropertyNames".split(","),function(e,t){var n=(o.core.Object||{})[e]||Object[e],r=0,i={};i[e]=0==t?function(e){return s(e)?n(e):e}:1==t?function(e){return s(e)?n(e):e}:2==t?function(e){return s(e)?n(e):e}:3==t?function(e){return s(e)?n(e):!0}:4==t?function(e){return s(e)?n(e):!0}:5==t?function(e){return s(e)?n(e):!1}:6==t?function(e,t){return n(u(e),t)}:7==t?function(e){return n(Object(o.assertDefined(e)))}:8==t?function(e){return n(u(e))}:function(e){return n(u(e))};try{n("z")}catch(c){r=1}a(a.S+a.F*r,"Object",i)}),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/object/define-property",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$");return n.exports=function(e,t,n){return o.setDesc(e,t,n)},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.collection-strong",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.ctx","npm:core-js@0.9.12/library/modules/$.uid","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.for-of","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.mix","npm:core-js@0.9.12/library/modules/$.iter-define"],!0,function(require,t,n){function r(e,t){if(!h(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!p(e,v)){if(!g(e))return"F";if(!t)return"E";b(e,v,++E)}return"O"+e[v]}function i(e,t){var n,i=r(t);if("F"!==i)return e[y][i];for(n=e[w];n;n=n.n)if(n.k==t)return n}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.9.12/library/modules/$"),u=require("npm:core-js@0.9.12/library/modules/$.ctx"),c=require("npm:core-js@0.9.12/library/modules/$.uid").safe,l=require("npm:core-js@0.9.12/library/modules/$.assert"),f=require("npm:core-js@0.9.12/library/modules/$.for-of"),m=require("npm:core-js@0.9.12/library/modules/$.iter").step,p=s.has,d=s.set,h=s.isObject,b=s.hide,g=Object.isExtensible||h,v=c("id"),y=c("O1"),x=c("last"),w=c("first"),j=c("iter"),_=s.DESC?c("size"):"size",E=0;return n.exports={getConstructor:function(e,t,n){function r(){var i=l.inst(this,r,e),o=arguments[0];d(i,y,s.create(null)),d(i,_,0),d(i,x,void 0),d(i,w,void 0),void 0!=o&&f(o,t,i[n],i)}return require("npm:core-js@0.9.12/library/modules/$.mix")(r.prototype,{clear:function(){for(var e=this,t=e[y],n=e[w];n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e[w]=e[x]=void 0,e[_]=0},"delete":function(e){var t=this,n=i(t,e);if(n){var r=n.n,o=n.p;delete t[y][n.i],n.r=!0,o&&(o.n=r),r&&(r.p=o),t[w]==n&&(t[w]=r),t[x]==n&&(t[x]=o),t[_]--}return!!n},forEach:function(e){for(var t,n=u(e,arguments[1],3);t=t?t.n:this[w];)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!i(this,e)}}),s.DESC&&s.setDesc(r.prototype,"size",{get:function(){return l.def(this[_])}}),r},def:function(e,t,n){var o,a,s=i(e,t);return s?s.v=n:(e[x]=s={i:a=r(t,!0),k:t,v:n,p:o=e[x],n:void 0,r:!1},e[w]||(e[w]=s),o&&(o.n=s),e[_]++,"F"!==a&&(e[y][a]=s)),e},getEntry:i,setIter:function(e,t,n){require("npm:core-js@0.9.12/library/modules/$.iter-define")(e,t,function(e,t){d(this,j,{o:e,k:t})},function(){for(var e=this[j],t=e.k,n=e.l;n&&n.r;)n=n.p;return e.o&&(e.l=n=n?n.n:e.o[w])?"keys"==t?m(0,n.k):"values"==t?m(0,n.v):m(0,[n.k,n.v]):(e.o=void 0,m(1))},n?"entries":"values",!n,!0)}},o.define=a,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.collection-to-json",["npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.for-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.def"),a=require("npm:core-js@0.9.12/library/modules/$.for-of");return n.exports=function(e){o(o.P,e,{toJSON:function(){var e=[];return a(this,!1,e.push,e),e}})},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.set",["npm:core-js@0.9.12/library/modules/$.collection-strong","npm:core-js@0.9.12/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.collection-strong");return require("npm:core-js@0.9.12/library/modules/$.collection")("Set",{add:function(e){return o.def(this,e=0===e?0:e,e)}},o),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es7.set.to-json",["npm:core-js@0.9.12/library/modules/$.collection-to-json"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/$.collection-to-json")("Set"),r.define=i,n.exports}),e.register("github:mrdoob/stats.js@master/src/Stats",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=function(){var e=Date.now(),t=e,n=0,r=1/0,i=0,o=0,a=1/0,s=0,u=0,c=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(e){e.preventDefault(),v(++c%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var f=document.createElement("div");f.id="fps",f.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(f);var m=document.createElement("div");m.id="fpsText",m.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",m.innerHTML="FPS",f.appendChild(m);var p=document.createElement("div");for(p.id="fpsGraph",p.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",f.appendChild(p);p.children.length<74;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#113",p.appendChild(d)}var h=document.createElement("div");h.id="ms",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(h);var b=document.createElement("div");b.id="msText",b.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",b.innerHTML="MS",h.appendChild(b);var g=document.createElement("div");for(g.id="msGraph",g.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",h.appendChild(g);g.children.length<74;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#131",g.appendChild(d)}var v=function(e){switch(c=e){case 0:f.style.display="block",h.style.display="none";break;case 1:f.style.display="none",h.style.display="block"}},y=function(e,t){var n=e.appendChild(e.firstChild);n.style.height=t+"px"};return{REVISION:12,domElement:l,setMode:v,begin:function(){e=Date.now()},end:function(){var c=Date.now();return n=c-e,r=Math.min(r,n),i=Math.max(i,n),b.textContent=n+" MS ("+r+"-"+i+")",y(g,Math.min(30,30-n/200*30)),u++,c>t+1e3&&(o=Math.round(1e3*u/(c-t)),a=Math.min(a,o),s=Math.max(s,o),m.textContent=o+" FPS ("+a+"-"+s+")",y(p,Math.min(30,30-o/100*30)),t=c,u=0),c},update:function(){e=this.end()}}};return"object"==typeof n&&(n.exports=o),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/symbol/iterator",["npm:core-js@0.9.12/library/modules/es6.string.iterator","npm:core-js@0.9.12/library/modules/web.dom.iterable","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.string.iterator"),require("npm:core-js@0.9.12/library/modules/web.dom.iterable"),n.exports=require("npm:core-js@0.9.12/library/modules/$.wks")("iterator"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.keyof",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$");return n.exports=function(e,t){for(var n,r=o.toObject(e),i=o.getKeys(r),a=i.length,s=0;a>s;)if(r[n=i[s++]]===t)return n},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.enum-keys",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$");return n.exports=function(e){var t=o.getKeys(e),n=o.getDesc,r=o.getSymbols;return r&&o.each.call(r(e),function(r){n(e,r).enumerable&&t.push(r)}),t},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.array.from",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.ctx","npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.iter-call","npm:core-js@0.9.12/library/modules/$.iter-detect"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.ctx"),s=require("npm:core-js@0.9.12/library/modules/$.def"),u=require("npm:core-js@0.9.12/library/modules/$.iter"),c=require("npm:core-js@0.9.12/library/modules/$.iter-call");return s(s.S+s.F*!require("npm:core-js@0.9.12/library/modules/$.iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,i,s=Object(o.assertDefined(e)),l=arguments[1],f=void 0!==l,m=f?a(l,arguments[2],2):void 0,p=0;if(u.is(s))for(i=u.get(s),n=new("function"==typeof this?this:Array);!(r=i.next()).done;p++)n[p]=f?c(i,m,[r.value,p],!0):r.value;else for(n=new("function"==typeof this?this:Array)(t=o.toLength(s.length));t>p;p++)n[p]=f?m(s[p],p):s[p];return n.length=p,n}}),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/helpers/object-without-properties",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},t.__esModule=!0,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/normalize-options",["github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";var t=Array.prototype.forEach,r=Object.create,e=function(e,t){var n;for(n in e)t[n]=e[n]};n.exports=function(n){var i=r(null);return t.call(arguments,function(t){null!=t&&e(Object(t),i)}),i}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/math/sign/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e=Math.sign;return"function"!=typeof e?!1:1===e(10)&&-1===e(-20)},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/math/sign/shim",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/valid-callable",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/is-callable",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return"function"==typeof e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/valid-value",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/registered-extensions",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/assign/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e,t=Object.assign;return"function"!=typeof t?!1:(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/keys/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/keys/shim",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.keys;return n.exports=function(e){return o(null==e?e:Object(e))},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/mixin",["npm:es5-ext@0.10.7/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/valid-value"),a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames;return n.exports=function(e,t){var n;if(e=Object(o(e)),u(Object(o(t))).forEach(function(r){try{a(e,r,s(t,r))}catch(i){n=i}}),void 0!==n)throw n;return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/assign",["npm:es5-ext@0.10.7/object/assign/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/object/assign/index"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/string/#/contains/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o="razdwatrzy";return n.exports=function(){return"function"!=typeof o.contains?!1:o.contains("dwa")===!0&&o.contains("foo")===!1},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/string/#/contains/shim",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=String.prototype.indexOf;return n.exports=function(e){return o.call(this,e,arguments[1])>-1},r.define=i,n.exports}),e.register("npm:event-emitter@0.3.3/index",["npm:d@0.1.1","npm:es5-ext@0.10.7/object/valid-callable"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a,s,u,c,l,f,m=require("npm:d@0.1.1"),p=require("npm:es5-ext@0.10.7/object/valid-callable"),d=Function.prototype.apply,h=Function.prototype.call,b=Object.create,g=Object.defineProperty,v=Object.defineProperties,y=Object.prototype.hasOwnProperty,x={configurable:!0,enumerable:!1,writable:!0};return o=function(e,t){var n;return p(t),y.call(this,"__ee__")?n=this.__ee__:(n=x.value=b(null),g(this,"__ee__",x),x.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},a=function(e,t){var n,r;return p(t),r=this,o.call(this,e,n=function(){s.call(r,e,n),d.call(t,this,arguments)}),n.__eeOnceListener__=t,this},s=function(e,t){var n,r,i,o;if(p(t),!y.call(this,"__ee__"))return this;if(n=this.__ee__,!n[e])return this;if(r=n[e],"object"==typeof r)for(o=0;i=r[o];++o)(i===t||i.__eeOnceListener__===t)&&(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else(r===t||r.__eeOnceListener__===t)&&delete n[e];return this},u=function(e){var t,n,r,i,o;if(y.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;n>t;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)d.call(r,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;n>t;++t)o[t-1]=arguments[t];d.call(i,this,o)}},c={on:o,once:a,off:s,emit:u},l={on:m(o),once:m(a),off:m(s),emit:m(u)},f=v({},l),n.exports=t=function(e){return null==e?b(f):v(Object(e),l)},t.methods=c,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/array/from/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e,t,n=Array.from;return"function"!=typeof n?!1:(e=["raz","dwa"],t=n(e),Boolean(t&&t!==e&&"dwa"===t[1]))},r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(t){return!1}return"symbol"==typeof Symbol.iterator?!0:"object"!=typeof Symbol.isConcatSpreadable?!1:"object"!=typeof Symbol.iterator?!1:"object"!=typeof Symbol.toPrimitive?!1:"object"!=typeof Symbol.toStringTag?!1:"object"!=typeof Symbol.unscopables?!1:!0},r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/is-symbol",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e&&("symbol"==typeof e||"Symbol"===e["@@toStringTag"])||!1},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/function/is-arguments",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call(function(){return arguments}());return n.exports=function(e){return o.call(e)===a},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/function/noop",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/string/is-string",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call("");return n.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||o.call(e)===a)||!1},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/resolve-normalize",["npm:es5-ext@0.10.7/object/valid-callable"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/valid-callable");return n.exports=function(e){var t;return"function"==typeof e?{set:e,get:e}:(t={get:o(e.get)},void 0!==e.set?(t.set=o(e.set),t["delete"]=o(e["delete"]),t.clear=o(e.clear),t):(t.set=t.get,t))},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/primitive",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){var t,n,r=e.length;if(!r)return"";for(t=String(e[n=0]);--r;)t+=""+e[++n];return t},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get-primitive-fixed",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e?function(t){for(var n=String(t[0]),r=0,i=e;--i;)n+=""+t[++r];return n}:function(){return""}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/array/#/e-index-of",["npm:es5-ext@0.10.7/number/to-pos-integer","npm:es5-ext@0.10.7/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/number/to-pos-integer"),a=require("npm:es5-ext@0.10.7/object/valid-value"),s=Array.prototype.indexOf,u=Object.prototype.hasOwnProperty,c=Math.abs,l=Math.floor;return n.exports=function(e){var t,n,r,i;if(e===e)return s.apply(this,arguments);for(n=o(a(this).length),r=arguments[1],r=isNaN(r)?0:r>=0?l(r):o(this.length)-l(c(r)),t=r;n>t;++t)if(u.call(this,t)&&(i=this[t],i!==i))return t;return-1},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get-1",["npm:es5-ext@0.10.7/array/#/e-index-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/array/#/e-index-of");return n.exports=function(){var e=0,t=[],n=[];return{get:function(e){var r=o.call(t,e[0]);return-1===r?null:n[r]},set:function(r){return t.push(r[0]),n.push(++e),e},"delete":function(e){var r=o.call(n,e);-1!==r&&(t.splice(r,1),n.splice(r,1))},clear:function(){t=[],n=[]}}},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get-fixed",["npm:es5-ext@0.10.7/array/#/e-index-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/array/#/e-index-of"),a=Object.create;return n.exports=function(e){var t=0,n=[[],[]],r=a(null);return{get:function(t){for(var r,i=0,a=n;e-1>i;){if(r=o.call(a[0],t[i]),-1===r)return null;a=a[1][r],++i}return r=o.call(a[0],t[i]),-1===r?null:a[1][r]||null},set:function(i){for(var a,s=0,u=n;e-1>s;)a=o.call(u[0],i[s]),-1===a&&(a=u[0].push(i[s])-1,u[1].push([[],[]])),u=u[1][a],++s;return a=o.call(u[0],i[s]),-1===a&&(a=u[0].push(i[s])-1),u[1][a]=++t,r[t]=i,t},"delete":function(t){for(var i,a=0,s=n,u=[],c=r[t];e-1>a;){if(i=o.call(s[0],c[a]),-1===i)return;u.push(s,i),s=s[1][i],++a}if(i=o.call(s[0],c[a]),-1!==i){for(t=s[1][i],s[0].splice(i,1),s[1].splice(i,1);!s[0].length&&u.length;)i=u.pop(),s=u.pop(),s[0].splice(i,1),s[1].splice(i,1);delete r[t]}},clear:function(){n=[[],[]],r=a(null)}}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/array/from",["npm:es5-ext@0.10.7/array/from/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/array/from/index"),r.define=i,n.exports}),e.register("npm:next-tick@0.2.2/index",["github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){
var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";var t,r;t=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},r=function(e){var n,r=document.createTextNode(""),i=0;return new e(function(){var e;if(n)return e=n,n=null,"function"==typeof e?void e():void e.forEach(function(e){e()})}).observe(r,{characterData:!0}),function(e){return t(e),n?void("function"==typeof n?n=[n,e]:n.push(e)):(n=e,void(r.data=i=++i%2))}},n.exports=function(){if("undefined"!=typeof e&&e&&"function"==typeof e.nextTick)return e.nextTick;if("object"==typeof document&&document){if("function"==typeof MutationObserver)return r(MutationObserver);if("function"==typeof WebKitMutationObserver)return r(WebKitMutationObserver)}return"function"==typeof setImmediate?function(e){setImmediate(t(e))}:"function"==typeof setTimeout?function(e){setTimeout(t(e),0)}:null}()}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/dispose",["npm:es5-ext@0.10.7/object/valid-callable","npm:es5-ext@0.10.7/object/for-each","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/valid-callable"),a=require("npm:es5-ext@0.10.7/object/for-each"),s=require("npm:memoizee@0.3.8/lib/registered-extensions"),u=Array.prototype.slice,c=Function.prototype.apply;return s.dispose=function(e,t,n){var r;return o(e),n.async&&s.async?(t.on("deleteasync",r=function(t,n){c.call(e,null,u.call(n.args,1))}),void t.on("clearasync",function(e){a(e,function(e,t){r(t,e)})})):(t.on("delete",r=function(t,n){e(n)}),void t.on("clear",function(e){a(e,function(e,t){r(t,e)})}))},r.define=i,n.exports}),e.register("npm:timers-ext@0.1.0/max-timeout",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=2147483647,r.define=i,n.exports}),e.register("npm:lru-queue@0.1.0/index",["npm:es5-ext@0.10.7/number/to-pos-integer"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/number/to-pos-integer"),a=Object.create,s=Object.prototype.hasOwnProperty;return n.exports=function(e){var t,n=0,r=1,i=a(null),u=a(null),c=0;return e=o(e),{hit:function(o){var a=u[o],l=++c;if(i[l]=o,u[o]=l,!a){if(++n,e>=n)return;return o=i[r],t(o),o}if(delete i[a],r===a)for(;!s.call(i,++r);)continue},"delete":t=function(e){var t=u[e];if(t&&(delete i[t],delete u[e],--n,r===t)){if(!n)return c=0,void(r=1);for(;!s.call(i,++r);)continue}},clear:function(){n=0,r=1,i=a(null),u=a(null),c=0}}},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/ref-counter",["npm:d@0.1.1","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:d@0.1.1"),a=require("npm:memoizee@0.3.8/lib/registered-extensions"),s=Object.create,u=Object.defineProperties;return a.refCounter=function(e,t,n){var r,i;r=s(null),i=n.async&&a.async?"async":"",t.on("set"+i,function(e,t){r[e]=t||1}),t.on("get"+i,function(e){++r[e]}),t.on("delete"+i,function(e){delete r[e]}),t.on("clear"+i,function(){r={}}),u(t.memoized,{deleteRef:o(function(){var e=t.get(arguments);return null===e?null:r[e]?--r[e]?!1:(t["delete"](e),!0):null}),getRefCount:o(function(){var e=t.get(arguments);return null===e?0:r[e]?r[e]:0})})},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/helpers/bind",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=Function.prototype.bind,t.__esModule=!0,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/object/seal",["npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Object.seal,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/object/freeze",["npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Object.freeze,r.define=i,n.exports}),e.register("github:toji/gl-matrix@2.2.1/src/gl-matrix/vec3.js!github:systemjs/plugin-text@0.0.2",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports="/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation \n    and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\n\n/**\n * @class 3 Dimensional Vector\n * @name vec3\n */\nvar vec3 = {};\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nvec3.create = function() {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nvec3.clone = function(a) {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nvec3.fromValues = function(x, y, z) {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nvec3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nvec3.set = function(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nvec3.sub = vec3.subtract;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    out[2] = a[2] * b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nvec3.mul = vec3.multiply;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    out[2] = a[2] / b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nvec3.div = vec3.divide;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    out[2] = Math.min(a[2], b[2]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    out[2] = Math.max(a[2], b[2]);\n    return out;\n};\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nvec3.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n};\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nvec3.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nvec3.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nvec3.dist = vec3.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec3.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nvec3.sqrDist = vec3.squaredDistance;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec3.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nvec3.len = vec3.length;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec3.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nvec3.sqrLen = vec3.squaredLength;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nvec3.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    return out;\n};\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nvec3.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    var len = x*x + y*y + z*z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.cross = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n};\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    out[2] = az + t * (b[2] - az);\n    return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nvec3.random = function (out, scale) {\n    scale = scale || 1.0;\n\n    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\n    var z = (GLMAT_RANDOM() * 2.0) - 1.0;\n    var zScale = Math.sqrt(1.0-z*z) * scale;\n\n    out[0] = Math.cos(r) * zScale;\n    out[1] = Math.sin(r) * zScale;\n    out[2] = z * scale;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat4 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = m[0] * x + m[4] * y + m[8] * z + m[12];\n    out[1] = m[1] * x + m[5] * y + m[9] * z + m[13];\n    out[2] = m[2] * x + m[6] * y + m[10] * z + m[14];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat3 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = x * m[0] + y * m[3] + z * m[6];\n    out[1] = x * m[1] + y * m[4] + z * m[7];\n    out[2] = x * m[2] + y * m[5] + z * m[8];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nvec3.transformQuat = function(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return out;\n};\n\n/*\n* Rotate a 3D vector around the x-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateX = function(out, a, b, c){\n   var p = [], r=[];\n	  //Translate point to the origin\n	  p[0] = a[0] - b[0];\n	  p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n\n	  //perform rotation\n	  r[0] = p[0];\n	  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\n	  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\n\n	  //translate to correct position\n	  out[0] = r[0] + b[0];\n	  out[1] = r[1] + b[1];\n	  out[2] = r[2] + b[2];\n\n  	return out;\n};\n\n/*\n* Rotate a 3D vector around the y-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateY = function(out, a, b, c){\n  	var p = [], r=[];\n  	//Translate point to the origin\n  	p[0] = a[0] - b[0];\n  	p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n  \n  	//perform rotation\n  	r[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\n  	r[1] = p[1];\n  	r[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\n  \n  	//translate to correct position\n  	out[0] = r[0] + b[0];\n  	out[1] = r[1] + b[1];\n  	out[2] = r[2] + b[2];\n  \n  	return out;\n};\n\n/*\n* Rotate a 3D vector around the z-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateZ = function(out, a, b, c){\n  	var p = [], r=[];\n  	//Translate point to the origin\n  	p[0] = a[0] - b[0];\n  	p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n  \n  	//perform rotation\n  	r[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\n  	r[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\n  	r[2] = p[2];\n  \n  	//translate to correct position\n  	out[0] = r[0] + b[0];\n  	out[1] = r[1] + b[1];\n  	out[2] = r[2] + b[2];\n  \n  	return out;\n};\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec3.forEach = (function() {\n    var vec = vec3.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 3;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec3} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec3.str = function (a) {\n    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n};\n\nif(typeof(exports) !== 'undefined') {\n    exports.vec3 = vec3;\n}\n",r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.assign",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.enum-keys"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.enum-keys");return n.exports=Object.assign||function(e,t){for(var n=Object(o.assertDefined(e)),r=arguments.length,i=1;r>i;)for(var s,u=o.ES5Object(arguments[i++]),c=a(u),l=c.length,f=0;l>f;)n[s=c[f++]]=u[s];return n},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.math",["npm:core-js@0.9.12/library/modules/$.def"],!0,function(require,t,n){function r(e){return e+1/y-1/y}function i(e){return 0==(e=+e)||e!=e?e:0>e?-1:1}function o(e){return isFinite(e=+e)&&0!=e?0>e?-o(-e):h(e+b(e*e+1)):e}function a(e){return 0==(e=+e)?e:e>-1e-6&&1e-6>e?e+e*e/2:d(e)-1}var s=e.global,u=s.define;s.define=void 0;var c=1/0,l=require("npm:core-js@0.9.12/library/modules/$.def"),f=Math.E,m=Math.pow,p=Math.abs,d=Math.exp,h=Math.log,b=Math.sqrt,g=Math.ceil,v=Math.floor,y=m(2,-52),x=m(2,-23),w=m(2,127)*(2-x),j=m(2,-126);return l(l.S,"Math",{acosh:function(e){return(e=+e)<1?NaN:isFinite(e)?h(e/f+b(e+1)*b(e-1)/f)+1:e},asinh:o,atanh:function(e){return 0==(e=+e)?e:h((1+e)/(1-e))/2},cbrt:function(e){return i(e=+e)*m(p(e),1/3)},clz32:function(e){return(e>>>=0)?31-v(h(e+.5)*Math.LOG2E):32},cosh:function(e){return(d(e=+e)+d(-e))/2},expm1:a,fround:function(e){var t,n,o=p(e),a=i(e);return j>o?a*r(o/j/x)*j*x:(t=(1+x/y)*o,n=t-(t-o),n>w||n!=n?a*c:a*n)},hypot:function(e,t){for(var n,r=0,i=0,o=arguments.length,a=Array(o),s=0;o>i;){if(n=a[i]=p(arguments[i++]),n==c)return c;n>s&&(s=n)}for(s=s||1;o--;)r+=m(a[o]/s,2);return s*b(r)},imul:function(e,t){var n=65535,r=+e,i=+t,o=n&r,a=n&i;return 0|o*a+((n&r>>>16)*a+o*(n&i>>>16)<<16>>>0)},log1p:function(e){return(e=+e)>-1e-8&&1e-8>e?e-e*e/2:h(1+e)},log10:function(e){return h(e)/Math.LN10},log2:function(e){return h(e)/Math.LN2},sign:i,sinh:function(e){return p(e=+e)<1?(a(e)-a(-e))/2:(d(e-1)-d(-e-1))*(f/2)},tanh:function(e){var t=a(e=+e),n=a(-e);return t==c?1:n==c?-1:(t-n)/(d(e)+d(-e))},trunc:function(e){return(e>0?v:g)(e)}}),s.define=u,n.exports}),e.register("github:maxdavidson/jsTGALoader@master/tga.js!github:systemjs/plugin-text@0.0.2",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=" /**\n * @fileoverview jsTGALoader - Javascript loader for TGA file\n * @author Vincent Thibault\n * @version 1.2.1\n * @blog http://blog.robrowser.com/javascript-tga-loader.html\n */\n\n/* Copyright (c) 2013, Vincent Thibault. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation \n    and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\n\n(function(_global)\n{\n	'use strict';\n\n\n	/**\n	 * TGA Namespace\n	 * @constructor\n	 */\n	function Targa()\n	{\n	}\n\n\n	/**\n	 * @var {object} TGA type constants\n	 */\n	Targa.Type = {\n		NO_DATA:      0,\n		INDEXED:      1,\n		RGB:          2,\n		GREY:         3,\n		RLE_INDEXED:  9,\n		RLE_RGB:     10,\n		RLE_GREY:    11\n	};\n\n\n	/**\n	 * @var {object} TGA origin constants\n	 */\n	Targa.Origin = {\n		BOTTOM_LEFT:  0x00,\n		BOTTOM_RIGHT: 0x01,\n		TOP_LEFT:     0x02,\n		TOP_RIGHT:    0x03,\n		SHIFT:        0x04,\n		MASK:         0x30\n	};\n\n\n	/**\n	 * Check the header of TGA file to detect errors\n	 *\n	 * @param {object} tga header structure\n	 * @throws Error\n	 */\n	function checkHeader( header )\n	{\n		// What the need of a file without data ?\n		if (header.imageType === Targa.Type.NO_DATA) {\n			throw new Error('Targa::checkHeader() - No data');\n		}\n\n		// Indexed type\n		if (header.hasColorMap) {\n			if (header.colorMapLength > 256 || header.colorMapSize !== 24 || header.colorMapType !== 1) {\n				throw new Error('Targa::checkHeader() - Invalid colormap for indexed type');\n			}\n		}\n		else {\n			if (header.colorMapType) {\n				throw new Error('Targa::checkHeader() - Why does the image contain a palette ?');\n			}\n		}\n\n		// Check image size\n		if (header.width <= 0 || header.height <= 0) {\n			throw new Error('Targa::checkHeader() - Invalid image size');\n		}\n\n		// Check pixel size\n		if (header.pixelDepth !== 8  &&\n		    header.pixelDepth !== 16 &&\n		    header.pixelDepth !== 24 &&\n		    header.pixelDepth !== 32) {\n			throw new Error('Targa::checkHeader() - Invalid pixel size \"' + header.pixelDepth + '\"');\n		}\n	}\n\n\n	/**\n	 * Decode RLE compression\n	 *\n	 * @param {Uint8Array} data\n	 * @param {number} offset in data to start loading RLE\n	 * @param {number} pixel count\n	 * @param {number} output buffer size\n	 */\n	function decodeRLE( data, offset, pixelSize, outputSize)\n	{\n		var pos, c, count, i;\n		var pixels, output;\n\n		output = new Uint8Array(outputSize);\n		pixels = new Uint8Array(pixelSize);\n		pos    = 0;\n\n		while (pos < outputSize) {\n			c     = data[offset++];\n			count = (c & 0x7f) + 1;\n\n			// RLE pixels.\n			if (c & 0x80) {\n				// Bind pixel tmp array\n				for (i = 0; i < pixelSize; ++i) {\n					pixels[i] = data[offset++];\n				}\n\n				// Copy pixel array\n				for (i = 0; i < count; ++i) {\n					output.set(pixels, pos);\n					pos += pixelSize;\n				}\n			}\n\n			// Raw pixels.\n			else {\n				count *= pixelSize;\n				for (i = 0; i < count; ++i) {\n					output[pos++] = data[offset++];\n				}\n			}\n		}\n\n		return output;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (8bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} indexes - index to colormap\n	 * @param {Array} colormap\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData8bits(imageData, indexes, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i++) {\n				color = indexes[i];\n				imageData[(x + width * y) * 4 + 3] = 255;\n				imageData[(x + width * y) * 4 + 2] = colormap[(color * 3) + 0];\n				imageData[(x + width * y) * 4 + 1] = colormap[(color * 3) + 1];\n				imageData[(x + width * y) * 4 + 0] = colormap[(color * 3) + 2];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (16bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData16bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 2) {\n				color = pixels[i + 0] | (pixels[i + 1] << 8);\n				imageData[(x + width * y) * 4 + 0] = (color & 0x7C00) >> 7;\n				imageData[(x + width * y) * 4 + 1] = (color & 0x03E0) >> 2;\n				imageData[(x + width * y) * 4 + 2] = (color & 0x001F) >> 3;\n				imageData[(x + width * y) * 4 + 3] = (color & 0x8000) ? 0 : 255;\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (24bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData24bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 3) {\n				imageData[(x + width * y) * 4 + 3] = 255;\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 1];\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 2];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (32bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData32bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 4) {\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 1];\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 2];\n				imageData[(x + width * y) * 4 + 3] = pixels[i + 3];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (8bits grey)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageDataGrey8bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i++) {\n				color = pixels[i];\n				imageData[(x + width * y) * 4 + 0] = color;\n				imageData[(x + width * y) * 4 + 1] = color;\n				imageData[(x + width * y) * 4 + 2] = color;\n				imageData[(x + width * y) * 4 + 3] = 255;\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (16bits grey)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageDataGrey16bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 2) {\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 3] = pixels[i + 1];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Open a targa file using XHR, be aware with Cross Domain files...\n	 *\n	 * @param {string} path - Path of the filename to load\n	 * @param {function} callback - callback to trigger when the file is loaded\n	 */\n	Targa.prototype.open = function targaOpen(path, callback)\n	{\n		var req, tga = this;\n		req = new XMLHttpRequest();\n		req.open('GET', path, true);\n		req.responseType = 'arraybuffer';\n		req.onload = function() {\n			if (this.status === 200) {\n				tga.load(new Uint8Array(req.response));\n				if (callback) {\n					callback.call(tga);\n				}\n			}\n		};\n		req.send(null);\n	};\n\n\n	/**\n	 * Load and parse a TGA file\n	 *\n	 * @param {Uint8Array} data - TGA file buffer array\n	 */\n	Targa.prototype.load = function targaLoad( data )\n	{\n		var offset = 0;\n\n		// Not enough data to contain header ?\n		if (data.length < 0x12) {\n			throw new Error('Targa::load() - Not enough data to contain header');\n		}\n\n		// Read TgaHeader\n		this.header = {\n			/* 0x00  BYTE */  idLength:       data[offset++],\n			/* 0x01  BYTE */  colorMapType:   data[offset++],\n			/* 0x02  BYTE */  imageType:      data[offset++],\n			/* 0x03  WORD */  colorMapIndex:  data[offset++] | data[offset++] << 8,\n			/* 0x05  WORD */  colorMapLength: data[offset++] | data[offset++] << 8,\n			/* 0x07  BYTE */  colorMapDepth:  data[offset++],\n			/* 0x08  WORD */  offsetX:        data[offset++] | data[offset++] << 8,\n			/* 0x0a  WORD */  offsetY:        data[offset++] | data[offset++] << 8,\n			/* 0x0c  WORD */  width:          data[offset++] | data[offset++] << 8,\n			/* 0x0e  WORD */  height:         data[offset++] | data[offset++] << 8,\n			/* 0x10  BYTE */  pixelDepth:     data[offset++],\n			/* 0x11  BYTE */  flags:          data[offset++]\n		};\n\n		// Set shortcut\n		this.header.hasEncoding = (this.header.imageType === Targa.Type.RLE_INDEXED || this.header.imageType === Targa.Type.RLE_RGB   || this.header.imageType === Targa.Type.RLE_GREY);\n		this.header.hasColorMap = (this.header.imageType === Targa.Type.RLE_INDEXED || this.header.imageType === Targa.Type.INDEXED);\n		this.header.isGreyColor = (this.header.imageType === Targa.Type.RLE_GREY    || this.header.imageType === Targa.Type.GREY);\n\n		// Check if a valid TGA file (or if we can load it)\n		checkHeader(this.header);\n\n		// Move to data\n		offset += this.header.idLength;\n		if (offset >= data.length) {\n			throw new Error('Targa::load() - No data');\n		}\n\n		// Read palette\n		if (this.header.hasColorMap) {\n			var colorMapSize  = this.header.colorMapLength * (this.header.colorMapDepth >> 3);\n			this.palette      = data.subarray( offset, offset + colorMapSize);\n			offset           += colorMapSize;\n		}\n\n		var pixelSize  = this.header.pixelDepth >> 3;\n		var imageSize  = this.header.width * this.header.height;\n		var pixelTotal = imageSize * pixelSize;\n\n		// RLE encoded\n		if (this.header.hasEncoding) {\n			this.imageData = decodeRLE(data, offset, pixelSize, pixelTotal);\n		}\n\n		// RAW pixels\n		else {\n			this.imageData = data.subarray( offset, offset + (this.header.hasColorMap ? imageSize : pixelTotal) );\n		}\n	};\n\n\n	/**\n	 * Return a ImageData object from a TGA file\n	 *\n	 * @param {object} imageData - Optional ImageData to work with\n	 * @returns {object} imageData\n	 */\n	Targa.prototype.getImageData = function targaGetImageData( imageData )\n	{\n		var width  = this.header.width;\n		var height = this.header.height;\n		var origin = (this.header.flags & Targa.Origin.MASK) >> Targa.Origin.SHIFT;\n		var x_start, x_step, x_end, y_start, y_step, y_end;\n		var getImageData;\n\n			// Create an imageData\n		if (!imageData) {\n			if (typeof(window) === 'object') {\n				imageData = document.createElement('canvas').getContext('2d').createImageData(width, height);\n			}\n			// In Thread context ?\n			else {\n				imageData = {\n					width:  width,\n					height: height,\n					data: new Uint8ClampedArray(width * height * 4)\n				};\n			}\n		}\n\n		if (origin === Targa.Origin.TOP_LEFT || origin === Targa.Origin.TOP_RIGHT) {\n			y_start = 0;\n			y_step  = 1;\n			y_end   = height;\n		}\n		else {\n			y_start = height - 1;\n			y_step  = -1;\n			y_end   = -1;\n		}\n\n		if (origin === Targa.Origin.TOP_LEFT || origin === Targa.Origin.BOTTOM_LEFT) {\n			x_start = 0;\n			x_step  = 1;\n			x_end   = width;\n		}\n		else {\n			x_start = width - 1;\n			x_step  = -1;\n			x_end   = -1;\n		}\n\n		// TODO: use this.header.offsetX and this.header.offsetY ?\n\n		switch (this.header.pixelDepth) {\n			case 8:\n				getImageData = this.header.isGreyColor ? getImageDataGrey8bits : getImageData8bits;\n				break;\n\n			case 16:\n				getImageData = this.header.isGreyColor ? getImageDataGrey16bits : getImageData16bits;\n				break;\n\n			case 24:\n				getImageData = getImageData24bits;\n				break;\n\n			case 32:\n				getImageData = getImageData32bits;\n				break;\n		}\n\n		getImageData(imageData.data, this.imageData, this.palette, width, y_start, y_step, y_end, x_start, x_step, x_end);\n		return imageData;\n	};\n\n\n	/**\n	 * Return a canvas with the TGA render on it\n	 *\n	 * @returns {object} CanvasElement\n	 */\n	Targa.prototype.getCanvas = function targaGetCanvas()\n	{\n		var canvas, ctx, imageData;\n\n		canvas    = document.createElement('canvas');\n		ctx       = canvas.getContext('2d');\n		imageData = ctx.createImageData(this.header.width, this.header.height);\n\n		canvas.width  = this.header.width;\n		canvas.height = this.header.height;\n\n		ctx.putImageData(this.getImageData(imageData), 0, 0);\n\n		return canvas;\n	};\n\n\n	/**\n	 * Return a dataURI of the TGA file\n	 *\n	 * @param {string} type - Optional image content-type to output (default: image/png)\n	 * @returns {string} url\n	 */\n	Targa.prototype.getDataURL = function targaGetDatURL( type )\n	{\n		return this.getCanvas().toDataURL(type || 'image/png');\n	};\n\n\n	// Find Context\n	var shim = {};\n	if (typeof(exports) === 'undefined') {\n		if (typeof(define) === 'function' && typeof(define.amd) === 'object' && define.amd) {\n			define(function(){\n				return Targa;\n			});\n		} else {\n			// Browser\n			shim.exports = typeof(window) !== 'undefined' ? window : _global;\n		}\n	} \n	else {\n		// Commonjs\n		shim.exports = exports;\n	}\n\n\n	// Export\n	if (shim.exports) {\n		shim.exports.TGA = Targa;\n	}\n\n})(this);\n",
r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/material/shaders/phong.vert.dot!github:maxdavidson/tribus@master/plugins/dot",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){var t="uniform mat4 mvpMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nattribute vec3 vertex;\nattribute vec3 normal;\n\n";return("texture"===e.ambient||"texture"===e.diffuse||"texture"===e.specular)&&(t+="\nattribute vec2 texcoord;\nvarying vec2 lerpTexcoords;\n"),t+="\n\nvarying vec3 worldFragPos;\nvarying vec3 worldNormal;\n\nvoid main() {\n\n    worldFragPos = vec3(modelMatrix * vec4(vertex, 1.0));\n    worldNormal = normalize(normalMatrix * normal);\n\n    ",("texture"===e.ambient||"texture"===e.diffuse||"texture"===e.specular)&&(t+="\n    lerpTexcoords = texcoord;\n    "),t+="\n\n    gl_Position = mvpMatrix * vec4(vertex, 1.0);\n}\n"},r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/material/shaders/phong.frag.dot!github:maxdavidson/tribus@master/plugins/dot",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){var t="\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nprecision mediump float;\n\nstruct DirectionalLight {\n    vec3  direction;\n    vec3  diffuse, specular;\n};\n\nstruct PointLight {\n    vec3  position;\n    vec3  diffuse, specular;\n    float constant, linear, quadratic;\n};\n\nstruct SpotLight {\n    vec3  position, direction;\n    vec3  diffuse, specular;\n    float cutoff, outerCutoff;\n    float constant, linear, quadratic;\n};\n\nstruct Material {\n    lowp float shininess;\n    ";return"static"===e.ambient&&(t+=" vec3 ambient; "),t+="\n    ","static"===e.diffuse&&(t+=" vec3 diffuse; "),t+="\n    ","static"===e.specular&&(t+=" vec3 specular; "),t+="\n};\n\n\nvarying vec3 worldFragPos;\nvarying vec3 worldNormal;\n\nuniform vec3 viewPos;\n\n",("texture"===e.ambient||"texture"===e.diffuse||"texture"===e.specular)&&(t+="\nvarying vec2 lerpTexcoords;\n"),t+="\n\n","texture"===e.ambient&&(t+="\nuniform sampler2D ambientSampler;\nuniform vec4 ambientTexcoordBounds;\n"),t+="\n\n","texture"===e.diffuse&&(t+="\nuniform sampler2D diffuseSampler;\nuniform vec4 diffuseTexcoordBounds;\n"),t+="\n\n","texture"===e.specular&&(t+="\nuniform sampler2D specularSampler;\nuniform vec4 specularTexcoordBounds;\n"),t+="\n\n",e.MAX_DIRECTIONAL_LIGHTS&&(t+="\nuniform DirectionalLight directionalLights["+e.MAX_DIRECTIONAL_LIGHTS+"];\n"),t+="\n\n",e.MAX_POINT_LIGHTS&&(t+="\nuniform PointLight pointLights["+e.MAX_POINT_LIGHTS+"];\n"),t+="\n\n",e.MAX_SPOT_LIGHTS&&(t+="\nuniform SpotLight spotLights["+e.MAX_SPOT_LIGHTS+"];\n"),t+="\n\nuniform Material material;\nuniform vec3 environmentAmbient;\n\nvoid main() {\n\n    ",("texture"===e.ambient||"texture"===e.diffuse||"texture"===e.specular)&&(t+="\n    vec2 fixedLerpTexcoords = fract(lerpTexcoords);\n    "),t+="\n\n    ","texture"===e.ambient&&(t+="\n    vec2 ambientTexcoord = ambientTexcoordBounds.xy + fixedLerpTexcoords * ambientTexcoordBounds.zw;\n    "),t+="\n\n    ","texture"===e.diffuse&&(t+="\n    vec2 diffuseTexcoord = diffuseTexcoordBounds.xy + fixedLerpTexcoords * diffuseTexcoordBounds.zw;\n    "),t+="\n\n    ","texture"===e.specular&&(t+="\n    vec2 specularTexcoord = specularTexcoordBounds.xy + fixedLerpTexcoords * specularTexcoordBounds.zw;\n    "),t+="\n\n    vec3 worldNormal2 = normalize(worldNormal);\n\n    // Direction from fragment to camera\n    vec3 viewDir = normalize(viewPos - worldFragPos);\n    vec3 color = environmentAmbient +  ",t+="texture"===e.ambient?" texture2D(ambientSampler, ambientTexcoord).stp ":" material.ambient ",t+=" ;\n\n    ",e.MAX_DIRECTIONAL_LIGHTS&&(t+="\n    for (int i = 0; i < "+e.MAX_DIRECTIONAL_LIGHTS+"; ++i) {\n        DirectionalLight light = directionalLights[i];\n        \n    vec3 lightDir = -light.direction;\n\n    \n\n    vec3 diffuse = light.diffuse *  ",t+="texture"===e.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",t+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n        color += shade;\n    }\n    "),t+="\n\n    ",e.MAX_POINT_LIGHTS&&(t+="\n    for (int i = 0; i < "+e.MAX_POINT_LIGHTS+"; ++i) {\n        PointLight light = pointLights[i];\n        \n    vec3 direction = light.position - worldFragPos;\n    float distance = length(direction);\n\n    vec3 lightDir = direction / distance;\n\n    \n\n    vec3 diffuse = light.diffuse *  ",t+="texture"===e.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",t+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n    float attenuation = 1.0 / (light.constant + distance * (light.linear + distance * light.quadratic));\n\n    shade += attenuation;\n\n        color += shade;\n    }\n    "),t+="\n\n    ",e.MAX_SPOT_LIGHTS&&(t+="\n    for (int i = 0; i < "+e.MAX_SPOT_LIGHTS+"; ++i) {\n        SpotLight light = spotLights[i];\n        \n    \n    vec3 direction = light.position - worldFragPos;\n    float distance = length(direction);\n\n    vec3 lightDir = direction / distance;\n\n    \n\n    vec3 diffuse = light.diffuse *  ",t+="texture"===e.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",t+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n    float attenuation = 1.0 / (light.constant + distance * (light.linear + distance * light.quadratic));\n\n    shade += attenuation;\n\n\n    float theta = dot(lightDir, light.direction);\n    float epsilon = light.cutoff - light.outerCutoff;\n    float intensity = clamp((theta - light.outerCutoff) / epsilon, 0.0, 1.0);\n\n    shade *= intensity;\n\n        color += shade;\n    }\n    "),t+="\n\n    gl_FragColor = vec4(color, 1.0);\n}\n"},r.define=i,n.exports}),function(){function t(){}t.amd={},function(){var n,r,i,o,a,s,u,c,l,f,m,p,d,h,b,g,v,y,x,w,j,_,E,T,A,S,M,k,L,I,R,O,D,C,$,F,z,N,P,U,B,G,q,W,H,V,X,Y,K,Z,Q,J,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,fe,me,pe,de,he,be,ge,ve,ye={}.hasOwnProperty,xe=function(e,t){function n(){this.constructor=e}for(var r in t)ye.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},we=[].slice,je=function(e,t){return function(){return e.apply(t,arguments)}};n={toString:function(){return"Bacon"}},n.version="0.7.59",p=("undefined"!=typeof global&&null!==global?global:this).Error,ie=function(){},K=function(e,t){return t},q=function(e,t){return e},O=function(e){return e.slice(0)},T=function(e,t){if(!t)throw new p(e)},I=function(e){if(e instanceof g&&!(e instanceof v))throw new p("Observable is not a Property : "+e)},S=function(e){if(!(e instanceof m))throw new p("not an EventStream : "+e)},L=function(e){if(!(e instanceof g))throw new p("not an Observable : "+e)},M=function(e){return T("not a function : "+e,_.isFunction(e))},V=function(e){return e instanceof Array},Y=function(e){return e instanceof g},A=function(e){if(!V(e))throw new p("not an array : "+e)},k=function(e){return T("no arguments supported",0===e.length)},R=function(e){if("string"!=typeof e)throw new p("not a string : "+e)},_={indexOf:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){var n,r,i,o;for(n=r=0,i=e.length;i>r;n=++r)if(o=e[n],t===o)return n;return-1},indexWhere:function(e,t){var n,r,i,o;for(n=r=0,i=e.length;i>r;n=++r)if(o=e[n],t(o))return n;return-1},head:function(e){return e[0]},always:function(e){return function(){return e}},negate:function(e){return function(t){return!e(t)}},empty:function(e){return 0===e.length},tail:function(e){return e.slice(1,e.length)},filter:function(e,t){var n,r,i,o;for(n=[],r=0,i=t.length;i>r;r++)o=t[r],e(o)&&n.push(o);return n},map:function(e,t){var n,r,i,o;for(i=[],n=0,r=t.length;r>n;n++)o=t[n],i.push(e(o));return i},each:function(e,t){var n,r;for(n in e)r=e[n],t(n,r);return void 0},toArray:function(e){return V(e)?e:[e]},contains:function(e,t){return-1!==_.indexOf(e,t)},id:function(e){return e},last:function(e){return e[e.length-1]},all:function(e,t){var n,r,i;for(null==t&&(t=_.id),n=0,r=e.length;r>n;n++)if(i=e[n],!t(i))return!1;return!0},any:function(e,t){var n,r,i;for(null==t&&(t=_.id),n=0,r=e.length;r>n;n++)if(i=e[n],t(i))return!0;return!1},without:function(e,t){return _.filter(function(t){return t!==e},t)},remove:function(e,t){var n;return n=_.indexOf(t,e),n>=0?t.splice(n,1):void 0},fold:function(e,t,n){var r,i,o;for(r=0,i=e.length;i>r;r++)o=e[r],t=n(t,o);return t},flatMap:function(e,t){return _.fold(t,[],function(t,n){return t.concat(e(n))})},cached:function(e){var t;return t=b,function(){return t===b&&(t=e(),e=void 0),t}},isFunction:function(e){return"function"==typeof e},toString:function(e){var t,n,r,i;try{return ae++,null==e?"undefined":_.isFunction(e)?"function":V(e)?ae>5?"[..]":"["+_.map(_.toString,e).toString()+"]":null!=(null!=e?e.toString:void 0)&&e.toString!==Object.prototype.toString?e.toString():"object"==typeof e?ae>5?"{..}":(n=function(){var n;n=[];for(r in e)ye.call(e,r)&&(i=function(){try{return e[r]}catch(n){return t=n}}(),n.push(_.toString(r)+":"+_.toString(i)));return n}(),"{"+n+"}"):e}finally{ae--}}},ae=0,n._=_,j=n.UpdateBarrier=function(){var e,t,r,i,o,a,s,u,c,l,f,m,p,d;return l=void 0,f=[],m={},t=[],r=0,e=function(e){return l?t.push(e):e()},p=function(e,t){var n;return l?(n=m[e.id],null==n?(n=m[e.id]=[t],f.push(e)):n.push(t)):t()},o=function(){for(;f.length>0;)s(0);return void 0},s=function(e){var t,n,r,i,o,s;for(i=f[e],o=i.id,s=m[o],f.splice(e,1),delete m[o],a(i),n=0,r=s.length;r>n;n++)(t=s[n])();return void 0},a=function(e){var t,n,r,i,o;for(n=e.internalDeps(),i=0,o=n.length;o>i;i++)t=n[i],a(t),m[t.id]&&(r=_.indexOf(f,t),s(r));return void 0},c=function(e,n,i,a){var s,u;if(l)return i.apply(n,a);l=e;try{u=i.apply(n,a),o()}finally{for(l=void 0;r<t.length;)s=t[r],r++,s();r=0,t=[]}return u},i=function(){return l?l.id:void 0},d=function(t,r){var i,o,a,s;return s=!1,o=!1,i=function(){return o=!0},a=function(){return s=!0,i()},i=t.dispatcher.subscribe(function(t){return e(function(){var e;return s||(e=r(t),e!==n.noMore)?void 0:a()})}),o&&i(),a},u=function(){return f.length>0},{whenDoneWith:p,hasWaiters:u,inTransaction:c,currentEventId:i,wrappedSubscribe:d,afterTransaction:e}}(),w=function(){function e(e,t,n){this.obs=e,this.sync=t,this.lazy=null!=n?n:!1,this.queue=[]}return e.prototype.subscribe=function(e){return this.obs.dispatcher.subscribe(e)},e.prototype.toString=function(){return this.obs.toString()},e.prototype.markEnded=function(){return this.ended=!0},e.prototype.consume=function(){return this.lazy?{value:_.always(this.queue[0])}:this.queue[0]},e.prototype.push=function(e){return this.queue=[e]},e.prototype.mayHave=function(){return!0},e.prototype.hasAtLeast=function(){return this.queue.length},e.prototype.flatten=!0,e}(),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return xe(t,e),t.prototype.consume=function(){return this.queue.shift()},t.prototype.push=function(e){return this.queue.push(e)},t.prototype.mayHave=function(e){return!this.ended||this.queue.length>=e},t.prototype.hasAtLeast=function(e){return this.queue.length>=e},t.prototype.flatten=!1,t}(w),r=function(e){function t(e){t.__super__.constructor.call(this,e,!0)}return xe(t,e),t.prototype.consume=function(){var e;return e=this.queue,this.queue=[],{value:function(){return e}}},t.prototype.push=function(e){return this.queue.push(e.value())},t.prototype.hasAtLeast=function(){return!0},t}(w),w.isTrigger=function(e){return e instanceof w?e.sync:e instanceof m},w.fromObservable=function(e){return e instanceof w?e:e instanceof v?new w(e,!1):new a(e,!0)},s=function(){function e(e,t,n){this.context=e,this.method=t,this.args=n,this.cached=void 0}return e.prototype.deps=function(){return this.cached||(this.cached=U([this.context].concat(this.args)))},e.prototype.apply=function(e){return e.desc=this,e},e.prototype.toString=function(){return _.toString(this.context)+"."+_.toString(this.method)+"("+_.map(_.toString,this.args)+")"},e}(),F=function(){var e,t,n;return t=arguments[0],n=arguments[1],e=3<=arguments.length?we.call(arguments,2):[],(t||n)instanceof s?t||n:new s(t,n,e)},ge=function(){var e,t,n;return e=2<=arguments.length?we.call(arguments,0,t=arguments.length-1):(t=0,[]),n=arguments[t++],F.apply(null,e).apply(n)},U=function(e){return V(e)?_.flatMap(U,e):Y(e)?[e]:e instanceof w?[e.obs]:[]},ve=function(e){return function(){var t,n,r,i;return r=arguments[0],t=2<=arguments.length?we.call(arguments,1):[],"object"==typeof r&&t.length&&(n=r,i=t[0],r=function(){return n[i].apply(n,arguments)},t=t.slice(1)),e.apply(null,[r].concat(we.call(t)))}},J=function(e){return e=Array.prototype.slice.call(e),ee.apply(null,e)},oe=function(e,t){return function(){var n;return n=1<=arguments.length?we.call(arguments,0):[],e.apply(null,t.concat(n))}},he=function(e){return function(t){return function(n){var r;return null==n?void 0:(r=n[t],_.isFunction(r)?r.apply(n,e):r)}}},me=function(e,t){var n,r;return r=e.slice(1).split("."),n=_.map(he(t),r),function(t){var r,i;for(r=0,i=n.length;i>r;r++)e=n[r],t=e(t);return t}},X=function(e){return"string"==typeof e&&e.length>1&&"."===e.charAt(0)},ee=ve(function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],_.isFunction(t)?e.length?oe(t,e):t:X(t)?me(t,e):_.always(t)}),Q=function(e,t){return ee.apply(null,[e].concat(we.call(t)))},$=function(e,t,n,r){var i;return t instanceof v?(i=t.sampledBy(e,function(e,t){return[e,t]}),r.call(i,function(e){var t,n;return t=e[0],n=e[1],t}).map(function(e){var t,n;return t=e[0],n=e[1]})):(t=Q(t,n),r.call(e,t))},le=function(e){var t;if(_.isFunction(e))return e;if(X(e))return t=pe(e),function(e,n){return e[t](n)};throw new p("not a function or a field key: "+e)},pe=function(e){return e.slice(1)},x=function(){function e(e){this.value=e}return e.prototype.getOrElse=function(){return this.value},e.prototype.get=function(){return this.value},e.prototype.filter=function(t){return t(this.value)?new e(this.value):b},e.prototype.map=function(t){return new e(t(this.value))},e.prototype.forEach=function(e){return e(this.value)},e.prototype.isDefined=!0,e.prototype.toArray=function(){return[this.value]},e.prototype.inspect=function(){return"Some("+this.value+")"},e.prototype.toString=function(){return this.inspect()},e}(),b={getOrElse:function(e){return e},filter:function(){return b},map:function(){return b},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},de=function(e){return e instanceof x||e===b?e:new x(e)},n.noMore=["<no-more>"],n.more=["<more>"],N=0,f=function(){function e(){this.id=++N}return e.prototype.isEvent=function(){return!0},e.prototype.isEnd=function(){return!1},e.prototype.isInitial=function(){return!1},e.prototype.isNext=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.hasValue=function(){return!1},e.prototype.filter=function(){return!0},e.prototype.inspect=function(){return this.toString()},e.prototype.log=function(){return this.toString()},e}(),h=function(e){function t(e,n){t.__super__.constructor.call(this),!n&&_.isFunction(e)||e instanceof t?(this.valueF=e,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=e)}return xe(t,e),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.value=function(){return this.valueF instanceof t?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},t.prototype.fmap=function(e){var t,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return e(n)})):(t=this,this.apply(function(){return e(t.value())}))},t.prototype.apply=function(e){return new t(e)},t.prototype.filter=function(e){return e(this.value())},t.prototype.toString=function(){return _.toString(this.value())},t.prototype.log=function(){return this.value()},t}(f),d=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return xe(t,e),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(e){return new t(e)},t.prototype.toNext=function(){return new h(this)},t}(h),c=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return xe(t,e),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<end>"},t}(f),l=function(e){function t(e){this.error=e}return xe(t,e),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<error> "+_.toString(this.error)},t}(f),n.Event=f,n.Initial=d,n.Next=h,n.End=c,n.Error=l,H=function(e){return new d(e,!0)},re=function(e){return new h(e,!0)},z=function(){return new c},fe=function(e){return e instanceof f?e:re(e)},W=0,ue=function(){},g=function(){function e(e){this.id=++W,ge(e,this),this.initialDesc=this.desc}return e.prototype.subscribe=function(e){return j.wrappedSubscribe(this,e)},e.prototype.subscribeInternal=function(e){return this.dispatcher.subscribe(e)},e.prototype.onValue=function(){var e;return e=J(arguments),this.subscribe(function(t){return t.hasValue()?e(t.value()):void 0})},e.prototype.onValues=function(e){return this.onValue(function(t){return e.apply(null,t)})},e.prototype.onError=function(){var e;return e=J(arguments),this.subscribe(function(t){return t.isError()?e(t.error):void 0})},e.prototype.onEnd=function(){var e;return e=J(arguments),this.subscribe(function(t){return t.isEnd()?e():void 0})},e.prototype.name=function(e){return this._name=e,this},e.prototype.withDescription=function(){return F.apply(null,arguments).apply(this)},e.prototype.toString=function(){return this._name?this._name:this.desc.toString()},e.prototype.internalDeps=function(){return this.initialDesc.deps()},e}(),g.prototype.assign=g.prototype.onValue,g.prototype.forEach=g.prototype.onValue,g.prototype.inspect=g.prototype.toString,n.Observable=g,o=function(){function e(e){var t,n,r;for(null==e&&(e=[]),this.unsubscribe=je(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],t=0,n=e.length;n>t;t++)r=e[t],this.add(r)}return e.prototype.add=function(e){var t,n,r;if(!this.unsubscribed)return t=!1,n=ie,this.starting.push(e),r=function(r){return function(){return r.unsubscribed?void 0:(t=!0,r.remove(n),_.remove(e,r.starting))}}(this),n=e(this.unsubscribe,r),this.unsubscribed||t?n():this.subscriptions.push(n),_.remove(e,this.starting),n},e.prototype.remove=function(e){return this.unsubscribed?void 0:void 0!==_.remove(e,this.subscriptions)?e():void 0},e.prototype.unsubscribe=function(){var e,t,n,r;if(!this.unsubscribed){for(this.unsubscribed=!0,n=this.subscriptions,e=0,t=n.length;t>e;e++)(r=n[e])();return this.subscriptions=[],this.starting=[]}},e.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},e.prototype.empty=function(){return 0===this.count()},e}(),n.CompositeUnsubscribe=o,u=function(){function e(e,t){this._subscribe=e,this._handleEvent=t,this.subscribe=je(this.subscribe,this),this.handleEvent=je(this.handleEvent,this),this.subscriptions=[],this.queue=[],this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0}return e.prototype.hasSubscribers=function(){return this.subscriptions.length>0},e.prototype.removeSub=function(e){return this.subscriptions=_.without(e,this.subscriptions)},e.prototype.push=function(e){return e.isEnd()&&(this.ended=!0),j.inTransaction(e,this,this.pushIt,[e])},e.prototype.pushToSubscriptions=function(e){var t,r,i,o,a,s;try{for(s=this.subscriptions,r=0,i=s.length;i>r;r++)a=s[r],o=a.sink(e),(o===n.noMore||e.isEnd())&&this.removeSub(a);return!0}catch(u){throw t=u,this.pushing=!1,this.queue=[],t}},e.prototype.pushIt=function(e){if(this.pushing)return this.queue.push(e),n.more;if(e!==this.prevError){for(e.isError()&&(this.prevError=e),this.pushing=!0,this.pushToSubscriptions(e),this.pushing=!1;this.queue.length;)e=this.queue.shift(),this.push(e);return this.hasSubscribers()?n.more:(this.unsubscribeFromSource(),n.noMore)}},e.prototype.handleEvent=function(e){return this._handleEvent?this._handleEvent(e):this.push(e)},e.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},e.prototype.subscribe=function(e){var t;return this.ended?(e(z()),ie):(M(e),t={sink:e},this.subscriptions.push(t),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),M(this.unsubSrc)),function(e){return function(){return e.removeSub(t),e.hasSubscribers()?void 0:e.unsubscribeFromSource()}}(this))},e}(),m=function(e){function t(e,n,r){_.isFunction(e)&&(r=n,n=e,e=[]),t.__super__.constructor.call(this,e),M(n),this.dispatcher=new u(n,r),ue(this)}return xe(t,e),t.prototype.toProperty=function(e){var t,r;return r=0===arguments.length?b:de(function(){return e}),t=this.dispatcher,new v(F(this,"toProperty",e),function(e){var i,o,a,s;return i=!1,s=ie,o=n.more,a=function(){return i?void 0:r.forEach(function(t){return i=!0,o=e(new d(t)),o===n.noMore?(s(),s=ie):void 0})},s=t.subscribe(function(t){return t.hasValue()?i&&t.isInitial()?n.more:(t.isInitial()||a(),i=!0,r=new x(t),e(t)):(t.isEnd()&&(o=a()),o!==n.noMore?e(t):void 0)}),a(),s})},t.prototype.toEventStream=function(){return this},t.prototype.withHandler=function(e){return new t(F(this,"withHandler",e),this.dispatcher.subscribe,e)},t}(g),n.EventStream=m,n.never=function(){return new m(F(n,"never"),function(e){return e(z()),ie})},n.when=function(){var e,t,r,i,o,a,s,u,c,l,f,p,d,h,b,g,v,y,x,E;if(0===arguments.length)return n.never();for(s=arguments.length,E="when: expecting arguments in the form (Observable+,function)+",T(E,s%2===0),y=[],d=[],t=0,h=[];s>t;){for(h[t]=arguments[t],h[t+1]=arguments[t+1],p=_.toArray(arguments[t]),e=D(arguments[t+1]),f={f:e,ixs:[]},x=!1,o=0,u=p.length;u>o;o++){for(v=p[o],r=_.indexOf(y,v),x||(x=w.isTrigger(v)),0>r&&(y.push(v),r=y.length-1),b=f.ixs,a=0,c=b.length;c>a;a++)i=b[a],i.index===r&&i.count++;f.ixs.push({index:r,count:1})}T("At least one EventStream required",x||!p.length),p.length>0&&d.push(f),t+=2}return y.length?(y=_.map(w.fromObservable,y),l=_.any(y,function(e){return e.flatten})&&C(_.map(function(e){return e.obs},y)),g=new m(F.apply(null,[n,"when"].concat(we.call(h))),function(e){var r,i,o,a,s,u,c;return c=[],o=!1,a=function(e){var n,r,i;for(i=e.ixs,n=0,r=i.length;r>n;n++)if(t=i[n],!y[t.index].hasAtLeast(t.count))return!1;return!0},i=function(e){return!e.sync||e.ended},r=function(e){var n,r,i;for(i=e.ixs,n=0,r=i.length;r>n;n++)if(t=i[n],!y[t.index].mayHave(t.count))return!0},s=function(e){return!e.source.flatten},u=function(u){return function(f){var m,p,h;return p=function(){return j.whenDoneWith(g,m)},h=function(){var r,i,o,u,l,f;if(!(c.length>0))return n.more;for(l=n.more,f=c.pop(),i=0,o=d.length;o>i;i++)if(u=d[i],a(u))return r=function(){var e,n,r,i;for(r=u.ixs,i=[],n=0,e=r.length;e>n;n++)t=r[n],i.push(y[t.index].consume());return i}(),l=e(f.e.apply(function(){var e,t;return t=function(){var t,n,i;for(i=[],n=0,t=r.length;t>n;n++)e=r[n],i.push(e.value());return i}(),u.f.apply(u,t)})),c.length&&(c=_.filter(s,c)),l===n.noMore?l:h()},m=function(){var t;return t=h(),o&&(o=!1,(_.all(y,i)||_.all(d,r))&&(t=n.noMore,e(z()))),t===n.noMore&&f(),t},u.subscribe(function(t){var r;return t.isEnd()?(o=!0,u.markEnded(),p()):t.isError()?r=e(t):(u.push(t),u.sync&&(c.push({source:u,e:t}),l||j.hasWaiters()?p():m())),r===n.noMore&&f(),r||n.more})}},new n.CompositeUnsubscribe(function(){var e,t,n;for(n=[],e=0,t=y.length;t>e;e++)v=y[e],n.push(u(v));return n}()).unsubscribe})):n.never()},C=function(e,t){var n;return null==t&&(t=[]),n=function(e){var r;return _.contains(t,e)?!0:(r=e.internalDeps(),r.length?(t.push(e),_.any(r,n)):(t.push(e),!1))},_.any(e,n)},D=function(e){return _.isFunction(e)?e:_.always(e)},n.groupSimultaneous=function(){var e,t,i;return i=1<=arguments.length?we.call(arguments,0):[],1===i.length&&V(i[0])&&(i=i[0]),t=function(){var t,n,o;for(o=[],t=0,n=i.length;n>t;t++)e=i[t],o.push(new r(e));return o}(),ge.apply(null,[n,"groupSimultaneous"].concat(we.call(i),[n.when(t,function(){var e;return e=1<=arguments.length?we.call(arguments,0):[]})]))},y=function(e){function t(e,n,r){this.property=e,this.subscribe=je(this.subscribe,this),t.__super__.constructor.call(this,n,r),this.current=b,this.currentValueRootId=void 0,this.propertyEnded=!1}return xe(t,e),t.prototype.push=function(e){return e.isEnd()&&(this.propertyEnded=!0),e.hasValue()&&(this.current=new x(e),this.currentValueRootId=j.currentEventId()),t.__super__.push.call(this,e)},t.prototype.maybeSubSource=function(e,t){return t===n.noMore?ie:this.propertyEnded?(e(z()),ie):u.prototype.subscribe.call(this,e)},t.prototype.subscribe=function(e){var t,r,i,o;return r=!1,i=n.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(t=j.currentEventId(),o=this.currentValueRootId,!this.propertyEnded&&o&&t&&t!==o?(j.whenDoneWith(this.property,function(t){return function(){return t.currentValueRootId===o?e(H(t.current.get().value())):void 0}}(this)),this.maybeSubSource(e,i)):(j.inTransaction(void 0,this,function(){return i=e(H(this.current.get().value()))},[]),this.maybeSubSource(e,i))):this.maybeSubSource(e,i)},t}(u),v=function(e){function t(e,n,r){_.isFunction(e)&&(r=n,n=e,e=[]),t.__super__.constructor.call(this,e),M(n),this.dispatcher=new y(this,n,r),ue(this)}return xe(t,e),t.prototype.changes=function(){return new m(F(this,"changes"),function(e){return function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()?void 0:t(e)})}}(this))},t.prototype.withHandler=function(e){return new t(F(this,"withHandler",e),this.dispatcher.subscribe,e)},t.prototype.toProperty=function(){return k(arguments),this},t.prototype.toEventStream=function(){return new m(F(this,"toEventStream"),function(e){return function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()&&(e=e.toNext()),t(e)})}}(this))},t}(g),n.Property=v,n.constant=function(e){return new v(F(n,"constant",e),function(t){return t(H(e)),t(z()),ie})},n.fromBinder=function(e,t){return null==t&&(t=_.id),new m(F(n,"fromBinder",e,t),function(r){var i,o,a,s;return s=!1,i=!1,o=function(){return s?void 0:"undefined"!=typeof a&&null!==a?(a(),s=!0):i=!0},a=e(function(){var e,i,a,s,u,c;for(e=1<=arguments.length?we.call(arguments,0):[],c=t.apply(this,e),V(c)&&_.last(c)instanceof f||(c=[c]),u=n.more,a=0,s=c.length;s>a;a++)if(i=c[a],u=r(i=fe(i)),u===n.noMore||i.isEnd())return o(),u;return u}),i&&o(),o})},P=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],B=function(e){var t,n,r,i;for(t=0,n=P.length;n>t;t++)if(i=P[t],r=[e[i[0]],e[i[1]]],r[0]&&r[1])return r;throw new l("No suitable event methods in "+e)},n.fromEventTarget=function(e,t,r){var i,o,a;return i=B(e),o=i[0],a=i[1],ge(n,"fromEvent",e,t,n.fromBinder(function(n){return o.call(e,t,n),function(){return a.call(e,t,n)}},r))},n.fromEvent=n.fromEventTarget,n.Observable.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],$(this,t,e,function(e){return ge(this,"map",e,this.withHandler(function(t){return this.push(t.fmap(e))}))})},n.combineAsArray=function(){var e,t,r,i,o,a,s;for(s=1<=arguments.length?we.call(arguments,0):[],1===s.length&&V(s[0])&&(s=s[0]),e=t=0,r=s.length;r>t;e=++t)a=s[e],Y(a)||(s[e]=n.constant(a));return s.length?(o=function(){var e,t,n;for(n=[],e=0,t=s.length;t>e;e++)i=s[e],n.push(new w(i,!0));return n}(),ge.apply(null,[n,"combineAsArray"].concat(we.call(s),[n.when(o,function(){var e;return e=1<=arguments.length?we.call(arguments,0):[]}).toProperty()]))):n.constant([])},n.onValues=function(){var e,t,r;return r=2<=arguments.length?we.call(arguments,0,t=arguments.length-1):(t=0,[]),e=arguments[t++],n.combineAsArray(r).onValues(e)},n.combineWith=function(){var e,t;return e=arguments[0],t=2<=arguments.length?we.call(arguments,1):[],ge.apply(null,[n,"combineWith",e].concat(we.call(t),[n.combineAsArray(t).map(function(t){return e.apply(null,t)})]))},n.combineTemplate=function(e){var t,r,i,o,a,s,u,c,l,f;return u=[],f=[],s=function(e){return e[e.length-1]},l=function(e,t,n){return s(e)[t]=n},t=function(e,t){return function(n,r){return l(n,e,r[t])}},a=function(e,t){return function(n){return l(n,e,t)}},c=function(e){return V(e)?[]:{}},i=function(e,n){var r,i;return Y(n)?(f.push(n),u.push(t(e,f.length-1))):n!==Object(n)||"function"==typeof n||n instanceof RegExp||n instanceof Date?u.push(a(e,n)):(i=function(e){return function(t){var r;return r=c(n),l(t,e,r),t.push(r)}},r=function(e){return e.pop()},u.push(i(e)),o(n),u.push(r))},o=function(e){return _.each(e,i)},o(e),r=function(t){var n,r,i,o,a;for(a=c(e),n=[a],i=0,o=u.length;o>i;i++)(r=u[i])(n,t);return a},ge(n,"combineTemplate",e,n.combineAsArray(f).map(r))},n.Observable.prototype.combine=function(e,t){var r;return r=le(t),ge(this,"combine",e,t,n.combineAsArray(this,e).map(function(e){return r(e[0],e[1])}))},n.Observable.prototype.decode=function(e){return ge(this,"decode",e,this.combine(n.combineTemplate(e),function(e,t){return t[e]}))},n.Observable.prototype.withStateMachine=function(e,t){var r;return r=e,ge(this,"withStateMachine",e,t,this.withHandler(function(e){var i,o,a,s,u,c,l;for(i=t(r,e),s=i[0],c=i[1],r=s,l=n.more,o=0,a=c.length;a>o;o++)if(u=c[o],l=this.push(u),l===n.noMore)return l;return l}))},n.Observable.prototype.skipDuplicates=function(e){return null==e&&(e=function(e,t){return e===t}),ge(this,"skipDuplicates",this.withStateMachine(b,function(t,n){return n.hasValue()?n.isInitial()||t===b||!e(t.get(),n.value())?[new x(n.value()),[n]]:[t,[]]:[t,[n]]}))},n.Observable.prototype.awaiting=function(e){return ge(this,"awaiting",e,n.groupSimultaneous(this,e).map(function(e){var t,n;return t=e[0],n=e[1],0===n.length}).toProperty(!1).skipDuplicates())},n.Observable.prototype.not=function(){return ge(this,"not",this.map(function(e){return!e}))},n.Property.prototype.and=function(e){return ge(this,"and",e,this.combine(e,function(e,t){return e&&t}))},n.Property.prototype.or=function(e){return ge(this,"or",e,this.combine(e,function(e,t){return e||t}))},n.scheduler={setTimeout:function(e,t){
return setTimeout(e,t)},setInterval:function(e,t){return setInterval(e,t)},clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)},now:function(){return(new Date).getTime()}},n.EventStream.prototype.bufferWithTime=function(e){return ge(this,"bufferWithTime",e,this.bufferWithTimeOrCount(e,Number.MAX_VALUE))},n.EventStream.prototype.bufferWithCount=function(e){return ge(this,"bufferWithCount",e,this.bufferWithTimeOrCount(void 0,e))},n.EventStream.prototype.bufferWithTimeOrCount=function(e,t){var n;return n=function(n){return n.values.length===t?n.flush():void 0!==e?n.schedule():void 0},ge(this,"bufferWithTimeOrCount",e,t,this.buffer(e,n,n))},n.EventStream.prototype.buffer=function(e,t,r){var i,o,a;return null==t&&(t=ie),null==r&&(r=ie),i={scheduled:null,end:void 0,values:[],flush:function(){var e;if(this.scheduled&&(n.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){if(e=this.push(re(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(e!==n.noMore)return r(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:this.scheduled=e(function(e){return function(){return e.flush()}}(this))}},a=n.more,_.isFunction(e)||(o=e,e=function(e){return n.scheduler.setTimeout(e,o)}),ge(this,"buffer",this.withHandler(function(e){return i.push=function(e){return function(t){return e.push(t)}}(this),e.isError()?a=this.push(e):e.isEnd()?(i.end=e,i.scheduled||i.flush()):(i.values.push(e.value()),t(i)),a}))},n.Observable.prototype.filter=function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],I(t),$(this,t,e,function(e){return ge(this,"filter",e,this.withHandler(function(t){return t.filter(e)?this.push(t):n.more}))})},n.once=function(e){return new m(F(n,"once",e),function(t){return t(fe(e)),t(z()),ie})},n.EventStream.prototype.concat=function(e){var t;return t=this,new m(F(t,"concat",e),function(n){var r,i;return i=ie,r=t.dispatcher.subscribe(function(t){return t.isEnd()?i=e.dispatcher.subscribe(n):n(t)}),function(){return r(),i()}})},n.Observable.prototype.flatMap=function(){return G(this,ne(arguments))},n.Observable.prototype.flatMapFirst=function(){return G(this,ne(arguments),!0)},G=function(e,t,r,i){var a,s,u;return u=[e],a=[],s=new m(F(e,"flatMap"+(r?"First":""),t),function(s){var u,c,l,f,m;return l=new o,f=[],m=function(e){var r;return r=te(t(e.value())),a.push(r),l.add(function(e,t){return r.dispatcher.subscribe(function(i){var o;return i.isEnd()?(_.remove(r,a),c(),u(t),n.noMore):(i instanceof d&&(i=i.toNext()),o=s(i),o===n.noMore&&e(),o)})})},c=function(){var e;return e=f.shift(),e?m(e):void 0},u=function(e){return e(),l.empty()?s(z()):void 0},l.add(function(t,o){return e.dispatcher.subscribe(function(e){return e.isEnd()?u(o):e.isError()?s(e):r&&l.count()>1?n.more:l.unsubscribed?n.noMore:i&&l.count()>i?f.push(e):m(e)})}),l.unsubscribe}),s.internalDeps=function(){return a.length?u.concat(a):u},s},ne=function(e){return 1===e.length&&Y(e[0])?_.always(e[0]):J(e)},te=function(e){return Y(e)?e:n.once(e)},n.Observable.prototype.flatMapWithConcurrencyLimit=function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],ge.apply(null,[this,"flatMapWithConcurrencyLimit",t].concat(we.call(e),[G(this,ne(e),!1,t)]))},n.Observable.prototype.flatMapConcat=function(){return ge.apply(null,[this,"flatMapConcat"].concat(we.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(we.call(arguments)))]))},n.later=function(e,t){return ge(n,"later",e,t,n.fromBinder(function(r){var i,o;return o=function(){return r([t,z()])},i=n.scheduler.setTimeout(o,e),function(){return n.scheduler.clearTimeout(i)}}))},n.Observable.prototype.bufferingThrottle=function(e){return ge(this,"bufferingThrottle",e,this.flatMapConcat(function(t){return n.once(t).concat(n.later(e).filter(!1))}))},n.Property.prototype.bufferingThrottle=function(){return n.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},i=function(e){function t(){this.guardedSink=je(this.guardedSink,this),this.subscribeAll=je(this.subscribeAll,this),this.unsubAll=je(this.unsubAll,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,t.__super__.constructor.call(this,F(n,"Bus"),this.subscribeAll)}return xe(t,e),t.prototype.unsubAll=function(){var e,t,n,r;for(n=this.subscriptions,e=0,t=n.length;t>e;e++)r=n[e],"function"==typeof r.unsub&&r.unsub();return void 0},t.prototype.subscribeAll=function(e){var t,n,r,i;if(this.ended)e(z());else for(this.sink=e,r=O(this.subscriptions),t=0,n=r.length;n>t;t++)i=r[t],this.subscribeInput(i);return this.unsubAll},t.prototype.guardedSink=function(e){return function(t){return function(r){return r.isEnd()?(t.unsubscribeInput(e),n.noMore):t.sink(r)}}(this)},t.prototype.subscribeInput=function(e){return e.unsub=e.input.dispatcher.subscribe(this.guardedSink(e.input))},t.prototype.unsubscribeInput=function(e){var t,n,r,i,o;for(i=this.subscriptions,t=n=0,r=i.length;r>n;t=++n)if(o=i[t],o.input===e)return"function"==typeof o.unsub&&o.unsub(),void this.subscriptions.splice(t,1)},t.prototype.plug=function(e){var t;return L(e),this.ended?void 0:(t={input:e},this.subscriptions.push(t),null!=this.sink&&this.subscribeInput(t),function(t){return function(){return t.unsubscribeInput(e)}}(this))},t.prototype.end=function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(z()):void 0},t.prototype.push=function(e){return this.ended?void 0:"function"==typeof this.sink?this.sink(re(e)):void 0},t.prototype.error=function(e){return"function"==typeof this.sink?this.sink(new l(e)):void 0},t}(m),n.Bus=i,Z=function(e,t){return ve(function(){var r,i,o;return i=arguments[0],r=2<=arguments.length?we.call(arguments,1):[],o=oe(t,[function(e,t){return i.apply(null,we.call(e).concat([t]))}]),ge.apply(null,[n,e,i].concat(we.call(r),[n.combineAsArray(r).flatMap(o)]))})},n.fromCallback=Z("fromCallback",function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],n.fromBinder(function(n){return Q(t,e)(n),ie},function(e){return[e,z()]})}),n.fromNodeCallback=Z("fromNodeCallback",function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],n.fromBinder(function(n){return Q(t,e)(n),ie},function(e,t){return e?[new l(e),z()]:[t,z()]})}),E=function(e,t){var r;return r=new m(F(e,"justInitValue"),function(t){var i,o;return o=void 0,i=e.dispatcher.subscribe(function(e){return e.isEnd()||(o=e),n.noMore}),j.whenDoneWith(r,function(){return null!=o&&t(o),t(z())}),i}),r.concat(t).toProperty()},n.Observable.prototype.mapEnd=function(){var e;return e=J(arguments),ge(this,"mapEnd",e,this.withHandler(function(t){return t.isEnd()?(this.push(re(e(t))),this.push(z()),n.noMore):this.push(t)}))},n.Observable.prototype.skipErrors=function(){return ge(this,"skipErrors",this.withHandler(function(e){return e.isError()?n.more:this.push(e)}))},n.EventStream.prototype.takeUntil=function(e){var t;return t={},ge(this,"takeUntil",e,n.groupSimultaneous(this.mapEnd(t),e.skipErrors()).withHandler(function(r){var i,o,a,s,u,c;if(r.hasValue()){if(s=r.value(),i=s[0],e=s[1],e.length)return this.push(z());for(u=n.more,o=0,a=i.length;a>o;o++)c=i[o],u=c===t?this.push(z()):this.push(re(c));return u}return this.push(r)}))},n.Property.prototype.takeUntil=function(e){var t;return t=this.changes().takeUntil(e),ge(this,"takeUntil",e,E(this,t))},n.Observable.prototype.flatMapLatest=function(){var e,t;return e=ne(arguments),t=this.toEventStream(),ge(this,"flatMapLatest",e,t.flatMap(function(n){return te(e(n)).takeUntil(t)}))},n.Property.prototype.delayChanges=function(){var e,t,n;return e=2<=arguments.length?we.call(arguments,0,n=arguments.length-1):(n=0,[]),t=arguments[n++],ge.apply(null,[this].concat(we.call(e),[E(this,t(this.changes()))]))},n.EventStream.prototype.delay=function(e){return ge(this,"delay",e,this.flatMap(function(t){return n.later(e,t)}))},n.Property.prototype.delay=function(e){return this.delayChanges("delay",e,function(t){return t.delay(e)})},n.EventStream.prototype.debounce=function(e){return ge(this,"debounce",e,this.flatMapLatest(function(t){return n.later(e,t)}))},n.Property.prototype.debounce=function(e){return this.delayChanges("debounce",e,function(t){return t.debounce(e)})},n.EventStream.prototype.debounceImmediate=function(e){return ge(this,"debounceImmediate",e,this.flatMapFirst(function(t){return n.once(t).concat(n.later(e).filter(!1))}))},n.Observable.prototype.scan=function(e,t){var r,i,o;return t=le(t),r=de(e),o=function(e){return function(o){var a,s,u,c;return a=!1,c=ie,s=n.more,u=function(){return a?void 0:r.forEach(function(e){return a=!0,s=o(new d(function(){return e})),s===n.noMore?(c(),c=ie):void 0})},c=e.dispatcher.subscribe(function(e){var i,c;return e.hasValue()?a&&e.isInitial()?n.more:(e.isInitial()||u(),a=!0,c=r.getOrElse(void 0),i=t(c,e.value()),r=new x(i),o(e.apply(function(){return i}))):(e.isEnd()&&(s=u()),s!==n.noMore?o(e):void 0)}),j.whenDoneWith(i,u),c}}(this),i=new v(F(this,"scan",e,t),o)},n.Observable.prototype.diff=function(e,t){return t=le(t),ge(this,"diff",e,t,this.scan([e],function(e,n){return[n,t(e[0],n)]}).filter(function(e){return 2===e.length}).map(function(e){return e[1]}))},n.Observable.prototype.doAction=function(){var e;return e=J(arguments),ge(this,"doAction",e,this.withHandler(function(t){return t.hasValue()&&e(t.value()),this.push(t)}))},n.Observable.prototype.doError=function(){var e;return e=J(arguments),ge(this,"doError",e,this.withHandler(function(t){return t.isError()&&e(t.error),this.push(t)}))},n.Observable.prototype.endOnError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],null==t&&(t=!0),$(this,t,e,function(e){return ge(this,"endOnError",this.withHandler(function(t){return t.isError()&&e(t.error)?(this.push(t),this.push(z())):this.push(t)}))})},g.prototype.errors=function(){return ge(this,"errors",this.filter(function(){return!1}))},be=function(e){return[e,z()]},n.fromPromise=function(e,t){return ge(n,"fromPromise",e,n.fromBinder(function(n){var r;return null!=(r=e.then(n,function(e){return n(new l(e))}))&&"function"==typeof r.done&&r.done(),function(){return t&&"function"==typeof e.abort?e.abort():void 0}},be))},n.Observable.prototype.mapError=function(){var e;return e=J(arguments),ge(this,"mapError",e,this.withHandler(function(t){return t.isError()?this.push(re(e(t.error))):this.push(t)}))},n.Observable.prototype.flatMapError=function(e){return ge(this,"flatMapError",e,this.mapError(function(e){return new l(e)}).flatMap(function(t){return t instanceof l?e(t.error):n.once(t)}))},n.EventStream.prototype.sampledBy=function(e,t){return ge(this,"sampledBy",e,t,this.toProperty().sampledBy(e,t))},n.Property.prototype.sampledBy=function(e,t){var r,i,o,a,s;return null!=t?t=le(t):(r=!0,t=function(e){return e.value()}),s=new w(this,!1,r),o=new w(e,!0,r),a=n.when([s,o],t),i=e instanceof v?a.toProperty():a,ge(this,"sampledBy",e,t,i)},n.Property.prototype.sample=function(e){return ge(this,"sample",e,this.sampledBy(n.interval(e,{})))},n.Observable.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],t instanceof v?t.sampledBy(this,q):$(this,t,e,function(e){return ge(this,"map",e,this.withHandler(function(t){return this.push(t.fmap(e))}))})},n.Observable.prototype.fold=function(e,t){return ge(this,"fold",e,t,this.scan(e,t).sampledBy(this.filter(!1).mapEnd().toProperty()))},g.prototype.reduce=g.prototype.fold,n.fromPoll=function(e,t){return ge(n,"fromPoll",e,t,n.fromBinder(function(t){var r;return r=n.scheduler.setInterval(t,e),function(){return n.scheduler.clearInterval(r)}},t))},n.EventStream.prototype.merge=function(e){var t;return S(e),t=this,ge(t,"merge",e,n.mergeAll(this,e))},n.mergeAll=function(){var e;return e=1<=arguments.length?we.call(arguments,0):[],V(e[0])&&(e=e[0]),e.length?new m(F.apply(null,[n,"mergeAll"].concat(we.call(e))),function(t){var r,i,o;return r=0,o=function(i){return function(o){return i.dispatcher.subscribe(function(i){var a;return i.isEnd()?(r++,r===e.length?t(z()):n.more):(a=t(i),a===n.noMore&&o(),a)})}},i=_.map(o,e),new n.CompositeUnsubscribe(i).unsubscribe}):n.never()},n.Observable.prototype.take=function(e){return 0>=e?n.never():ge(this,"take",e,this.withHandler(function(t){return t.hasValue()?(e--,e>0?this.push(t):(0===e&&this.push(t),this.push(z()),n.noMore)):this.push(t)}))},n.fromArray=function(e){var t;return A(e),e.length?(t=0,new m(F(n,"fromArray",e),function(r){var i,o,a,s,u;return u=!1,s=n.more,a=!1,o=!1,i=function(){var c;if(o=!0,!a){for(a=!0;o;)o=!1,s===n.noMore||u||(c=e[t++],s=r(fe(c)),s!==n.noMore&&(t===e.length?r(z()):j.afterTransaction(i)));return a=!1}},i(),function(){return u=!0}})):ge(n,"fromArray",e,n.never())},n.EventStream.prototype.holdWhen=function(e){var t,r,i;return i=e.startWith(!1),r=i.filter(function(e){return!e}),t=i.filter(_.id),ge(this,"holdWhen",e,this.filter(!1).merge(i.flatMapConcat(function(e){return function(i){return i?e.scan([],function(e,t){return e.concat([t])}).sampledBy(r).take(1).flatMap(n.fromArray):e.takeUntil(t)}}(this))))},n.interval=function(e,t){return null==t&&(t={}),ge(n,"interval",e,t,n.fromPoll(e,function(){return re(t)}))},n.$={},n.$.asEventStream=function(e,t,r){var i;return _.isFunction(t)&&(i=[t,void 0],r=i[0],t=i[1]),ge(this.selector||this,"asEventStream",e,n.fromBinder(function(n){return function(r){return n.on(e,t,r),function(){return n.off(e,t,r)}}}(this),r))},null!=(se="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:void 0)&&(se.fn.asEventStream=n.$.asEventStream),n.Observable.prototype.log=function(){var e;return e=1<=arguments.length?we.call(arguments,0):[],this.subscribe(function(t){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log.apply(console,we.call(e).concat([t.log()])):void 0}),this},n.repeatedly=function(e,t){var r;return r=0,ge(n,"repeatedly",e,t,n.fromPoll(e,function(){return t[r++%t.length]}))},n.repeat=function(e){var t;return t=0,n.fromBinder(function(r){var i,o,a,s,u;return i=!1,a=n.more,u=function(){},o=function(e){return e.isEnd()?i?s():i=!0:a=r(e)},s=function(){var s;for(i=!0;i&&a!==n.noMore;)s=e(t++),i=!1,s?u=s.subscribeInternal(o):r(z());return i=!0},s(),function(){return u()}})},n.retry=function(e){var t,r,i,o,a,s,u;if(!_.isFunction(e.source))throw new p("'source' option has to be a function");return u=e.source,s=e.retries||0,a=e.maxRetries||s,t=e.delay||function(){return 0},o=e.isRetryable||function(){return!0},i=!1,r=null,ge(n,"retry",e,n.repeat(function(){var e,c,l;return i?null:(l=function(){return u().endOnError().withHandler(function(e){return e.isError()?(r=e,o(r.error)&&s>0?void 0:(i=!0,this.push(e))):(e.hasValue()&&(r=null,i=!0),this.push(e))})},r?(e={error:r.error,retriesDone:a-s},c=n.later(t(e)).filter(!1),s-=1,c.concat(n.once().flatMap(l))):l())}))},n.sequentially=function(e,t){var r;return r=0,ge(n,"sequentially",e,t,n.fromPoll(e,function(){var e;return e=t[r++],r<t.length?e:r===t.length?[e,z()]:z()}))},n.Observable.prototype.skip=function(e){return ge(this,"skip",e,this.withHandler(function(t){return t.hasValue()&&e>0?(e--,n.more):this.push(t)}))},n.EventStream.prototype.skipUntil=function(e){var t;return t=e.take(1).map(!0).toProperty(!1),ge(this,"skipUntil",e,this.filter(t))},n.EventStream.prototype.skipWhile=function(){var e,t,r;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],I(t),r=!1,$(this,t,e,function(e){return ge(this,"skipWhile",e,this.withHandler(function(t){return!r&&t.hasValue()&&e(t.value())?n.more:(t.hasValue()&&(r=!0),this.push(t))}))})},n.Observable.prototype.slidingWindow=function(e,t){return null==t&&(t=0),ge(this,"slidingWindow",e,t,this.scan([],function(t,n){return t.concat([n]).slice(-e)}).filter(function(e){return e.length>=t}))},n.spy=function(e){return ce.push(e)},ce=[],ue=function(e){var t,n,r;if(ce.length&&!ue.running)try{for(ue.running=!0,t=0,n=ce.length;n>t;t++)(r=ce[t])(e)}finally{delete ue.running}return void 0},n.Property.prototype.startWith=function(e){return ge(this,"startWith",e,this.scan(e,function(e,t){return t}))},n.EventStream.prototype.startWith=function(e){return ge(this,"startWith",e,n.once(e).concat(this))},n.Observable.prototype.takeWhile=function(){var e,t;return t=arguments[0],e=2<=arguments.length?we.call(arguments,1):[],I(t),$(this,t,e,function(e){return ge(this,"takeWhile",e,this.withHandler(function(t){return t.filter(e)?this.push(t):(this.push(z()),n.noMore)}))})},n.update=function(){var e,t,r,i;for(t=arguments[0],i=2<=arguments.length?we.call(arguments,1):[],r=function(e){return function(){var t;return t=1<=arguments.length?we.call(arguments,0):[],function(n){return e.apply(null,[n].concat(t))}}},e=i.length-1;e>0;)i[e]instanceof Function||(i[e]=function(e){return function(){return e}}(i[e])),i[e]=r(i[e]),e-=2;return ge.apply(null,[n,"update",t].concat(we.call(i),[n.when.apply(n,i).scan(t,function(e,t){return t(e)})]))},n.zipAsArray=function(){var e;return e=1<=arguments.length?we.call(arguments,0):[],V(e[0])&&(e=e[0]),ge.apply(null,[n,"zipAsArray"].concat(we.call(e),[n.zipWith(e,function(){var e;return e=1<=arguments.length?we.call(arguments,0):[]})]))},n.zipWith=function(){var e,t,r;return e=arguments[0],r=2<=arguments.length?we.call(arguments,1):[],_.isFunction(e)||(t=[e,r[0]],r=t[0],e=t[1]),r=_.map(function(e){return e.toEventStream()},r),ge.apply(null,[n,"zipWith",e].concat(we.call(r),[n.when(r,e)]))},n.Observable.prototype.zip=function(e,t){return null==t&&(t=Array),ge(this,"zip",e,n.zipWith([this,e],t))},n.Observable.prototype.first=function(){return ge(this,"first",this.take(1))},n.Observable.prototype.last=function(){var e;return ge(this,"last",this.withHandler(function(t){return t.isEnd()?(e&&this.push(e),this.push(z()),n.noMore):void(e=t)}))},n.EventStream.prototype.throttle=function(e){return ge(this,"throttle",e,this.bufferWithTime(e).map(function(e){return e[e.length-1]}))},n.Property.prototype.throttle=function(e){return this.delayChanges("throttle",e,function(t){return t.throttle(e)})},g.prototype.firstToPromise=function(e){var t=this;if("function"!=typeof e){if("function"!=typeof Promise)throw new p("There isn't default Promise, use shim or parameter");e=Promise}return new e(function(e,r){return t.subscribe(function(t){return t.hasValue()&&e(t.value()),t.isError()&&r(t.error),n.noMore})})},g.prototype.toPromise=function(e){return this.last().firstToPromise(e)},"undefined"!=typeof t&&null!==t&&null!=t.amd?(e.register("github:baconjs/bacon.js@0.7.59/dist/Bacon",[],!1,function(e,t,r){return function(){return n}.call(this)}),this.Bacon=n):"undefined"!=typeof module&&null!==module&&null!=module.exports?(module.exports=n,n.Bacon=n):this.Bacon=n}.call(this)}(),function(){function t(){}t.amd={},!function(n,r){"undefined"!=typeof module?module.exports=r():"function"==typeof t&&"object"==typeof t.amd?e.register("github:ded/domready@1.0.8/ready",[],!1,"function"==typeof r?r:function(){return r}):this[n]=r()}("domready",function(){var e,t=[],n=document,r=n.documentElement.doScroll,i="DOMContentLoaded",o=(r?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);return o||n.addEventListener(i,e=function(){for(n.removeEventListener(i,e),o=1;e=t.shift();)e()}),function(e){o?setTimeout(e,0):t.push(e)}})}(),e.register("npm:core-js@0.9.12/library/modules/$",["npm:core-js@0.9.12/library/modules/$.fw"],!0,function(require,t,n){function r(e){return isNaN(e=+e)?0:(e>0?b:h)(e)}function i(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function o(e,t,n){return e[t]=n,e}function a(e){return y?function(t,n,r){return w.setDesc(t,n,i(e,r))}:o}function s(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function u(e){return"function"==typeof e}function c(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}var l=e.global,f=l.define;l.define=void 0;var l="undefined"!=typeof self?self:Function("return this")(),m={},p=Object.defineProperty,d={}.hasOwnProperty,h=Math.ceil,b=Math.floor,g=Math.max,v=Math.min,y=!!function(){try{return 2==p({},"a",{get:function(){return 2}}).a}catch(e){}}(),x=a(1),w=n.exports=require("npm:core-js@0.9.12/library/modules/$.fw")({g:l,core:m,html:l.document&&document.documentElement,isObject:s,isFunction:u,it:function(e){return e},that:function(){return this},toInteger:r,toLength:function(e){return e>0?v(r(e),9007199254740991):0},toIndex:function(e,t){return e=r(e),0>e?g(e+t,0):v(e,t)},has:function(e,t){return d.call(e,t)},create:Object.create,getProto:Object.getPrototypeOf,DESC:y,desc:i,getDesc:Object.getOwnPropertyDescriptor,setDesc:p,setDescs:Object.defineProperties,getKeys:Object.keys,getNames:Object.getOwnPropertyNames,getSymbols:Object.getOwnPropertySymbols,assertDefined:c,ES5Object:Object,toObject:function(e){return w.ES5Object(c(e))},hide:x,def:a(0),set:l.Symbol?o:x,each:[].forEach});return"undefined"!=typeof __e&&(__e=m),"undefined"!=typeof __g&&(__g=l),l.define=f,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.wks",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.shared","npm:core-js@0.9.12/library/modules/$.uid"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var r=require("npm:core-js@0.9.12/library/modules/$").g,o=require("npm:core-js@0.9.12/library/modules/$.shared")("wks");return n.exports=function(e){return o[e]||(o[e]=r.Symbol&&r.Symbol[e]||require("npm:core-js@0.9.12/library/modules/$.uid").safe("Symbol."+e))},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.iter",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.cof","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.wks","npm:core-js@0.9.12/library/modules/$.shared"],!0,function(require,t,n){function r(e,t){a.hide(e,c,t),l in[]&&a.hide(e,l,t)}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.9.12/library/modules/$"),s=require("npm:core-js@0.9.12/library/modules/$.cof"),u=require("npm:core-js@0.9.12/library/modules/$.assert").obj,c=require("npm:core-js@0.9.12/library/modules/$.wks")("iterator"),l="@@iterator",f=require("npm:core-js@0.9.12/library/modules/$.shared")("iterators"),m={};return r(m,a.that),n.exports={BUGGY:"keys"in[]&&!("next"in[].keys()),Iterators:f,step:function(e,t){return{value:t,done:!!e}},is:function(e){var t=Object(e),n=a.g.Symbol,r=n&&n.iterator||l;return r in t||c in t||a.has(f,s.classof(t))},get:function(e){var t=a.g.Symbol,n=e[t&&t.iterator||l],r=n||e[c]||f[s.classof(e)];return u(r.call(e))},set:r,create:function(e,t,n,r){e.prototype=a.create(r||m,{next:a.desc(1,n)}),s.set(e,t+" Iterator")}},i.define=o,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.iter-define",["npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.redef","npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.cof","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.def"),a=require("npm:core-js@0.9.12/library/modules/$.redef"),s=require("npm:core-js@0.9.12/library/modules/$"),u=require("npm:core-js@0.9.12/library/modules/$.cof"),c=require("npm:core-js@0.9.12/library/modules/$.iter"),l=require("npm:core-js@0.9.12/library/modules/$.wks")("iterator"),f="@@iterator",m="keys",p="values",d=c.Iterators;return n.exports=function(e,t,n,r,i,h,b){function g(e){function t(t){return new n(t,e)}switch(e){case m:return function(){return t(this)};case p:return function(){return t(this)}}return function(){return t(this)}}c.create(n,t,r);var v,y,x=t+" Iterator",w=e.prototype,j=w[l]||w[f]||i&&w[i],_=j||g(i);if(j){var E=s.getProto(_.call(new e));u.set(E,x,!0),s.FW&&s.has(w,f)&&c.set(E,s.that)}if(s.FW&&c.set(w,_),d[t]=_,d[x]=s.that,i)if(v={keys:h?_:g(m),values:i==p?_:g(p),entries:i!=p?_:g("entries")},b)for(y in v)y in w||a(w,y,v[y]);else o(o.P+o.F*c.BUGGY,t,v)},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.array.iterator",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.unscope","npm:core-js@0.9.12/library/modules/$.uid","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.iter-define"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.unscope"),s=require("npm:core-js@0.9.12/library/modules/$.uid").safe("iter"),u=require("npm:core-js@0.9.12/library/modules/$.iter"),c=u.step,l=u.Iterators;return require("npm:core-js@0.9.12/library/modules/$.iter-define")(Array,"Array",function(e,t){o.set(this,s,{o:o.toObject(e),i:0,k:t})},function(){var e=this[s],t=e.o,n=e.k,r=e.i++;return!t||r>=t.length?(e.o=void 0,c(1)):"keys"==n?c(0,r):"values"==n?c(0,t[r]):c(0,[r,t[r]])},"values"),l.Arguments=l.Array,a("keys"),a("values"),a("entries"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.for-of",["npm:core-js@0.9.12/library/modules/$.ctx","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.iter-call"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.ctx"),a=require("npm:core-js@0.9.12/library/modules/$.iter").get,s=require("npm:core-js@0.9.12/library/modules/$.iter-call");return n.exports=function(e,t,n,r){for(var i,u=a(e),c=o(n,r,t?2:1);!(i=u.next()).done;)if(s(u,c,i.value,t)===!1)return s.close(u)},r.define=i,n.exports}),e.register("npm:process@0.10.1",["npm:process@0.10.1/browser"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:process@0.10.1/browser"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.collection-weak",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.uid","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.for-of","npm:core-js@0.9.12/library/modules/$.array-methods","npm:core-js@0.9.12/library/modules/$.mix"],!0,function(require,t,n){function r(e,t){return x(e.array,function(e){return e[0]===t})}function i(e){return e[v]||p(e,v,{array:[],get:function(e){var t=r(this,e);return t?t[1]:void 0},has:function(e){return!!r(this,e)},set:function(e,t){var n=r(this,e);n?n[1]=t:this.array.push([e,t])},"delete":function(e){var t=w(this.array,function(t){return t[0]===e});return~t&&this.array.splice(t,1),!!~t}})[v]}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.9.12/library/modules/$"),u=require("npm:core-js@0.9.12/library/modules/$.uid").safe,c=require("npm:core-js@0.9.12/library/modules/$.assert"),l=require("npm:core-js@0.9.12/library/modules/$.for-of"),f=s.has,m=s.isObject,p=s.hide,d=Object.isExtensible||m,h=0,b=u("id"),g=u("weak"),v=u("leak"),y=require("npm:core-js@0.9.12/library/modules/$.array-methods"),x=y(5),w=y(6);return n.exports={getConstructor:function(e,t,n){function r(){s.set(c.inst(this,r,e),b,h++);var i=arguments[0];void 0!=i&&l(i,t,this[n],this)}return require("npm:core-js@0.9.12/library/modules/$.mix")(r.prototype,{"delete":function(e){return m(e)?d(e)?f(e,g)&&f(e[g],this[b])&&delete e[g][this[b]]:i(this)["delete"](e):!1},has:function(e){return m(e)?d(e)?f(e,g)&&f(e[g],this[b]):i(this).has(e):!1}}),r},def:function(e,t,n){return d(c.obj(t))?(f(t,g)||p(t,g,{}),t[g][e[b]]=n):i(e).set(t,n),e},leakStore:i,WEAK:g,ID:b},o.define=a,n.exports}),e.register("npm:core-js@0.9.12/library/fn/weak-set",["npm:core-js@0.9.12/library/modules/es6.object.to-string","npm:core-js@0.9.12/library/modules/web.dom.iterable","npm:core-js@0.9.12/library/modules/es6.weak-set","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.to-string"),require("npm:core-js@0.9.12/library/modules/web.dom.iterable"),require("npm:core-js@0.9.12/library/modules/es6.weak-set"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.WeakSet,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/get-iterator",["npm:core-js@0.9.12/library/modules/web.dom.iterable","npm:core-js@0.9.12/library/modules/es6.string.iterator","npm:core-js@0.9.12/library/modules/core.iter-helpers","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/web.dom.iterable"),require("npm:core-js@0.9.12/library/modules/es6.string.iterator"),require("npm:core-js@0.9.12/library/modules/core.iter-helpers"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.getIterator,r.define=i,n.exports}),function(){function t(){}t.amd={},e.register("github:toji/gl-matrix@2.2.1",["github:toji/gl-matrix@2.2.1/dist/gl-matrix"],!1,function(e,t,n){return function(e){return e}.call(this,e("github:toji/gl-matrix@2.2.1/dist/gl-matrix"))})}(),e.register("npm:core-js@0.9.12/library/fn/object/keys",["npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.statics-accept-primitives"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Object.keys,r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/object/define-property",["npm:core-js@0.9.12/library/fn/object/define-property"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/object/define-property"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.map",["npm:core-js@0.9.12/library/modules/$.collection-strong","npm:core-js@0.9.12/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.collection-strong");return require("npm:core-js@0.9.12/library/modules/$.collection")("Map",{get:function(e){var t=o.getEntry(this,e);return t&&t.v},set:function(e,t){return o.def(this,0===e?0:e,t)}},o,!0),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es7.map.to-json",["npm:core-js@0.9.12/library/modules/$.collection-to-json"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/$.collection-to-json")("Map"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/set",["npm:core-js@0.9.12/library/modules/es6.object.to-string","npm:core-js@0.9.12/library/modules/es6.string.iterator","npm:core-js@0.9.12/library/modules/web.dom.iterable","npm:core-js@0.9.12/library/modules/es6.set","npm:core-js@0.9.12/library/modules/es7.set.to-json","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.to-string"),require("npm:core-js@0.9.12/library/modules/es6.string.iterator"),require("npm:core-js@0.9.12/library/modules/web.dom.iterable"),require("npm:core-js@0.9.12/library/modules/es6.set"),require("npm:core-js@0.9.12/library/modules/es7.set.to-json"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Set,r.define=i,n.exports}),e.register("github:mrdoob/stats.js@master",["github:mrdoob/stats.js@master/src/Stats"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("github:mrdoob/stats.js@master/src/Stats"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/symbol/iterator",["npm:core-js@0.9.12/library/fn/symbol/iterator"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/symbol/iterator"),__esModule:!0
},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.symbol",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.cof","npm:core-js@0.9.12/library/modules/$.uid","npm:core-js@0.9.12/library/modules/$.shared","npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.redef","npm:core-js@0.9.12/library/modules/$.keyof","npm:core-js@0.9.12/library/modules/$.enum-keys","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){function r(e){var t=C[e]=p.set(_(k.prototype),I,e);return p.DESC&&L&&T(Object.prototype,e,{configurable:!0,set:function(t){j(this,R)&&j(this[R],e)&&(this[R][e]=!1),T(this,e,A(1,t))}}),t}function i(e,t,n){return n&&j(C,t)&&(n.enumerable?(j(e,R)&&e[R][t]&&(e[R][t]=!1),n=_(n,{enumerable:A(0,!1)})):(j(e,R)||T(e,R,A(1,{})),e[R][t]=!0)),T(e,t,n)}function o(e,t){w(e);for(var n,r=x(t=M(t)),o=0,a=r.length;a>o;)i(e,n=r[o++],t[n]);return e}function a(e,t){return void 0===t?_(e):o(_(e),t)}function s(e){var t=O.call(this,e);return t||!j(this,e)||!j(C,e)||j(this,R)&&this[R][e]?t:!0}function u(e,t){var n=E(e=M(e),t);return!n||!j(C,t)||j(e,R)&&e[R][t]||(n.enumerable=!0),n}function c(e){for(var t,n=S(M(e)),r=[],i=0;n.length>i;)j(C,t=n[i++])||t==R||r.push(t);return r}function l(e){for(var t,n=S(M(e)),r=[],i=0;n.length>i;)j(C,t=n[i++])&&r.push(C[t]);return r}var f=e.global,m=f.define;f.define=void 0;var p=require("npm:core-js@0.9.12/library/modules/$"),d=require("npm:core-js@0.9.12/library/modules/$.cof").set,h=require("npm:core-js@0.9.12/library/modules/$.uid"),b=require("npm:core-js@0.9.12/library/modules/$.shared"),g=require("npm:core-js@0.9.12/library/modules/$.def"),v=require("npm:core-js@0.9.12/library/modules/$.redef"),y=require("npm:core-js@0.9.12/library/modules/$.keyof"),x=require("npm:core-js@0.9.12/library/modules/$.enum-keys"),w=require("npm:core-js@0.9.12/library/modules/$.assert").obj,j=p.has,_=p.create,E=p.getDesc,T=p.setDesc,A=p.desc,S=p.getNames,M=p.toObject,k=p.g.Symbol,L=!1,I=h("tag"),R=h("hidden"),O={}.propertyIsEnumerable,D=b("symbol-registry"),C=b("symbols"),$=p.isFunction(k);$||(k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor");return r(h(arguments[0]))},v(k.prototype,"toString",function(){return this[I]}),p.create=a,p.setDesc=i,p.getDesc=u,p.setDescs=o,p.getNames=c,p.getSymbols=l,p.DESC&&p.FW&&v(Object.prototype,"propertyIsEnumerable",s,!0));var F={"for":function(e){return j(D,e+="")?D[e]:D[e]=k(e)},keyFor:function(e){return y(D,e)},useSetter:function(){L=!0},useSimple:function(){L=!1}};return p.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=require("npm:core-js@0.9.12/library/modules/$.wks")(e);F[e]=$?t:r(t)}),L=!0,g(g.G+g.W,{Symbol:k}),g(g.S,"Symbol",F),g(g.S+g.F*!$,"Object",{create:a,defineProperty:i,defineProperties:o,getOwnPropertyDescriptor:u,getOwnPropertyNames:c,getOwnPropertySymbols:l}),d(k,"Symbol"),d(Math,"Math",!0),d(p.g.JSON,"JSON",!0),f.define=m,n.exports}),e.register("npm:core-js@0.9.12/library/fn/array/from",["npm:core-js@0.9.12/library/modules/es6.string.iterator","npm:core-js@0.9.12/library/modules/es6.array.from","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.string.iterator"),require("npm:core-js@0.9.12/library/modules/es6.array.from"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Array.from,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/math/sign/index",["npm:es5-ext@0.10.7/math/sign/is-implemented","npm:es5-ext@0.10.7/math/sign/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/math/sign/is-implemented")()?Math.sign:require("npm:es5-ext@0.10.7/math/sign/shim"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/_iterate",["npm:es5-ext@0.10.7/object/is-callable","npm:es5-ext@0.10.7/object/valid-callable","npm:es5-ext@0.10.7/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/is-callable"),a=require("npm:es5-ext@0.10.7/object/valid-callable"),s=require("npm:es5-ext@0.10.7/object/valid-value"),u=Function.prototype.call,c=Object.keys,l=Object.prototype.propertyIsEnumerable;return n.exports=function(e,t){return function(n,r){var i,f=arguments[2],m=arguments[3];return n=Object(s(n)),a(r),i=c(n),m&&i.sort(o(m)?m.bind(n):void 0),i[e](function(e,i){return l.call(n,e)?u.call(r,f,n[e],e,n,i):t})}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/keys/index",["npm:es5-ext@0.10.7/object/keys/is-implemented","npm:es5-ext@0.10.7/object/keys/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/object/keys/is-implemented")()?Object.keys:require("npm:es5-ext@0.10.7/object/keys/shim"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/function/_define-length",["npm:es5-ext@0.10.7/number/to-pos-integer","npm:es5-ext@0.10.7/object/mixin"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a,s,u,c=require("npm:es5-ext@0.10.7/number/to-pos-integer"),l=function(e,t){};try{Object.defineProperty(l,"length",{configurable:!0,writable:!1,enumerable:!1,value:1})}catch(f){}return 1===l.length?(o={configurable:!0,writable:!1,enumerable:!1},a=Object.defineProperty,n.exports=function(e,t){return t=c(t),e.length===t?e:(o.value=t,a(e,"length",o))}):(u=require("npm:es5-ext@0.10.7/object/mixin"),s=function(){var e=[];return function(t){var n,r=0;if(e[t])return e[t];for(n=[];t--;)n.push("a"+(++r).toString(36));return new Function("fn","return function ("+n.join(", ")+") { return fn.apply(this, arguments); };")}}(),n.exports=function(e,t){var n;if(t=c(t),e.length===t)return e;n=s(t)(e);try{u(n,e)}catch(r){}return n}),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/string/#/contains/index",["npm:es5-ext@0.10.7/string/#/contains/is-implemented","npm:es5-ext@0.10.7/string/#/contains/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/string/#/contains/is-implemented")()?String.prototype.contains:require("npm:es5-ext@0.10.7/string/#/contains/shim"),r.define=i,n.exports}),e.register("npm:event-emitter@0.3.3",["npm:event-emitter@0.3.3/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:event-emitter@0.3.3/index"),r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/validate-symbol",["npm:es6-symbol@2.0.1/is-symbol"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es6-symbol@2.0.1/is-symbol");return n.exports=function(e){if(!o(e))throw new TypeError(e+" is not a symbol");return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/function/is-function",["npm:es5-ext@0.10.7/function/noop"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call(require("npm:es5-ext@0.10.7/function/noop"));return n.exports=function(e){return"function"==typeof e&&o.call(e)===a},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get",["npm:es5-ext@0.10.7/array/#/e-index-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/array/#/e-index-of"),a=Object.create;return n.exports=function(){var e=0,t=[],n=a(null);return{get:function(e){var n,r=0,i=t,a=e.length;if(0===a)return i[a]||null;if(i=i[a]){for(;a-1>r;){if(n=o.call(i[0],e[r]),-1===n)return null;i=i[1][n],++r}return n=o.call(i[0],e[r]),-1===n?null:i[1][n]||null}return null},set:function(r){var i,a=0,s=t,u=r.length;if(0===u)s[u]=++e;else{for(s[u]||(s[u]=[[],[]]),s=s[u];u-1>a;)i=o.call(s[0],r[a]),-1===i&&(i=s[0].push(r[a])-1,s[1].push([[],[]])),s=s[1][i],++a;i=o.call(s[0],r[a]),-1===i&&(i=s[0].push(r[a])-1),s[1][i]=++e}return n[e]=r,e},"delete":function(e){var r,i=0,a=t,s=n[e],u=s.length,c=[];if(0===u)delete a[u];else if(a=a[u]){for(;u-1>i;){if(r=o.call(a[0],s[i]),-1===r)return;c.push(a,r),a=a[1][r],++i}if(r=o.call(a[0],s[i]),-1===r)return;for(e=a[1][r],a[0].splice(r,1),a[1].splice(r,1);!a[0].length&&c.length;)r=c.pop(),a=c.pop(),a[0].splice(r,1),a[1].splice(r,1)}delete n[e]},clear:function(){t=[],n=a(null)}}},r.define=i,n.exports}),e.register("npm:next-tick@0.2.2",["npm:next-tick@0.2.2/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:next-tick@0.2.2/index"),r.define=i,n.exports}),e.register("npm:timers-ext@0.1.0/valid-timeout",["npm:es5-ext@0.10.7/number/to-pos-integer","npm:timers-ext@0.1.0/max-timeout"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/number/to-pos-integer"),a=require("npm:timers-ext@0.1.0/max-timeout");return n.exports=function(e){if(e=o(e),e>a)throw new TypeError(e+" exceeds maximum possible timeout");return e},r.define=i,n.exports}),e.register("npm:lru-queue@0.1.0",["npm:lru-queue@0.1.0/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:lru-queue@0.1.0/index"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/object/seal",["npm:core-js@0.9.12/library/fn/object/seal"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/object/seal"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/object/freeze",["npm:core-js@0.9.12/library/fn/object/freeze"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/object/freeze"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.object.assign",["npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.assign"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.def");return o(o.S,"Object",{assign:require("npm:core-js@0.9.12/library/modules/$.assign")}),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/math/log2",["npm:core-js@0.9.12/library/modules/es6.math","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.math"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Math.log2,r.define=i,n.exports}),function(){function t(){}t.amd={},e.register("github:baconjs/bacon.js@0.7.59",["github:baconjs/bacon.js@0.7.59/dist/Bacon"],!1,function(e,t,n){return function(e){return e}.call(this,e("github:baconjs/bacon.js@0.7.59/dist/Bacon"))})}(),function(){function t(){}t.amd={},e.register("github:ded/domready@1.0.8",["github:ded/domready@1.0.8/ready"],!1,function(e,t,n){return function(e){return e}.call(this,e("github:ded/domready@1.0.8/ready"))})}(),e.register("npm:core-js@0.9.12/library/fn/object/create",["npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$");return n.exports=function(e,t){return o.create(e,t)},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.cof",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){function r(e){return u.call(e).slice(8,-1)}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.9.12/library/modules/$"),s=require("npm:core-js@0.9.12/library/modules/$.wks")("toStringTag"),u={}.toString;return r.classof=function(e){var t,n;return void 0==e?void 0===e?"Undefined":"Null":"string"==typeof(n=(t=Object(e))[s])?n:r(t)},r.set=function(e,t,n){e&&!a.has(e=n?e:e.prototype,s)&&a.hide(e,s,t)},n.exports=r,i.define=o,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.string.iterator",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.string-at","npm:core-js@0.9.12/library/modules/$.uid","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.iter-define"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$").set,a=require("npm:core-js@0.9.12/library/modules/$.string-at")(!0),s=require("npm:core-js@0.9.12/library/modules/$.uid").safe("iter"),u=require("npm:core-js@0.9.12/library/modules/$.iter"),c=u.step;return require("npm:core-js@0.9.12/library/modules/$.iter-define")(String,"String",function(e){o(this,s,{o:String(e),i:0})},function(){var e,t=this[s],n=t.o,r=t.i;return r>=n.length?c(1):(e=a(n,r),t.i+=e.length,c(0,e))}),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/web.dom.iterable",["npm:core-js@0.9.12/library/modules/es6.array.iterator","npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.iter","npm:core-js@0.9.12/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.array.iterator");var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.iter").Iterators,s=require("npm:core-js@0.9.12/library/modules/$.wks")("iterator"),u=a.Array,c=o.g.NodeList,l=o.g.HTMLCollection,f=c&&c.prototype,m=l&&l.prototype;return o.FW&&(!c||s in f||o.hide(f,s,u),!l||s in m||o.hide(m,s,u)),a.NodeList=a.HTMLCollection=u,r.define=i,n.exports}),e.register("github:jspm/nodelibs-process@0.1.1/index",["npm:process@0.10.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=e._nodeRequire?process:require("npm:process@0.10.1"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.weak-map",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.collection-weak","npm:core-js@0.9.12/library/modules/$.collection","npm:core-js@0.9.12/library/modules/$.redef"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$"),a=require("npm:core-js@0.9.12/library/modules/$.collection-weak"),s=a.leakStore,u=a.ID,c=a.WEAK,l=o.has,f=o.isObject,m=Object.isExtensible||f,p={},d=require("npm:core-js@0.9.12/library/modules/$.collection")("WeakMap",{get:function(e){if(f(e)){if(!m(e))return s(this).get(e);if(l(e,c))return e[c][this[u]]}},set:function(e,t){return a.def(this,e,t)}},a,!0,!0);return o.FW&&7!=(new d).set((Object.freeze||Object)(p),7).get(p)&&o.each.call(["delete","has","get","set"],function(e){var t=d.prototype,n=t[e];require("npm:core-js@0.9.12/library/modules/$.redef")(t,e,function(t,r){if(f(t)&&!m(t)){var i=s(this)[e](t,r);return"set"==e?this:i}return n.call(this,t,r)})}),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/weak-set",["npm:core-js@0.9.12/library/fn/weak-set"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/weak-set"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/get-iterator",["npm:core-js@0.9.12/library/fn/get-iterator"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/get-iterator"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/object/keys",["npm:core-js@0.9.12/library/fn/object/keys"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/object/keys"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/helpers/create-class",["npm:babel-runtime@5.4.7/core-js/object/define-property"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:babel-runtime@5.4.7/core-js/object/define-property")["default"];return t["default"]=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),o(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),t.__esModule=!0,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/map",["npm:core-js@0.9.12/library/modules/es6.object.to-string","npm:core-js@0.9.12/library/modules/es6.string.iterator","npm:core-js@0.9.12/library/modules/web.dom.iterable","npm:core-js@0.9.12/library/modules/es6.map","npm:core-js@0.9.12/library/modules/es7.map.to-json","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.to-string"),require("npm:core-js@0.9.12/library/modules/es6.string.iterator"),require("npm:core-js@0.9.12/library/modules/web.dom.iterable"),require("npm:core-js@0.9.12/library/modules/es6.map"),require("npm:core-js@0.9.12/library/modules/es7.map.to-json"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Map,r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/set",["npm:core-js@0.9.12/library/fn/set"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/set"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/symbol/index",["npm:core-js@0.9.12/library/modules/es6.symbol","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.symbol"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Symbol,r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/array/from",["npm:core-js@0.9.12/library/fn/array/from"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/array/from"),__esModule:!0},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/number/to-integer",["npm:es5-ext@0.10.7/math/sign/index"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/math/sign/index"),a=Math.abs,s=Math.floor;return n.exports=function(e){return isNaN(e)?0:(e=Number(e),0!==e&&isFinite(e)?o(e)*s(a(e)):e)},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/for-each",["npm:es5-ext@0.10.7/object/_iterate"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/object/_iterate")("forEach"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/assign/shim",["npm:es5-ext@0.10.7/object/keys/index","npm:es5-ext@0.10.7/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/keys/index"),a=require("npm:es5-ext@0.10.7/object/valid-value"),s=Math.max;return n.exports=function(e,t){var n,r,i,u=s(arguments.length,2);for(e=Object(a(e)),i=function(r){try{e[r]=t[r]}catch(i){n||(n=i)}},r=1;u>r;++r)t=arguments[r],o(t).forEach(i);if(void 0!==n)throw n;return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/string/#/contains",["npm:es5-ext@0.10.7/string/#/contains/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/string/#/contains/index"),r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/polyfill",["npm:d@0.1.1","npm:es6-symbol@2.0.1/validate-symbol"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a,s=require("npm:d@0.1.1"),u=require("npm:es6-symbol@2.0.1/validate-symbol"),c=Object.create,l=Object.defineProperties,f=Object.defineProperty,m=Object.prototype,p=c(null),d=function(){var e=c(null);return function(t){for(var n,r=0;e[t+(r||"")];)++r;return t+=r||"",e[t]=!0,n="@@"+t,f(m,n,s.gs(null,function(e){f(this,n,s(e))})),n}}();return a=function h(e){if(this instanceof a)throw new TypeError("TypeError: Symbol is not a constructor");return h(e)},n.exports=o=function b(e){var t;if(this instanceof b)throw new TypeError("TypeError: Symbol is not a constructor");return t=c(a.prototype),e=void 0===e?"":String(e),l(t,{__description__:s("",e),__name__:s("",d(e))})},l(o,{"for":s(function(e){return p[e]?p[e]:p[e]=o(String(e))}),keyFor:s(function(e){var t;u(e);for(t in p)if(p[t]===e)return t}),hasInstance:s("",o("hasInstance")),isConcatSpreadable:s("",o("isConcatSpreadable")),iterator:s("",o("iterator")),match:s("",o("match")),replace:s("",o("replace")),search:s("",o("search")),species:s("",o("species")),split:s("",o("split")),toPrimitive:s("",o("toPrimitive")),toStringTag:s("",o("toStringTag")),unscopables:s("",o("unscopables"))}),l(a.prototype,{constructor:s(o),toString:s("",function(){return this.__name__})}),l(o.prototype,{toString:s(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:s(function(){return u(this)})}),f(o.prototype,o.toPrimitive,s("",function(){return u(this)})),f(o.prototype,o.toStringTag,s("c","Symbol")),f(a.prototype,o.toPrimitive,s("c",o.prototype[o.toPrimitive])),f(a.prototype,o.toStringTag,s("c",o.prototype[o.toStringTag])),r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/async",["npm:es5-ext@0.10.7/array/from","npm:es5-ext@0.10.7/object/mixin","npm:es5-ext@0.10.7/function/_define-length","npm:next-tick@0.2.2","npm:memoizee@0.3.8/lib/registered-extensions","github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";var t=require("npm:es5-ext@0.10.7/array/from"),n=require("npm:es5-ext@0.10.7/object/mixin"),r=require("npm:es5-ext@0.10.7/function/_define-length"),i=require("npm:next-tick@0.2.2"),o=Array.prototype.slice,a=Function.prototype.apply,s=Object.create,u=Object.prototype.hasOwnProperty;require("npm:memoizee@0.3.8/lib/registered-extensions").async=function(e,c){var l,f,m,p=s(null),d=s(null),h=c.memoized,b=c.original;c.memoized=r(function(e){var t=arguments,n=t[t.length-1];return"function"==typeof n&&(l=n,t=o.call(t,0,-1)),h.apply(f=this,m=t)},h);try{n(c.memoized,h)}catch(g){}c.on("get",function(e){var t,n,r;if(l){if(p[e])return"function"==typeof p[e]?p[e]=[p[e],l]:p[e].push(l),void(l=null);t=l,n=f,r=m,l=f=m=null,i(function(){var i;u.call(d,e)?(i=d[e],c.emit("getasync",e,r,n),a.call(t,i.context,i.args)):(l=t,f=n,m=r,h.apply(n,r))})}}),c.original=function(){var e,n,r,o;return l?(e=t(arguments),n=function s(e){var n,r,u=s.id;return null==u?void i(a.bind(s,this,arguments)):(delete s.id,n=p[u],delete p[u],n?(r=t(arguments),c.has(u)&&(e?c["delete"](u):(d[u]={context:this,args:r},c.emit("setasync",u,"function"==typeof n?1:n.length))),"function"==typeof n?o=a.call(n,this,r):n.forEach(function(e){o=a.call(e,this,r)},this),o):void 0)},r=l,l=f=m=null,e.push(n),o=a.call(b,this,e),n.cb=r,l=n,o):a.call(b,this,arguments)},c.on("set",function(e){return l?(p[e]?"function"==typeof p[e]?p[e]=[p[e],l.cb]:p[e].push(l.cb):p[e]=l.cb,delete l.cb,l.id=e,void(l=null)):void c["delete"](e)}),c.on("delete",function(e){var t;u.call(p,e)||d[e]&&(t=d[e],delete d[e],c.emit("deleteasync",e,t))}),c.on("clear",function(){var e=d;d=s(null),c.emit("clearasync",e)})}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/max-age",["npm:es5-ext@0.10.7/array/from","npm:es5-ext@0.10.7/function/noop","npm:es5-ext@0.10.7/object/for-each","npm:timers-ext@0.1.0/valid-timeout","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/array/from"),a=require("npm:es5-ext@0.10.7/function/noop"),s=require("npm:es5-ext@0.10.7/object/for-each"),u=require("npm:timers-ext@0.1.0/valid-timeout"),c=require("npm:memoizee@0.3.8/lib/registered-extensions"),l=Math.max,f=Math.min,m=Object.create;return c.maxAge=function(e,t,n){var r,i,p,d;e=u(e),e&&(r=m(null),i=n.async&&c.async?"async":"",t.on("set"+i,function(n){r[n]=setTimeout(function(){t["delete"](n)},e),d&&(d[n]&&clearTimeout(d[n]),d[n]=setTimeout(function(){delete d[n]},p))}),t.on("delete"+i,function(e){clearTimeout(r[e]),delete r[e],d&&(clearTimeout(d[e]),delete d[e])}),n.preFetch&&(p=n.preFetch===!0||isNaN(n.preFetch)?.333:l(f(Number(n.preFetch),1),0),p&&(d={},p=(1-p)*e,t.on("get"+i,function(e,r,i){d[e]||(d[e]=setTimeout(function(){delete d[e],t["delete"](e),n.async&&(r=o(r),r.push(a)),t.memoized.apply(i,r)},0))}))),t.on("clear"+i,function(){s(r,function(e){clearTimeout(e)}),r={},d&&(s(d,function(e){clearTimeout(e)}),d={})}))},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/max",["npm:es5-ext@0.10.7/number/to-pos-integer","npm:lru-queue@0.1.0","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/number/to-pos-integer"),a=require("npm:lru-queue@0.1.0"),s=require("npm:memoizee@0.3.8/lib/registered-extensions");return s.max=function(e,t,n){var r,i,u;e=o(e),e&&(i=a(e),r=n.async&&s.async?"async":"",t.on("set"+r,u=function(e){e=i.hit(e),void 0!==e&&t["delete"](e)}),t.on("get"+r,u),t.on("delete"+r,i["delete"]),t.on("clear"+r,i.clear))},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/object/assign",["npm:core-js@0.9.12/library/modules/es6.object.assign","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.assign"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Object.assign,r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/math/log2",["npm:core-js@0.9.12/library/fn/math/log2"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/math/log2"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/object/create",["npm:core-js@0.9.12/library/fn/object/create"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/object/create"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.object.to-string",["npm:core-js@0.9.12/library/modules/$.cof","npm:core-js@0.9.12/library/modules/$.wks","npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.redef"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.9.12/library/modules/$.cof"),a={};return a[require("npm:core-js@0.9.12/library/modules/$.wks")("toStringTag")]="z",require("npm:core-js@0.9.12/library/modules/$").FW&&"z"!=o(a)&&require("npm:core-js@0.9.12/library/modules/$.redef")(Object.prototype,"toString",function(){return"[object "+o.classof(this)+"]"},!0),r.define=i,n.exports}),e.register("github:jspm/nodelibs-process@0.1.1",["github:jspm/nodelibs-process@0.1.1/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("github:jspm/nodelibs-process@0.1.1/index"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/weak-map",["npm:core-js@0.9.12/library/modules/es6.object.to-string","npm:core-js@0.9.12/library/modules/es6.array.iterator","npm:core-js@0.9.12/library/modules/es6.weak-map","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.to-string"),require("npm:core-js@0.9.12/library/modules/es6.array.iterator"),require("npm:core-js@0.9.12/library/modules/es6.weak-map"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.WeakMap,r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/map",["npm:core-js@0.9.12/library/fn/map"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/map"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/symbol",["npm:core-js@0.9.12/library/fn/symbol/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:core-js@0.9.12/library/fn/symbol/index"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/number/to-pos-integer",["npm:es5-ext@0.10.7/number/to-integer"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/number/to-integer"),a=Math.max;return n.exports=function(e){return a(0,o(e))},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/object/assign/index",["npm:es5-ext@0.10.7/object/assign/is-implemented","npm:es5-ext@0.10.7/object/assign/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/object/assign/is-implemented")()?Object.assign:require("npm:es5-ext@0.10.7/object/assign/shim"),r.define=i,n.exports}),e.register("npm:d@0.1.1/index",["npm:es5-ext@0.10.7/object/assign","npm:es5-ext@0.10.7/object/normalize-options","npm:es5-ext@0.10.7/object/is-callable","npm:es5-ext@0.10.7/string/#/contains"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a=require("npm:es5-ext@0.10.7/object/assign"),s=require("npm:es5-ext@0.10.7/object/normalize-options"),u=require("npm:es5-ext@0.10.7/object/is-callable"),c=require("npm:es5-ext@0.10.7/string/#/contains");return o=n.exports=function(e,t){var n,r,i,o,u;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],null==e?(n=i=!0,r=!1):(n=c.call(e,"c"),r=c.call(e,"e"),i=c.call(e,"w")),u={value:t,configurable:n,enumerable:r,writable:i},o?a(s(o),u):u},o.gs=function(e,t,n){var r,i,o,l;return"string"!=typeof e?(o=n,n=t,t=e,e=null):o=arguments[3],null==t?t=void 0:u(t)?null==n?n=void 0:u(n)||(o=n,n=void 0):(o=t,t=n=void 0),null==e?(r=!0,i=!1):(r=c.call(e,"c"),i=c.call(e,"e")),l={get:t,set:n,configurable:r,enumerable:i},o?a(s(o),l):l},r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/index",["npm:es6-symbol@2.0.1/is-implemented","npm:es6-symbol@2.0.1/polyfill"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es6-symbol@2.0.1/is-implemented")()?Symbol:require("npm:es6-symbol@2.0.1/polyfill"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/object/assign",["npm:core-js@0.9.12/library/fn/object/assign"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/object/assign"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/helpers/inherits",["npm:babel-runtime@5.4.7/core-js/object/create"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:babel-runtime@5.4.7/core-js/object/create")["default"];return t["default"]=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=o(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},t.__esModule=!0,r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/$.task",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.ctx","npm:core-js@0.9.12/library/modules/$.cof","npm:core-js@0.9.12/library/modules/$.invoke","npm:core-js@0.9.12/library/modules/$.dom-create","github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";function t(){var e=+this;if(s.has(w,e)){var t=w[e];delete w[e],t()}}function r(e){t.call(e.data)}var i,o,a,s=require("npm:core-js@0.9.12/library/modules/$"),u=require("npm:core-js@0.9.12/library/modules/$.ctx"),c=require("npm:core-js@0.9.12/library/modules/$.cof"),l=require("npm:core-js@0.9.12/library/modules/$.invoke"),f=require("npm:core-js@0.9.12/library/modules/$.dom-create"),m=s.g,p=s.isFunction,d=s.html,e=m.process,h=m.setImmediate,b=m.clearImmediate,g=m.postMessage,v=m.addEventListener,y=m.MessageChannel,x=0,w={},j="onreadystatechange";
p(h)&&p(b)||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return w[++x]=function(){l(p(e)?e:Function(e),t)},i(x),x},b=function(e){delete w[e]},"process"==c(e)?i=function(n){e.nextTick(u(t,n,1))}:v&&p(g)&&!m.importScripts?(i=function(e){g(e,"*")},v("message",r,!1)):p(y)?(o=new y,a=o.port2,o.port1.onmessage=r,i=u(a.postMessage,a,1)):i=j in f("script")?function(e){d.appendChild(f("script"))[j]=function(){d.removeChild(this),t.call(e)}}:function(e){setTimeout(u(t,e,1),0)}),n.exports={set:h,clear:b}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/weak-map",["npm:core-js@0.9.12/library/fn/weak-map"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/weak-map"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/symbol",["npm:core-js@0.9.12/library/fn/symbol"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/symbol"),__esModule:!0},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/resolve-length",["npm:es5-ext@0.10.7/number/to-pos-integer"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/number/to-pos-integer");return n.exports=function(e,t,n){var r;return isNaN(e)?(r=t,r>=0?n&&r?r-1:r:1):e===!1?!1:o(e)},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/error/custom",["npm:es5-ext@0.10.7/object/assign/index"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/assign/index"),a=Error.captureStackTrace;return t=n.exports=function(e){var n=new Error,r=arguments[1],i=arguments[2];return null==i&&r&&"object"==typeof r&&(i=r,r=null),null!=i&&o(n,i),n.message=String(e),null!=r&&(n.code=String(r)),a&&a(n,t),n},r.define=i,n.exports}),e.register("npm:d@0.1.1",["npm:d@0.1.1/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:d@0.1.1/index"),r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1",["npm:es6-symbol@2.0.1/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es6-symbol@2.0.1/index"),r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/modules/es6.promise",["npm:core-js@0.9.12/library/modules/$","npm:core-js@0.9.12/library/modules/$.ctx","npm:core-js@0.9.12/library/modules/$.cof","npm:core-js@0.9.12/library/modules/$.def","npm:core-js@0.9.12/library/modules/$.assert","npm:core-js@0.9.12/library/modules/$.for-of","npm:core-js@0.9.12/library/modules/$.set-proto","npm:core-js@0.9.12/library/modules/$.species","npm:core-js@0.9.12/library/modules/$.wks","npm:core-js@0.9.12/library/modules/$.uid","npm:core-js@0.9.12/library/modules/$.task","npm:core-js@0.9.12/library/modules/$.mix","npm:core-js@0.9.12/library/modules/$.iter-detect","github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";function t(e){var t=E(e)[h];return void 0!=t?t:e}function n(e){var t;return j(e)&&(t=e.then),w(t)?t:!1}function r(e){var t=e.c;t.length&&y(function(){function r(t){var r,a,s=o?t.ok:t.fail;try{s?(o||(e.h=!0),r=s===!0?i:s(i),r===t.P?t.rej(TypeError("Promise-chain cycle")):(a=n(r))?a.call(r,t.res,t.rej):t.res(r)):t.rej(i)}catch(u){t.rej(u)}}for(var i=e.v,o=1==e.s,a=0;t.length>a;)r(t[a++]);t.length=0})}function i(e){var t,n=e[b],r=n.a||n.c,o=0;if(n.h)return!1;for(;r.length>o;)if(t=r[o++],t.fail||!i(t.P))return!1;return!0}function o(t){var n,o=this;o.d||(o.d=!0,o=o.r||o,o.v=t,o.s=2,o.a=o.c.slice(),setTimeout(function(){y(function(){i(n=o.p)&&("process"==c(e)?e.emit("unhandledRejection",t,n):v.console&&w(console.error)&&console.error("Unhandled promise rejection",t)),o.a=void 0})},1),r(o))}function a(e){var t,i,s=this;if(!s.d){s.d=!0,s=s.r||s;try{(t=n(e))?(i={r:s,d:!1},t.call(e,u(a,i,1),u(o,i,1))):(s.v=e,s.s=1,r(s))}catch(c){o.call(i||{r:s,d:!1},c)}}}var s=require("npm:core-js@0.9.12/library/modules/$"),u=require("npm:core-js@0.9.12/library/modules/$.ctx"),c=require("npm:core-js@0.9.12/library/modules/$.cof"),l=require("npm:core-js@0.9.12/library/modules/$.def"),f=require("npm:core-js@0.9.12/library/modules/$.assert"),m=require("npm:core-js@0.9.12/library/modules/$.for-of"),p=require("npm:core-js@0.9.12/library/modules/$.set-proto").set,d=require("npm:core-js@0.9.12/library/modules/$.species"),h=require("npm:core-js@0.9.12/library/modules/$.wks")("species"),b=require("npm:core-js@0.9.12/library/modules/$.uid").safe("record"),g="Promise",v=s.g,e=v.process,y=e&&e.nextTick||require("npm:core-js@0.9.12/library/modules/$.task").set,x=v[g],w=s.isFunction,j=s.isObject,_=f.fn,E=f.obj,T=function(){function e(t){var n=new x(t);return p(n,e.prototype),n}var t,n=!1;try{n=w(x)&&w(x.resolve)&&x.resolve(t=new x(function(){}))==t,p(e,x),e.prototype=s.create(x.prototype,{constructor:{value:e}}),e.resolve(5).then(function(){})instanceof e||(n=!1)}catch(r){n=!1}return n}();T||(x=function(e){_(e);var t={p:f.inst(this,x,g),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1};s.hide(this,b,t);try{e(u(a,t,1),u(o,t,1))}catch(n){o.call(t,n)}},require("npm:core-js@0.9.12/library/modules/$.mix")(x.prototype,{then:function(e,t){var n=E(E(this).constructor)[h],i={ok:w(e)?e:!0,fail:w(t)?t:!1},o=i.P=new(void 0!=n?n:x)(function(e,t){i.res=_(e),i.rej=_(t)}),a=this[b];return a.c.push(i),a.a&&a.a.push(i),a.s&&r(a),o},"catch":function(e){return this.then(void 0,e)}})),l(l.G+l.W+l.F*!T,{Promise:x}),c.set(x,g),d(x),d(s.core[g]),l(l.S+l.F*!T,g,{reject:function(e){return new(t(this))(function(t,n){n(e)})},resolve:function(e){return j(e)&&b in e&&s.getProto(e)===this.prototype?e:new(t(this))(function(t){t(e)})}}),l(l.S+l.F*!(T&&require("npm:core-js@0.9.12/library/modules/$.iter-detect")(function(e){x.all(e)["catch"](function(){})})),g,{all:function(e){var n=t(this),r=[];return new n(function(t,i){m(e,!1,r.push,r);var o=r.length,a=Array(o);o?s.each.call(r,function(e,r){n.resolve(e).then(function(e){a[r]=e,--o||t(a)},i)}):t(a)})},race:function(e){var n=t(this);return new n(function(t,r){m(e,!1,function(e){n.resolve(e).then(t,r)})})}})}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/regenerator/runtime",["npm:babel-runtime@5.4.7/core-js/symbol","npm:babel-runtime@5.4.7/core-js/symbol/iterator","npm:babel-runtime@5.4.7/core-js/object/create","npm:babel-runtime@5.4.7/core-js/promise"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:babel-runtime@5.4.7/core-js/symbol")["default"],a=require("npm:babel-runtime@5.4.7/core-js/symbol/iterator")["default"],s=require("npm:babel-runtime@5.4.7/core-js/object/create")["default"],u=require("npm:babel-runtime@5.4.7/core-js/promise")["default"];return!function(e){"use strict";function t(e,t,n,r){var o=s((t||i).prototype);return o._invoke=f(e,n||null,new h(r||[])),o}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function i(){}function c(){}function l(){}function f(e,t,n){var i=_;return function(o,a){if(i===T)throw new Error("Generator is already running");if(i===A)return g();for(;;){var s=n.delegate;if(s){if("return"===o||"throw"===o&&s.iterator[o]===v){n.delegate=null;var u=s.iterator["return"];if(u){var c=r(u,s.iterator,a);if("throw"===c.type){o="throw",a=c.arg;continue}}if("return"===o)continue}var c=r(s.iterator[o],s.iterator,a);if("throw"===c.type){n.delegate=null,o="throw",a=c.arg;continue}o="next",a=v;var l=c.arg;if(!l.done)return i=E,l;n[s.resultName]=l.value,n.next=s.nextLoc,n.delegate=null}if("next"===o)i===E?n.sent=a:delete n.sent;else if("throw"===o){if(i===_)throw i=A,a;n.dispatchException(a)&&(o="next",a=v)}else"return"===o&&n.abrupt("return",a);i=T;var c=r(e,t,n);if("normal"===c.type){i=n.done?A:E;var l={value:c.arg,done:n.done};if(c.arg!==S)return l;n.delegate&&"next"===o&&(a=v)}else"throw"===c.type&&(i=A,o="throw",a=c.arg)}}}function m(e){M[e]=function(t){return this._invoke(e,t)}}function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function d(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset()}function b(e){if(e){var t=e[x];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function i(){for(;++n<e.length;)if(y.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=v,i.done=!0,i};return r.next=r}}return{next:g}}function g(){return{value:v,done:!0}}var v,y=Object.prototype.hasOwnProperty,x="function"==typeof o&&a||"@@iterator",w="object"==typeof n,j=e.regeneratorRuntime;if(j)return void(w&&(n.exports=j));j=e.regeneratorRuntime=w?n.exports:{},j.wrap=t;var _="suspendedStart",E="suspendedYield",T="executing",A="completed",S={},M=l.prototype=i.prototype;c.prototype=M.constructor=l,l.constructor=c,c.displayName="GeneratorFunction",j.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===c||"GeneratorFunction"===(t.displayName||t.name):!1},j.mark=function(e){return e.__proto__=l,e.prototype=s(M),e},j.async=function(e,n,i,o){return new u(function(a,s){function c(e,t){var n=r(l[e],l,t);if("throw"===n.type)return void s(n.arg);var i=n.arg;i.done?a(i.value):u.resolve(i.value).then(f,m)}var l=t(e,n,i,o),f=c.bind(l,"next"),m=c.bind(l,"throw");f()})},m("next"),m("throw"),m("return"),M[x]=function(){return this},M.toString=function(){return"[object Generator]"},j.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},j.values=b,h.prototype={constructor:h,reset:function(){this.prev=0,this.next=0,this.sent=v,this.done=!1,this.delegate=null,this.tryEntries.forEach(d);for(var e,t=0;y.call(this,e="t"+t)||20>t;++t)this[e]=null},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=y.call(i,"catchLoc"),s=y.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&y.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?this.next=i.finallyLoc:this.complete(o),S},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),d(n),S}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;d(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:b(e),resultName:t,nextLoc:n},S}}}("object"==typeof r?r:"object"==typeof window?window:"object"==typeof self?self:void 0),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/array/from/shim",["npm:es6-symbol@2.0.1","npm:es5-ext@0.10.7/function/is-arguments","npm:es5-ext@0.10.7/function/is-function","npm:es5-ext@0.10.7/number/to-pos-integer","npm:es5-ext@0.10.7/object/valid-callable","npm:es5-ext@0.10.7/object/valid-value","npm:es5-ext@0.10.7/string/is-string"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es6-symbol@2.0.1").iterator,a=require("npm:es5-ext@0.10.7/function/is-arguments"),s=require("npm:es5-ext@0.10.7/function/is-function"),u=require("npm:es5-ext@0.10.7/number/to-pos-integer"),c=require("npm:es5-ext@0.10.7/object/valid-callable"),l=require("npm:es5-ext@0.10.7/object/valid-value"),f=require("npm:es5-ext@0.10.7/string/is-string"),m=Array.isArray,p=Function.prototype.call,d={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;return n.exports=function(e){var t,n,r,i,b,g,v,y,x,w,j=arguments[1],_=arguments[2];if(e=Object(l(e)),null!=j&&c(j),this&&this!==Array&&s(this))t=this;else{if(!j){if(a(e))return b=e.length,1!==b?Array.apply(null,e):(i=new Array(1),i[0]=e[0],i);if(m(e)){for(i=new Array(b=e.length),n=0;b>n;++n)i[n]=e[n];return i}}i=[]}if(!m(e))if(void 0!==(x=e[o])){for(v=c(x).call(e),t&&(i=new t),y=v.next(),n=0;!y.done;)w=j?p.call(j,_,y.value,n):y.value,t?(d.value=w,h(i,n,d)):i[n]=w,y=v.next(),++n;b=n}else if(f(e)){for(b=e.length,t&&(i=new t),n=0,r=0;b>n;++n)w=e[n],b>n+1&&(g=w.charCodeAt(0),g>=55296&&56319>=g&&(w+=e[++n])),w=j?p.call(j,_,w,r):w,t?(d.value=w,h(i,r,d)):i[r]=w,++r;b=r}if(void 0===b)for(b=u(e.length),t&&(i=new t(b)),n=0;b>n;++n)w=j?p.call(j,_,e[n],n):e[n],t?(d.value=w,h(i,n,d)):i[n]=w;return t&&(d.value=null,i.length=b),i},r.define=i,n.exports}),e.register("npm:core-js@0.9.12/library/fn/promise",["npm:core-js@0.9.12/library/modules/es6.object.to-string","npm:core-js@0.9.12/library/modules/es6.string.iterator","npm:core-js@0.9.12/library/modules/web.dom.iterable","npm:core-js@0.9.12/library/modules/es6.promise","npm:core-js@0.9.12/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.9.12/library/modules/es6.object.to-string"),require("npm:core-js@0.9.12/library/modules/es6.string.iterator"),require("npm:core-js@0.9.12/library/modules/web.dom.iterable"),require("npm:core-js@0.9.12/library/modules/es6.promise"),n.exports=require("npm:core-js@0.9.12/library/modules/$").core.Promise,r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/regenerator/index",["npm:babel-runtime@5.4.7/regenerator/runtime"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o="object"==typeof r?r:"object"==typeof window?window:"object"==typeof self?self:this,a=o.regeneratorRuntime&&Object.getOwnPropertyNames(o).indexOf("regeneratorRuntime")>=0,s=a&&o.regeneratorRuntime;return o.regeneratorRuntime=void 0,n.exports=require("npm:babel-runtime@5.4.7/regenerator/runtime"),a?o.regeneratorRuntime=s:delete o.regeneratorRuntime,n.exports={"default":n.exports,__esModule:!0},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/array/from/index",["npm:es5-ext@0.10.7/array/from/is-implemented","npm:es5-ext@0.10.7/array/from/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.7/array/from/is-implemented")()?Array.from:require("npm:es5-ext@0.10.7/array/from/shim"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/core-js/promise",["npm:core-js@0.9.12/library/fn/promise"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.9.12/library/fn/promise"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.4.7/regenerator",["npm:babel-runtime@5.4.7/regenerator/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:babel-runtime@5.4.7/regenerator/index"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.7/array/to-array",["npm:es5-ext@0.10.7/array/from/index"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/array/from/index"),a=Array.isArray;return n.exports=function(e){return a(e)?e:o(e)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/resolve-resolve",["npm:es5-ext@0.10.7/array/to-array","npm:es5-ext@0.10.7/object/valid-callable"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a=require("npm:es5-ext@0.10.7/array/to-array"),s=require("npm:es5-ext@0.10.7/object/valid-callable"),u=Array.prototype.slice;return o=function(e){return this.map(function(t,n){return t?t(e[n]):e[n]}).concat(u.call(e,this.length))},n.exports=function(e){return e=a(e),e.forEach(function(e){null!=e&&s(e)}),o.bind(e)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/configure-map",["npm:es5-ext@0.10.7/error/custom","npm:es5-ext@0.10.7/function/_define-length","npm:d@0.1.1","npm:event-emitter@0.3.3","npm:memoizee@0.3.8/lib/resolve-resolve","npm:memoizee@0.3.8/lib/resolve-normalize"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/error/custom"),a=require("npm:es5-ext@0.10.7/function/_define-length"),s=require("npm:d@0.1.1"),u=require("npm:event-emitter@0.3.3").methods,c=require("npm:memoizee@0.3.8/lib/resolve-resolve"),l=require("npm:memoizee@0.3.8/lib/resolve-normalize"),f=Function.prototype.apply,m=Function.prototype.call,p=Object.create,d=Object.prototype.hasOwnProperty,h=Object.defineProperties,b=u.on,g=u.emit;return n.exports=function(e,t,n){var r,i,u,v,y,x,w,j,_,E,T,A,S,M=p(null);return i=t!==!1?t:isNaN(e.length)?1:e.length,n.normalizer&&(j=l(n.normalizer),u=j.get,v=j.set,y=j["delete"],x=j.clear),null!=n.resolvers&&(S=c(n.resolvers)),A=u?a(function(t){var n,i,a=arguments;if(S&&(a=S(a)),n=u(a),null!==n&&d.call(M,n))return _&&r.emit("get",n,a,this),M[n];if(i=1===a.length?m.call(e,this,t):f.call(e,this,a),null===n){if(n=u(a),null!==n)throw o("Circular invocation","CIRCULAR_INVOCATION");n=v(a)}else if(d.call(M,n))throw o("Circular invocation","CIRCULAR_INVOCATION");return M[n]=i,E&&r.emit("set",n),i},i):0===t?function(){var t;if(d.call(M,"data"))return _&&r.emit("get","data",arguments,this),M.data;if(t=arguments.length?f.call(e,this,arguments):m.call(e,this),d.call(M,"data"))throw o("Circular invocation","CIRCULAR_INVOCATION");return M.data=t,E&&r.emit("set","data"),t}:function(t){var n,i,a=arguments;if(S&&(a=S(arguments)),i=String(a[0]),d.call(M,i))return _&&r.emit("get",i,a,this),M[i];if(n=1===a.length?m.call(e,this,a[0]):f.call(e,this,a),d.call(M,i))throw o("Circular invocation","CIRCULAR_INVOCATION");return M[i]=n,E&&r.emit("set",i),n},r={original:e,memoized:A,get:function(e){return S&&(e=S(e)),u?u(e):String(e[0])},has:function(e){return d.call(M,e)},"delete":function(e){var t;d.call(M,e)&&(y&&y(e),t=M[e],delete M[e],T&&r.emit("delete",e,t))},clear:function(){var e=M;x&&x(),M=p(null),r.emit("clear",e)},on:function(e,t){return"get"===e?_=!0:"set"===e?E=!0:"delete"===e&&(T=!0),b.call(this,e,t)},emit:g,updateEnv:function(){e=r.original}},w=u?a(function(e){var t,n=arguments;S&&(n=S(n)),t=u(n),null!==t&&r["delete"](t)},i):0===t?function(){return r["delete"]("data")}:function(e){return S&&(e=S(arguments)[0]),r["delete"](e)},h(A,{__memoized__:s(!0),"delete":s(w),clear:s(r.clear)}),r},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/plain",["npm:es5-ext@0.10.7/object/valid-callable","npm:es5-ext@0.10.7/object/for-each","npm:memoizee@0.3.8/lib/registered-extensions","npm:memoizee@0.3.8/lib/configure-map","npm:memoizee@0.3.8/lib/resolve-length"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/valid-callable"),a=require("npm:es5-ext@0.10.7/object/for-each"),s=require("npm:memoizee@0.3.8/lib/registered-extensions"),u=require("npm:memoizee@0.3.8/lib/configure-map"),c=require("npm:memoizee@0.3.8/lib/resolve-length"),l=Object.prototype.hasOwnProperty;return n.exports=function f(e){var t,n,r;return o(e),t=Object(arguments[1]),l.call(e,"__memoized__")&&!t.force?e:(n=c(t.length,e.length,t.async&&s.async),r=u(e,n,t),a(s,function(e,n){t[n]&&e(t[n],r,t)}),f.__profiler__&&f.__profiler__(r),r.updateEnv(),r.memoized)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/index",["npm:es5-ext@0.10.7/object/normalize-options","npm:memoizee@0.3.8/lib/resolve-length","npm:memoizee@0.3.8/plain","npm:memoizee@0.3.8/normalizers/primitive","npm:memoizee@0.3.8/normalizers/get-primitive-fixed","npm:memoizee@0.3.8/normalizers/get","npm:memoizee@0.3.8/normalizers/get-1","npm:memoizee@0.3.8/normalizers/get-fixed","npm:memoizee@0.3.8/ext/async","npm:memoizee@0.3.8/ext/dispose","npm:memoizee@0.3.8/ext/max-age","npm:memoizee@0.3.8/ext/max","npm:memoizee@0.3.8/ext/ref-counter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.7/object/normalize-options"),a=require("npm:memoizee@0.3.8/lib/resolve-length"),s=require("npm:memoizee@0.3.8/plain");return n.exports=function(e){var t,n=o(arguments[1]);return n.normalizer||(t=n.length=a(n.length,e.length,n.async),0!==t&&(n.primitive?t===!1?n.normalizer=require("npm:memoizee@0.3.8/normalizers/primitive"):t>1&&(n.normalizer=require("npm:memoizee@0.3.8/normalizers/get-primitive-fixed")(t)):t===!1?n.normalizer=require("npm:memoizee@0.3.8/normalizers/get")():1===t?n.normalizer=require("npm:memoizee@0.3.8/normalizers/get-1")():n.normalizer=require("npm:memoizee@0.3.8/normalizers/get-fixed")(t))),n.async&&require("npm:memoizee@0.3.8/ext/async"),n.dispose&&require("npm:memoizee@0.3.8/ext/dispose"),n.maxAge&&require("npm:memoizee@0.3.8/ext/max-age"),n.max&&require("npm:memoizee@0.3.8/ext/max"),n.refCounter&&require("npm:memoizee@0.3.8/ext/ref-counter"),s(e,n)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8",["npm:memoizee@0.3.8/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:memoizee@0.3.8/index"),r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/camera/perspective-camera",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","github:maxdavidson/tribus@master/camera/base","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]}],execute:function(){"use strict";o=Math.PI/180,a=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,t);var i=t.fov,o=void 0===i?60:i,a=t.aspect,s=void 0===a?1.3333333333333333:a,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?100:l;this.fov=o,this.aspect=s,this.near=c,this.far=f,this._lastFov=this.fov,this._lastAspect=this.aspect,this._lastNear=this.near,this._lastFar=this.far}return t(r,e),r.prototype.recalculate=function(t){return this.dirty=this.dirty||null!==this.parent&&this.parent.dirty||this.fov!==this._lastFov||this.aspect!==this._lastAspect||this.near!==this._lastNear||this.far!==this._lastFar,this.dirty&&(i.mat4.perspective(this.projectionMatrix,this.fov*o,this.aspect,this.near,this.far),this._lastFov=this.fov,this._lastAspect=this.aspect,this._lastNear=this.near,this._lastFar=this.far),e.prototype.recalculate.call(this,t)},r}(r),e("default",a)}}}),e.register("github:maxdavidson/tribus@master/webgl/buffer",["npm:babel-runtime@5.4.7/helpers/class-call-check"],function(e){var t,n,r;return{setters:[function(e){t=e["default"]}],execute:function(){"use strict";n=WebGLRenderingContext,r=function(){function e(r,i,o){var a=void 0===arguments[3]?{}:arguments[3],s=a.mode,u=void 0===s?n.STATIC_DRAW:s,c=a.size,l=void 0===c?3:c,f=a.bufferType,m=void 0===f?n.ARRAY_BUFFER:f,p=a.dataType,d=void 0===p?n.FLOAT:p;t(this,e),this.gl=r,void 0!==o&&(this.vao=o,this.vaoExtension=r.getExtension("OES_vertex_array_object")),this.size=l,this.mode=u,this.bufferType=m,this.dataType=d,this.vbo=r.createBuffer(),this.data=null,this.attribLocation=null,this.updateData(i)}return e.prototype.bind=function(){var e=this.data&&0!==this.data.length&&this.bufferType!==n.ELEMENT_ARRAY_BUFFER;e&&this.gl.enableVertexAttribArray(this.attribLocation),this.gl.bindBuffer(this.bufferType,this.vbo),e&&this.gl.vertexAttribPointer(this.attribLocation,this.size,this.dataType,!1,4*this.size,0)},e.prototype._executeBound=function(e){this.vao&&this.vaoExtension.bindVertexArrayOES(this.vao),this.gl.bindBuffer(this.bufferType,this.vbo),e(),this.vao&&this.vaoExtension.bindVertexArrayOES(null)},e.prototype.updateData=function(e){var t=this;this.data=e,this._executeBound(function(){t.gl.bufferData(t.bufferType,t.data,t.mode)})},e.prototype.updateSubData=function(e,t){var n=this;this.data.set(e,t),this._executeBound(function(){n.gl.bufferSubData(n.bufferType,e,n.mode)})},e.prototype.setAttribLocation=function(e,t){var n=this;t.gl!==this.gl&&console.error("Couldn't set attribute location: the program's WebGL context is not the same as the buffer's!");var r=t.getAttribLocation(e);-1===r&&console.error("Couldn't bind buffer to location: \""+e+'"'),this._executeBound(function(){n.gl.vertexAttribPointer(r,n.size,n.dataType,!1,0,0),n.gl.enableVertexAttribArray(r)}),this.attribLocation=r},e.prototype.destroy=function(){var e=this;this._executeBound(function(){e.gl.deleteBuffer(e.vbo)})},e}(),e("default",r)}}}),e.register("github:maxdavidson/tribus@master/extra/ajax",["npm:babel-runtime@5.4.7/core-js/promise"],function(e){function t(e){return i(e)}function n(e){return i(e,{responseType:"json"})}function r(e){return i(e,{responseType:"arraybuffer"})}function i(e){var t=void 0===arguments[1]?{}:arguments[1],n=t.responseType,r=void 0===n?"text":n,i=new XMLHttpRequest;return new o(function(t,n){i.open("GET",e),i.responseType=r,i.onload=function(){200==i.status?t(i.response):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()})}var o;return{setters:[function(e){o=e["default"]}],execute:function(){"use strict";e("getString",t),e("getJson",n),e("getArrayBuffer",r),e("ajax",i)}}}),e.register("github:maxdavidson/tribus@master/extra/functional",["npm:babel-runtime@5.4.7/helpers/bind"],function(e){var t,n,r;return{setters:[function(e){t=e["default"]}],execute:function(){"use strict";n=function(e){return function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];return new(t.apply(e,[null].concat(r)))}},e("construct",n),r=function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return e.apply(void 0,n).apply(void 0,n)}},e("delegate",r)}}}),e.register("github:maxdavidson/tribus@master/workers/model-splitter",["github:maxdavidson/tribus@master/extra/worker-pool"],function(e){"use strict";var t,n;return{setters:[function(e){t=e["default"]}],execute:function(){n=t.fromFunction(function(e,t){var n="Splitting geometry";console.time(n);for(var r=t.indices,i=t.vertices,o=t.normals,a=t.texcoords,s=a.length>0,u=i.length/3,c=r.length/3,l=(u>>16)+1,f=Math.ceil(c/l),m=0;l>m;++m){for(var p=l-1>m?f:c-(l-1)*f,d=0,h=3*p,b=[],g=new Uint16Array(h),v=[],y=[],x=[],w=3*m*f,j=0;h>j;++j){var _=r[w+j],E=b[_];if(void 0===E){E=b[_]=d++;var T=3*_;v.push(i[T],i[T+1],i[T+2]),y.push(o[T],o[T+1],o[T+2]),s&&(T=2*_,x.push(a[T],a[T+1]))}g[j]=E}var A=new Float32Array(v),S=new Float32Array(y),M=new Float32Array(x);e.progress({type:"geometry",part:m,vertices:A,normals:S,texcoords:M,indices:g},[A.buffer,S.buffer,M.buffer,g.buffer])}console.timeEnd(n),e.done()}),e("workerpool",n)}}}),e.register("github:maxdavidson/tribus@master/extra/errors",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check"],function(e){var t,n,r,i;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=function(e){function i(){var t=void 0===arguments[0]?"Method not implemented!":arguments[0];r(this,i),e.call(this,t)}return t(i,e),n(i,[{key:"name",get:function(){return"UnimplementedMethod"}}]),i}(Error),e("UnimplementedMethodError",i)}}}),e.register("github:maxdavidson/tribus@master/extra/atlas",["npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/math/log2","npm:babel-runtime@5.4.7/core-js/get-iterator","npm:babel-runtime@5.4.7/regenerator","npm:babel-runtime@5.4.7/core-js/symbol/iterator"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]}],execute:function(){"use strict";s=function(){function e(t){var r=t.maxSize,i=void 0===r?10:r,o=t.initialSize,a=void 0===o?0:o;n(this,e),this.regions=[new u(0,0,1<<a,1<<a)],this.maxSize=i}return e.imageComparator=function(t,n){return e.getImageSize(n)-e.getImageSize(t)},e.getImageSize=function(e){return Math.max(e.width,e.height)},e.getFittingSize=function(t){return Math.ceil(r(e.getImageSize(t)))},e.prototype.insert=function(t){if(e.getFittingSize(t)>this.maxSize)return[e.FAILED,"Image size is too large!"];for(var n=void 0,r=0,o=this.regions.length;o>r;++r)if(n=this.regions[r].insert(t))return[e.SUCCESS,r,n];for(var a=[t],s=this.regions,c=Array.isArray(s),l=0,s=c?s:i(s);;){var f;if(c){if(l>=s.length)break;f=s[l++]}else{if(l=s.next(),l.done)break;f=l.value}for(var m=f,p=m.images(),d=Array.isArray(p),h=0,p=d?p:i(p);;){var b;if(d){if(h>=p.length)break;b=p[h++]}else{if(h=p.next(),h.done)break;b=h.value}var g=b;a.push(g)}}a.sort(e.imageComparator);var v=e.getFittingSize(a[0]);this.regions.length=1;e:for(;;){for(var r=0;r<this.regions.length-1;++r)this.regions[r]=new u(0,0,1<<this.maxSize,1<<this.maxSize);this.regions[this.regions.length-1]=new u(0,0,1<<v,1<<v);for(var y=0,m=this.regions[y],x=a,w=Array.isArray(x),j=0,x=w?x:i(x);;){var _;if(w){if(j>=x.length)break;_=x[j++]}else{if(j=x.next(),j.done)break;_=j.value}var g=_;if(!m.insert(g)){if(v++,v<=this.maxSize)continue e;m=this.regions[++y],m||(v=e.getFittingSize(g),m=this.regions[y]=new u(0,0,1<<v,1<<v)),m.insert(g)}}break}return[e.RESET]},t(e,null,[{key:"FAILED",value:0,enumerable:!0},{key:"SUCCESS",value:1,enumerable:!0},{key:"RESET",value:2,enumerable:!0}]),e}(),e("Atlas",s),u=function(){function e(){var t=void 0===arguments[0]?0:arguments[0],r=void 0===arguments[1]?0:arguments[1],i=void 0===arguments[2]?0:arguments[2],o=void 0===arguments[3]?0:arguments[3];n(this,e),this.left=t,this.top=r,this.right=i,this.bottom=o,this.image=null,this.downRegion=null,this.rightRegion=null}return e.prototype.toString=function(){return""+this.constructor.name+"("+this.left+", "+this.top+", "+this.right+", "+this.bottom+")"},e.prototype.images=o.mark(function r(){var e,t,n,a,s;return o.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e=this,t=Array.isArray(e),n=0,e=t?e:i(e);case 1:if(!t){r.next=7;break}if(!(n>=e.length)){r.next=4;break}return r.abrupt("break",16);case 4:a=e[n++],r.next=11;break;case 7:if(n=e.next(),!n.done){r.next=10;break}return r.abrupt("break",16);case 10:a=n.value;case 11:return s=a,r.next=14,s.image;case 14:r.next=1;break;case 16:case"end":return r.stop()}},r,this)}),e.prototype[a]=o.mark(function s(){return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFilled){e.next=5;break}return e.next=3,this;case 3:return e.delegateYield(this.downRegion,"t3",4);case 4:return e.delegateYield(this.rightRegion,"t4",5);case 5:case"end":return e.stop()}},s,this)}),e.prototype.insert=function(t){if(this.isFilled)return this.image===t?this:this.downRegion.insert(t)||this.rightRegion.insert(t);if(t.height>this.outerHeight||t.width>this.outerWidth)return void 0;this.image=t;var n=this.outerWidth-this.innerWidth,r=this.outerHeight-this.innerHeight;return n>r?(this.downRegion=new e(this.left,this.top+this.innerHeight,this.right,this.bottom),this.rightRegion=new e(this.left+this.innerWidth,this.top,this.right,this.top+this.innerHeight)):(this.downRegion=new e(this.left,this.top+this.innerHeight,this.left+this.innerWidth,this.bottom),
this.rightRegion=new e(this.left+this.innerWidth,this.top,this.right,this.bottom)),this},t(e,[{key:"outerWidth",get:function(){return this.right-this.left}},{key:"outerHeight",get:function(){return this.bottom-this.top}},{key:"innerWidth",get:function(){return this.image.width}},{key:"innerHeight",get:function(){return this.image.height}},{key:"isFilled",get:function(){return null!==this.image}}]),e}(),e("Region",u)}}}),e.register("github:maxdavidson/tribus@master/extra/color",["github:toji/gl-matrix@2.2.1"],function(e){"use strict";function t(e){var t=void 0===arguments[1]?r.create():arguments[1];return"number"==typeof e?r.set(t,((16711680&e)>>16)/255,((65280&e)>>8)/255,(255&e)/255):"length"in e&&r.copy(t,e),t}var n,r;return e("convertColorToVector",t),{setters:[function(e){n=e["default"]}],execute:function(){r=n.vec3}}}),e.register("github:maxdavidson/tribus@master/light/pointlight",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/object-without-properties","npm:babel-runtime@5.4.7/core-js/object/freeze","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base","npm:memoizee@0.3.8"],function(e){var t,n,r,i,o,a,s,u,c,l;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e.construct},function(e){a=e.Light,s=e.LightRenderer},function(e){u=e["default"]}],execute:function(){"use strict";c=function(e){function i(){var t=void 0===arguments[0]?{}:arguments[0],o=t.constant,a=void 0===o?1:o,s=t.linear,u=void 0===s?.7:s,c=t.quadratic,f=void 0===c?1.8:c,m=r(t,["constant","linear","quadratic"]);n(this,i),e.call(this,"pointlight",l,m),this.constant=a,this.linear=u,this.quadratic=f}return t(i,e),i}(a),e("default",c),l=function(e){function r(t,i){n(this,r),e.call(this,t,i)}return t(r,e),r.prototype.getLocations=function(e){return i({position:e.getUniformLocation("pointLights["+this.id+"].position"),diffuse:e.getUniformLocation("pointLights["+this.id+"].diffuse"),specular:e.getUniformLocation("pointLights["+this.id+"].specular"),constant:e.getUniformLocation("pointLights["+this.id+"].constant"),linear:e.getUniformLocation("pointLights["+this.id+"].linear"),quadratic:e.getUniformLocation("pointLights["+this.id+"].quadratic")})},r.prototype.render=function(e){var t=this.gl,n=this.light,r=this.getLocations(e);t.uniform3fv(r.position,n.worldPosition),t.uniform3fv(r.diffuse,n._diffuseVector),t.uniform3fv(r.specular,n._specularVector),t.uniform1f(r.constant,n.constant),t.uniform1f(r.linear,n.linear),t.uniform1f(r.quadratic,n.quadratic)},r}(s)}}}),e.register("github:maxdavidson/tribus@master/light/spotlight",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/object-without-properties","npm:babel-runtime@5.4.7/core-js/object/freeze","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base","npm:memoizee@0.3.8"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.construct},function(e){s=e.Light,u=e.LightRenderer},function(e){c=e["default"]}],execute:function(){"use strict";l=o.vec3,f=Math.PI/180,m=function(e){function i(){var t=void 0===arguments[0]?{}:arguments[0],o=t.constant,a=void 0===o?1:o,s=t.linear,u=void 0===s?.7:s,c=t.quadratic,f=void 0===c?1.8:c,m=t.cutoff,d=void 0===m?40:m,h=t.outerCutoff,b=void 0===h?35:h,g=r(t,["constant","linear","quadratic","cutoff","outerCutoff"]);n(this,i),e.call(this,"spotlight",p,g),this.constant=a,this.linear=u,this.quadratic=f,this.cutoff=d,this.outerCutoff=b,this.direction=l.create(),this.worldDirection=l.create()}return t(i,e),i.prototype.recalculate=function(t){var n=e.prototype.recalculate.call(this,t),r=this.direction,i=this.orientation;if(n){var o=i[0],a=i[1],s=i[2],u=i[3];r[0]=-2*(o*s+a*u),r[1]=2*(o*u-a*s),r[2]=o*o+a*a-(s*s+u*u),this.parent?l.transformMat3(this.worldDirection,this.direction,this.parent.normalMatrix):l.copy(this.worldDirection,this.direction)}return n},i}(s),e("default",m),p=function(e){function r(t,i){n(this,r),e.call(this,t,i)}return t(r,e),r.prototype.getLocations=function(e){return i({position:e.getUniformLocation("spotLights["+this.id+"].position"),direction:e.getUniformLocation("spotLights["+this.id+"].direction"),diffuse:e.getUniformLocation("spotLights["+this.id+"].diffuse"),specular:e.getUniformLocation("spotLights["+this.id+"].specular"),constant:e.getUniformLocation("spotLights["+this.id+"].constant"),linear:e.getUniformLocation("spotLights["+this.id+"].linear"),quadratic:e.getUniformLocation("spotLights["+this.id+"].quadratic"),cutoff:e.getUniformLocation("spotLights["+this.id+"].cutoff"),outerCutoff:e.getUniformLocation("spotLights["+this.id+"].outerCutoff")})},r.prototype.render=function(e){var t=this.gl,n=this.light,r=this.getLocations(e);t.uniform3fv(r.position,n.worldPosition),t.uniform3fv(r.direction,n.worldDirection),t.uniform3fv(r.diffuse,n._diffuseVector),t.uniform3fv(r.specular,n._specularVector),t.uniform1f(r.constant,n.constant),t.uniform1f(r.linear,n.linear),t.uniform1f(r.quadratic,n.quadratic),t.uniform1f(r.cutoff,n.cutoff*f),t.uniform1f(r.outerCutoff,n.outerCutoff*f)},r}(u)}}}),e.register("github:maxdavidson/tribus@master/scene/group",["npm:babel-runtime@5.4.7/helpers/bind","npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/array/from","npm:babel-runtime@5.4.7/core-js/symbol/iterator","npm:babel-runtime@5.4.7/regenerator","npm:babel-runtime@5.4.7/core-js/get-iterator","npm:babel-runtime@5.4.7/core-js/promise","github:maxdavidson/tribus@master/scene/base","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/phong","github:maxdavidson/tribus@master/extra/ajax","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/workers/wavefront"],function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];return new(n.apply(x,[null].concat(t)))}var n,r,i,o,a,s,u,c,l,f,m,p,d,h,b,g,v,y,x,w;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e["default"]},function(e){p=e["default"]},function(e){d=e.getArrayBuffer},function(e){h=e["default"]},function(e){b=e.workerpool}],execute:function(){"use strict";e("group",t),g=h.vec3,v=new Float64Array(24),y=64,x=function(e){function t(n){var r=void 0===arguments[1]?{}:arguments[1],a=void 0===arguments[2]?[]:arguments[2];i(this,t),e.call(this,n,r),this.children=o(a);for(var s=0,u=a.length;u>s;++s)a[s].parent=this}return r(t,e),t.prototype.toString=function(){var t=void 0===arguments[0]?["name","dirty"]:arguments[0],n=void 0===arguments[1]?0:arguments[1];return e.prototype.toString.call(this,t,n)+this.children.map(function(e){return"\n"+e.toString(t,n+1)}).join("")},t.prototype.forEach=function(e){e(this);for(var t=0,n=this.children,r=n.length;r>t;++t)n[t].forEach(e)},t.prototype.recalculate=function(t){var n=e.prototype.recalculate.call(this,t),r=this.aabb,i=this.children,o=this.children.length,a=!1,s=void 0,u=void 0;for(s=0;o>s;++s)u=i[s],u.dirty=u.dirty||n,n=u.recalculate(t)||n,a=a||u.processing;if(n){for(r.reset(),s=0;o>s;++s)r.expandFromBox(i[s].aabb);r.computePoints()}return!a&&i.length>y&&this.split(),this.processing=a,n},t.prototype.recalculateSubtreeIds=function(){var e=this.subtreeIds;e.length=1,e[0]=this.id;for(var t=0,n=this.children,r=(n.length,void 0);r=n[t];++t)r.recalculateSubtreeIds(),e.push.apply(e,r.subtreeIds)},t.prototype.add=function(e){e.parent=this,this.children.push(e)},t.prototype.remove=function(e){e.parent=null,this.children.splice(this.children.indexOf(e),1)},t.prototype[a]=s.mark(function n(){var e,t,r,i,o;return s.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this;case 2:e=this.children,t=Array.isArray(e),r=0,e=t?e:u(e);case 3:if(!t){n.next=9;break}if(!(r>=e.length)){n.next=6;break}return n.abrupt("break",17);case 6:i=e[r++],n.next=13;break;case 9:if(r=e.next(),!r.done){n.next=12;break}return n.abrupt("break",17);case 12:i=r.value;case 13:return o=i,n.delegateYield(o,"t5",15);case 15:n.next=3;break;case 17:case"end":return n.stop()}},n,this)}),t.prototype.split=function(){for(var e=this.aabb.center,t=[[],[],[],[],[],[],[],[]],n=e[0],r=e[1],i=e[2],o=void 0,a=void 0,s=0,u=this.children,c=u.length;c>s;++s)a=u[s],o=a.aabb.center,t[((o[0]<n)<<2)+((o[1]<r)<<1)+(o[2]<i)].push(a);for(var l=[],s=0,c=t.length,f=void 0;f=t[s];++s)if(f.length>0){var m=new w(this,{},f);m.parent=this,l.push(m)}this.children=l},t.fromObjFile=function(e){var n=new t;return d(e).then(function(t){var r={};b.run(t,[t]).subscribe(function(t){var i=t[0],o=t[1];switch(i){case"mtllib":var a=e.substr(0,e.lastIndexOf("/")+1)+o;r=p.fromMtlFile(a);break;case"geometry":c.resolve(r).then(function(e){var t=function(t){var r=e[o.materialName],i=new f(name,{},t,r);n.add(i)},r=function(e){t(e)},i=new m(o);0===i.normals.length?i.generateNormals().then(r):r(i)})}})}),n},t}(l),e("default",x),w=function(e){function t(n){var r=void 0===arguments[1]?{}:arguments[1],o=void 0===arguments[2]?[]:arguments[2];i(this,t),e.call(this,"split",r,o),this.orientation=n.orientation,this.position=n.position,this.scale=n.scale,this.localTransform=n.localTransform,this.worldTransform=n.worldTransform,this.direction=n.direction,this.worldDirection=n.worldDirection,this.worldPosition=n.worldPosition,this.normalMatrix=n.normalMatrix,this.processing=!1}return r(t,e),t.prototype.recalculate=function(e){for(var t=this.aabb,n=this.children,r=this.children.length,i=this.dirty,o=i,a=0,s=void 0;s=n[a];++a)s.dirty=s.dirty||i,o=s.recalculate(e)||o;if(o){t.reset();for(var a=0;r>a;++a)t.expandFromBox(n[a].aabb);t.computePoints()}return n.length>y&&this.split(),e.set(this.id),this.dirty=!1,o},t}(x)}}}),e.register("github:maxdavidson/tribus@master/environment/environment",["npm:babel-runtime@5.4.7/helpers/class-call-check","github:maxdavidson/tribus@master/extra/color"],function(e){var t,n,r,i;return{setters:[function(e){t=e["default"]},function(e){n=e.convertColorToVector}],execute:function(){"use strict";r=WebGLRenderingContext,i=function(){function e(){var r=void 0===arguments[0]?{}:arguments[0],i=r.ambient,o=void 0===i?0:i;t(this,e),this.ambient=o,this._ambientVector=n(this.ambient)}return e.prototype.initialize=function(e){this.gl=e.gl;var t=this._ambientVector;this.gl.clearColor(t[0],t[1],t[2],1)},e.prototype.render=function(){this.gl.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)},e.prototype.renderLast=function(){},e}(),e("default",i)}}}),e.register("github:maxdavidson/tribus@master/extra/bitfield",["npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/array/from"],function(e){var t,n,r,i;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=function(){function e(){var t=void 0===arguments[0]?8:arguments[0],r=void 0===arguments[1]?{}:arguments[1],i=r.grow,o=void 0===i?!0:i;n(this,e);var a=Math.ceil((t+1)/32);this._grow=o,this._buffer=new Uint32Array(a),this._emptyBuffer=new Uint32Array(a)}return e.prototype.isEmpty=function(){for(var e=0,t=this._buffer,n=t.length;n>e;++e)if(0!==t[e])return!1;return!0},e.prototype.toString=function(){return r(this._buffer,function(e){var t="00000000000000000000000000000000",n=e.toString(2);return(t.substring(0,32-n.length)+n).split("").reverse().join("")}).join("")},e.prototype.toArray=function(){for(var e=this._buffer,t=e.length<<5,n=[],r=0;t>r;++r)0!==(e[r>>5]&1<<r%32)&&n.push(r);return n},e.prototype.toBitArray=function(){for(var e=this._buffer,t=e.length<<5,n=new Array(t),r=0;t>r;++r)n[r]=0!==(e[r>>5]&1<<r%32);return n},e.prototype.get=function(e){return 0!==(this._buffer[e>>5]&1<<e%32)},e.prototype.set=function(e){var t=e>>5;this._grow&&t>=this._buffer.length&&this._resize(e),this._buffer[t]|=1<<e%32},e.prototype.unset=function(e){var t=e>>5;this._grow&&t>=this._buffer.length&&this._resize(e),this._buffer[t]&=~(1<<e%32)},e.prototype.reset=function(){this._buffer.set(this._emptyBuffer)},e.prototype.forEach=function(e){var t=this._buffer,n=void 0,r=void 0,i=void 0,o=void 0;for(i=0,r=t.length;r>i;++i)for(n=t[i],o=0;32>o;++o)0!==(n&1<<o)&&e((i<<5)+o)},e.applyUnaryFunction=function(e,t,n){var r=t._buffer,i=e._buffer,o=r.length;i.length<o&&(e._resize((o<<5)-1),i=e._buffer);for(var a=0;o>a;++a)i[a]=n(r[a]);return e},e.applyBinaryFunction=function(e,t,n,r){var i=t._buffer,o=n._buffer,a=e._buffer,s=Math.max(i.length,o.length);a.length<s&&(e._resize((s<<5)-1),a=e._buffer);for(var u=0;s>u;++u)a[u]=r(i[u],o[u]);return e},e.prototype.diff=function(t){var n=void 0===arguments[1]?new e:arguments[1];return e.applyBinaryFunction(n,this,t,e.xor)},e.prototype.union=function(t){var n=void 0===arguments[1]?new e:arguments[1];return e.applyBinaryFunction(n,this,t,e.or)},e.prototype.intersection=function(t){var n=void 0===arguments[1]?new e:arguments[1];return e.applyBinaryFunction(n,this,t,e.and)},e.prototype._resize=function(e){var t=this._buffer,n=Math.ceil((e+1)/32);this._buffer=new Uint32Array(n),this._emptyBuffer=new Uint32Array(n),this._buffer.set(t)},t(e,[{key:"length",get:function(){for(var e=this._buffer,t=e.length<<5,n=0,r=0;t>r;++r)0!==(e[r>>5]&1<<r%32)&&n++;return n}}],[{key:"not",value:function(e){return~e},enumerable:!0},{key:"and",value:function(e,t){return e&t},enumerable:!0},{key:"nand",value:function(e,t){return~(e&t)},enumerable:!0},{key:"or",value:function(e,t){return e|t},enumerable:!0},{key:"nor",value:function(e,t){return~(e|t)},enumerable:!0},{key:"xor",value:function(e,t){return e^t},enumerable:!0},{key:"xnor",value:function(e,t){return~(e^t)},enumerable:!0},{key:"added",value:function(e,t){return~e&t},enumerable:!0},{key:"removed",value:function(e,t){return e&~t},enumerable:!0}]),e}(),e("default",i)}}}),e.register("github:maxdavidson/tribus@master/geometry/shapes",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","github:maxdavidson/tribus@master/geometry/geometry","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a,s,u,c,l;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]}],execute:function(){"use strict";o=i.vec3,a=i.mat4,s=o.create(),u=a.create(),c=function(e){function r(){n(this,r);var t=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,-1];e.call(this,{vertices:t.map(function(e){return.5*e}),normals:t.map(function(e){return Math.sqrt(3)/3*e}),texcoords:[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,0,0,1,1,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,1,9,8,9,10,11,12,13,11,13,14,15,16,2,15,2,17,15,18,19,15,19,10]})}return t(r,e),r}(r),e("Cube",c),l=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0],i=t.size,o=void 0===i?8:i,a=t.heightmap,s=void 0===a?null:a,u=t.repeat,c=void 0===u?!1:u;n(this,r);var l=null,f=void 0,m=void 0;null===s?(f=o,m=o):(f=s.width,m=s.height,l=s.image.data);var p=f*m,d=(f-1)*m*2,h=new Float32Array(3*p),b=new Float32Array(2*p),g=new Uint16Array(3*d),v=void 0,y=void 0,x=void 0;for(v=0;f>v;++v)for(y=0;m>y;++y)x=v+y*f,h[3*x]=v/(f-1)-.5,h[3*x+1]=l?l[4*x]/255:0,h[3*x+2]=y/(m-1)-.5,b[2*x]=c?v%2==1:v/f,b[2*x+1]=c?y%2==1:1-y/m;for(v=0;f-1>v;++v)for(y=0;m-1>y;++y)x=6*(v+y*(f-1)),g[x]=v+y*f,g[x+1]=v+(y+1)*f,g[x+2]=v+1+y*f,g[x+3]=v+1+y*f,g[x+4]=v+(y+1)*f,g[x+5]=v+1+(y+1)*f;var w={vertices:h,texcoords:b,indices:g};if(!l){for(var j=new Float32Array(h.length),_=1,E=h.length;E>_;_+=3)j[_]=1;w.normals=j}e.call(this,w),this.heightmap=s}return t(r,e),r.prototype.getHeightAtWorldPosition=function(e,t){var n=this,r=o.transformMat4(s,e.worldPosition,a.invert(u,t.worldTransform));null===this.heightmap?r[1]=0:!function(){var e=function(e,t,n){return Math.min(Math.max(e,t),n)},t=n.heightmap.image.width,i=n.heightmap.image.height,o=e(t*(r[0]+.5),0,t-1),a=e(i*(r[2]+.5),0,i-1),s=Math.floor(o),u=Math.ceil(o),c=Math.floor(a),l=(Math.ceil(a),function(e,r){return n.heightmap.image.data[4*(e+r*t)]/256}),f=function(e,t,n){return e+n*(t-e)};r[1]=f(l(s,c),l(u,c),o%1)}();var i=o.transformMat4(s,r,t.worldTransform);return i[1]},r}(r),e("Plane",l)}}}),e.register("github:maxdavidson/tribus@master/texture/cubemap",["npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/bind","npm:babel-runtime@5.4.7/core-js/promise","npm:babel-runtime@5.4.7/core-js/math/log2","github:maxdavidson/tribus@master/texture/common"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e.resizeImage,a=e.getImage}],execute:function(){"use strict";s=function(){var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE)}(),u=function(){function e(n,r,i,o,a,s){t(this,e),this.right=n,this.left=r,this.top=i,this.bottom=o,this.front=a,this.back=s}return e.fromFiles=function(t,u,c,l,f,m,p){return r.all([t,u,c,l,f,m].map(function(e){return a(e,p)})).then(function(t){var r=function(e){return 0!=e&&!(e&e-1)};return(t[0].width!==t[0].height||t[0].width>s||!r(t[0].width)||t.slice(0).some(function(e){return e.width!==t[0].width||e.height!==t[0].height}))&&!function(){var e=function(e){return 1<<Math.floor(i(Math.max(e.width,e.height)))},n=t.reduce(function(t,n){return Math.max(t,e(n))},0),r=Math.min(s,n);t=t.map(function(e){return o(e,r,r)})}(),new(n.apply(e,[null].concat(t)))})},e}(),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/extra/helpers",["npm:babel-runtime@5.4.7/helpers/bind","npm:babel-runtime@5.4.7/core-js/promise","npm:babel-runtime@5.4.7/core-js/object/keys","npm:babel-runtime@5.4.7/core-js/object/assign","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/scene/group","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/phong","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/geometry/shapes"],function(e){function t(e){return j.fromFile(e).then(function(e){return new E({heightmap:e})}).then(function(e){return e.generateNormals()})}function n(){return new T}function r(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(p.apply(E,[null].concat(t)))}function i(){var e=void 0===arguments[0]?{}:arguments[0];return new y(e)}function o(){var e=void 0===arguments[0]?{}:arguments[0];return new PointLight(e)}function a(){var e=void 0===arguments[0]?{}:arguments[0];return new SpotLight(e)}function s(e){return x.fromFile(e)}function u(e){return j.fromFile(e)}function c(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return _.fromFiles.apply(_,t)}function l(){var e=void 0===arguments[0]?{}:arguments[0];return d.all(h(e).map(function(t){return d.resolve(e[t]).then(function(e){var n;return n={},n[t]=e,n})})).then(function(e){return b.apply(Object,[{}].concat(e))}).then(function(e){return new w(e)})}function f(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(p.apply(g,[null].concat(t)))}function m(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(p.apply(v,[null].concat(t)))}var p,d,h,b,g,v,y,x,w,j,_,E,T;return{setters:[function(e){p=e["default"]},function(e){d=e["default"]},function(e){h=e["default"]},function(e){b=e["default"]},function(e){g=e["default"]},function(e){v=e["default"]},function(e){y=e["default"]},function(e){x=e["default"]},function(e){w=e["default"]},function(e){j=e["default"]},function(e){_=e["default"]},function(e){E=e.Plane,T=e.Cube}],execute:function(){"use strict";e("terrain",t),e("cube",n),e("plane",r),e("camera",i),e("pointlight",o),e("spotlight",a),e("geometry",s),e("texture2d",u),e("cubemap",c),e("phong",l),e("model",f),e("group",m)}}}),e.register("github:maxdavidson/tribus@master/webgl/shader",["npm:babel-runtime@5.4.7/helpers/class-call-check","github:maxdavidson/tribus@master/extra/ajax"],function(e){var t,n,r,i;return{setters:[function(e){t=e["default"]},function(e){n=e.getString}],execute:function(){"use strict";r=WebGLRenderingContext,i=function(){function e(n,r,i){t(this,e),this.gl=n,this.type=i,this.handle=n.createShader(i),n.shaderSource(this.handle,r),n.compileShader(this.handle);var o=this.getInfoLog();""!==o&&console.error(o)}return e.prototype.destroy=function(){this.gl.deleteShader(this.handle)},e.prototype.getInfoLog=function(){return this.gl.getShaderInfoLog(this.handle)},e.prototype.getSource=function(){return this.gl.getShaderSource(this.handle)},e.prototype.getTranslatedSource=function(){return this.gl.getExtension("WEBGL_debug_shaders").getTranslatedShaderSource(this.handle)},e.fromFile=function(t,i){var o={vert:r.VERTEX_SHADER,frag:r.FRAGMENT_SHADER}[i.split(".").pop()];return n(i).then(function(n){return new e(t,n,o)})},e}(),e("default",i)}}}),e.register("github:maxdavidson/tribus@master/workers/normal-vectors",["github:maxdavidson/tribus@master/extra/worker-pool","github:toji/gl-matrix@2.2.1/src/gl-matrix/vec3.js!github:systemjs/plugin-text@0.0.2"],function(e){"use strict";function t(e,t){console.time("Calculating normals");for(var n=t.vertices,r=t.indices,i=new Float32Array(n.length),o=new Array(n.length/3),a=new Float32Array(r.length),s=0,u=o.length;u>s;++s)o[s]=[];for(var c=0,u=r.length;u>c;c+=3){var l=r[c],f=r[c+1],m=r[c+2],p=3*l,d=3*f,h=3*m,b=vec3.set(tmp0,n[p],n[p+1],n[p+2]),g=vec3.set(tmp1,n[d],n[d+1],n[d+2]),v=vec3.set(tmp2,n[h],n[h+1],n[h+2]);o[l].push(c),o[f].push(c),o[m].push(c);var y=vec3.cross(tmp0,vec3.subtract(tmp1,g,b),vec3.subtract(tmp2,v,b));a.set(y,c)}for(var x=0,w=o.length;w>x;++x){for(var j=o[x],_=j[0],E=vec3.set(tmp0,a[_],a[_+1],a[_+2]),T=1,A=j.length;A>T;++T)_=j[T],E[0]+=a[_],E[1]+=a[_+1],E[2]+=a[_+2];vec3.normalize(E,E);var c=3*x;i.set(E,c)}console.timeEnd("Calculating normals"),e.done({indices:r,vertices:n,normals:i},[r.buffer,n.buffer,i.buffer])}var n,r,i;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){i=n.fromFunction(t,{dependencies:["var GLMAT_ARRAY_TYPE = Float32Array;",r,"var tmp0 = vec3.create(), tmp1 = vec3.create(), tmp2 = vec3.create();"]}),e("workerpool",i)}}}),e.register("github:maxdavidson/tribus@master/material/base",["npm:babel-runtime@5.4.7/helpers/class-call-check","github:maxdavidson/tribus@master/extra/errors"],function(e){var t,n,r,i,o;return{setters:[function(e){t=e["default"]},function(e){n=e.UnimplementedMethodError}],execute:function(){"use strict";r=WebGLRenderingContext,i=function(){function e(){t(this,e)}return e.prototype.getRenderer=function(e){throw new n},e}(),e("Material",i),o=function(){function e(n){t(this,e),this.material=n,this.program=null,this.geometryRenderer=null}return e.prototype.init=function(e){throw new n},e.prototype.setGeometryRenderer=function(e){},e.prototype.beforeRender=function(){},e.prototype.render=function(e){},e.prototype.afterRender=function(){},e}(),e("MaterialRenderer",o)}}}),e.register("github:maxdavidson/tribus@master/workers/tga",["github:maxdavidson/tribus@master/extra/worker-pool","github:maxdavidson/jsTGALoader@master/tga.js!github:systemjs/plugin-text@0.0.2"],function(e){"use strict";function t(e,t){tga.load(new Uint8ClampedArray(t));var n=tga.getImageData();e.done(n,[n.data.buffer])}var n,r,i;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){i=n.fromFunction(t,{dependencies:[r,"var tga = new TGA();"]}),e("workerpool",i)}}}),e.register("github:maxdavidson/tribus@master/light/base",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/object-without-properties","npm:babel-runtime@5.4.7/core-js/weak-map","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/scene/base","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/extra/color"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e.convertColorToVector}],execute:function(){"use strict";c=o.vec3,l=function(e){function i(t,o){var a=this,l=void 0===arguments[2]?{}:arguments[2],f=l.diffuse,m=void 0===f?16777215:f,p=l.specular,d=void 0===p?m:p,h=r(l,["diffuse","specular"]);n(this,i),e.call(this,t,h),this.diffuse=m,this.specular=d,this.worldPosition=c.create(),this._lastDiffuse=null,this._lastSpecular=null,this._diffuseVector=u(this.diffuse),this._specularVector=u(this.specular),this.getRenderer=s(function(e){return new o(a,e)})}return t(i,e),i.prototype.recalculate=function(t){(this.diffuse!==this._lastDiffuse||this.specular!==this._lastSpecular)&&(u(this.diffuse,this._diffuseVector),u(this.specular,this._specularVector),this._lastDiffuse=this.diffuse,this._lastSpecular=this.specular);var n=e.prototype.recalculate.call(this,t);return n&&(this.parent?c.transformMat4(this.worldPosition,this.position,this.parent.worldTransform):c.copy(this.worldPosition,this.position)),n},i}(a),e("Light",l),f=new i,m=function(){function e(t,r){n(this,e),this.light=t,this.gl=r,this.id=e.allocateLight(t.constructor),this.getLocations=s(this.getLocations.bind(this))}return e.allocateLight=function(e){var t=f.get(e)||0;return f.set(e,t+1),t},e.prototype.getLocations=function(e){},e.prototype.render=function(){},e}(),e("LightRenderer",m)}}}),e.register("github:maxdavidson/tribus@master/environment/skybox",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/promise","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/environment/environment","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/geometry/shapes","github:maxdavidson/tribus@master/texture/common"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e.Cube},function(e){c=e.allocateTextureUnit}],execute:function(){"use strict";l=i.mat4,f=WebGLRenderingContext,m="\n    uniform mat4 cameraMatrix;\n    attribute mediump vec3 vertex;\n    varying mediump vec3 texcoord;\n\n    void main() {\n        gl_Position = cameraMatrix * vec4(vertex, 1.0);\n        texcoord = vertex;\n    }\n",p="\n    uniform mat4 cameraMatrix;\n    attribute mediump vec3 vertex;\n    varying mediump vec3 texcoord;\n\n    void main() {\n        vec4 pos = cameraMatrix * vec4(vertex, 1.0);\n        gl_Position = pos.xyww;\n        texcoord = vertex;\n    }\n",d="\n    precision mediump float;\n    varying vec3 texcoord;\n    uniform samplerCube skybox;\n\n    void main() {\n        gl_FragColor = textureCube(skybox, texcoord);\n    }\n",h=function(e){function i(t){var o=this,a=void 0===arguments[1]?{}:arguments[1];n(this,i),e.call(this,a),this.cubemap=null,this._onCubemapReady=r.resolve(t).then(function(e){o.cubemap=e}),this.cube=new u,this.program=null,this.unit=null,this.handle=null,this.cubeRenderer=null,this.locations=null,this.initialized=!1,this.cameraMatrix=l.create()}return t(i,e),i.prototype.initialize=function(t){var n=this;e.prototype.initialize.call(this,t);var r=this.gl=t.gl;this.program=new a(r,new s(r,d,f.FRAGMENT_SHADER),new s(r,p,f.VERTEX_SHADER)),this.unit=c(r),this.handle=r.createTexture(),this.cubeRenderer=this.cube.getRenderer(r),this.locations={sampler:this.program.getUniformLocation("skybox"),cameraMatrix:this.program.getUniformLocation("cameraMatrix")},this.cubeRenderer.vertexBuffer.setAttribLocation("vertex",this.program),this._onCubemapReady.then(function(){r.activeTexture(f.TEXTURE0+n.unit),r.bindTexture(f.TEXTURE_CUBE_MAP,n.handle),r.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MIN_FILTER,f.LINEAR),r.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_MAG_FILTER,f.LINEAR),r.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),r.texParameteri(f.TEXTURE_CUBE_MAP,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),r.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,n.cubemap.right),r.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_X,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,n.cubemap.left),r.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Y,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,n.cubemap.top),r.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,n.cubemap.bottom),r.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Z,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,n.cubemap.back),r.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,n.cubemap.front),r.generateMipmap(f.TEXTURE_CUBE_MAP),r.bindTexture(f.TEXTURE_CUBE_MAP,null),n.initialized=!0})},i.prototype.render=function(){this.gl.clear(f.DEPTH_BUFFER_BIT)},i.prototype.renderLast=function(e){if(this.initialized){var t=this.program.gl;t.disable(f.CULL_FACE),t.depthFunc(f.LEQUAL),this.program.use(),t.uniform1i(this.locations.sampler,this.unit),t.activeTexture(f.TEXTURE0+this.unit),t.bindTexture(f.TEXTURE_CUBE_MAP,this.handle),l.copy(this.cameraMatrix,e.camera.viewMatrix),this.cameraMatrix[12]=0,this.cameraMatrix[13]=0,this.cameraMatrix[14]=0,l.multiply(this.cameraMatrix,e.camera.projectionMatrix,this.cameraMatrix),t.uniformMatrix4fv(this.locations.cameraMatrix,!1,this.cameraMatrix),this.cubeRenderer.render(),t.enable(f.CULL_FACE),t.depthFunc(f.LESS)}},i}(o),e("default",h)}}}),e.register("github:maxdavidson/tribus@master/webgl/program",["npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/bind","npm:babel-runtime@5.4.7/core-js/map","npm:babel-runtime@5.4.7/core-js/promise","github:maxdavidson/tribus@master/webgl/shader"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]}],execute:function(){"use strict";a=WebGLRenderingContext,s={35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT"},u=function(){function e(n){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;i>s;s++)o[s-1]=arguments[s];if(t(this,e),this.gl=n,this.handle=n.createProgram(),this.vertexShader=o.filter(function(e){return e.type===a.VERTEX_SHADER})[0]||null,this.fragmentShader=o.filter(function(e){return e.type===a.FRAGMENT_SHADER})[0]||null,this._attribLocationCache=new r,this._uniformLocationCache=new r,[this.vertexShader,this.fragmentShader].some(function(e){return null===e}))throw"You need to supply both a vertex and a fragment shader!";n.attachShader(this.handle,this.vertexShader.handle),n.attachShader(this.handle,this.fragmentShader.handle),n.linkProgram(this.handle);var u=this.getInfoLog();""!==u&&console.error(u);
}return e.prototype.use=function(){this.gl.useProgram(this.handle)},e.prototype.destroy=function(){this.gl.deleteProgram(this.handle),this.fragmentShader.destroy(),this.vertexShader.destroy()},e.prototype.getUniformLocation=function(e){var t=this._uniformLocationCache.get(e);return void 0===t&&(t=this.gl.getUniformLocation(this.handle,e),null===t&&console.error("Couldn't get uniform location: "+e),this._uniformLocationCache.set(e,t)),t},e.prototype.getAttribLocation=function(e){var t=this._attribLocationCache.get(e);return void 0===t&&(t=this.gl.getAttribLocation(this.handle,e),null===t&&console.error("Couldn't get attribute location: "+e),this._attribLocationCache.set(e,t)),t},e.prototype.getInfoLog=function(){return this.gl.getProgramInfoLog(this.handle)},e.prototype.getActiveUniforms=function(){for(var e=[],t=0;t<this.gl.getProgramParameter(this.handle,a.ACTIVE_UNIFORMS);++t){var n=this.gl.getActiveUniform(this.handle,t);n.typeName=s[n.type],n.value=this.gl.getUniform(this.handle,this.gl.getUniformLocation(this.handle,n.name)),e.push(n)}return e},e.prototype.getActiveAttributes=function(){for(var e=[],t=0;t<this.gl.getProgramParameter(this.handle,a.ACTIVE_ATTRIBUTES);++t){var n=this.gl.getActiveAttrib(this.handle,t);n.typeName=s[n.type],e.push(n)}return e},e.fromShaderPromises=function(t){for(var r=arguments.length,o=Array(r>1?r-1:0),a=1;r>a;a++)o[a-1]=arguments[a];return i.all(o).then(function(r){return new(n.apply(e,[null].concat([t],r)))})},e.fromShaderFiles=function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;n>i;i++)r[i-1]=arguments[i];return e.fromShaderPromises(t,r.map(function(e){return o.fromFile(t,e)}))},e.prototype.setUniform=function(e,t){this.gl.uniform1f(this.getUniformLocation(e),t)},e.prototype.setUniformInt=function(e,t){this.gl.uniform1i(this.getUniformLocation(e),t)},e.prototype.setUniformVector=function(e,t){var n=this.getUniformLocation(e);switch(t.length){case 1:this.gl.uniform1fv(n,t);break;case 2:this.gl.uniform2fv(n,t);break;case 3:this.gl.uniform3fv(n,t);break;case 4:this.gl.uniform4fv(n,t)}},e.prototype.setUniformIntVector=function(e,t){var n=this.getUniformLocation(e);switch(t.length){case 1:this.gl.uniform1iv(n,t);break;case 2:this.gl.uniform2iv(n,t);break;case 3:this.gl.uniform3iv(n,t);break;case 4:this.gl.uniform4iv(n,t)}},e.prototype.setUniformMatrix=function(e,t){var n=void 0===arguments[2]?!1:arguments[2],r=this.getUniformLocation(e);switch(t.length){case 4:this.gl.uniformMatrix2fv(r,n,t);break;case 9:this.gl.uniformMatrix3fv(r,n,t);break;case 16:this.gl.uniformMatrix4fv(r,n,t)}},e}(),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/extra/async",["npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/core-js/promise","npm:babel-runtime@5.4.7/core-js/get-iterator","npm:babel-runtime@5.4.7/core-js/object/seal","npm:babel-runtime@5.4.7/core-js/object/freeze"],function(e){var t,n,r,i,o,a,s,u,c,l;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]}],execute:function(){"use strict";s=function f(){var e=this;t(this,f),this.promise=new r(function(t,n){e.resolve=t,e.reject=n})},e("PromiseCompleter",s),u=function(){function e(){var n=this,r=void 0===arguments[0]?{}:arguments[0],a=r.closeOnError,u=void 0===a?!0:a;t(this,e),this.completer=new s,this.stream=new l(this),this.subscriptions=[],this.onSubscribeCompleter=new s,this.onSubscribe=this.onSubscribeCompleter.promise.then(function(){for(var e=n.buffer,t=Array.isArray(e),r=0,e=t?e:i(e);;){var o;if(t){if(r>=e.length)break;o=e[r++]}else{if(r=e.next(),r.done)break;o=r.value}for(var a=o[0],s=o[1],u=n.subscriptions,c=Array.isArray(u),l=0,u=c?u:i(u);;){var f;if(c){if(l>=u.length)break;f=u[l++]}else{if(l=u.next(),l.done)break;f=l.value}var m=f;"data"===a?m._cb(s):m._errorCb(s)}}}),this.buffer=[],this.closeOnError=u,this.isClosed=!1,o(this)}return e.prototype.add=function(e){this.isClosed||(0===this.subscriptions.length?this.buffer.push(["data",e]):this.subscriptions.forEach(function(t){return t._cb(e)}))},e.prototype.addError=function(e){this.isClosed||(this.closeOnError&&this.completer.reject(e),0===this.subscriptions.length?this.buffer.push(["error",e]):this.subscriptions.forEach(function(e){return e._errorCb(data)}))},e.prototype.close=function(){this.isClosed=!0,this.completer.resolve(this)},e}(),e("StreamController",u),c=function(){function e(n,r){t(this,e),this.stream=n,this._cb=r,this._errorCb=function(){},o(this)}return e.prototype.onError=function(e){this._errorCb=e},e.prototype.unsubscribe=function(){this.stream._controller.subscriptions.splice(this.stream._controller.subscriptions.indexOf(this),1)},e}(),l=function(){function e(n){t(this,e),this._controller=n,a(this)}return e.prototype.subscribe=function(e){var t=new c(this,e);return this._controller.onSubscribeCompleter.resolve(),this._controller.subscriptions.push(t),t},e.prototype.transform=function(e){var t=this,n=new u,r={add:n.add.bind(n),addError:n.addError.bind(n)};return n.onSubscribe.then(function(){var i=t.subscribe(function(t){try{e(t,r)}catch(n){r.addError(n)}});i.onError(function(e){return n.fail(e)}),t.onComplete.then(function(){return n.close()})}),n.stream},e.prototype.filter=function(e){return this.transform(function(t,n){e(t)&&n.add(t)})},e.prototype.map=function(e){return this.transform(function(t,n){n.add(e(t))})},e.prototype.scan=function(e){var t=void 0===arguments[1]?{}:arguments[1],n=t;return this.transform(function(t,r){r.add(n=e(n,t))})},e.prototype.asyncMap=function(e){return this.transform(function(t,n){r.resolve(e(t)).then(function(e){return n.add(e)})["catch"](function(e){return n.addError(e)})})},e.prototype.toArray=function(){var e=[];return this.subscribe(function(t){return e.push(t)}),this.onComplete.then(function(){return e})},n(e,[{key:"onComplete",get:function(){return this._controller.completer.promise}},{key:"first",get:function(){var e=this;return new r(function(t,n){var r=void 0;r=e.subscribe(function(e){t(e),r.unsubscribe()}),r.onError(n)})}}]),e}()}}}),e.register("github:maxdavidson/tribus@master/texture/common",["npm:babel-runtime@5.4.7/core-js/map","npm:babel-runtime@5.4.7/core-js/promise","github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/workers/tga"],function(e){function t(e){var t=l.get(e)||0;return l.set(e,t+1),t}function n(e){var t=void 0===arguments[1]?e.width:arguments[1],n=void 0===arguments[2]?e.height:arguments[2];return function(){return f.canvas.width=e.width,f.canvas.height=e.height,"data"in e?f.putImageData(e,0,0):f.drawImage(e,0,0),m.canvas.width=t,m.canvas.height=n,m.drawImage(f.canvas,0,0,t,n),m.getImageData(0,0,t,n)}()}function r(e){var t=void 0===arguments[1]?e.split(".").pop():arguments[1];return function(){return(p[t]||i)(e)}()}function i(e){return new s(function(t,n){var r=document.createElement("img"),i=function(){a(),t(r)},o=function(e){n(e),a()},a=function(){r.removeEventListener("load",i),r.removeEventListener("error",o)};r.addEventListener("error",o,!1),r.addEventListener("load",i,!1),r.src=e})}function o(e){return u(e).then(function(e){return c.run(e,[e]).first}).then(function(e){var t=e.data,n=e.width,r=e.height,i=f.createImageData(n,r);return i.data.set(t),i})}var a,s,u,c,l,f,m,p;return{setters:[function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e.getArrayBuffer},function(e){c=e.workerpool}],execute:function(){"use strict";e("allocateTextureUnit",t),e("resizeImage",n),e("getImage",r),l=new a,f=document.createElement("canvas").getContext("2d"),m=document.createElement("canvas").getContext("2d"),p={tga:o}}}}),e.register("github:maxdavidson/tribus@master/light/directional-light",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/object/freeze","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.construct},function(e){s=e.Light,u=e.LightRenderer}],execute:function(){"use strict";c=i.vec3,l=c.fromValues(0,0,-1),f=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,"directional-light",m,t),this.direction=c.create()}return t(r,e),r.prototype.recalculate=function(t){var n=e.prototype.recalculate.call(this,t);if(n){var r=this.direction,i=this.orientation,o=i[0],a=i[1],s=i[2],u=i[3];r[0]=-2*(o*s+a*u),r[1]=2*(o*u-a*s),r[2]=o*o+a*a-(s*s+u*u)}return n},r}(s),e("default",f),m=function(e){function i(t,r){n(this,i),e.call(this,t,r)}return t(i,e),i.prototype.getLocations=function(e){return r({direction:e.getUniformLocation("directionalLights["+this.id+"].direction"),diffuse:e.getUniformLocation("directionalLights["+this.id+"].diffuse"),specular:e.getUniformLocation("directionalLights["+this.id+"].specular")})},i.prototype.render=function(e){var t=this.gl,n=this.light,r=this.getLocations(e);t.uniform3fv(r.direction,n.direction),t.uniform3fv(r.diffuse,n._diffuseVector),t.uniform3fv(r.specular,n._specularVector)},i}(u)}}}),e.register("github:maxdavidson/tribus@master/control/mouseview",["npm:babel-runtime@5.4.7/helpers/class-call-check","github:baconjs/bacon.js@0.7.59","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a,s,u,c;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=r.vec3,o=r.mat4,a=r.quat,s=function(e){return function(t){return e===t}},u=i.create(),c=function(){function e(r,i){function o(e){var t=void 0!==e.movementX?e.movementX:e.mozMovementX,n=void 0!==e.movementY?e.movementY:e.mozMovementY;I.pitch=Math.max(-90,Math.min(90,I.pitch+R*n)),I.yaw+=R*t,I.yaw=I.yaw%360}function a(){document.pointerLockElement===h||document.mozPointerLockElement===h?(console.log("The pointer lock status is now locked"),document.addEventListener("mousemove",o,!1),I.locked=!0):(console.log("The pointer lock status is now unlocked"),document.removeEventListener("mousemove",o,!1),I.locked=!1)}function u(e){e.preventDefault(),z=e.touches[0].pageX,N=e.touches[0].pageY;var t=$-z,n=F-N;I.pitch=Math.max(-90,Math.min(90,D+O*n)),I.yaw=C+O*t,I.yaw=I.yaw%360}var c=this,l=void 0===arguments[2]?{}:arguments[2],f=l.speed,m=void 0===f?1:f,p=l.mode,d=void 0===p?"walk":p;t(this,e),this.target=r,this.mode=d,this.yaw=0,this.pitch=0,this.roll=0,this.forward=0,this.sideways=0,this.turn=0,this.locked=!1,this.moving=!1,this.first=!0,this.speed=m;var h=i.canvas,b=["keydown","keyup"].map(function(e){return n.fromEventTarget(document.body,e).map(function(e){return e.keyCode})}),g=b[0],v=b[1],y=function(e){return n.mergeAll(g.filter(s(e)).map(function(){return!0}),v.filter(s(e)).map(function(){return!1})).skipDuplicates().toProperty(!1)},x="WASDQE".split("").map(function(e){return e.charCodeAt(0)}).map(y),w=x[0],j=x[1],_=x[2],E=x[3],T=x[4],A=x[5],S=[[E,j],[_,w],[T,A]].map(function(e){var t=e[0],r=e[1];return n.combineWith(function(e,t){return e+t},t.map(function(e){return+e}),r.map(function(e){return-e}))}),M=S[0],k=S[1],L=S[2];M.onValue(function(e){c.sideways=e}),k.onValue(function(e){c.forward=e}),L.onValue(function(e){c.turn=e});var I=this;n.combineWith(function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t.some(function(e){return e})},w,j,_,E,T,A).onValue(function(e){I.moving=e}),g.filter(s("F".charCodeAt(0))).onValue(function(e){h.requestFullscreen?h.requestFullscreen():h.msRequestFullscreen?h.msRequestFullscreen():h.mozRequestFullScreen?h.mozRequestFullScreen():h.webkitRequestFullscreen&&h.webkitRequestFullscreen()}),g.filter(s("C".charCodeAt(0))).onValue(function(){window.cull=!window.cull}),h.requestPointerLock=h.requestPointerLock||h.mozRequestPointerLock||function(){},h.addEventListener("click",function(){h.requestPointerLock()},!1);var R=.1;document.addEventListener("pointerlockchange",a,!1),document.addEventListener("mozpointerlockchange",a,!1),this.touching=!1;var O=.2,D=void 0,C=void 0,$=void 0,F=void 0,z=void 0,N=void 0;h.addEventListener("touchstart",function(e){h.addEventListener("touchmove",u,!1),D=c.pitch,C=c.yaw,$=e.touches[0].pageX,F=e.touches[0].pageY,I.touching=!0},!1),h.addEventListener("touchend",function(e){h.removeEventListener("touchmove",u,!1),I.touching=0!==e.touches.length},!1),i.on("tick",this.tick.bind(this))}return e.prototype.tick=function(e){if(this.first||this.moving||this.locked||this.touching){var t=this.target;t.lookForward(),t.rotateY(-this.yaw),i.set(u,e/200*this.speed*this.sideways,0,e/200*this.speed*this.forward),"walk"===this.mode&&t.translateRelatively(u),t.rotateX(-this.pitch),t.rotateZ(-this.roll),"fly"===this.mode&&t.translateRelatively(u),this.first=!1}},e}(),e("default",c)}}}),e.register("github:maxdavidson/tribus@master/extra/webgl-debug",["npm:babel-runtime@5.4.7/core-js/object/keys"],function(e){function t(e){if(null==h){h={},b={};for(var t in e)"number"==typeof e[t]&&(h[e[t]]=t,b[t]=e[t])}}function n(){if(null==h)throw"WebGLDebugUtils.init(ctx) not called"}function r(e){return n(),void 0!==h[e]}function i(e){n();var t=h[e];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function o(e,t,n,r){var o=d[e];if(void 0!==o){var o=o[t];if(void 0!==o&&o[n]){if("object"==typeof o[n]&&void 0!==o[n].enumBitwiseOr){for(var a=o[n].enumBitwiseOr,s=0,u=[],c=0;c<a.length;++c){var l=b[a[c]];0!==(r&l)&&(s|=l,u.push(i(l)))}return s===r?u.join(" | "):i(r)}return i(r)}}return null===r?"null":void 0===r?"undefined":r.toString()}function a(e,t){for(var n="",r=t.length,i=0;r>i;++i)n+=(0==i?"":", ")+o(e,r,i,t[i]);return n}function s(e,t,n){e.__defineGetter__(n,function(){return t[n]}),e.__defineSetter__(n,function(e){t[n]=e})}function u(e,n,r,a){function c(e,t){return function(){r&&r(t,arguments);var i=e[t].apply(e,arguments),o=a.getError();return 0!=o&&(l[o]=!0,n(o,t,arguments)),i}}a=a||e,t(e),n=n||function(e,t,n){for(var r="",a=n.length,s=0;a>s;++s)r+=(0==s?"":", ")+o(t,a,s,n[s]);p("WebGL error "+i(e)+" in "+t+"("+r+")")};var l={},f={};for(var m in e)if("function"==typeof e[m])if("getExtension"!=m)f[m]=c(e,m);else{var d=c(e,m);f[m]=function(){var t=d.apply(e,arguments);return u(t,n,r,a)}}else s(f,e,m);return f.getError=function(){for(var t in l)if(l.hasOwnProperty(t)&&l[t])return l[t]=!1,t;return e.NO_ERROR},f}function c(e){var t=e.getParameter(e.MAX_VERTEX_ATTRIBS),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);for(var r=0;t>r;++r)e.disableVertexAttribArray(r),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(r,0);e.deleteBuffer(n);for(var i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),r=0;i>r;++r)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);for(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);e.getError(););}function l(e){function t(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}function n(e){var t=e.addEventListener;e.addEventListener=function(n,r,i){switch(n){case"webglcontextlost":E(r);break;case"webglcontextrestored":T(r);break;default:t.apply(e,arguments)}}}function r(){for(var e=f(_),t=0;t<e.length;++t)delete _[e]}function i(){++x,g||y==x&&e.loseContext()}function o(e,t){var n=e[t];return function(){if(i(),!g){var t=n.apply(e,arguments);return t}}}function a(){for(var e=0;e<v.length;++e){var t=v[e];t instanceof WebGLBuffer?m.deleteBuffer(t):t instanceof WebGLFramebuffer?m.deleteFramebuffer(t):t instanceof WebGLProgram?m.deleteProgram(t):t instanceof WebGLRenderbuffer?m.deleteRenderbuffer(t):t instanceof WebGLShader?m.deleteShader(t):t instanceof WebGLTexture&&m.deleteTexture(t)}}function u(e){return{statusMessage:e,preventDefault:function(){w=!0}}}function l(e){for(var t in e)"function"==typeof e[t]?p[t]=o(e,t):s(p,e,t);p.getError=function(){if(i(),!g)for(var e;e=m.getError();)_[e]=!0;for(var e in _)if(_[e])return delete _[e],e;return p.NO_ERROR};for(var n=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],r=0;r<n.length;++r){var a=n[r];p[a]=function(t){return function(){if(i(),g)return null;var n=t.apply(e,arguments);return n.__webglDebugContextLostId__=b,v.push(n),n}}(e[a])}for(var u=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],r=0;r<u.length;++r){var a=u[r];p[a]=function(t){return function(){return i(),g?null:t.apply(e,arguments)}}(p[a])}for(var c=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],r=0;r<c.length;++r){var a=c[r];p[a]=function(t){return function(){return i(),g?!1:t.apply(e,arguments)}}(p[a])}return p.checkFramebufferStatus=function(t){return function(){return i(),g?p.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(p.checkFramebufferStatus),p.getAttribLocation=function(t){return function(){return i(),g?-1:t.apply(e,arguments)}}(p.getAttribLocation),p.getVertexAttribOffset=function(t){return function(){return i(),g?0:t.apply(e,arguments)}}(p.getVertexAttribOffset),p.isContextLost=function(){return g},p}var m,p,d=[],h=[],p={},b=1,g=!1,v=[],y=0,x=0,w=!1,j=0,_={};e.getContext=function(t){return function(){var n=t.apply(e,arguments);if(n instanceof WebGLRenderingContext){if(n!=m){if(m)throw"got different context";m=n,p=l(m)}return p}return n}}(e.getContext);var E=function(e){d.push(t(e))},T=function(e){h.push(t(e))};return n(e),e.loseContext=function(){if(!g){for(g=!0,y=0,++b;m.getError(););r(),_[m.CONTEXT_LOST_WEBGL]=!0;var t=u("context lost"),n=d.slice();setTimeout(function(){for(var r=0;r<n.length;++r)n[r](t);j>=0&&setTimeout(function(){e.restoreContext()},j)},0)}},e.restoreContext=function(){g&&h.length&&setTimeout(function(){if(!w)throw"can not restore. webglcontestlost listener did not call event.preventDefault";a(),c(m),g=!1,x=0,w=!1;for(var e=h.slice(),t=u("context restored"),n=0;n<e.length;++n)e[n](t)},0)},e.loseContextInNCalls=function(e){if(g)throw"You can not ask a lost contet to be lost";y=x+e},e.getNumCalls=function(){return x},e.setRestoreTimeout=function(e){j=e},e}var f,m,p,d,h,b;return{setters:[function(e){f=e["default"]}],execute:function(){"use strict";m=function(e){window.console&&window.console.log&&window.console.log(e)},p=function(e){window.console&&window.console.error?window.console.error(e):m(e)},d={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},h=null,b=null,e("default",{init:t,mightBeEnum:r,glEnumToString:i,glFunctionArgToString:o,glFunctionArgsToString:a,makeDebugContext:u,makeLostContextSimulatingCanvas:l,resetToInitialState:c})}}}),e.register("github:maxdavidson/tribus@master/extra/bounding-box",["npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/array/from"],function(e){var t,n,r;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]}],execute:function(){"use strict";r=function(){function e(){t(this,e),this.points=new Float64Array(24),this.center=new Float64Array(3)}return e.prototype.toString=function(){return"("+n(this.intervals,function(e){return e.toFixed(2)}).join(", ")+")"},e.prototype.intersects=function(e){var t=this.points,n=e.points;return t[21]>n[0]&&t[0]<n[21]&&t[22]>n[1]&&t[1]<n[22]&&t[23]>n[2]&&t[2]<n[23]},e.prototype.reset=function(){var e=this.points;e[0]=1/0,e[1]=1/0,e[2]=1/0,e[21]=-(1/0),e[22]=-(1/0),e[23]=-(1/0)},e.prototype.expandFromPoints=function(e){for(var t=void 0===arguments[1]?3:arguments[1],n=this.points,r=void 0,i=0,o=e.length;o>i;i+=t)r=e[i],r<n[0]?n[0]=r:r>n[21]&&(n[21]=r),r=e[i+1],r<n[1]?n[1]=r:r>n[22]&&(n[22]=r),r=e[i+2],r<n[2]?n[2]=r:r>n[23]&&(n[23]=r)},e.prototype.expandFromBox=function(e){var t=this.points,n=e.points;n[0]<t[0]&&(t[0]=n[0]),n[1]<t[1]&&(t[1]=n[1]),n[2]<t[2]&&(t[2]=n[2]),n[21]>t[21]&&(t[21]=n[21]),n[22]>t[22]&&(t[22]=n[22]),n[23]>t[23]&&(t[23]=n[23])},e.prototype.computePoints=function(){var e=this.points,t=this.center,n=e[0],r=e[1],i=e[2],o=e[21],a=e[22],s=e[23];e[3]=n,e[4]=r,e[5]=s,e[6]=n,e[7]=a,e[8]=i,e[9]=n,e[10]=a,e[11]=s,e[12]=o,e[13]=r,e[14]=i,e[15]=o,e[16]=r,e[17]=s,e[18]=o,e[19]=a,e[20]=i,t[0]=(n+o)/2,t[1]=(r+a)/2,t[2]=(i+s)/2},e}(),e("default",r)}}}),e.register("github:maxdavidson/tribus@master/extra/worker-pool",["npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/object-without-properties","npm:babel-runtime@5.4.7/core-js/map","npm:babel-runtime@5.4.7/core-js/object/seal","github:maxdavidson/tribus@master/extra/async"],function(e){var t,n,r,i,o,a,s,u,c;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.StreamController,s=e.PromiseCompleter}],execute:function(){"use strict";u=function(){function e(n){var r=void 0===arguments[1]?{}:arguments[1],a=r.poolSize,s=void 0===a?4:a,u=r.timeout,c=void 0===u?5:u;t(this,e),this.url=n,this.poolSize=s,this.timeout=c,this._taskQueue=[],this._workerCount=0,this._availableWorkers=[],this._timeouts=new i,o(this)}return e.prototype.run=function(e){var t=this,n=void 0===arguments[1]?[]:arguments[1],r=new c(e,n),i=this._availableWorkers.shift();if(!i&&this._workerCount<this.poolSize&&(i=new Worker(this.url),this._workerCount++),i){var o=this._timeouts.get(i);o&&(window.clearTimeout(o),this._timeouts["delete"](i)),r.run(i)}else this._taskQueue.push(r);return r.onComplete.then(function(){var e=t._taskQueue.shift();e?e.run(r.worker):(t._availableWorkers.push(r.worker),t._timeouts.set(r.worker,window.setTimeout(function(){t._availableWorkers.splice(t._availableWorkers.indexOf(r.worker),1),r.worker.terminate(),t._workerCount--},1e3*t.timeout)))}),r.stream},e.fromFunction=function(t){var n=void 0===arguments[1]?{}:arguments[1],i=n.dependencies,o=void 0===i?[]:i,a=r(n,["dependencies"]),s="self.onmessage = function (e) {\n                ("+t.toString()+")({\n                    progress: function progress(payload, transferList) {\n                        self.postMessage(['progress', payload], transferList);\n                    },\n                    error: function reject(payload, transferList) {\n                        self.postMessage(['error', payload], transferList);\n                    },\n                    done: function resolve(payload, transferList) {\n                        self.postMessage(['done', payload], transferList);\n                    }\n                }, e.data);\n            };",u=new Blob([[].concat(o,[s]).join(";\n")],{type:"application/javascript"}),c=URL.createObjectURL(u);return new e(c,a)},e}(),e("default",u),c=function(){function e(n){var r=void 0===arguments[1]?[]:arguments[1];t(this,e),this.id=e.count++,this.controller=new a,this.payload=n,this.transferList=r,this.worker=null,o(this)}return e.prototype.run=function(e){this.worker=e,e.postMessage(this.payload,this.transferList);var t=this.controller;e.addEventListener("message",function n(r){var i=r.data,o=i[0],a=i[1];switch(o){case"progress":t.add(a);break;case"error":t.addError(a);break;case"done":void 0!==a&&t.add(a),t.close(),e.removeEventListener("message",n,!1)}},!1)},n(e,[{key:"stream",get:function(){return this.controller.stream}},{key:"onComplete",get:function(){return this.controller.completer.promise}}],[{key:"count",value:0,enumerable:!0}]),e}()}}}),e.register("github:maxdavidson/tribus@master/texture/texture2d",["npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check","github:maxdavidson/tribus@master/texture/common"],function(e){var t,n,r,i,o,a;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e.resizeImage,i=e.getImage}],execute:function(){"use strict";o=function(){var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t.getParameter(t.MAX_TEXTURE_SIZE)}(),a=function(){function e(t){n(this,e),this.image=t}return e.fromFile=function(t,n){return i(t,n).then(function(t){return(t.height>o||t.width>o)&&(t=r(t,Math.min(o,t.width),Math.min(o,t.height))),new e(t)})},t(e,[{key:"width",get:function(){return this.image.width}},{key:"height",get:function(){return this.image.height}}]),e}(),e("default",a)}}}),e.register("github:maxdavidson/tribus@master/extra/event-aggregator",["npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/map","npm:babel-runtime@5.4.7/core-js/set","npm:babel-runtime@5.4.7/core-js/get-iterator","npm:babel-runtime@5.4.7/core-js/weak-map"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]}],execute:function(){"use strict";s=!0,u=function(){function e(){var t=void 0===arguments[0]?null:arguments[0];n(this,e),e.privates.set(this,{callbacks:new r,buffers:new r,bubbleTarget:t})}return e.prototype.on=function(e){var t=void 0===arguments[1]?null:arguments[1];this._callbacks.has(e)||this._callbacks.set(e,new i),s&&console.log(""+this.constructor.name+" bound handler to: "+e),this._callbacks.get(e).add(t);var n=this._buffers.get(e);if(void 0!==n){for(var r=n,a=Array.isArray(r),u=0,r=a?r:o(r);;){var c;if(a){if(u>=r.length)break;c=r[u++]}else{if(u=r.next(),u.done)break;c=u.value}var l=c.args,f=c.options;this.trigger.apply(this,[e,f].concat(l)),s&&console.log(""+this.constructor.name+" released: "+e)}this._buffers["delete"](e)}},e.prototype.off=function(e){var t=void 0===arguments[1]?null:arguments[1];this._callbacks.has(e)&&(null===t&&this._callbacks["delete"](e),this._callbacks.get(e)["delete"](t),0===this._callbacks.get(e).size&&this._callbacks["delete"](e))},e.prototype.once=function(e,t){var n=this,r=function i(){for(var r=arguments.length,o=Array(r),a=0;r>a;a++)o[a]=arguments[a];t.apply(void 0,o),n.off(e,i)};this.on(e,r)},e.prototype.trigger=function(t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;n>i;i++)r[i-2]=arguments[i];var a=void 0===arguments[1]?{}:arguments[1],s=a.bubble,u=void 0===s?!1:s,c=a.buffer,l=void 0===c?!1:c,f=a.sync,m=void 0===f?!1:f,p=a.target,d=void 0===p?this:p,h=a.delay,b=void 0===h?0:h;if(this._callbacks.has(t))for(var g=function(){if(y){if(x>=v.length)return"break";w=v[x++]}else{if(x=v.next(),x.done)return"break";w=x.value}var e=w;m?e.apply(void 0,r.concat([d])):window.setTimeout(function(){return e.apply(void 0,r.concat([d]))},b)},v=this._callbacks.get(t),y=Array.isArray(v),x=0,v=y?v:o(v);;){var w,j=g();if("break"===j)break}else if(u&&null!==e.privates.get(this).bubbleTarget){var _;(_=e.privates.get(this).bubbleTarget).trigger.apply(_,[t,a].concat(r))}else l&&(this._buffers.has(t)||this._buffers.set(t,[]),this._buffers.get(t).push({args:r,options:a}))},t(e,[{key:"_callbacks",get:function(){return e.privates.get(this).callbacks||(e.privates.get(this).callbacks=new r)}},{key:"_buffers",get:function(){return e.privates.get(this).buffers||(e.privates.get(this).buffers=new r)}}],[{key:"privates",value:new a,enumerable:!0}]),e}(),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/workers/wavefront",["github:maxdavidson/tribus@master/extra/worker-pool"],function(e){"use strict";function t(e,t){function n(){for(var t={},n=0,r=[],i=[],o=[],a=[],s=l.f,u=0,m=s.length;m>u;u+=3)for(var d=0;3>d;++d){var h=s[u+d],b=h[0],g=h[1],v=h[2],y=h.join(":"),x=t[y];void 0===x&&(x=t[y]=n++,i.push(b),void 0!==g&&o.push(g),void 0!==v&&a.push(v)),r.push(x)}for(var w=new Uint16Array(r),j=new Float32Array(3*i.length),_=new Float32Array(3*a.length),E=new Float32Array(2*o.length),u=0,m=i.length;m>u;++u){c=3*u;var T=3*i[u];j[c]=l.v[T],j[c+1]=l.v[T+1],j[c+2]=l.v[T+2]}for(var u=0,m=a.length;m>u;++u){c=3*u;var A=3*a[u];_[c]=l.vn[A],_[c+1]=l.vn[A+1],_[c+2]=l.vn[A+2]}for(var u=0,m=o.length;m>u;++u){c=2*u;var S=2*o[u];E[c]=l.vt[S],E[c+1]=l.vt[S+1]}e.progress(["geometry",{indices:w,vertices:j,normals:_,texcoords:E,geometryName:f,materialName:p}],[w.buffer,j.buffer,_.buffer,E.buffer]),l.f.length=0}function r(t){var r,i=t[0],o=t.length;switch(i){case"mtllib":var a=t[1];for(r=2;o>r;++r)a+=t[r];e.progress(["mtllib",a]);break;case"^^g":for(m||n(),f=t[1],r=2;o>r;++r)f+=" "+t[r];m=!1;break;case"usemtl":for(d||n(),p=t[1],r=2;o>r;++r)p+=" "+t[r];d=!1;break;case"v":case"vn":case"vt":for(r=1;o>r;++r)l[i].push(parseFloat(t[r]));break;case"f":for(r=1;o>r;++r){for(var s=t[r].split("/"),u=0;u<s.length;++u){var c=parseInt(s[u]);0>c?s[u]=c+l[h[u]].length/b[u]:s[u]=c-1}g[r-1]=s}if(4>o)for(r=o-1;3>=r;++r)g[r]=g[o-2];for(r=1;o-2>r;++r)l.f.push(g[0],g[r],g[r+1])}}var i="Parsing OBJ file";console.time(i);for(var o,a,s,u,c,l={v:[],vn:[],vt:[],f:[]},f="default",m=!0,p="default",d=!0,h=["v","vt","vn"],b=[3,2,3],g=[],v=new Uint8Array(t),y=[],x=[],w=0,j=v.length,_=0;j>_;){
switch(a=v[_++],a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o=a;break;case 12:case 13:s=v[_++],o=(31&a)<<6|63&s;break;case 14:s=v[_++],u=v[_++],o=(15&a)<<12|(63&s)<<6|(63&u)<<0}if(10===o||13===o){x.length=0;for(var E="",T=!0,A=0;w>A;++A)o=y[A],32===o||9===o?(T||x.push(E),E="",T=!0):(E+=String.fromCharCode(o),T=!1);T||x.push(E),x.length&&r(x),w=0}else y[w++]=o}n(),console.timeEnd(i),e.done()}var n,r;return{setters:[function(e){n=e["default"]}],execute:function(){r=n.fromFunction(t),e("workerpool",r)}}}),e.register("github:maxdavidson/tribus@master/material/phong",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/get-iterator","npm:babel-runtime@5.4.7/core-js/promise","npm:babel-runtime@5.4.7/core-js/object/assign","npm:babel-runtime@5.4.7/core-js/math/log2","npm:babel-runtime@5.4.7/core-js/map","npm:babel-runtime@5.4.7/core-js/set","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/extra/atlas","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/directional-light","github:maxdavidson/tribus@master/light/pointlight","github:maxdavidson/tribus@master/light/spotlight","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/material/shaders/phong.vert.dot!github:maxdavidson/tribus@master/plugins/dot","github:maxdavidson/tribus@master/material/shaders/phong.frag.dot!github:maxdavidson/tribus@master/plugins/dot","github:maxdavidson/tribus@master/extra/color","github:maxdavidson/tribus@master/texture/common"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h,b,g,v,y,x,w,j,_,E,T,A,S,M,k,L,I,R,O,D,C,$,F,z,N,P;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e.getString},function(e){p=e.Atlas,d=e.Region},function(e){h=e.Material,b=e.MaterialRenderer},function(e){g=e["default"]},function(e){v=e.construct,y=e.delegate},function(e){x=e["default"]},function(e){w=e["default"]},function(e){j=e["default"]},function(e){_=e["default"]},function(e){E=e["default"]},function(e){T=e["default"]},function(e){A=e["default"]},function(e){S=e.convertColorToVector},function(e){M=e.allocateTextureUnit}],execute:function(){"use strict";k=l.vec3,L=l.vec4,I=l.mat3,R=l.mat4,O=WebGLRenderingContext,D=function(e){function a(){var t=void 0===arguments[0]?{}:arguments[0],n=t.shininess,i=void 0===n?10:n,o=t.ambient,s=void 0===o?0:o,u=t.diffuse,c=void 0===u?8421504:u,l=t.specular,f=void 0===l?c:l,m=t.name,p=void 0===m?"":m;r(this,a),e.call(this),this.shininess=i,this.ambient=s,this.diffuse=c,this.specular=f,this.name=p}return t(a,e),a.prototype.getRenderer=function(e){return C.create(this,e)},a.getSourceType=function(e){switch(e.constructor){case Number:case Array:case Float32Array:return"static";case g:return"texture";default:console.error("Incompatible material source color type")}},a.fromMtlFile=function(e){return m(e).then(function(t){for(var n=[],r=[],s=-1,u=e.substr(0,e.lastIndexOf("/")+1),c=function(){if(f){if(m>=l.length)return"break";p=l[m++]}else{if(m=l.next(),m.done)return"break";p=m.value}var e=p;e=e.trim().split(/\s+/);var t=e[0],i=e.slice(1);switch(t){case"newmtl":r[++s]={name:i[0]};break;case"Kd":r[s].diffuse=i.map(parseFloat);break;case"map_Kd":n.push(function(e){return g.fromFile(u+i[0].replace(/^\//,"")).then(function(t){return r[e].diffuse=t})}(s))}},l=t.split(/\r?\n/),f=Array.isArray(l),m=0,l=f?l:i(l);;){var p,d=c();if("break"===d)break}return o.all(n).then(function(){for(var e={},t=r,n=Array.isArray(t),o=0,t=n?t:i(t);;){var s;if(n){if(o>=t.length)break;s=t[o++]}else{if(o=t.next(),o.done)break;s=o.value}var u=s;e[u.name]=new a(u)}return e})})},n(a,[{key:"config",get:function(){return{ambient:a.getSourceType(this.ambient),diffuse:a.getSourceType(this.diffuse),specular:a.getSourceType(this.specular)}}}]),a}(h),e("default",D),C=function(e){function i(t,n){r(this,i),e.call(this,t),this.gl=n,this.locations=null,this.ambientStrategy=null,this.diffuseStrategy=null,this.specularStrategy=null}return t(i,e),i.prototype.init=function(e){this.renderer=e;for(var t={MAX_DIRECTIONAL_LIGHTS:0,MAX_SPOT_LIGHTS:0,MAX_POINT_LIGHTS:0},n=e._lightRenderers,r=0,o=n.length;o>r;++r){var s=n[r].light;s instanceof x?t.MAX_DIRECTIONAL_LIGHTS+=1:s instanceof j?t.MAX_SPOT_LIGHTS+=1:s instanceof w&&(t.MAX_POINT_LIGHTS+=1)}var u=a({},t,this.material.config);this.program=i.createProgram(this.gl,JSON.stringify(u),u),this.ambientStrategy=$.select("ambient",this.material.ambient,this.program),this.diffuseStrategy=$.select("diffuse",this.material.diffuse,this.program),this.specularStrategy=$.select("specular",this.material.specular,this.program),this.geometryRenderer&&this.setGeometryRenderer(this.geometryRenderer)},i.prototype.setGeometryRenderer=function(e){this.geometryRenderer=e;var t=e.vertexBuffer,n=e.normalBuffer,r=e.texcoordBuffer;t.setAttribLocation("vertex",this.program),n.setAttribLocation("normal",this.program),this.locations={mvpMatrix:this.program.getUniformLocation("mvpMatrix"),modelMatrix:this.program.getUniformLocation("modelMatrix"),normalMatrix:this.program.getUniformLocation("normalMatrix"),viewPos:this.program.getUniformLocation("viewPos"),shininess:this.program.getUniformLocation("material.shininess"),environmentAmbient:this.program.getUniformLocation("environmentAmbient")},this.ambientStrategy.init(r),this.diffuseStrategy.init(r),this.specularStrategy.init(r)},i.prototype.beforeRender=function(){for(var e=this.program,t=e.gl,n=this.locations,r=this.renderer,i=r._lightRenderers,o=0,a=i.length;a>o;++o)i[o].render(e);t.uniform3fv(n.viewPos,r.camera.worldPosition),t.uniform1f(n.shininess,this.material.shininess),t.uniform3fv(n.environmentAmbient,r.environment._ambientVector),this.ambientStrategy.update(),this.diffuseStrategy.update(),this.specularStrategy.update()},i.prototype.render=function(e){var t=this.program.gl,n=this.locations;t.uniformMatrix4fv(n.mvpMatrix,!1,e.mvpMatrix),t.uniformMatrix4fv(n.modelMatrix,!1,e.worldTransform),t.uniformMatrix3fv(n.normalMatrix,!1,e.normalMatrix)},n(i,null,[{key:"create",value:f(v(i),{length:2}),enumerable:!0},{key:"createProgram",value:f(function(e,t,n){return new _(e,new E(e,T(n),O.VERTEX_SHADER),new E(e,A(n),O.FRAGMENT_SHADER))},{length:2}),enumerable:!0}]),i}(b),$=function(){function e(t,n,i){r(this,e),this.locations={},this.target=t,this.source=n,this.program=i}return e.prototype.init=function(e){},e.prototype.update=function(){},n(e,null,[{key:"select",value:f(function(e,t,n){return{"static":F.create,texture:P.create}[D.getSourceType(t)](e,t,n)}),enumerable:!0}]),e}(),F=function(e){function i(t,n,o){r(this,i),e.call(this,t,n,o),this.color=n,this.colorVector=S(this.color)}return t(i,e),i.prototype.init=function(e){this.locations.target=this.program.getUniformLocation("material."+this.target)},i.prototype.update=function(){S(this.color,this.colorVector),this.program.gl.uniform3fv(this.locations.target,this.colorVector)},n(i,null,[{key:"create",value:f(v(i),{length:3}),enumerable:!0}]),i}($),z=L.create(),N=function(){function e(t,n,i){r(this,e),this.gl=t,this.region=n,this.unit=M(),this.handle=t.createTexture(),this.ctx=document.createElement("canvas").getContext("2d"),this.strategies=i,document.body.appendChild(this.ctx.canvas)}return e.prototype.bind=function(){this.gl.activeTexture(O.TEXTURE0+this.unit),this.gl.bindTexture(O.TEXTURE_2D,this.handle)},e.prototype.updateTexcoordBounds=function(e){var t=this.region.outerWidth;L.set(z,e.left/t,(e.top+e.innerHeight)/t,e.innerWidth/t,-(e.innerHeight/t));for(var n=this.strategies.get(e.image),r=Array.isArray(n),o=0,n=r?n:i(n);;){var a;if(r){if(o>=n.length)break;a=n[o++]}else{if(o=n.next(),o.done)break;a=o.value}var s=a;L.copy(s.texcoordBounds,z),s.textureRegion=this}},e.prototype.uploadRegion=function(){this.ctx.canvas.width=this.region.outerWidth,this.ctx.canvas.height=this.region.outerHeight;for(var e=this.region,t=Array.isArray(e),n=0,e=t?e:i(e);;){var r;if(t){if(n>=e.length)break;r=e[n++]}else{if(n=e.next(),n.done)break;r=n.value}var o=r;"data"in o.image?this.ctx.putImageData(o.image,o.left,o.top):this.ctx.drawImage(o.image,o.left,o.top),this.updateTexcoordBounds(o)}this.bind(),this.gl.texImage2D(O.TEXTURE_2D,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,this.ctx.canvas),this.gl.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR),this.gl.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR),this.gl.generateMipmap(O.TEXTURE_2D)},e.prototype.uploadSubregion=function(e){"data"in e.image?this.ctx.putImageData(e.image,e.left,e.top):this.ctx.drawImage(e.image,e.left,e.top),this.updateTexcoordBounds(e),this.bind(),this.gl.texSubImage2D(O.TEXTURE_2D,0,e.left,e.top,O.RGBA,O.UNSIGNED_BYTE,e.image),this.gl.generateMipmap(O.TEXTURE_2D)},e}(),P=function(e){function i(t,n,o){r(this,i),e.call(this,t,n,o),this.texcoordBounds=L.create(),this.textureRegion=null,i.getConfig(o.gl)(this)}return t(i,e),i.prototype.init=function(e){e.setAttribLocation("texcoord",this.program),this.locations.sampler=this.program.getUniformLocation(""+this.target+"Sampler"),this.locations.bounds=this.program.getUniformLocation(""+this.target+"TexcoordBounds")},i.prototype.update=function(){var e=this.program.gl;e.uniform1i(this.locations.sampler,this.textureRegion.unit),e.uniform4fv(this.locations.bounds,this.texcoordBounds),this.textureRegion.bind()},n(i,null,[{key:"getConfig",value:f(function(e){var t=new p({maxSize:s(e.getParameter(O.MAX_TEXTURE_SIZE))}),n=new u,r=[new N(e,t.regions[0],n)];return function(i){var o=i.source,a=n.get(o.image);void 0===a&&(a=new c,n.set(o.image,a)),a.add(i);var s=t.insert(o.image),u=s[0],l=s.slice(1);switch(u){case p.SUCCESS:var f=l[0],m=l[1];return r[f].uploadSubregion(m),r[f];case p.RESET:for(var d=0,h=t.regions.length;h>d;++d)void 0===r[d]?r[d]=new N(e,t.regions[d],n):r[d].region=t.regions[d],r[d].uploadRegion();break;case p.FAILED:var b=l[0];throw b}}}),enumerable:!0},{key:"create",value:f(v(i),{length:3}),enumerable:!0}]),i}($)}}}),e.register("github:maxdavidson/tribus@master/scene/base",["npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/get-iterator","npm:babel-runtime@5.4.7/core-js/symbol/iterator","npm:babel-runtime@5.4.7/regenerator","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/extra/bounding-box"],function(e){function t(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,c=o+o,l=a+a,f=i*u,m=i*c,p=i*l,d=o*c,h=o*l,b=a*l,g=s*u,v=s*c,y=s*l,x=r[0],w=r[1],j=r[2];return e[0]=(1-(d+b))*x,e[1]=(m+y)*x,e[2]=(p-v)*x,e[3]=0,e[4]=(m-y)*w,e[5]=(1-(f+b))*w,e[6]=(h+g)*w,e[7]=0,e[8]=(p+v)*j,e[9]=(h-g)*j,e[10]=(1-(f+d))*j,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}var n,r,i,o,a,s,u,c,l,f,m,p,d,h,b;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]}],execute:function(){"use strict";c=s.vec3,l=s.mat3,f=s.mat4,m=s.quat,p=Math.PI/180,d=c.create(),h=[],b=function(){function e(t){var n=void 0===arguments[1]?{}:arguments[1],i=n.parent,o=void 0===i?null:i,a=n.position,s=void 0===a?[0,0,0]:a,p=n.rotateX,d=void 0===p?0:p,h=n.rotateY,b=void 0===h?0:h,g=n.rotateZ,v=void 0===g?0:g,y=n.scale,x=void 0===y?1:y;r(this,e),this.id=e.instances.length,e.instances.push(this),this.name=t,this.parent=o,this.orientation=m.create(),this.position=c.create(),this.scale=c.fromValues(1,1,1),this.localTransform=f.create(),this.worldTransform=f.create(),this.normalMatrix=l.create(),this.subtreeIds=[this.id],this.aabb=new u,this.dirty=!0,this.processing=!1,this.resize(x),this.rotateX(d),this.rotateZ(v),this.rotateY(b),this.translate(s)}return e.prototype.toString=function(){for(var e=this,t=void 0===arguments[0]?["name","dirty"]:arguments[0],n=void 0===arguments[1]?0:arguments[1],r="",i=" ",o=0;2*n>o;++o)r+=i;return r+this.constructor.name+": { "+t.map(function(t){return t+": "+e[t]}).join(", ")+" }"},e.prototype.query=function(e){for(var t=this,n=Array.isArray(t),r=0,t=n?t:i(t);;){var o;if(n){if(r>=t.length)break;o=t[r++]}else{if(r=t.next(),r.done)break;o=r.value}var a=o;if(a.name===e)return a}},e.prototype.forEach=function(e){e(this)},e.prototype[o]=a.mark(function s(){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this;case 2:case"end":return e.stop()}},s,this)}),e.prototype.recalculate=function(e){if(this.dirty){var n=this.localTransform,r=this.worldTransform;t(n,this.orientation,this.position,this.scale),this.parent?f.multiply(r,this.parent.worldTransform,n):f.copy(r,n),l.normalFromMat4(this.normalMatrix,r)}e.set(this.id);var i=this.dirty;return this.dirty=!1,i},e.prototype.recalculateSubtreeIds=function(){},e.prototype.resize=function(e){("number"==typeof e?c.scale:c.multiply)(this.scale,this.scale,e),this.dirty=!0},e.prototype.rotateX=function(e){m.rotateX(this.orientation,this.orientation,e*p),this.dirty=!0},e.prototype.rotateY=function(e){m.rotateY(this.orientation,this.orientation,e*p),this.dirty=!0},e.prototype.rotateZ=function(e){m.rotateZ(this.orientation,this.orientation,e*p),this.dirty=!0},e.prototype.lookForward=function(){m.identity(this.orientation),this.dirty=!0},e.prototype.translate=function(e){c.add(this.position,this.position,e),this.dirty=!0},e.prototype.translateRelatively=function(e){c.add(this.position,this.position,c.transformQuat(d,e,this.orientation)),this.dirty=!0},e.prototype.getEulerAngles=function(){var e=this.orientation,t=Math.atan2(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2])),n=Math.asin(2*(e[0]*e[2]-e[3]*e[1])),r=Math.atan2(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]));return{roll:t,pitch:n,yaw:r}},n(e,null,[{key:"instances",value:[],enumerable:!0}]),e}(),e("default",b)}}}),e.register("github:maxdavidson/tribus@master/camera/base",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/scene/base"],function(e){var t,n,r,i,o,a,s,u,c;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]}],execute:function(){"use strict";o=r.mat3,a=r.mat4,s=r.vec3,u=r.vec4,c=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,"camera",t),this.projectionMatrix=a.create(),this.viewMatrix=a.create(),this.cameraMatrix=a.create(),this.worldPosition=s.create(),this.planes=new Float64Array(24),this.npOffsets=new Uint8Array(12),this._lastFailedPlanes=[]}return t(r,e),r.prototype.recalculate=function(t){if(this.dirty=e.prototype.recalculate.call(this,t),this.dirty){a.invert(this.viewMatrix,this.worldTransform),a.multiply(this.cameraMatrix,this.projectionMatrix,this.viewMatrix);var n=this.planes,r=this.cameraMatrix;n[0]=r[0]+r[3],n[1]=r[4]+r[7],n[2]=r[8]+r[11],n[3]=r[12]+r[15],n[4]=-r[0]+r[3],n[5]=-r[4]+r[7],n[6]=-r[8]+r[11],n[7]=-r[12]+r[15],n[8]=r[1]+r[3],n[9]=r[5]+r[7],n[10]=r[9]+r[11],n[11]=r[13]+r[15],n[12]=-r[1]+r[3],n[13]=-r[5]+r[7],n[14]=-r[9]+r[11],n[15]=-r[13]+r[15],n[16]=r[2]+r[3],n[17]=r[6]+r[7],n[18]=r[10]+r[11],n[19]=r[14]+r[15],n[20]=-r[2]+r[3],n[21]=-r[6]+r[7],n[22]=-r[10]+r[11],n[23]=-r[14]+r[15];for(var i=this.npOffsets,o=void 0,u=void 0,c=void 0,l=void 0,f=void 0,m=0;24>m;m+=4)o=n[m],u=n[m+1],c=n[m+2],l=n[m+3],f=2*(2*(o>0?1:0)+(u>0?1:0))+(c>0?1:0),i[m>>1]=3*f,i[(m>>1)+1]=3*(7-f);this.parent?s.transformMat4(this.worldPosition,this.position,this.parent.worldTransform):s.copy(this.worldPosition,this.position)}return this.dirty},r.prototype.canSee=function(e,t){var n=e.aabb.points,r=this.planes,i=this._lastFailedPlanes[e.id],o=this.npOffsets,a=t[0],s=0,u=1,c=void 0,l=void 0,f=void 0,m=void 0,p=void 0,d=void 0,h=1<<(i>>2),b=i;if(-1!==i&&h&a){if(p=o[b>>1],c=r[b],l=r[b+1],f=r[b+2],m=r[b+3],c*n[p]+l*n[p+1]+f*n[p+2]<-m)return t[0]=s,0;d=o[(b>>1)+1],c*n[d]+l*n[d+1]+f*n[d+2]<-m&&(s|=h,u=2)}for(b=0,h=1;a>=h;b+=4,h+=h)if(b!==i&&h&a){if(c=r[b],l=r[b+1],f=r[b+2],m=r[b+3],p=o[b>>1],c*n[p]+l*n[p+1]+f*n[p+2]<-m)return this._lastFailedPlanes[e.id]=b,t[0]=s,0;d=o[(b>>1)+1],c*n[d]+l*n[d+1]+f*n[d+2]<-m&&(s|=h,u=2)}return t[0]=s,u},r}(i),e("default",c)}}}),e.register("github:maxdavidson/tribus@master/geometry/geometry",["npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/helpers/create-class","npm:babel-runtime@5.4.7/helpers/object-without-properties","npm:babel-runtime@5.4.7/core-js/promise","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/extra/bounding-box","github:maxdavidson/tribus@master/webgl/buffer","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/workers/wavefront","github:maxdavidson/tribus@master/workers/normal-vectors","github:maxdavidson/tribus@master/workers/model-splitter"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h,b;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e.construct},function(e){l=e.getArrayBuffer},function(e){f=e.workerpool},function(e){m=e.workerpool},function(e){p=e.workerpool}],execute:function(){"use strict";d=WebGLRenderingContext,h=function(){function e(){var n=void 0===arguments[0]?{}:arguments[0],r=n.vertices,i=n.indices,o=n.texcoords,s=n.normals,u=void 0===s?new Float32Array(r.length):s,c=n.name;t(this,e);var l=function(e,t){return e instanceof t?e:new t(e)};this.vertices=l(r,Float32Array),this.indices=l(i,Uint16Array),this.normals=l(u,Float32Array),this.texcoords=l(o,Float32Array),this.name=c,this.bounds=new a,this.bounds.reset(),this.bounds.expandFromPoints(this.vertices),this.bounds.computePoints()}return e.fromFile=function(t){var n=t.split(".").pop();switch(n){case"obj":return l(t).then(function(t){return new i(function(n,r){var i=void 0;i=f.run(t,[t]).subscribe(function(t){var o=t[0],a=t[1];if("geometry"===o){a.name=a.geometryName;var s=new e(a);0===s.normals.length?s.generateNormals().then(n)["catch"](r):n(s),i.unsubscribe()}}),i.onError(r)})});default:throw new Error('Unsupported geometry file extension: ".'+n+'"')}},e.prototype.generateNormals=function(){var e=this;return m.run({vertices:this.vertices,indices:this.indices},[this.vertices.buffer,this.indices.buffer]).first.then(function(t){var n=t.vertices,r=t.indices,i=t.normals;return e.vertices=n,e.indices=r,e.normals=i,e})},e.prototype.split=function(){return p.run({indices:this.indices,vertices:this.vertices,normals:this.normals,texcoords:this.texcoords},[this.indices.buffer,this.vertices.buffer,this.normals.buffer,this.texcoords.buffer]).map(function(t){var n=t.part,i=r(t,["part"]),o=new e(i);return o.name+="-part"+n,o})},e.prototype.getRenderer=function(e){return b.create(this,e)},e}(),e("default",h),b=function(){function e(n,r){t(this,e),this.gl=r,this.geometry=n;var i=r.getExtension("OES_vertex_array_object");i&&(this.vaoExtension=i,this.vao=this.vaoExtension.createVertexArrayOES()),this.vertexBuffer=new s(r,n.vertices,this.vao),this.normalBuffer=new s(r,n.normals,this.vao),this.texcoordBuffer=new s(r,n.texcoords,this.vao,{size:2}),this.indexBuffer=new s(r,n.indices,this.vao,{bufferType:d.ELEMENT_ARRAY_BUFFER})}return e.prototype.render=function(){this.vao?this.vaoExtension.bindVertexArrayOES(this.vao):(this.vertexBuffer.bind(),this.normalBuffer.bind(),this.texcoordBuffer.bind(),this.indexBuffer.bind()),this.gl.drawElements(d.TRIANGLES,this.indexBuffer.data.length,d.UNSIGNED_SHORT,0),this.vao&&this.vaoExtension.bindVertexArrayOES(null)},n(e,null,[{key:"create",value:o(c(e),{length:2}),enumerable:!0}]),e}(),e("GeometryRenderer",b)}}}),e.register("github:maxdavidson/tribus@master/scene/model",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/promise","github:maxdavidson/tribus@master/scene/base","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/material/phong","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.Material},function(e){s=e["default"]},function(e){u=e["default"]}],execute:function(){"use strict";c=u.vec3,l=u.mat4,f=new Float64Array(24),m=function(e){function i(t,o,a){var u=this,c=void 0===arguments[3]?new s:arguments[3];n(this,i),e.call(this,t,o),this.geometry=null,this.material=null;var f=[];a instanceof r?(f.push(a),a.then(function(e){return u.geometry=e,u.dirty=!0,e})):this.geometry=a,c instanceof r?(f.push(c),c.then(function(e){return u.material=e,e})):this.material=c,f.length>0&&(this.processing=!0,this.onReady=r.all(f).then(function(){return u.processing=!1,u})),this.mvpMatrix=l.create()}return t(i,e),i.prototype.recalculate=function(t){var n=e.prototype.recalculate.call(this,t);return n&&this.geometry&&(f.set(this.geometry.bounds.points),c.forEach(f,0,0,0,c.transformMat4,this.worldTransform),this.aabb.reset(),this.aabb.expandFromPoints(f),this.aabb.computePoints()),this.dirty=n,n},i}(i),e("default",m)}}}),e.register("github:maxdavidson/tribus@master/renderer",["npm:babel-runtime@5.4.7/helpers/inherits","npm:babel-runtime@5.4.7/helpers/class-call-check","npm:babel-runtime@5.4.7/core-js/promise","npm:babel-runtime@5.4.7/core-js/weak-map","npm:babel-runtime@5.4.7/core-js/weak-set","npm:babel-runtime@5.4.7/core-js/get-iterator","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/extra/webgl-debug","github:maxdavidson/tribus@master/extra/event-aggregator","github:mrdoob/stats.js@master","github:maxdavidson/tribus@master/camera/base","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/scene/base","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/scene/group","github:maxdavidson/tribus@master/light/base","github:maxdavidson/tribus@master/environment/environment","github:maxdavidson/tribus@master/extra/bitfield"],function(e){function t(e,t,n,r,i){for(var o=!0;o;){var a=e,s=t,u=n,c=r,l=i;f=void 0,o=!1,c=c||0,l=l||s.length;var f=Math.floor(c+(l-c)/2);if(s[f]===a)return f;if(1>=l-c)return s[f]>a?f-1:f;u(s[f],a)<0?(e=a,t=s,n=u,r=f,i=l,o=!0):(e=a,t=s,n=u,r=c,i=f,o=!0)}}function n(e,n,r){return n.splice(t(e,n,r)+1,0,e),n}function r(e){return f.makeDebugContext(e,function(e,t){console.error(""+f.glEnumToString(e)+" was caused by call to: "+t)},function(e,t){console.log("gl."+e+"("+f.glFunctionArgsToString(e,t)+")");for(var n=t,r=Array.isArray(n),i=0,n=r?n:c(n);;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if(i=n.next(),i.done)break;o=i.value}var a=o;void 0===a&&console.error("undefined passed to gl."+e+"("+f.glFunctionArgsToString(e,t)+")")}})}var i,o,a,s,u,c,l,f,m,p,d,h,b,g,v,y,x,w,j,_,E,T,A;return{setters:[function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e["default"]},function(e){p=e["default"]},function(e){d=e["default"]},function(e){h=e["default"]},function(e){b=e["default"]},function(e){g=e["default"]},function(e){v=e["default"]},function(e){y=e.Light},function(e){x=e["default"]},function(e){w=e["default"]}],execute:function(){"use strict";j=l.mat4,_=WebGLRenderingContext,E=new Uint8Array(1),T=[],A=function(e){function t(i,c,l){var f=this,m=void 0===arguments[3]?{}:arguments[3],d=m.environment,g=void 0===d?0:d,v=m.debug,y=void 0===v?!1:v,j=m.showFPS,E=void 0===j?!1:j,T=m.hidpi,A=void 0===T?!0:T,S=m.antialias,M=void 0===S?!0:S,k=m.fullscreen,L=void 0===k?!0:k;o(this,t),e.call(this),this.scene=i,this.camera=c,this.canvas=l,a.resolve(g).then(function(e){f.environment=e instanceof x?e:new x({ambient:e}),f.environment.initialize(f)}),this._activeModels=[],this._geometryRenderers=[],this._materialRenderers=[],this._lightRenderers=[],this._materialsUsingGeometry=new s,this._newNodes=new w,this._processedNodes=new w,this._visibleNodes=new w;var I=A?devicePixelRatio:1;l.width=Math.round(l.clientWidth*I),l.height=Math.round(l.clientHeight*I);var R={antialias:M},O=l.getContext("webgl",R)||l.getContext("experimental-webgl",R);if(void 0===O)throw"Your browser does not seem to support WebGL! Too bad!";if(y&&(O=r(O)),E){var D=new p;D.setMode(0),D.domElement.style.position="absolute",D.domElement.style.left="0px",D.domElement.style.top="0px",document.body.appendChild(D.domElement),this._stats=D}L&&c instanceof h&&(c.aspect=l.clientWidth/l.clientHeight,window.addEventListener("resize",function(){l.width=Math.round(l.clientWidth*I),l.height=Math.round(l.clientHeight*I),O.viewport(0,0,l.width,l.height),c.aspect=l.clientWidth/l.clientHeight})),this.gl=O;var C=function z(e){return e.thenBy=function(t){return z(function(n,r){return e(n,r)||t(n,r)})},e},$=function(e){var t=void 0===arguments[1]?function(e,t){return t-e}:arguments[1];return function(n,r){return t(e(n),e(r))}},F=function(e,t){return e===t?0:-1};this._modelComparator=C($(function(e){return f._materialRenderers[e].program},F)).thenBy($(function(e){return b.instances[e].material},F)),this.start=this.start.bind(this),this._processNode=this._processNode.bind(this),this._processModelCallback=function(e){var t=e.geometry.getRenderer(f.gl),r=e.material.getRenderer(f.gl);r.init(f),f._geometryRenderers[e.id]=t,f._materialRenderers[e.id]=r;var i=f._materialsUsingGeometry.get(e.geometry);void 0===i&&(i=new u,f._materialsUsingGeometry.set(e.geometry,new u)),i.has(e.material)||(r.setGeometryRenderer(t),i.add(e.material)),n(e.id,f._activeModels,f._modelComparator),e.dirty=!0},O.enable(_.DEPTH_TEST),O.enable(_.CULL_FACE),O.cullFace(_.BACK)}return i(t,e),t.prototype.start=function(){var e=void 0===arguments[0]?0:arguments[0],t=this._lastTime||0;this.render(e-t,e),this._lastTime=e,this._animationFrame=window.requestAnimationFrame(this.start)},t.prototype.stop=function(){this._animationFrame&&window.cancelAnimationFrame(this._animationFrame)},t.prototype._processNode=function(e){var t=b.instances[e];if(t instanceof g)this._processModel(t);else if(t instanceof y){this._lightRenderers.push(t.getRenderer(this.gl));for(var n=this._materialRenderers,r=Array.isArray(n),i=0,n=r?n:c(n);;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if(i=n.next(),i.done)break;o=i.value}var a=o;a.init(this)}}},t.prototype._processModel=function(e){e.onReady?e.onReady.then(this._processModelCallback):window.setTimeout(this._processModelCallback,0,e)},t.prototype._markVisibleNodes=function(e){var t=this.camera,n=this._visibleNodes,r=0;T[r++]=e,T[r++]=63;var i=void 0,o=void 0;do switch(E[0]=T[--r],e=T[--r],i=t.canSee(e,E),o=E[0],i){case 1:for(var a=0,s=e.subtreeIds,u=s.length;u>a;++a)n.set(s[a]);break;case 2:if(n.set(e.id),e instanceof v)for(var a=0,u=e.children.length;u>a;++a)T[r++]=e.children[a],T[r++]=o}while(r>0)},t.prototype.render=function(e,t){this._stats&&this._stats.begin();var n=this.scene,r=this.camera,i=this._geometryRenderers,o=this._materialRenderers,a=this._activeModels,s=this._visibleNodes,u=this._newNodes,c=this._processedNodes,l=b.instances;this.trigger("tick",{sync:!0},e,t);var f=n.recalculate(u);if(w.applyBinaryFunction(u,c,u,w.added),u.forEach(this._processNode),u.isEmpty()||n.recalculateSubtreeIds(),w.applyBinaryFunction(c,u,c,w.or),f){this._markVisibleNodes(n),this.environment&&this.environment.render(this);for(var m=void 0,p=void 0,d=void 0,h=void 0,g=void 0,v=void 0,y=void 0,x=0,_=a.length;_>x;++x)m=a[x],y=l[m],s.get(m)&&((r.dirty||y.dirty)&&j.multiply(y.mvpMatrix,r.cameraMatrix,y.worldTransform),h=i[m],g=o[m],v=g.program,v!==p&&v.use(),g!==d&&g.beforeRender(),g.render(y),h.render(),g!==d&&g.afterRender(),p=v,d=g),y.dirty=!1;r.dirty=!1,this.environment&&this.environment.renderLast(this),s.reset(),u.reset(),this._stats&&this._stats.end()}},t}(m),e("default",A)}}}),e.register("main",["github:maxdavidson/tribus@master/renderer","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/light/directional-light","github:maxdavidson/tribus@master/light/pointlight","github:maxdavidson/tribus@master/light/spotlight","github:maxdavidson/tribus@master/control/mouseview","github:maxdavidson/tribus@master/environment/skybox","github:maxdavidson/tribus@master/material/phong","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/geometry/shapes","github:maxdavidson/tribus@master/extra/helpers","github:maxdavidson/tribus@master/scene/group","github:ded/domready@1.0.8"],function(e){"use strict";var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h,b,g,v,y,x,w,j,_,E,T,A,S;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e.Plane},function(e){p=e.model,d=e.group},function(e){h=e["default"]},function(e){b=e["default"]}],execute:function(){g=c.fromFile("models/blade.obj"),v=c.fromFile("models/windmill-balcony.obj"),y=c.fromFile("models/windmill-roof.obj"),x=c.fromFile("models/windmill-walls.obj"),w=function(){var e=new u({shininess:10,diffuse:[Math.random(),Math.random(),Math.random()]}),t=new u({shininess:15,diffuse:[Math.random(),Math.random(),Math.random()]}),n=new u({diffuse:[Math.random(),Math.random(),Math.random()]}),r=new u;return d("windmill",{scale:.6,rotateY:-90},[p("walls",{},x,t),p("roof",{},y,r),p("balcony",{},v,n),d("blades",{position:[4.5,9.2,0],scale:.8},[p("blade0",{rotateX:0},g,e),p("blade1",{rotateX:90},g,e),p("blade2",{rotateX:180},g,e),p("blade3",{rotateX:270},g,e)])])},j=d("windmills",{},[]),_=new n({far:200,position:[0,2,10]}),E=new r({rotateX:15,rotateY:-163}),T=d("world",{},[j,_,E,p("floor",{scale:250},new m({repeat:!0,size:40}),l.fromFile("textures/stone-floor.jpg").then(function(e){return new u({diffuse:e})}))]),A=f.fromFiles.apply(f,["Left","Right","Up","Down","Back","Front"].map(function(e){return"textures/Skybox/TropicalSunnyDay"+e+"1024.jpeg"})).then(function(e){return new s(e,{ambient:1052688})}),S=document.createElement("canvas"),b(function(){document.body.appendChild(S);for(var e=new t(T,_,S,{environment:A,showFPS:!1,hidpi:!1,antialias:!1}),n=5,r=-n;n>=r;++r)for(var i=function(t){var n=w();n.translate([20*r,0,20*t]),j.add(n);var i=n.query("blades"),o=5*(Math.random()-.5);e.on("tick",function(e){i.rotateX(60*e/1e3*o)})},o=-n;n>=o;++o)i(o);new a(_,e,{speed:10}),e.start()})}}})});
!function(e){function t(e){for(var t=[],n=0,r=e.length;r>n;n++)-1==m.call(t,e[n])&&t.push(e[n]);return t}function n(e,n,r,i){if("string"!=typeof e)throw"System.register provided no module name";var o;o="boolean"==typeof r?{declarative:!1,deps:n,execute:i,executingRequire:r}:{declarative:!0,deps:n,declare:r},o.name=e,e in f||(f[e]=o),o.deps=t(o.deps),o.normalizedDeps=o.deps}function r(e,t){if(t[e.groupIndex]=t[e.groupIndex]||[],-1==m.call(t[e.groupIndex],e)){t[e.groupIndex].push(e);for(var n=0,i=e.normalizedDeps.length;i>n;n++){var o=e.normalizedDeps[n],a=f[o];if(a&&!a.evaluated){var s=e.groupIndex+(a.declarative!=e.declarative);if(void 0===a.groupIndex||a.groupIndex<s){if(void 0!==a.groupIndex&&(t[a.groupIndex].splice(m.call(t[a.groupIndex],a),1),0==t[a.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");a.groupIndex=s}r(a,t)}}}}function i(e){var t=f[e];t.groupIndex=0;var n=[];r(t,n);for(var i=!!t.declarative==n.length%2,o=n.length-1;o>=0;o--){for(var s=n[o],c=0;c<s.length;c++){var l=s[c];i?a(l):u(l)}i=!i}}function o(e){return p[e]||(p[e]={name:e,dependencies:[],exports:{},importers:[]})}function a(t){if(!t.module){var n=t.module=o(t.name),r=t.module.exports,i=t.declare.call(e,function(e,t){n.locked=!0,r[e]=t;for(var i=0,o=n.importers.length;o>i;i++){var a=n.importers[i];if(!a.locked){var s=m.call(a.dependencies,n);a.setters[s](r)}}return n.locked=!1,t});if(n.setters=i.setters,n.execute=i.execute,!n.setters||!n.execute)throw new TypeError("Invalid System.register form for "+t.name);for(var s=0,u=t.normalizedDeps.length;u>s;s++){var c,d=t.normalizedDeps[s],h=f[d],g=p[d];g?c=g.exports:h&&!h.declarative?c=h.module.exports&&h.module.exports.__esModule?h.module.exports:{"default":h.module.exports,__useDefault:!0}:h?(a(h),g=h.module,c=g.exports):c=l(d),g&&g.importers?(g.importers.push(n),n.dependencies.push(g)):n.dependencies.push(null),n.setters[s]&&n.setters[s](c)}}}function s(e){var t,n=f[e];if(n)n.declarative?c(e,[]):n.evaluated||u(n),t=n.module.exports;else if(t=l(e),!t)throw new Error("Unable to load dependency "+e+".");return(!n||n.declarative)&&t&&t.__useDefault?t["default"]:t}function u(t){if(!t.module){var n={},r=t.module={exports:n,id:t.name};if(!t.executingRequire)for(var i=0,o=t.normalizedDeps.length;o>i;i++){var a=t.normalizedDeps[i],c=f[a];c&&u(c)}t.evaluated=!0;var l=t.execute.call(e,function(e){for(var n=0,r=t.deps.length;r>n;n++)if(t.deps[n]==e)return s(t.normalizedDeps[n]);throw new TypeError("Module "+e+" not declared as a dependency.")},n,r);l&&(r.exports=l)}}function c(t,n){var r=f[t];if(r&&!r.evaluated&&r.declarative){n.push(t);for(var i=0,o=r.normalizedDeps.length;o>i;i++){var a=r.normalizedDeps[i];-1==m.call(n,a)&&(f[a]?c(a,n):l(a))}r.evaluated||(r.evaluated=!0,r.module.execute.call(e))}}function l(e){if(d[e])return d[e];var t=f[e];if(!t)throw"Module "+e+" not present.";i(e),c(e,[]),f[e]=void 0;var n=t.module.exports;return(!n||!t.declarative&&n.__esModule!==!0)&&(n={"default":n,__useDefault:!0}),d[e]=n}var f={},m=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},p={},d={};return function(t,r){var i,i={register:n,get:l,set:function(e,t){d[e]=t},newModule:function(e){return e},global:e};i.set("@empty",{}),r(i);for(var o=0;o<t.length;o++)l(t[o])}}("undefined"!=typeof window?window:global)(["main"],function(e){e.register("npm:babel-runtime@5.1.2/helpers/class-call-check",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.__esModule=!0,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.fw",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e.FW=!1,e.path=e.core,e},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.string-at",["npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$");return n.exports=function(e){return function(t){var n,r,i=String(o.assertDefined(this)),a=o.toInteger(t),s=i.length;return 0>a||a>=s?e?"":void 0:(n=i.charCodeAt(a),55296>n||n>56319||a+1===s||(r=i.charCodeAt(a+1))<56320||r>57343?e?i.charAt(a):n:e?i.slice(a,a+2):(n-55296<<10)+(r-56320)+65536)}},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.uid",["npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){function r(e){return"Symbol("+e+")_"+(++a+Math.random()).toString(36)}var i=e.global,o=i.define;i.define=void 0;var a=0;return r.safe=require("npm:core-js@0.8.2/library/modules/$").g.Symbol||r,n.exports=r,i.define=o,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.assert",["npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){function r(e,t,n){if(!e)throw TypeError(n?t+n:t)}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.8.2/library/modules/$");return r.def=a.assertDefined,r.fn=function(e){if(!a.isFunction(e))throw TypeError(e+" is not a function!");return e},r.obj=function(e){if(!a.isObject(e))throw TypeError(e+" is not an object!");return e},r.inst=function(e,t,n){if(!(e instanceof t))throw TypeError(n+": use the 'new' operator!");return e},n.exports=r,i.define=o,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.wks",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.uid"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var r=require("npm:core-js@0.8.2/library/modules/$").g,o={};return n.exports=function(e){return o[e]||(o[e]=r.Symbol&&r.Symbol[e]||require("npm:core-js@0.8.2/library/modules/$.uid").safe("Symbol."+e))},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.def",["npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){function r(e,t){return function(){return e.apply(t,arguments)}}function i(e,t,n){var a,l,f,m,p=e&i.G,d=p?o:e&i.S?o[t]:(o[t]||{}).prototype,h=p?u:u[t]||(u[t]={});p&&(n=t);for(a in n)l=!(e&i.F)&&d&&a in d,l&&a in h||(f=l?d[a]:n[a],p&&!c(d[a])?m=n[a]:e&i.B&&l?m=r(f,o):e&i.W&&d[a]==f?!function(e){m=function(t){return this instanceof e?new e(t):e(t)},m.prototype=e.prototype}(f):m=e&i.P&&c(f)?r(Function.call,f):f,s.hide(h,a,m))}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.8.2/library/modules/$"),o=s.g,u=s.core,c=s.isFunction;return i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,n.exports=i,o.define=a,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.unscope",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.wks")("unscopables");return!o.FW||a in[]||o.hide(Array.prototype,a,{}),n.exports=function(e){o.FW&&([][a][e]=!0)},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.array-methods",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.ctx"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.ctx");return n.exports=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,u=5==e||s;return function(c){for(var l,f,m=Object(o.assertDefined(this)),p=o.ES5Object(m),d=a(c,arguments[1],3),h=o.toLength(p.length),g=0,b=t?Array(h):n?[]:void 0;h>g;g++)if((u||g in p)&&(l=p[g],f=d(l,g,m),e))if(t)b[g]=f;else if(f)switch(e){case 3:return!0;case 5:return l;case 6:return g;case 2:b.push(l)}else if(i)return!1;return s?-1:r||i?i:b}},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.iter-detect",["npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.wks")("iterator"),a=!1;try{var s=[7][o]();s["return"]=function(){a=!0},Array.from(s,function(){throw 2})}catch(u){}return n.exports=function(e){if(!a)return!1;var t=!1;try{var n=[7],r=n[o]();r.next=function(){t=!0},n[o]=function(){return r},e(n)}catch(i){}return t},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.species",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$");return n.exports=function(e){o.DESC&&o.FW&&o.setDesc(e,require("npm:core-js@0.8.2/library/modules/$.wks")("species"),{configurable:!0,get:o.that})},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.weak-set",["npm:core-js@0.8.2/library/modules/$.collection-weak","npm:core-js@0.8.2/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.collection-weak");return require("npm:core-js@0.8.2/library/modules/$.collection")("WeakSet",{add:function(e){return o.def(this,e,!0)}},o,!1,!0),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.invoke",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3]);case 5:return r?e(t[0],t[1],t[2],t[3],t[4]):e.call(n,t[0],t[1],t[2],t[3],t[4])}return e.apply(n,t)},r.define=i,n.exports}),e.register("npm:process@0.10.1/browser",[],!0,function(require,t,n){function r(){if(!c){c=!0;for(var e,t=u.length;t;){e=u,u=[];for(var n=-1;++n<t;)e[n]();t=u.length}c=!1}}function i(){}var o=e.global,a=o.define;o.define=void 0;var s=n.exports={},u=[],c=!1;return s.nextTick=function(e){u.push(e),c||setTimeout(r,0)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=i,s.addListener=i,s.once=i,s.off=i,s.removeListener=i,s.removeAllListeners=i,s.emit=i,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0},o.define=a,n.exports}),e.register("npm:core-js@0.8.2/library/modules/core.iter-helpers",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.iter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$").core,a=require("npm:core-js@0.8.2/library/modules/$.iter");return o.isIterable=a.is,o.getIterator=a.get,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.object.statics-accept-primitives",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.def"],!0,function(require,t,n){function r(e,t){var n=(a.core.Object||{})[e]||Object[e],r=0,i={};i[e]=1==t?function(e){return u(e)?n(e):e}:2==t?function(e){return u(e)?n(e):!0}:3==t?function(e){return u(e)?n(e):!1}:4==t?function(e,t){return n(c(e),t)}:5==t?function(e){return n(Object(a.assertDefined(e)))}:function(e){return n(c(e))};try{n("z")}catch(o){r=1}s(s.S+s.F*r,"Object",i)}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.8.2/library/modules/$"),s=require("npm:core-js@0.8.2/library/modules/$.def"),u=a.isObject,c=a.toObject;return r("freeze",1),r("seal",1),r("preventExtensions",1),r("isFrozen",2),r("isSealed",2),r("isExtensible",3),r("getOwnPropertyDescriptor",4),r("getPrototypeOf",5),r("keys"),r("getOwnPropertyNames"),i.define=o,n.exports}),e.register("github:mrdoob/stats.js@master/src/Stats",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=function(){var e=Date.now(),t=e,n=0,r=1/0,i=0,o=0,a=1/0,s=0,u=0,c=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(e){e.preventDefault(),v(++c%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var f=document.createElement("div");f.id="fps",f.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(f);var m=document.createElement("div");m.id="fpsText",m.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",m.innerHTML="FPS",f.appendChild(m);var p=document.createElement("div");for(p.id="fpsGraph",p.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",f.appendChild(p);p.children.length<74;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#113",p.appendChild(d)}var h=document.createElement("div");h.id="ms",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(h);var g=document.createElement("div");g.id="msText",g.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",g.innerHTML="MS",h.appendChild(g);var b=document.createElement("div");for(b.id="msGraph",b.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",h.appendChild(b);b.children.length<74;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#131",b.appendChild(d)}var v=function(e){switch(c=e){case 0:f.style.display="block",h.style.display="none";break;case 1:f.style.display="none",h.style.display="block"}},y=function(e,t){var n=e.appendChild(e.firstChild);n.style.height=t+"px"};return{REVISION:12,domElement:l,setMode:v,begin:function(){e=Date.now()},end:function(){var c=Date.now();return n=c-e,r=Math.min(r,n),i=Math.max(i,n),g.textContent=n+" MS ("+r+"-"+i+")",y(b,Math.min(30,30-n/200*30)),u++,c>t+1e3&&(o=Math.round(1e3*u/(c-t)),a=Math.min(a,o),s=Math.max(s,o),m.textContent=o+" FPS ("+a+"-"+s+")",y(p,Math.min(30,30-o/100*30)),t=c,u=0),c},update:function(){e=this.end()}}};return"object"==typeof n&&(n.exports=o),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/helpers/inherits",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},t.__esModule=!0,r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/helpers/create-class",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),t.__esModule=!0,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/symbol/iterator",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),n.exports=require("npm:core-js@0.8.2/library/modules/$.wks")("iterator"),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.keyof",["npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$");return n.exports=function(e,t){for(var n,r=o.toObject(e),i=o.getKeys(r),a=i.length,s=0;a>s;)if(r[n=i[s++]]===t)return n},r.define=i,n.exports}),function(){function t(){}t.amd={},function(n){"use strict";var r={};"undefined"==typeof exports?"function"==typeof t&&"object"==typeof t.amd&&t.amd?(r.exports={},e.register("github:toji/gl-matrix@2.2.1/dist/gl-matrix",[],!1,function(){return r.exports})):r.exports="undefined"!=typeof window?window:n:r.exports=exports,function(e){if(!t)var t=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!r)var r=Math.random;var i={};i.setMatrixArrayType=function(e){n=e},"undefined"!=typeof e&&(e.glMatrix=i);var o=Math.PI/180;i.toRadian=function(e){return e*o};var a={};a.create=function(){var e=new n(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var r=new n(2);return r[0]=e,r[1]=t,r},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,n){return e[0]=t,e[1]=n,e},a.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},a.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},a.sub=a.subtract,a.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},a.mul=a.multiply,a.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},a.div=a.divide,a.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},a.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},a.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},a.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},a.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},a.len=a.length,a.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},a.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},a.random=function(e,t){t=t||1;var n=2*r()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},a.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},a.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},a.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},a.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},a.forEach=function(){var e=a.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;u>s;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},"undefined"!=typeof e&&(e.vec2=a);var s={};s.create=function(){var e=new n(3);return e[0]=0,e[1]=0,e[2]=0,e},s.clone=function(e){var t=new n(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.fromValues=function(e,t,r){var i=new n(3);return i[0]=e,i[1]=t,i[2]=r,i},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},s.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},s.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},s.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},s.sub=s.subtract,s.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},s.mul=s.multiply,s.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},s.div=s.divide,s.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},s.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},s.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},s.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},s.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)},s.dist=s.distance,s.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i},s.sqrDist=s.squaredDistance,s.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},s.len=s.length,s.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},s.sqrLen=s.squaredLength,s.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},s.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},s.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},s.random=function(e,t){t=t||1;var n=2*r()*Math.PI,i=2*r()-1,o=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=i*t,e},s.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12],e[1]=n[1]*r+n[5]*i+n[9]*o+n[13],e[2]=n[2]*r+n[6]*i+n[10]*o+n[14],e},s.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},s.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,m=c*o+a*i-s*r,p=-a*r-s*i-u*o;return e[0]=l*c+p*-a+f*-u-m*-s,e[1]=f*c+p*-s+m*-a-l*-u,e[2]=m*c+p*-u+l*-s-f*-a,e},s.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},s.forEach=function(){var e=s.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;u>s;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),s.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},"undefined"!=typeof e&&(e.vec3=s);var u={};u.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},u.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.fromValues=function(e,t,r,i){var o=new n(4);return o[0]=e,o[1]=t,o[2]=r,o[3]=i,o},u.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},u.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},u.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e},u.sub=u.subtract,u.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},u.mul=u.multiply,u.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},u.div=u.divide,u.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},u.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},u.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},u.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},u.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)},u.dist=u.distance,u.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o},u.sqrDist=u.squaredDistance,u.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},u.len=u.length,u.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},u.sqrLen=u.squaredLength,u.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},u.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e},u.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},u.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e},u.random=function(e,t){return t=t||1,e[0]=r(),e[1]=r(),e[2]=r(),e[3]=r(),u.normalize(e,e),u.scale(e,e,t),e},u.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},u.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,m=c*o+a*i-s*r,p=-a*r-s*i-u*o;return e[0]=l*c+p*-a+f*-u-m*-s,e[1]=f*c+p*-s+m*-a-l*-u,e[2]=m*c+p*-u+l*-s-f*-a,e},u.forEach=function(){var e=u.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;u>s;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),u.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},"undefined"!=typeof e&&(e.vec4=u);var c={};c.create=function(){var e=new n(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},c.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},c.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},c.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},c.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},c.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*o-i*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e):null},c.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},c.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},c.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*s+o*u,e[1]=i*s+a*u,e[2]=r*c+o*l,e[3]=i*c+a*l,e},c.mul=c.multiply,c.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=r*-s+o*u,e[3]=i*-s+a*u,e},c.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1];return e[0]=r*s,e[1]=i*s,e[2]=o*u,e[3]=a*u,e},c.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},c.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},c.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},"undefined"!=typeof e&&(e.mat2=c);var l={};l.create=function(){var e=new n(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},l.clone=function(e){var t=new n(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},l.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},l.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=n*o-r*i;return u?(u=1/u,e[0]=o*u,e[1]=-r*u,e[2]=-i*u,e[3]=n*u,e[4]=(i*s-o*a)*u,e[5]=(r*a-n*s)*u,e):null},l.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},l.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=n[0],l=n[1],f=n[2],m=n[3],p=n[4],d=n[5];return e[0]=r*c+o*l,e[1]=i*c+a*l,e[2]=r*f+o*m,e[3]=i*f+a*m,e[4]=r*p+o*d+s,e[5]=i*p+a*d+u,e},l.mul=l.multiply,l.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*c,e[1]=i*l+a*c,e[2]=r*-c+o*l,e[3]=i*-c+a*l,e[4]=s,e[5]=u,e},l.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=n[0],l=n[1];return e[0]=r*c,e[1]=i*c,e[2]=o*l,e[3]=a*l,e[4]=s,e[5]=u,e},l.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=n[0],l=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*c+o*l+s,e[5]=i*c+a*l+u,e},l.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},l.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},"undefined"!=typeof e&&(e.mat2d=l);var f={};f.create=function(){var e=new n(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},f.clone=function(e){var t=new n(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},f.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},f.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=l*a-s*c,m=-l*o+s*u,p=c*o-a*u,d=n*f+r*m+i*p;return d?(d=1/d,e[0]=f*d,e[1]=(-l*r+i*c)*d,e[2]=(s*r-i*a)*d,e[3]=m*d,e[4]=(l*n-i*u)*d,e[5]=(-s*n+i*o)*d,e[6]=p*d,e[7]=(-c*n+r*u)*d,e[8]=(a*n-r*o)*d,e):null},f.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=a*l-s*c,e[1]=i*c-r*l,e[2]=r*s-i*a,e[3]=s*u-o*l,e[4]=n*l-i*u,e[5]=i*o-n*s,e[6]=o*c-a*u,e[7]=r*u-n*c,e[8]=n*a-r*o,e},f.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)},f.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=n[0],p=n[1],d=n[2],h=n[3],g=n[4],b=n[5],v=n[6],y=n[7],x=n[8];return e[0]=m*r+p*a+d*c,e[1]=m*i+p*s+d*l,e[2]=m*o+p*u+d*f,e[3]=h*r+g*a+b*c,e[4]=h*i+g*s+b*l,e[5]=h*o+g*u+b*f,e[6]=v*r+y*a+x*c,e[7]=v*i+y*s+x*l,e[8]=v*o+y*u+x*f,e},f.mul=f.multiply,f.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=m*r+p*a+c,e[7]=m*i+p*s+l,e[8]=m*o+p*u+f,e},f.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=Math.sin(n),p=Math.cos(n);return e[0]=p*r+m*a,e[1]=p*i+m*s,e[2]=p*o+m*u,e[3]=p*a-m*r,e[4]=p*s-m*i,e[5]=p*u-m*o,e[6]=c,e[7]=l,e[8]=f,e},f.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},f.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,m=i*a,p=i*s,d=i*u,h=o*a,g=o*s,b=o*u;return e[0]=1-f-d,e[3]=l-b,e[6]=m+g,e[1]=l+b,e[4]=1-c-d,e[7]=p-h,e[2]=m-g,e[5]=p+h,e[8]=1-c-f,e},f.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],m=t[10],p=t[11],d=t[12],h=t[13],g=t[14],b=t[15],v=n*s-r*a,y=n*u-i*a,x=n*c-o*a,w=r*u-i*s,j=r*c-o*s,E=i*c-o*u,T=l*h-f*d,_=l*g-m*d,A=l*b-p*d,M=f*g-m*h,S=f*b-p*h,k=m*b-p*g,D=v*k-y*S+x*M+w*A-j*_+E*T;return D?(D=1/D,e[0]=(s*k-u*S+c*M)*D,e[1]=(u*A-a*k-c*_)*D,e[2]=(a*S-s*A+c*T)*D,e[3]=(i*S-r*k-o*M)*D,e[4]=(n*k-i*A+o*_)*D,e[5]=(r*A-n*S-o*T)*D,e[6]=(h*E-g*j+b*w)*D,e[7]=(g*x-d*E-b*y)*D,e[8]=(d*j-h*x+b*v)*D,e):null},f.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")";

},f.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},"undefined"!=typeof e&&(e.mat3=f);var m={};m.create=function(){var e=new n(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.clone=function(e){var t=new n(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},m.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},m.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},m.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],m=t[10],p=t[11],d=t[12],h=t[13],g=t[14],b=t[15],v=n*s-r*a,y=n*u-i*a,x=n*c-o*a,w=r*u-i*s,j=r*c-o*s,E=i*c-o*u,T=l*h-f*d,_=l*g-m*d,A=l*b-p*d,M=f*g-m*h,S=f*b-p*h,k=m*b-p*g,D=v*k-y*S+x*M+w*A-j*_+E*T;return D?(D=1/D,e[0]=(s*k-u*S+c*M)*D,e[1]=(i*S-r*k-o*M)*D,e[2]=(h*E-g*j+b*w)*D,e[3]=(m*j-f*E-p*w)*D,e[4]=(u*A-a*k-c*_)*D,e[5]=(n*k-i*A+o*_)*D,e[6]=(g*x-d*E-b*y)*D,e[7]=(l*E-m*x+p*y)*D,e[8]=(a*S-s*A+c*T)*D,e[9]=(r*A-n*S-o*T)*D,e[10]=(d*j-h*x+b*v)*D,e[11]=(f*x-l*j-p*v)*D,e[12]=(s*_-a*M-u*T)*D,e[13]=(n*M-r*_+i*T)*D,e[14]=(h*y-d*w-g*v)*D,e[15]=(l*w-f*y+m*v)*D,e):null},m.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],m=t[10],p=t[11],d=t[12],h=t[13],g=t[14],b=t[15];return e[0]=s*(m*b-p*g)-f*(u*b-c*g)+h*(u*p-c*m),e[1]=-(r*(m*b-p*g)-f*(i*b-o*g)+h*(i*p-o*m)),e[2]=r*(u*b-c*g)-s*(i*b-o*g)+h*(i*c-o*u),e[3]=-(r*(u*p-c*m)-s*(i*p-o*m)+f*(i*c-o*u)),e[4]=-(a*(m*b-p*g)-l*(u*b-c*g)+d*(u*p-c*m)),e[5]=n*(m*b-p*g)-l*(i*b-o*g)+d*(i*p-o*m),e[6]=-(n*(u*b-c*g)-a*(i*b-o*g)+d*(i*c-o*u)),e[7]=n*(u*p-c*m)-a*(i*p-o*m)+l*(i*c-o*u),e[8]=a*(f*b-p*h)-l*(s*b-c*h)+d*(s*p-c*f),e[9]=-(n*(f*b-p*h)-l*(r*b-o*h)+d*(r*p-o*f)),e[10]=n*(s*b-c*h)-a*(r*b-o*h)+d*(r*c-o*s),e[11]=-(n*(s*p-c*f)-a*(r*p-o*f)+l*(r*c-o*s)),e[12]=-(a*(f*g-m*h)-l*(s*g-u*h)+d*(s*m-u*f)),e[13]=n*(f*g-m*h)-l*(r*g-i*h)+d*(r*m-i*f),e[14]=-(n*(s*g-u*h)-a*(r*g-i*h)+d*(r*u-i*s)),e[15]=n*(s*m-u*f)-a*(r*m-i*f)+l*(r*u-i*s),e},m.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],m=e[11],p=e[12],d=e[13],h=e[14],g=e[15],b=t*a-n*o,v=t*s-r*o,y=t*u-i*o,x=n*s-r*a,w=n*u-i*a,j=r*u-i*s,E=c*d-l*p,T=c*h-f*p,_=c*g-m*p,A=l*h-f*d,M=l*g-m*d,S=f*g-m*h;return b*S-v*M+y*A+x*_-w*T+j*E},m.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=t[9],p=t[10],d=t[11],h=t[12],g=t[13],b=t[14],v=t[15],y=n[0],x=n[1],w=n[2],j=n[3];return e[0]=y*r+x*s+w*f+j*h,e[1]=y*i+x*u+w*m+j*g,e[2]=y*o+x*c+w*p+j*b,e[3]=y*a+x*l+w*d+j*v,y=n[4],x=n[5],w=n[6],j=n[7],e[4]=y*r+x*s+w*f+j*h,e[5]=y*i+x*u+w*m+j*g,e[6]=y*o+x*c+w*p+j*b,e[7]=y*a+x*l+w*d+j*v,y=n[8],x=n[9],w=n[10],j=n[11],e[8]=y*r+x*s+w*f+j*h,e[9]=y*i+x*u+w*m+j*g,e[10]=y*o+x*c+w*p+j*b,e[11]=y*a+x*l+w*d+j*v,y=n[12],x=n[13],w=n[14],j=n[15],e[12]=y*r+x*s+w*f+j*h,e[13]=y*i+x*u+w*m+j*g,e[14]=y*o+x*c+w*p+j*b,e[15]=y*a+x*l+w*d+j*v,e},m.mul=m.multiply,m.translate=function(e,t,n){var r,i,o,a,s,u,c,l,f,m,p,d,h=n[0],g=n[1],b=n[2];return t===e?(e[12]=t[0]*h+t[4]*g+t[8]*b+t[12],e[13]=t[1]*h+t[5]*g+t[9]*b+t[13],e[14]=t[2]*h+t[6]*g+t[10]*b+t[14],e[15]=t[3]*h+t[7]*g+t[11]*b+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],m=t[9],p=t[10],d=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=m,e[10]=p,e[11]=d,e[12]=r*h+s*g+f*b+t[12],e[13]=i*h+u*g+m*b+t[13],e[14]=o*h+c*g+p*b+t[14],e[15]=a*h+l*g+d*b+t[15]),e},m.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},m.rotate=function(e,n,r,i){var o,a,s,u,c,l,f,m,p,d,h,g,b,v,y,x,w,j,E,T,_,A,M,S,k=i[0],D=i[1],O=i[2],L=Math.sqrt(k*k+D*D+O*O);return Math.abs(L)<t?null:(L=1/L,k*=L,D*=L,O*=L,o=Math.sin(r),a=Math.cos(r),s=1-a,u=n[0],c=n[1],l=n[2],f=n[3],m=n[4],p=n[5],d=n[6],h=n[7],g=n[8],b=n[9],v=n[10],y=n[11],x=k*k*s+a,w=D*k*s+O*o,j=O*k*s-D*o,E=k*D*s-O*o,T=D*D*s+a,_=O*D*s+k*o,A=k*O*s+D*o,M=D*O*s-k*o,S=O*O*s+a,e[0]=u*x+m*w+g*j,e[1]=c*x+p*w+b*j,e[2]=l*x+d*w+v*j,e[3]=f*x+h*w+y*j,e[4]=u*E+m*T+g*_,e[5]=c*E+p*T+b*_,e[6]=l*E+d*T+v*_,e[7]=f*E+h*T+y*_,e[8]=u*A+m*M+g*S,e[9]=c*A+p*M+b*S,e[10]=l*A+d*M+v*S,e[11]=f*A+h*M+y*S,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},m.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+f*r,e[7]=u*i+m*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=f*i-s*r,e[11]=m*i-u*r,e},m.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-f*r,e[3]=u*i-m*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+f*i,e[11]=u*r+m*i,e},m.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+f*r,e[3]=u*i+m*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=f*i-s*r,e[7]=m*i-u*r,e},m.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,m=r*c,p=i*u,d=i*c,h=o*c,g=a*s,b=a*u,v=a*c;return e[0]=1-(p+h),e[1]=f+v,e[2]=m-b,e[3]=0,e[4]=f-v,e[5]=1-(l+h),e[6]=d+g,e[7]=0,e[8]=m+b,e[9]=d-g,e[10]=1-(l+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},m.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,m=i*a,p=i*s,d=i*u,h=o*a,g=o*s,b=o*u;return e[0]=1-f-d,e[1]=l+b,e[2]=m-g,e[3]=0,e[4]=l-b,e[5]=1-c-d,e[6]=p+h,e[7]=0,e[8]=m+g,e[9]=p-h,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e},m.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e},m.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e},m.lookAt=function(e,n,r,i){var o,a,s,u,c,l,f,p,d,h,g=n[0],b=n[1],v=n[2],y=i[0],x=i[1],w=i[2],j=r[0],E=r[1],T=r[2];return Math.abs(g-j)<t&&Math.abs(b-E)<t&&Math.abs(v-T)<t?m.identity(e):(f=g-j,p=b-E,d=v-T,h=1/Math.sqrt(f*f+p*p+d*d),f*=h,p*=h,d*=h,o=x*d-w*p,a=w*f-y*d,s=y*p-x*f,h=Math.sqrt(o*o+a*a+s*s),h?(h=1/h,o*=h,a*=h,s*=h):(o=0,a=0,s=0),u=p*s-d*a,c=d*o-f*s,l=f*a-p*o,h=Math.sqrt(u*u+c*c+l*l),h?(h=1/h,u*=h,c*=h,l*=h):(u=0,c=0,l=0),e[0]=o,e[1]=u,e[2]=f,e[3]=0,e[4]=a,e[5]=c,e[6]=p,e[7]=0,e[8]=s,e[9]=l,e[10]=d,e[11]=0,e[12]=-(o*g+a*b+s*v),e[13]=-(u*g+c*b+l*v),e[14]=-(f*g+p*b+d*v),e[15]=1,e)},m.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},m.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},"undefined"!=typeof e&&(e.mat4=m);var p={};p.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.rotationTo=function(){var e=s.create(),t=s.fromValues(1,0,0),n=s.fromValues(0,1,0);return function(r,i,o){var a=s.dot(i,o);return-.999999>a?(s.cross(e,t,i),s.length(e)<1e-6&&s.cross(e,n,i),s.normalize(e,e),p.setAxisAngle(r,e,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(s.cross(e,i,o),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+a,p.normalize(r,r))}}(),p.setAxes=function(){var e=f.create();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],p.normalize(t,p.fromMat3(t,e))}}(),p.clone=u.clone,p.fromValues=u.fromValues,p.copy=u.copy,p.set=u.set,p.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.setAxisAngle=function(e,t,n){n=.5*n;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},p.add=u.add,p.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,e},p.mul=p.multiply,p.scale=u.scale,p.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e},p.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e},p.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e},p.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},p.dot=u.dot,p.lerp=u.lerp,p.slerp=function(e,t,n,r){var i,o,a,s,u,c=t[0],l=t[1],f=t[2],m=t[3],p=n[0],d=n[1],h=n[2],g=n[3];return o=c*p+l*d+f*h+m*g,0>o&&(o=-o,p=-p,d=-d,h=-h,g=-g),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*c+u*p,e[1]=s*l+u*d,e[2]=s*f+u*h,e[3]=s*m+u*g,e},p.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},p.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},p.length=u.length,p.len=p.length,p.squaredLength=u.squaredLength,p.sqrLen=p.squaredLength,p.normalize=u.normalize,p.fromMat3=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[7]-t[5])*n,e[1]=(t[2]-t[6])*n,e[2]=(t[3]-t[1])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e},p.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},"undefined"!=typeof e&&(e.quat=p)}(r.exports)}(this)}(),e.register("npm:core-js@0.8.2/library/modules/$.collection-strong",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.ctx","npm:core-js@0.8.2/library/modules/$.uid","npm:core-js@0.8.2/library/modules/$.assert","npm:core-js@0.8.2/library/modules/$.iter"],!0,function(require,t,n){function r(e,t){if(!d(e))return("string"==typeof e?"S":"P")+e;if(b(e))return"F";if(!m(e,v)){if(!t)return"E";h(e,v,++T)}return"O"+e[v]}function i(e,t){var n,i=r(t);if("F"!=i)return e[y][i];for(n=e[w];n;n=n.n)if(n.k==t)return n}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.8.2/library/modules/$"),u=require("npm:core-js@0.8.2/library/modules/$.ctx"),c=require("npm:core-js@0.8.2/library/modules/$.uid").safe,l=require("npm:core-js@0.8.2/library/modules/$.assert"),f=require("npm:core-js@0.8.2/library/modules/$.iter"),m=s.has,p=s.set,d=s.isObject,h=s.hide,g=f.step,b=Object.isFrozen||s.core.Object.isFrozen,v=c("id"),y=c("O1"),x=c("last"),w=c("first"),j=c("iter"),E=s.DESC?c("size"):"size",T=0;return n.exports={getConstructor:function(e,t,n){function r(i){var o=l.inst(this,r,e);p(o,y,s.create(null)),p(o,E,0),p(o,x,void 0),p(o,w,void 0),void 0!=i&&f.forOf(i,t,o[n],o)}return s.mix(r.prototype,{clear:function(){for(var e=this,t=e[y],n=e[w];n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e[w]=e[x]=void 0,e[E]=0},"delete":function(e){var t=this,n=i(t,e);if(n){var r=n.n,o=n.p;delete t[y][n.i],n.r=!0,o&&(o.n=r),r&&(r.p=o),t[w]==n&&(t[w]=r),t[x]==n&&(t[x]=o),t[E]--}return!!n},forEach:function(e){for(var t,n=u(e,arguments[1],3);t=t?t.n:this[w];)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!i(this,e)}}),s.DESC&&s.setDesc(r.prototype,"size",{get:function(){return l.def(this[E])}}),r},def:function(e,t,n){var o,a,s=i(e,t);return s?s.v=n:(e[x]=s={i:a=r(t,!0),k:t,v:n,p:o=e[x],n:void 0,r:!1},e[w]||(e[w]=s),o&&(o.n=s),e[E]++,"F"!=a&&(e[y][a]=s)),e},getEntry:i,getIterConstructor:function(){return function(e,t){p(this,j,{o:e,k:t})}},next:function(){for(var e=this[j],t=e.k,n=e.l;n&&n.r;)n=n.p;return e.o&&(e.l=n=n?n.n:e.o[w])?"key"==t?g(0,n.k):"value"==t?g(0,n.v):g(0,[n.k,n.v]):(e.o=void 0,g(1))}},o.define=a,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.set",["npm:core-js@0.8.2/library/modules/$.collection-strong","npm:core-js@0.8.2/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.collection-strong");return require("npm:core-js@0.8.2/library/modules/$.collection")("Set",{add:function(e){return o.def(this,e=0===e?0:e,e)}},o),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es7.set.to-json",["npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.iter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.def"),a=require("npm:core-js@0.8.2/library/modules/$.iter").forOf;return o(o.P,"Set",{toJSON:function(){var e=[];return a(this,!1,e.push,e),e}}),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/normalize-options",["github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";var t=Array.prototype.forEach,r=Object.create,e=function(e,t){var n;for(n in e)t[n]=e[n]};n.exports=function(n){var i=r(null);return t.call(arguments,function(t){null!=t&&e(Object(t),i)}),i}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/math/sign/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e=Math.sign;return"function"!=typeof e?!1:1===e(10)&&-1===e(-20)},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/math/sign/shim",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/valid-callable",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/is-callable",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return"function"==typeof e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/valid-value",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/registered-extensions",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/assign/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e,t=Object.assign;return"function"!=typeof t?!1:(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/keys/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/keys/shim",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.keys;return n.exports=function(e){return o(null==e?e:Object(e))},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/mixin",["npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-value"),a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames;return n.exports=function(e,t){var n;if(e=Object(o(e)),u(Object(o(t))).forEach(function(r){try{a(e,r,s(t,r))}catch(i){n=i}}),void 0!==n)throw n;return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/assign",["npm:es5-ext@0.10.6/object/assign/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/assign/index"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/string/#/contains/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o="razdwatrzy";return n.exports=function(){return"function"!=typeof o.contains?!1:o.contains("dwa")===!0&&o.contains("foo")===!1},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/string/#/contains/shim",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=String.prototype.indexOf;return n.exports=function(e){return o.call(this,e,arguments[1])>-1},r.define=i,n.exports}),e.register("npm:event-emitter@0.3.3/index",["npm:d@0.1.1","npm:es5-ext@0.10.6/object/valid-callable"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a,s,u,c,l,f,m=require("npm:d@0.1.1"),p=require("npm:es5-ext@0.10.6/object/valid-callable"),d=Function.prototype.apply,h=Function.prototype.call,g=Object.create,b=Object.defineProperty,v=Object.defineProperties,y=Object.prototype.hasOwnProperty,x={configurable:!0,enumerable:!1,writable:!0};return o=function(e,t){var n;return p(t),y.call(this,"__ee__")?n=this.__ee__:(n=x.value=g(null),b(this,"__ee__",x),x.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},a=function(e,t){var n,r;return p(t),r=this,o.call(this,e,n=function(){s.call(r,e,n),d.call(t,this,arguments)}),n.__eeOnceListener__=t,this},s=function(e,t){var n,r,i,o;if(p(t),!y.call(this,"__ee__"))return this;if(n=this.__ee__,!n[e])return this;if(r=n[e],"object"==typeof r)for(o=0;i=r[o];++o)(i===t||i.__eeOnceListener__===t)&&(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else(r===t||r.__eeOnceListener__===t)&&delete n[e];return this},u=function(e){var t,n,r,i,o;if(y.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;n>t;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)d.call(r,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;n>t;++t)o[t-1]=arguments[t];d.call(i,this,o)}},c={on:o,once:a,off:s,emit:u},l={on:m(o),once:m(a),off:m(s),emit:m(u)},f=v({},l),n.exports=t=function(e){return null==e?g(f):v(Object(e),l)},t.methods=c,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/array/from/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e,t,n=Array.from;return"function"!=typeof n?!1:(e=["raz","dwa"],t=n(e),Boolean(t&&t!==e&&"dwa"===t[1]))},r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/is-implemented",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(t){return!1}return"symbol"==typeof Symbol.iterator?!0:"object"!=typeof Symbol.isConcatSpreadable?!1:"object"!=typeof Symbol.iterator?!1:"object"!=typeof Symbol.toPrimitive?!1:"object"!=typeof Symbol.toStringTag?!1:"object"!=typeof Symbol.unscopables?!1:!0},r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/is-symbol",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e&&("symbol"==typeof e||"Symbol"===e["@@toStringTag"])||!1},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/function/is-arguments",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call(function(){return arguments}());return n.exports=function(e){return o.call(e)===a},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/function/noop",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(){},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/string/is-string",[],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call("");return n.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||o.call(e)===a)||!1},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/resolve-normalize",["npm:es5-ext@0.10.6/object/valid-callable"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-callable");return n.exports=function(e){var t;return"function"==typeof e?{set:e,get:e}:(t={get:o(e.get)},void 0!==e.set?(t.set=o(e.set),t["delete"]=o(e["delete"]),t.clear=o(e.clear),t):(t.set=t.get,t))},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/primitive",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){var t,n,r=e.length;if(!r)return"";for(t=String(e[n=0]);--r;)t+=""+e[++n];return t},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get-primitive-fixed",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){return e?function(t){for(var n=String(t[0]),r=0,i=e;--i;)n+=""+t[++r];return n}:function(){return""}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/array/#/e-index-of",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=require("npm:es5-ext@0.10.6/object/valid-value"),s=Array.prototype.indexOf,u=Object.prototype.hasOwnProperty,c=Math.abs,l=Math.floor;return n.exports=function(e){var t,n,r,i;if(e===e)return s.apply(this,arguments);for(n=o(a(this).length),r=arguments[1],r=isNaN(r)?0:r>=0?l(r):o(this.length)-l(c(r)),t=r;n>t;++t)if(u.call(this,t)&&(i=this[t],i!==i))return t;return-1},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get-1",["npm:es5-ext@0.10.6/array/#/e-index-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/#/e-index-of");return n.exports=function(){var e=0,t=[],n=[];return{get:function(e){var r=o.call(t,e[0]);return-1===r?null:n[r]},set:function(r){return t.push(r[0]),n.push(++e),e},"delete":function(e){var r=o.call(n,e);-1!==r&&(t.splice(r,1),n.splice(r,1))},clear:function(){t=[],n=[]}}},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get-fixed",["npm:es5-ext@0.10.6/array/#/e-index-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/#/e-index-of"),a=Object.create;return n.exports=function(e){var t=0,n=[[],[]],r=a(null);return{get:function(t){for(var r,i=0,a=n;e-1>i;){if(r=o.call(a[0],t[i]),-1===r)return null;a=a[1][r],++i}return r=o.call(a[0],t[i]),-1===r?null:a[1][r]||null},set:function(i){for(var a,s=0,u=n;e-1>s;)a=o.call(u[0],i[s]),-1===a&&(a=u[0].push(i[s])-1,u[1].push([[],[]])),u=u[1][a],++s;return a=o.call(u[0],i[s]),-1===a&&(a=u[0].push(i[s])-1),u[1][a]=++t,r[t]=i,t},"delete":function(t){for(var i,a=0,s=n,u=[],c=r[t];e-1>a;){if(i=o.call(s[0],c[a]),-1===i)return;u.push(s,i),s=s[1][i],++a}if(i=o.call(s[0],c[a]),-1!==i){for(t=s[1][i],s[0].splice(i,1),s[1].splice(i,1);!s[0].length&&u.length;)i=u.pop(),s=u.pop(),s[0].splice(i,1),s[1].splice(i,1);delete r[t]}},clear:function(){n=[[],[]],r=a(null)}}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/array/from",["npm:es5-ext@0.10.6/array/from/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/array/from/index"),r.define=i,n.exports}),e.register("npm:next-tick@0.2.2/index",["github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";var t,r;t=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},r=function(e){var n,r=document.createTextNode(""),i=0;return new e(function(){var e;if(n)return e=n,n=null,"function"==typeof e?void e():void e.forEach(function(e){e()})}).observe(r,{characterData:!0}),function(e){return t(e),n?void("function"==typeof n?n=[n,e]:n.push(e)):(n=e,void(r.data=i=++i%2))}},n.exports=function(){if("undefined"!=typeof e&&e&&"function"==typeof e.nextTick)return e.nextTick;if("object"==typeof document&&document){if("function"==typeof MutationObserver)return r(MutationObserver);if("function"==typeof WebKitMutationObserver)return r(WebKitMutationObserver)}return"function"==typeof setImmediate?function(e){setImmediate(t(e))}:"function"==typeof setTimeout?function(e){setTimeout(t(e),0)}:null}()}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/dispose",["npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/for-each","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-callable"),a=require("npm:es5-ext@0.10.6/object/for-each"),s=require("npm:memoizee@0.3.8/lib/registered-extensions"),u=Array.prototype.slice,c=Function.prototype.apply;return s.dispose=function(e,t,n){var r;return o(e),n.async&&s.async?(t.on("deleteasync",r=function(t,n){c.call(e,null,u.call(n.args,1))}),void t.on("clearasync",function(e){a(e,function(e,t){r(t,e)})})):(t.on("delete",r=function(t,n){e(n)}),void t.on("clear",function(e){a(e,function(e,t){r(t,e)})}))},r.define=i,n.exports}),e.register("npm:timers-ext@0.1.0/max-timeout",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=2147483647,r.define=i,n.exports}),e.register("npm:lru-queue@0.1.0/index",["npm:es5-ext@0.10.6/number/to-pos-integer"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=Object.create,s=Object.prototype.hasOwnProperty;return n.exports=function(e){var t,n=0,r=1,i=a(null),u=a(null),c=0;return e=o(e),{hit:function(o){var a=u[o],l=++c;if(i[l]=o,u[o]=l,!a){if(++n,e>=n)return;return o=i[r],t(o),o}if(delete i[a],r===a)for(;!s.call(i,++r);)continue},"delete":t=function(e){var t=u[e];if(t&&(delete i[t],delete u[e],--n,r===t)){if(!n)return c=0,void(r=1);for(;!s.call(i,++r);)continue}},clear:function(){n=0,r=1,i=a(null),u=a(null),c=0}}},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/ref-counter",["npm:d@0.1.1","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:d@0.1.1"),a=require("npm:memoizee@0.3.8/lib/registered-extensions"),s=Object.create,u=Object.defineProperties;return a.refCounter=function(e,t,n){var r,i;r=s(null),i=n.async&&a.async?"async":"",t.on("set"+i,function(e,t){r[e]=t||1}),t.on("get"+i,function(e){++r[e]}),t.on("delete"+i,function(e){delete r[e]}),t.on("clear"+i,function(){r={}}),u(t.memoized,{deleteRef:o(function(){var e=t.get(arguments);return null===e?null:r[e]?--r[e]?!1:(t["delete"](e),!0):null}),getRefCount:o(function(){var e=t.get(arguments);return null===e?0:r[e]?r[e]:0})})},r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/helpers/bind",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,t["default"]=Function.prototype.bind,t.__esModule=!0,r.define=i,n.exports}),e.register("github:toji/gl-matrix@2.2.1/src/gl-matrix/vec3.js!github:systemjs/plugin-text@0.0.2",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports="/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation \n    and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\n\n/**\n * @class 3 Dimensional Vector\n * @name vec3\n */\nvar vec3 = {};\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nvec3.create = function() {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nvec3.clone = function(a) {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nvec3.fromValues = function(x, y, z) {\n    var out = new GLMAT_ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nvec3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nvec3.set = function(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nvec3.sub = vec3.subtract;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    out[2] = a[2] * b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nvec3.mul = vec3.multiply;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    out[2] = a[2] / b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nvec3.div = vec3.divide;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    out[2] = Math.min(a[2], b[2]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    out[2] = Math.max(a[2], b[2]);\n    return out;\n};\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nvec3.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n};\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nvec3.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nvec3.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nvec3.dist = vec3.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec3.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nvec3.sqrDist = vec3.squaredDistance;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec3.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nvec3.len = vec3.length;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec3.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nvec3.sqrLen = vec3.squaredLength;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nvec3.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    return out;\n};\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nvec3.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    var len = x*x + y*y + z*z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.cross = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n};\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    out[2] = az + t * (b[2] - az);\n    return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nvec3.random = function (out, scale) {\n    scale = scale || 1.0;\n\n    var r = GLMAT_RANDOM() * 2.0 * Math.PI;\n    var z = (GLMAT_RANDOM() * 2.0) - 1.0;\n    var zScale = Math.sqrt(1.0-z*z) * scale;\n\n    out[0] = Math.cos(r) * zScale;\n    out[1] = Math.sin(r) * zScale;\n    out[2] = z * scale;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat4 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = m[0] * x + m[4] * y + m[8] * z + m[12];\n    out[1] = m[1] * x + m[5] * y + m[9] * z + m[13];\n    out[2] = m[2] * x + m[6] * y + m[10] * z + m[14];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat3 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = x * m[0] + y * m[3] + z * m[6];\n    out[1] = x * m[1] + y * m[4] + z * m[7];\n    out[2] = x * m[2] + y * m[5] + z * m[8];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nvec3.transformQuat = function(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return out;\n};\n\n/*\n* Rotate a 3D vector around the x-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateX = function(out, a, b, c){\n   var p = [], r=[];\n	  //Translate point to the origin\n	  p[0] = a[0] - b[0];\n	  p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n\n	  //perform rotation\n	  r[0] = p[0];\n	  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\n	  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\n\n	  //translate to correct position\n	  out[0] = r[0] + b[0];\n	  out[1] = r[1] + b[1];\n	  out[2] = r[2] + b[2];\n\n  	return out;\n};\n\n/*\n* Rotate a 3D vector around the y-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateY = function(out, a, b, c){\n  	var p = [], r=[];\n  	//Translate point to the origin\n  	p[0] = a[0] - b[0];\n  	p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n  \n  	//perform rotation\n  	r[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\n  	r[1] = p[1];\n  	r[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\n  \n  	//translate to correct position\n  	out[0] = r[0] + b[0];\n  	out[1] = r[1] + b[1];\n  	out[2] = r[2] + b[2];\n  \n  	return out;\n};\n\n/*\n* Rotate a 3D vector around the z-axis\n* @param {vec3} out The receiving vec3\n* @param {vec3} a The vec3 point to rotate\n* @param {vec3} b The origin of the rotation\n* @param {Number} c The angle of rotation\n* @returns {vec3} out\n*/\nvec3.rotateZ = function(out, a, b, c){\n  	var p = [], r=[];\n  	//Translate point to the origin\n  	p[0] = a[0] - b[0];\n  	p[1] = a[1] - b[1];\n  	p[2] = a[2] - b[2];\n  \n  	//perform rotation\n  	r[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\n  	r[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\n  	r[2] = p[2];\n  \n  	//translate to correct position\n  	out[0] = r[0] + b[0];\n  	out[1] = r[1] + b[1];\n  	out[2] = r[2] + b[2];\n  \n  	return out;\n};\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec3.forEach = (function() {\n    var vec = vec3.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 3;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec3} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec3.str = function (a) {\n    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n};\n\nif(typeof(exports) !== 'undefined') {\n    exports.vec3 = vec3;\n}\n",
r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/object/freeze",["npm:core-js@0.8.2/library/modules/es6.object.statics-accept-primitives","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.object.statics-accept-primitives"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Object.freeze,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.array.from",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.ctx","npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.iter","npm:core-js@0.8.2/library/modules/$.iter-detect"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.ctx"),s=require("npm:core-js@0.8.2/library/modules/$.def"),u=require("npm:core-js@0.8.2/library/modules/$.iter"),c=u.stepCall;return s(s.S+s.F*!require("npm:core-js@0.8.2/library/modules/$.iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,i,s=Object(o.assertDefined(e)),l=arguments[1],f=void 0!==l,m=f?a(l,arguments[2],2):void 0,p=0;if(u.is(s))for(i=u.get(s),n=new("function"==typeof this?this:Array);!(r=i.next()).done;p++)n[p]=f?c(i,m,[r.value,p],!0):r.value;else for(n=new("function"==typeof this?this:Array)(t=o.toLength(s.length));t>p;p++)n[p]=f?m(s[p],p):s[p];return n.length=p,n}}),r.define=i,n.exports}),e.register("github:maxdavidson/jsTGALoader@master/tga.js!github:systemjs/plugin-text@0.0.2",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=" /**\n * @fileoverview jsTGALoader - Javascript loader for TGA file\n * @author Vincent Thibault\n * @version 1.2.1\n * @blog http://blog.robrowser.com/javascript-tga-loader.html\n */\n\n/* Copyright (c) 2013, Vincent Thibault. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n  * Redistributions of source code must retain the above copyright notice, this\n    list of conditions and the following disclaimer.\n  * Redistributions in binary form must reproduce the above copyright notice,\n    this list of conditions and the following disclaimer in the documentation \n    and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\nANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE \nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\nANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\nLOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\nANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */\n\n(function(_global)\n{\n	'use strict';\n\n\n	/**\n	 * TGA Namespace\n	 * @constructor\n	 */\n	function Targa()\n	{\n	}\n\n\n	/**\n	 * @var {object} TGA type constants\n	 */\n	Targa.Type = {\n		NO_DATA:      0,\n		INDEXED:      1,\n		RGB:          2,\n		GREY:         3,\n		RLE_INDEXED:  9,\n		RLE_RGB:     10,\n		RLE_GREY:    11\n	};\n\n\n	/**\n	 * @var {object} TGA origin constants\n	 */\n	Targa.Origin = {\n		BOTTOM_LEFT:  0x00,\n		BOTTOM_RIGHT: 0x01,\n		TOP_LEFT:     0x02,\n		TOP_RIGHT:    0x03,\n		SHIFT:        0x04,\n		MASK:         0x30\n	};\n\n\n	/**\n	 * Check the header of TGA file to detect errors\n	 *\n	 * @param {object} tga header structure\n	 * @throws Error\n	 */\n	function checkHeader( header )\n	{\n		// What the need of a file without data ?\n		if (header.imageType === Targa.Type.NO_DATA) {\n			throw new Error('Targa::checkHeader() - No data');\n		}\n\n		// Indexed type\n		if (header.hasColorMap) {\n			if (header.colorMapLength > 256 || header.colorMapSize !== 24 || header.colorMapType !== 1) {\n				throw new Error('Targa::checkHeader() - Invalid colormap for indexed type');\n			}\n		}\n		else {\n			if (header.colorMapType) {\n				throw new Error('Targa::checkHeader() - Why does the image contain a palette ?');\n			}\n		}\n\n		// Check image size\n		if (header.width <= 0 || header.height <= 0) {\n			throw new Error('Targa::checkHeader() - Invalid image size');\n		}\n\n		// Check pixel size\n		if (header.pixelDepth !== 8  &&\n		    header.pixelDepth !== 16 &&\n		    header.pixelDepth !== 24 &&\n		    header.pixelDepth !== 32) {\n			throw new Error('Targa::checkHeader() - Invalid pixel size \"' + header.pixelDepth + '\"');\n		}\n	}\n\n\n	/**\n	 * Decode RLE compression\n	 *\n	 * @param {Uint8Array} data\n	 * @param {number} offset in data to start loading RLE\n	 * @param {number} pixel count\n	 * @param {number} output buffer size\n	 */\n	function decodeRLE( data, offset, pixelSize, outputSize)\n	{\n		var pos, c, count, i;\n		var pixels, output;\n\n		output = new Uint8Array(outputSize);\n		pixels = new Uint8Array(pixelSize);\n		pos    = 0;\n\n		while (pos < outputSize) {\n			c     = data[offset++];\n			count = (c & 0x7f) + 1;\n\n			// RLE pixels.\n			if (c & 0x80) {\n				// Bind pixel tmp array\n				for (i = 0; i < pixelSize; ++i) {\n					pixels[i] = data[offset++];\n				}\n\n				// Copy pixel array\n				for (i = 0; i < count; ++i) {\n					output.set(pixels, pos);\n					pos += pixelSize;\n				}\n			}\n\n			// Raw pixels.\n			else {\n				count *= pixelSize;\n				for (i = 0; i < count; ++i) {\n					output[pos++] = data[offset++];\n				}\n			}\n		}\n\n		return output;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (8bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} indexes - index to colormap\n	 * @param {Array} colormap\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData8bits(imageData, indexes, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i++) {\n				color = indexes[i];\n				imageData[(x + width * y) * 4 + 3] = 255;\n				imageData[(x + width * y) * 4 + 2] = colormap[(color * 3) + 0];\n				imageData[(x + width * y) * 4 + 1] = colormap[(color * 3) + 1];\n				imageData[(x + width * y) * 4 + 0] = colormap[(color * 3) + 2];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (16bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData16bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 2) {\n				color = pixels[i + 0] | (pixels[i + 1] << 8);\n				imageData[(x + width * y) * 4 + 0] = (color & 0x7C00) >> 7;\n				imageData[(x + width * y) * 4 + 1] = (color & 0x03E0) >> 2;\n				imageData[(x + width * y) * 4 + 2] = (color & 0x001F) >> 3;\n				imageData[(x + width * y) * 4 + 3] = (color & 0x8000) ? 0 : 255;\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (24bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData24bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 3) {\n				imageData[(x + width * y) * 4 + 3] = 255;\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 1];\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 2];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (32bits)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageData32bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 4) {\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 1];\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 2];\n				imageData[(x + width * y) * 4 + 3] = pixels[i + 3];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (8bits grey)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageDataGrey8bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var color, i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i++) {\n				color = pixels[i];\n				imageData[(x + width * y) * 4 + 0] = color;\n				imageData[(x + width * y) * 4 + 1] = color;\n				imageData[(x + width * y) * 4 + 2] = color;\n				imageData[(x + width * y) * 4 + 3] = 255;\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Return a ImageData object from a TGA file (16bits grey)\n	 *\n	 * @param {Array} imageData - ImageData to bind\n	 * @param {Array} pixels data\n	 * @param {Array} colormap - not used\n	 * @param {number} width\n	 * @param {number} y_start - start at y pixel.\n	 * @param {number} x_start - start at x pixel.\n	 * @param {number} y_step  - increment y pixel each time.\n	 * @param {number} y_end   - stop at pixel y.\n	 * @param {number} x_step  - increment x pixel each time.\n	 * @param {number} x_end   - stop at pixel x.\n	 * @returns {Array} imageData\n	 */\n	function getImageDataGrey16bits(imageData, pixels, colormap, width, y_start, y_step, y_end, x_start, x_step, x_end)\n	{\n		var i, x, y;\n\n		for (i = 0, y = y_start; y !== y_end; y += y_step) {\n			for (x = x_start; x !== x_end; x += x_step, i += 2) {\n				imageData[(x + width * y) * 4 + 0] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 1] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 2] = pixels[i + 0];\n				imageData[(x + width * y) * 4 + 3] = pixels[i + 1];\n			}\n		}\n\n		return imageData;\n	}\n\n\n	/**\n	 * Open a targa file using XHR, be aware with Cross Domain files...\n	 *\n	 * @param {string} path - Path of the filename to load\n	 * @param {function} callback - callback to trigger when the file is loaded\n	 */\n	Targa.prototype.open = function targaOpen(path, callback)\n	{\n		var req, tga = this;\n		req = new XMLHttpRequest();\n		req.open('GET', path, true);\n		req.responseType = 'arraybuffer';\n		req.onload = function() {\n			if (this.status === 200) {\n				tga.load(new Uint8Array(req.response));\n				if (callback) {\n					callback.call(tga);\n				}\n			}\n		};\n		req.send(null);\n	};\n\n\n	/**\n	 * Load and parse a TGA file\n	 *\n	 * @param {Uint8Array} data - TGA file buffer array\n	 */\n	Targa.prototype.load = function targaLoad( data )\n	{\n		var offset = 0;\n\n		// Not enough data to contain header ?\n		if (data.length < 0x12) {\n			throw new Error('Targa::load() - Not enough data to contain header');\n		}\n\n		// Read TgaHeader\n		this.header = {\n			/* 0x00  BYTE */  idLength:       data[offset++],\n			/* 0x01  BYTE */  colorMapType:   data[offset++],\n			/* 0x02  BYTE */  imageType:      data[offset++],\n			/* 0x03  WORD */  colorMapIndex:  data[offset++] | data[offset++] << 8,\n			/* 0x05  WORD */  colorMapLength: data[offset++] | data[offset++] << 8,\n			/* 0x07  BYTE */  colorMapDepth:  data[offset++],\n			/* 0x08  WORD */  offsetX:        data[offset++] | data[offset++] << 8,\n			/* 0x0a  WORD */  offsetY:        data[offset++] | data[offset++] << 8,\n			/* 0x0c  WORD */  width:          data[offset++] | data[offset++] << 8,\n			/* 0x0e  WORD */  height:         data[offset++] | data[offset++] << 8,\n			/* 0x10  BYTE */  pixelDepth:     data[offset++],\n			/* 0x11  BYTE */  flags:          data[offset++]\n		};\n\n		// Set shortcut\n		this.header.hasEncoding = (this.header.imageType === Targa.Type.RLE_INDEXED || this.header.imageType === Targa.Type.RLE_RGB   || this.header.imageType === Targa.Type.RLE_GREY);\n		this.header.hasColorMap = (this.header.imageType === Targa.Type.RLE_INDEXED || this.header.imageType === Targa.Type.INDEXED);\n		this.header.isGreyColor = (this.header.imageType === Targa.Type.RLE_GREY    || this.header.imageType === Targa.Type.GREY);\n\n		// Check if a valid TGA file (or if we can load it)\n		checkHeader(this.header);\n\n		// Move to data\n		offset += this.header.idLength;\n		if (offset >= data.length) {\n			throw new Error('Targa::load() - No data');\n		}\n\n		// Read palette\n		if (this.header.hasColorMap) {\n			var colorMapSize  = this.header.colorMapLength * (this.header.colorMapDepth >> 3);\n			this.palette      = data.subarray( offset, offset + colorMapSize);\n			offset           += colorMapSize;\n		}\n\n		var pixelSize  = this.header.pixelDepth >> 3;\n		var imageSize  = this.header.width * this.header.height;\n		var pixelTotal = imageSize * pixelSize;\n\n		// RLE encoded\n		if (this.header.hasEncoding) {\n			this.imageData = decodeRLE(data, offset, pixelSize, pixelTotal);\n		}\n\n		// RAW pixels\n		else {\n			this.imageData = data.subarray( offset, offset + (this.header.hasColorMap ? imageSize : pixelTotal) );\n		}\n	};\n\n\n	/**\n	 * Return a ImageData object from a TGA file\n	 *\n	 * @param {object} imageData - Optional ImageData to work with\n	 * @returns {object} imageData\n	 */\n	Targa.prototype.getImageData = function targaGetImageData( imageData )\n	{\n		var width  = this.header.width;\n		var height = this.header.height;\n		var origin = (this.header.flags & Targa.Origin.MASK) >> Targa.Origin.SHIFT;\n		var x_start, x_step, x_end, y_start, y_step, y_end;\n		var getImageData;\n\n			// Create an imageData\n		if (!imageData) {\n			if (typeof(window) === 'object') {\n				imageData = document.createElement('canvas').getContext('2d').createImageData(width, height);\n			}\n			// In Thread context ?\n			else {\n				imageData = {\n					width:  width,\n					height: height,\n					data: new Uint8ClampedArray(width * height * 4)\n				};\n			}\n		}\n\n		if (origin === Targa.Origin.TOP_LEFT || origin === Targa.Origin.TOP_RIGHT) {\n			y_start = 0;\n			y_step  = 1;\n			y_end   = height;\n		}\n		else {\n			y_start = height - 1;\n			y_step  = -1;\n			y_end   = -1;\n		}\n\n		if (origin === Targa.Origin.TOP_LEFT || origin === Targa.Origin.BOTTOM_LEFT) {\n			x_start = 0;\n			x_step  = 1;\n			x_end   = width;\n		}\n		else {\n			x_start = width - 1;\n			x_step  = -1;\n			x_end   = -1;\n		}\n\n		// TODO: use this.header.offsetX and this.header.offsetY ?\n\n		switch (this.header.pixelDepth) {\n			case 8:\n				getImageData = this.header.isGreyColor ? getImageDataGrey8bits : getImageData8bits;\n				break;\n\n			case 16:\n				getImageData = this.header.isGreyColor ? getImageDataGrey16bits : getImageData16bits;\n				break;\n\n			case 24:\n				getImageData = getImageData24bits;\n				break;\n\n			case 32:\n				getImageData = getImageData32bits;\n				break;\n		}\n\n		getImageData(imageData.data, this.imageData, this.palette, width, y_start, y_step, y_end, x_start, x_step, x_end);\n		return imageData;\n	};\n\n\n	/**\n	 * Return a canvas with the TGA render on it\n	 *\n	 * @returns {object} CanvasElement\n	 */\n	Targa.prototype.getCanvas = function targaGetCanvas()\n	{\n		var canvas, ctx, imageData;\n\n		canvas    = document.createElement('canvas');\n		ctx       = canvas.getContext('2d');\n		imageData = ctx.createImageData(this.header.width, this.header.height);\n\n		canvas.width  = this.header.width;\n		canvas.height = this.header.height;\n\n		ctx.putImageData(this.getImageData(imageData), 0, 0);\n\n		return canvas;\n	};\n\n\n	/**\n	 * Return a dataURI of the TGA file\n	 *\n	 * @param {string} type - Optional image content-type to output (default: image/png)\n	 * @returns {string} url\n	 */\n	Targa.prototype.getDataURL = function targaGetDatURL( type )\n	{\n		return this.getCanvas().toDataURL(type || 'image/png');\n	};\n\n\n	// Find Context\n	var shim = {};\n	if (typeof(exports) === 'undefined') {\n		if (typeof(define) === 'function' && typeof(define.amd) === 'object' && define.amd) {\n			define(function(){\n				return Targa;\n			});\n		} else {\n			// Browser\n			shim.exports = typeof(window) !== 'undefined' ? window : _global;\n		}\n	} \n	else {\n		// Commonjs\n		shim.exports = exports;\n	}\n\n\n	// Export\n	if (shim.exports) {\n		shim.exports.TGA = Targa;\n	}\n\n})(this);\n",r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/material/shaders/phong.vert.dot!github:maxdavidson/tribus@master/plugins/dot",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){var t="uniform mat4 mvpMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nattribute vec3 vertex;\nattribute vec3 normal;\n";return("texture"===e.ambient||"texture"===e.diffuse||"texture"===e.specular)&&(t+="\nattribute vec2 texcoord;\n"),t+="\n\nvarying vec3 worldFragPos;\nvarying vec3 worldNormal;\n\n","texture"===e.ambient&&(t+="\nuniform vec4 ambientTexcoordBounds;\nvarying vec2 ambientTexcoord;\n"),t+="\n\n","texture"===e.diffuse&&(t+="\nuniform vec4 diffuseTexcoordBounds;\nvarying vec2 diffuseTexcoord;\n"),t+="\n\n","texture"===e.specular&&(t+="\nuniform vec4 specularTexcoordBounds;\nvarying vec2 specularTexcoord;\n"),t+="\n\n\nvoid main() {\n\n    worldFragPos = vec3(modelMatrix * vec4(vertex, 1.0));\n    worldNormal = normalize(normalMatrix * normal);\n\n    ","texture"===e.ambient&&(t+="\n    ambientTexcoord = ambientTexcoordBounds.xy + texcoord * ambientTexcoordBounds.zw;\n    "),t+="\n\n    ","texture"===e.diffuse&&(t+="\n    diffuseTexcoord = diffuseTexcoordBounds.xy + texcoord * diffuseTexcoordBounds.zw;\n    "),t+="\n\n    ","texture"===e.specular&&(t+="\n    specularTexcoord = specularTexcoordBounds.xy + texcoord * specularTexcoordBounds.zw;\n    "),t+="\n\n    gl_Position = mvpMatrix * vec4(vertex, 1.0);\n}\n"},r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/material/shaders/phong.frag.dot!github:maxdavidson/tribus@master/plugins/dot",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=function(e){var t="\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nprecision mediump float;\n\nstruct DirectionalLight {\n    bool enabled;\n    vec3  direction;\n    vec3  diffuse, specular;\n};\n\nstruct PointLight {\n    bool enabled;\n    vec3  position;\n    vec3  diffuse, specular;\n    float constant, linear, quadratic;\n};\n\nstruct SpotLight {\n    bool enabled;\n    vec3  position, direction;\n    vec3  diffuse, specular;\n    float cutoff, outerCutoff;\n    float constant, linear, quadratic;\n};\n\nstruct Material {\n    lowp float shininess;\n    ";return"static"===e.ambient&&(t+=" vec3 ambient; "),t+="\n    ","static"===e.diffuse&&(t+=" vec3 diffuse; "),t+="\n    ","static"===e.specular&&(t+=" vec3 specular; "),t+="\n};\n\n\nvarying vec3 worldFragPos;\nvarying vec3 worldNormal;\n\nuniform vec3 viewPos;\n\n","texture"===e.ambient&&(t+="\nuniform sampler2D ambientSampler;\nvarying vec2 ambientTexcoord;\n"),t+="\n\n","texture"===e.diffuse&&(t+="\nuniform sampler2D diffuseSampler;\nvarying vec2 diffuseTexcoord;\n"),t+="\n\n","texture"===e.specular&&(t+="\nuniform sampler2D specularSampler;\nvarying vec2 specularTexcoord;\n"),t+="\n\n\nuniform Material material;\n\nuniform DirectionalLight directionalLights[ "+(e.MAX_DIRECTIONAL_LIGHTS||2)+" ];\nuniform PointLight pointLights[ "+(e.MAX_POINT_LIGHTS||2)+" ];\nuniform SpotLight spotLights[ "+(e.MAX_SPOT_LIGHTS||2)+" ];\n\n\nvoid main() {\n\n    vec3 worldNormal2 = normalize(worldNormal);\n\n    // Direction from fragment to camera\n    vec3 viewDir = normalize(viewPos - worldFragPos);\n    vec3 color =  ",t+="texture"===e.ambient?" texture2D(ambientSampler, ambientTexcoord).stp ":" material.ambient ",t+=" ;\n\n    for (int i = 0; i <  "+(e.MAX_DIRECTIONAL_LIGHTS||2)+" ; ++i) {\n        DirectionalLight light = directionalLights[i];\n        if (light.enabled) {\n            \n    vec3 lightDir = -light.direction;\n\n    \n\n    vec3 diffuse  = light.diffuse *  ",t+="texture"===e.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",t+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n            color += shade;\n        }\n    }\n\n    for (int i = 0; i <  "+(e.MAX_POINT_LIGHTS||2)+" ; ++i) {\n        PointLight light = pointLights[i];\n        if (light.enabled) {\n            \n    vec3 direction = light.position - worldFragPos;\n    float distance = length(direction);\n\n    vec3 lightDir = direction / distance;\n\n    \n\n    vec3 diffuse  = light.diffuse *  ",t+="texture"===e.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",t+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n    float attenuation = 1.0 / (light.constant + distance * (light.linear + distance * light.quadratic));\n\n    shade += attenuation;\n\n            color += shade;\n        }\n    }\n\n    for (int i = 0; i <  "+(e.MAX_SPOT_LIGHTS||2)+" ; ++i) {\n        SpotLight light = spotLights[i];\n        if (light.enabled) {\n            \n    \n    vec3 direction = light.position - worldFragPos;\n    float distance = length(direction);\n\n    vec3 lightDir = direction / distance;\n\n    \n\n    vec3 diffuse  = light.diffuse *  ",t+="texture"===e.diffuse?" texture2D(diffuseSampler, diffuseTexcoord).stp ":" material.diffuse ",t+="  * max(dot(worldNormal2, lightDir), 0.0);\n\n    //vec3 halfDir = normalize(lightDir + viewDir);\n    //vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(halfDir, worldNormal2), 0.0), material.shininess);\n\n    vec3 reflectDir = reflect(-lightDir, worldNormal2);\n    vec3 specular = light.specular *  ",t+="texture"===e.specular?" texture2D(specularSampler, specularTexcoord).stp ":" material.specular ",t+="  * pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\n\n    vec3 shade = diffuse + specular;\n\n\n    float attenuation = 1.0 / (light.constant + distance * (light.linear + distance * light.quadratic));\n\n    shade += attenuation;\n\n\n    float theta = dot(lightDir, light.direction);\n    float epsilon = light.cutoff - light.outerCutoff;\n    float intensity = clamp((theta - light.outerCutoff) / epsilon, 0.0, 1.0);\n\n    shade *= intensity;\n\n            color += shade;\n        }\n    }\n\n    gl_FragColor = vec4(color, 1.0);\n\n    //gl_FragColor = vec4(abs(worldNormal2), 1.0);\n}\n"},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.assign",["npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$");return n.exports=Object.assign||function(e,t){for(var n=Object(o.assertDefined(e)),r=arguments.length,i=1;r>i;)for(var a,s=o.ES5Object(arguments[i++]),u=o.getKeys(s),c=u.length,l=0;c>l;)n[a=u[l++]]=s[a];return n},r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/material/shaders/skybox.vert!github:systemjs/plugin-text@0.0.2",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports="uniform mat4 cameraMatrix;\n\nattribute highp vec3 vertex;\nvarying highp vec3 texcoord;\n\nvoid main() {\n    gl_Position = cameraMatrix * vec4(vertex, 1.0);\n    texcoord = vertex;\n}\n",r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/material/shaders/skybox.frag!github:systemjs/plugin-text@0.0.2",[],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports="precision highp float;\n\nvarying vec3 texcoord;\nuniform samplerCube skybox;\n\nvoid main() {\n    gl_FragColor = textureCube(skybox, texcoord);\n}\n",r.define=i,n.exports}),function(){function t(){}t.amd={},function(){var n,r,i,o,a,s,u,c,l,f,m,p,d,h,g,b,v,y,x,w,j,E,T,_,A,M,S,k,D,O,L,R,I,C,z,P,N,F,U,$,B,G,q,W,H,V,Y,X,K,Q,Z,J,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,fe,me,pe,de,he,ge,be,ve={}.hasOwnProperty,ye=function(e,t){function n(){this.constructor=e}for(var r in t)ve.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},xe=[].slice,we=function(e,t){return function(){return e.apply(t,arguments)}};n={toString:function(){return"Bacon"}},n.version="0.7.53",p=("undefined"!=typeof global&&null!==global?global:this).Error,re=function(){},X=function(e,t){return t},G=function(e,t){return e},L=function(e){return e.slice(0)},_=function(e,t){if(!t)throw new p(e)},M=function(e){if(!(e instanceof m))throw new p("not an EventStream : "+e)},D=function(e){if(!(e instanceof b))throw new p("not an Observable : "+e)},S=function(e){return _("not a function : "+e,E.isFunction(e))},H=function(e){return e instanceof Array},Y=function(e){return e instanceof b},A=function(e){if(!H(e))throw new p("not an array : "+e)},k=function(e){return _("no arguments supported",0===e.length)},O=function(e){if("string"!=typeof e)throw new p("not a string : "+e)},E={indexOf:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){var n,r,i,o;for(n=r=0,i=e.length;i>r;n=++r)if(o=e[n],t===o)return n;return-1},indexWhere:function(e,t){var n,r,i,o;for(n=r=0,i=e.length;i>r;n=++r)if(o=e[n],t(o))return n;return-1},head:function(e){return e[0]},always:function(e){return function(){return e}},negate:function(e){return function(t){return!e(t)}},empty:function(e){return 0===e.length},tail:function(e){return e.slice(1,e.length)},filter:function(e,t){var n,r,i,o;for(n=[],r=0,i=t.length;i>r;r++)o=t[r],e(o)&&n.push(o);return n},map:function(e,t){var n,r,i,o;for(i=[],n=0,r=t.length;r>n;n++)o=t[n],i.push(e(o));return i},each:function(e,t){var n,r;for(n in e)r=e[n],t(n,r);return void 0},toArray:function(e){return H(e)?e:[e]},contains:function(e,t){return-1!==E.indexOf(e,t)},id:function(e){return e},last:function(e){return e[e.length-1]},all:function(e,t){var n,r,i;for(null==t&&(t=E.id),n=0,r=e.length;r>n;n++)if(i=e[n],!t(i))return!1;return!0},any:function(e,t){var n,r,i;for(null==t&&(t=E.id),n=0,r=e.length;r>n;n++)if(i=e[n],t(i))return!0;return!1},without:function(e,t){return E.filter(function(t){return t!==e},t)},remove:function(e,t){var n;return n=E.indexOf(t,e),n>=0?t.splice(n,1):void 0},fold:function(e,t,n){var r,i,o;for(r=0,i=e.length;i>r;r++)o=e[r],t=n(t,o);return t},flatMap:function(e,t){return E.fold(t,[],function(t,n){return t.concat(e(n))})},cached:function(e){var t;return t=g,function(){return t===g&&(t=e(),e=void 0),t}},isFunction:function(e){return"function"==typeof e},toString:function(e){var t,n,r,i;try{return oe++,null==e?"undefined":E.isFunction(e)?"function":H(e)?oe>5?"[..]":"["+E.map(E.toString,e).toString()+"]":null!=(null!=e?e.toString:void 0)&&e.toString!==Object.prototype.toString?e.toString():"object"==typeof e?oe>5?"{..}":(n=function(){var n;n=[];for(r in e)ve.call(e,r)&&(i=function(){try{return e[r]}catch(n){return t=n}}(),n.push(E.toString(r)+":"+E.toString(i)));return n}(),"{"+n+"}"):e}finally{oe--}}},oe=0,n._=E,j=n.UpdateBarrier=function(){var e,t,r,i,o,a,s,u,c,l,f,m,p,d;return l=void 0,f=[],m={},t=[],r=0,e=function(e){return l?t.push(e):e()},p=function(e,t){var n;return l?(n=m[e.id],null==n?(n=m[e.id]=[t],f.push(e)):n.push(t)):t()},o=function(){for(;f.length>0;)s(0);return void 0},s=function(e){var t,n,r,i,o,s;for(i=f[e],o=i.id,s=m[o],f.splice(e,1),delete m[o],a(i),n=0,r=s.length;r>n;n++)(t=s[n])();return void 0},a=function(e){var t,n,r,i,o;for(n=e.internalDeps(),i=0,o=n.length;o>i;i++)t=n[i],a(t),m[t.id]&&(r=E.indexOf(f,t),s(r));return void 0},c=function(e,n,i,a){var s,u;if(l)return i.apply(n,a);l=e;try{u=i.apply(n,a),o()}finally{for(l=void 0;r<t.length;)s=t[r],r++,s();r=0,t=[]}return u},i=function(){return l?l.id:void 0},d=function(t,r){var i,o,a,s;return s=!1,o=!1,i=function(){return o=!0},a=function(){return s=!0,i()},i=t.dispatcher.subscribe(function(t){return e(function(){var e;return s||(e=r(t),e!==n.noMore)?void 0:a()})}),o&&i(),a},u=function(){return f.length>0},{whenDoneWith:p,hasWaiters:u,inTransaction:c,currentEventId:i,wrappedSubscribe:d,afterTransaction:e}}(),w=function(){function e(e,t,n){this.obs=e,this.sync=t,this.lazy=null!=n?n:!1,this.queue=[]}return e.prototype.subscribe=function(e){return this.obs.dispatcher.subscribe(e)},e.prototype.toString=function(){return this.obs.toString()},e.prototype.markEnded=function(){return this.ended=!0;

},e.prototype.consume=function(){return this.lazy?{value:E.always(this.queue[0])}:this.queue[0]},e.prototype.push=function(e){return this.queue=[e]},e.prototype.mayHave=function(){return!0},e.prototype.hasAtLeast=function(){return this.queue.length},e.prototype.flatten=!0,e}(),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ye(t,e),t.prototype.consume=function(){return this.queue.shift()},t.prototype.push=function(e){return this.queue.push(e)},t.prototype.mayHave=function(e){return!this.ended||this.queue.length>=e},t.prototype.hasAtLeast=function(e){return this.queue.length>=e},t.prototype.flatten=!1,t}(w),r=function(e){function t(e){t.__super__.constructor.call(this,e,!0)}return ye(t,e),t.prototype.consume=function(){var e;return e=this.queue,this.queue=[],{value:function(){return e}}},t.prototype.push=function(e){return this.queue.push(e.value())},t.prototype.hasAtLeast=function(){return!0},t}(w),w.isTrigger=function(e){return e instanceof w?e.sync:e instanceof m},w.fromObservable=function(e){return e instanceof w?e:e instanceof v?new w(e,!1):new a(e,!0)},s=function(){function e(e,t,n){this.context=e,this.method=t,this.args=n,this.cached=void 0}return e.prototype.deps=function(){return this.cached||(this.cached=U([this.context].concat(this.args)))},e.prototype.apply=function(e){return e.desc=this,e},e.prototype.toString=function(){return E.toString(this.context)+"."+E.toString(this.method)+"("+E.map(E.toString,this.args)+")"},e}(),z=function(){var e,t,n;return t=arguments[0],n=arguments[1],e=3<=arguments.length?xe.call(arguments,2):[],(t||n)instanceof s?t||n:new s(t,n,e)},ge=function(){var e,t,n;return e=2<=arguments.length?xe.call(arguments,0,t=arguments.length-1):(t=0,[]),n=arguments[t++],z.apply(null,e).apply(n)},U=function(e){return H(e)?E.flatMap(U,e):Y(e)?[e]:e instanceof w?[e.obs]:[]},be=function(e){return function(){var t,n,r,i;return r=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],"object"==typeof r&&t.length&&(n=r,i=t[0],r=function(){return n[i].apply(n,arguments)},t=t.slice(1)),e.apply(null,[r].concat(xe.call(t)))}},Z=function(e){return e=Array.prototype.slice.call(e),J.apply(null,e)},ie=function(e,t){return function(){var n;return n=1<=arguments.length?xe.call(arguments,0):[],e.apply(null,t.concat(n))}},de=function(e){return function(t){return function(n){var r;return null==n?void 0:(r=n[t],E.isFunction(r)?r.apply(n,e):r)}}},fe=function(e,t){var n,r;return r=e.slice(1).split("."),n=E.map(de(t),r),function(t){var r,i;for(r=0,i=n.length;i>r;r++)e=n[r],t=e(t);return t}},V=function(e){return"string"==typeof e&&e.length>1&&"."===e.charAt(0)},J=be(function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],E.isFunction(t)?e.length?ie(t,e):t:V(t)?fe(t,e):E.always(t)}),Q=function(e,t){return J.apply(null,[e].concat(xe.call(t)))},C=function(e,t,n,r){var i;return t instanceof v?(i=t.sampledBy(e,function(e,t){return[e,t]}),r.call(i,function(e){var t,n;return t=e[0],n=e[1],t}).map(function(e){var t,n;return t=e[0],n=e[1]})):(t=Q(t,n),r.call(e,t))},ce=function(e){var t;if(E.isFunction(e))return e;if(V(e))return t=me(e),function(e,n){return e[t](n)};throw new p("not a function or a field key: "+e)},me=function(e){return e.slice(1)},x=function(){function e(e){this.value=e}return e.prototype.getOrElse=function(){return this.value},e.prototype.get=function(){return this.value},e.prototype.filter=function(t){return t(this.value)?new e(this.value):g},e.prototype.map=function(t){return new e(t(this.value))},e.prototype.forEach=function(e){return e(this.value)},e.prototype.isDefined=!0,e.prototype.toArray=function(){return[this.value]},e.prototype.inspect=function(){return"Some("+this.value+")"},e.prototype.toString=function(){return this.inspect()},e}(),g={getOrElse:function(e){return e},filter:function(){return g},map:function(){return g},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},pe=function(e){return e instanceof x||e===g?e:new x(e)},n.noMore=["<no-more>"],n.more=["<more>"],N=0,f=function(){function e(){this.id=++N}return e.prototype.isEvent=function(){return!0},e.prototype.isEnd=function(){return!1},e.prototype.isInitial=function(){return!1},e.prototype.isNext=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.hasValue=function(){return!1},e.prototype.filter=function(){return!0},e.prototype.inspect=function(){return this.toString()},e.prototype.log=function(){return this.toString()},e}(),h=function(e){function t(e,n){t.__super__.constructor.call(this),!n&&E.isFunction(e)||e instanceof t?(this.valueF=e,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=e)}return ye(t,e),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.value=function(){return this.valueF instanceof t?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},t.prototype.fmap=function(e){var t,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return e(n)})):(t=this,this.apply(function(){return e(t.value())}))},t.prototype.apply=function(e){return new t(e)},t.prototype.filter=function(e){return e(this.value())},t.prototype.toString=function(){return E.toString(this.value())},t.prototype.log=function(){return this.value()},t}(f),d=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ye(t,e),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(e){return new t(e)},t.prototype.toNext=function(){return new h(this)},t}(h),c=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ye(t,e),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<end>"},t}(f),l=function(e){function t(e){this.error=e}return ye(t,e),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<error> "+E.toString(this.error)},t}(f),n.Event=f,n.Initial=d,n.Next=h,n.End=c,n.Error=l,W=function(e){return new d(e,!0)},ne=function(e){return new h(e,!0)},P=function(){return new c},le=function(e){return e instanceof f?e:ne(e)},q=0,se=function(){},b=function(){function e(e){this.id=++q,ge(e,this),this.initialDesc=this.desc}return e.prototype.subscribe=function(e){return j.wrappedSubscribe(this,e)},e.prototype.subscribeInternal=function(e){return this.dispatcher.subscribe(e)},e.prototype.onValue=function(){var e;return e=Z(arguments),this.subscribe(function(t){return t.hasValue()?e(t.value()):void 0})},e.prototype.onValues=function(e){return this.onValue(function(t){return e.apply(null,t)})},e.prototype.onError=function(){var e;return e=Z(arguments),this.subscribe(function(t){return t.isError()?e(t.error):void 0})},e.prototype.onEnd=function(){var e;return e=Z(arguments),this.subscribe(function(t){return t.isEnd()?e():void 0})},e.prototype.name=function(e){return this._name=e,this},e.prototype.withDescription=function(){return z.apply(null,arguments).apply(this)},e.prototype.toString=function(){return this._name?this._name:this.desc.toString()},e.prototype.internalDeps=function(){return this.initialDesc.deps()},e}(),b.prototype.assign=b.prototype.onValue,b.prototype.forEach=b.prototype.onValue,b.prototype.inspect=b.prototype.toString,n.Observable=b,o=function(){function e(e){var t,n,r;for(null==e&&(e=[]),this.unsubscribe=we(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],t=0,n=e.length;n>t;t++)r=e[t],this.add(r)}return e.prototype.add=function(e){var t,n,r;if(!this.unsubscribed)return t=!1,n=re,this.starting.push(e),r=function(r){return function(){return r.unsubscribed?void 0:(t=!0,r.remove(n),E.remove(e,r.starting))}}(this),n=e(this.unsubscribe,r),this.unsubscribed||t?n():this.subscriptions.push(n),E.remove(e,this.starting),n},e.prototype.remove=function(e){return this.unsubscribed?void 0:void 0!==E.remove(e,this.subscriptions)?e():void 0},e.prototype.unsubscribe=function(){var e,t,n,r;if(!this.unsubscribed){for(this.unsubscribed=!0,n=this.subscriptions,e=0,t=n.length;t>e;e++)(r=n[e])();return this.subscriptions=[],this.starting=[]}},e.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},e.prototype.empty=function(){return 0===this.count()},e}(),n.CompositeUnsubscribe=o,u=function(){function e(e,t){this._subscribe=e,this._handleEvent=t,this.subscribe=we(this.subscribe,this),this.handleEvent=we(this.handleEvent,this),this.subscriptions=[],this.queue=[],this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0}return e.prototype.hasSubscribers=function(){return this.subscriptions.length>0},e.prototype.removeSub=function(e){return this.subscriptions=E.without(e,this.subscriptions)},e.prototype.push=function(e){return e.isEnd()&&(this.ended=!0),j.inTransaction(e,this,this.pushIt,[e])},e.prototype.pushToSubscriptions=function(e){var t,r,i,o,a,s;try{for(s=this.subscriptions,r=0,i=s.length;i>r;r++)a=s[r],o=a.sink(e),(o===n.noMore||e.isEnd())&&this.removeSub(a);return!0}catch(u){throw t=u,this.pushing=!1,this.queue=[],t}},e.prototype.pushIt=function(e){if(this.pushing)return this.queue.push(e),n.more;if(e!==this.prevError){for(e.isError()&&(this.prevError=e),this.pushing=!0,this.pushToSubscriptions(e),this.pushing=!1;this.queue.length;)e=this.queue.shift(),this.push(e);return this.hasSubscribers()?n.more:(this.unsubscribeFromSource(),n.noMore)}},e.prototype.handleEvent=function(e){return this._handleEvent?this._handleEvent(e):this.push(e)},e.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},e.prototype.subscribe=function(e){var t;return this.ended?(e(P()),re):(S(e),t={sink:e},this.subscriptions.push(t),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),S(this.unsubSrc)),function(e){return function(){return e.removeSub(t),e.hasSubscribers()?void 0:e.unsubscribeFromSource()}}(this))},e}(),m=function(e){function t(e,n,r){E.isFunction(e)&&(r=n,n=e,e=[]),t.__super__.constructor.call(this,e),S(n),this.dispatcher=new u(n,r),se(this)}return ye(t,e),t.prototype.toProperty=function(e){var t,r;return r=0===arguments.length?g:pe(function(){return e}),t=this.dispatcher,new v(z(this,"toProperty",e),function(e){var i,o,a,s;return i=!1,s=re,o=n.more,a=function(){return i?void 0:r.forEach(function(t){return i=!0,o=e(new d(t)),o===n.noMore?(s(),s=re):void 0})},s=t.subscribe(function(t){return t.hasValue()?i&&t.isInitial()?n.more:(t.isInitial()||a(),i=!0,r=new x(t),e(t)):(t.isEnd()&&(o=a()),o!==n.noMore?e(t):void 0)}),a(),s})},t.prototype.toEventStream=function(){return this},t.prototype.withHandler=function(e){return new t(z(this,"withHandler",e),this.dispatcher.subscribe,e)},t}(b),n.EventStream=m,n.never=function(){return new m(z(n,"never"),function(e){return e(P()),re})},n.when=function(){var e,t,r,i,o,a,s,u,c,l,f,p,d,h,g,b,v,y,x,T;if(0===arguments.length)return n.never();for(s=arguments.length,T="when: expecting arguments in the form (Observable+,function)+",_(T,s%2===0),y=[],d=[],t=0,h=[];s>t;){for(h[t]=arguments[t],h[t+1]=arguments[t+1],p=E.toArray(arguments[t]),e=R(arguments[t+1]),f={f:e,ixs:[]},x=!1,o=0,u=p.length;u>o;o++){for(v=p[o],r=E.indexOf(y,v),x||(x=w.isTrigger(v)),0>r&&(y.push(v),r=y.length-1),g=f.ixs,a=0,c=g.length;c>a;a++)i=g[a],i.index===r&&i.count++;f.ixs.push({index:r,count:1})}_("At least one EventStream required",x||!p.length),p.length>0&&d.push(f),t+=2}return y.length?(y=E.map(w.fromObservable,y),l=E.any(y,function(e){return e.flatten})&&I(E.map(function(e){return e.obs},y)),b=new m(z.apply(null,[n,"when"].concat(xe.call(h))),function(e){var r,i,o,a,s,u,c;return c=[],o=!1,a=function(e){var n,r,i;for(i=e.ixs,n=0,r=i.length;r>n;n++)if(t=i[n],!y[t.index].hasAtLeast(t.count))return!1;return!0},i=function(e){return!e.sync||e.ended},r=function(e){var n,r,i;for(i=e.ixs,n=0,r=i.length;r>n;n++)if(t=i[n],!y[t.index].mayHave(t.count))return!0},s=function(e){return!e.source.flatten},u=function(u){return function(f){var m,p,h;return p=function(){return j.whenDoneWith(b,m)},h=function(){var r,i,o,u,l,f;if(!(c.length>0))return n.more;for(l=n.more,f=c.pop(),i=0,o=d.length;o>i;i++)if(u=d[i],a(u))return r=function(){var e,n,r,i;for(r=u.ixs,i=[],n=0,e=r.length;e>n;n++)t=r[n],i.push(y[t.index].consume());return i}(),l=e(f.e.apply(function(){var e,t;return t=function(){var t,n,i;for(i=[],n=0,t=r.length;t>n;n++)e=r[n],i.push(e.value());return i}(),u.f.apply(u,t)})),c.length&&(c=E.filter(s,c)),l===n.noMore?l:h()},m=function(){var t;return t=h(),o&&(o=!1,(E.all(y,i)||E.all(d,r))&&(t=n.noMore,e(P()))),t===n.noMore&&f(),t},u.subscribe(function(t){var r;return t.isEnd()?(o=!0,u.markEnded(),p()):t.isError()?r=e(t):(u.push(t),u.sync&&(c.push({source:u,e:t}),l||j.hasWaiters()?p():m())),r===n.noMore&&f(),r||n.more})}},new n.CompositeUnsubscribe(function(){var e,t,n;for(n=[],e=0,t=y.length;t>e;e++)v=y[e],n.push(u(v));return n}()).unsubscribe})):n.never()},I=function(e,t){var n;return null==t&&(t=[]),n=function(e){var r;return E.contains(t,e)?!0:(r=e.internalDeps(),r.length?(t.push(e),E.any(r,n)):(t.push(e),!1))},E.any(e,n)},R=function(e){return E.isFunction(e)?e:E.always(e)},n.groupSimultaneous=function(){var e,t,i;return i=1<=arguments.length?xe.call(arguments,0):[],1===i.length&&H(i[0])&&(i=i[0]),t=function(){var t,n,o;for(o=[],t=0,n=i.length;n>t;t++)e=i[t],o.push(new r(e));return o}(),ge.apply(null,[n,"groupSimultaneous"].concat(xe.call(i),[n.when(t,function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[]})]))},y=function(e){function t(e,n,r){this.property=e,this.subscribe=we(this.subscribe,this),t.__super__.constructor.call(this,n,r),this.current=g,this.currentValueRootId=void 0,this.propertyEnded=!1}return ye(t,e),t.prototype.push=function(e){return e.isEnd()&&(this.propertyEnded=!0),e.hasValue()&&(this.current=new x(e),this.currentValueRootId=j.currentEventId()),t.__super__.push.call(this,e)},t.prototype.maybeSubSource=function(e,t){return t===n.noMore?re:this.propertyEnded?(e(P()),re):u.prototype.subscribe.call(this,e)},t.prototype.subscribe=function(e){var t,r,i,o;return r=!1,i=n.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(t=j.currentEventId(),o=this.currentValueRootId,!this.propertyEnded&&o&&t&&t!==o?(j.whenDoneWith(this.property,function(t){return function(){return t.currentValueRootId===o?e(W(t.current.get().value())):void 0}}(this)),this.maybeSubSource(e,i)):(j.inTransaction(void 0,this,function(){return i=e(W(this.current.get().value()))},[]),this.maybeSubSource(e,i))):this.maybeSubSource(e,i)},t}(u),v=function(e){function t(e,n,r){E.isFunction(e)&&(r=n,n=e,e=[]),t.__super__.constructor.call(this,e),S(n),this.dispatcher=new y(this,n,r),se(this)}return ye(t,e),t.prototype.changes=function(){return new m(z(this,"changes"),function(e){return function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()?void 0:t(e)})}}(this))},t.prototype.withHandler=function(e){return new t(z(this,"withHandler",e),this.dispatcher.subscribe,e)},t.prototype.toProperty=function(){return k(arguments),this},t.prototype.toEventStream=function(){return new m(z(this,"toEventStream"),function(e){return function(t){return e.dispatcher.subscribe(function(e){return e.isInitial()&&(e=e.toNext()),t(e)})}}(this))},t}(b),n.Property=v,n.constant=function(e){return new v(z(n,"constant",e),function(t){return t(W(e)),t(P()),re})},n.fromBinder=function(e,t){return null==t&&(t=E.id),new m(z(n,"fromBinder",e,t),function(r){var i,o,a,s;return s=!1,i=!1,o=function(){return s?void 0:"undefined"!=typeof a&&null!==a?(a(),s=!0):i=!0},a=e(function(){var e,i,a,s,u,c;for(e=1<=arguments.length?xe.call(arguments,0):[],c=t.apply(this,e),H(c)&&E.last(c)instanceof f||(c=[c]),u=n.more,a=0,s=c.length;s>a;a++)if(i=c[a],u=r(i=le(i)),u===n.noMore||i.isEnd())return o(),u;return u}),i&&o(),o})},F=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],$=function(e){var t,n,r,i;for(t=0,n=F.length;n>t;t++)if(i=F[t],r=[e[i[0]],e[i[1]]],r[0]&&r[1])return r;throw new l("No suitable event methods in "+e)},n.fromEventTarget=function(e,t,r){var i,o,a;return i=$(e),o=i[0],a=i[1],ge(n,"fromEvent",e,t,n.fromBinder(function(n){return o.call(e,t,n),function(){return a.call(e,t,n)}},r))},n.fromEvent=n.fromEventTarget,n.Observable.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],C(this,t,e,function(e){return ge(this,"map",e,this.withHandler(function(t){return this.push(t.fmap(e))}))})},n.combineAsArray=function(){var e,t,r,i,o,a,s;for(s=1<=arguments.length?xe.call(arguments,0):[],1===s.length&&H(s[0])&&(s=s[0]),e=t=0,r=s.length;r>t;e=++t)a=s[e],Y(a)||(s[e]=n.constant(a));return s.length?(o=function(){var e,t,n;for(n=[],e=0,t=s.length;t>e;e++)i=s[e],n.push(new w(i,!0));return n}(),ge.apply(null,[n,"combineAsArray"].concat(xe.call(s),[n.when(o,function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[]}).toProperty()]))):n.constant([])},n.onValues=function(){var e,t,r;return r=2<=arguments.length?xe.call(arguments,0,t=arguments.length-1):(t=0,[]),e=arguments[t++],n.combineAsArray(r).onValues(e)},n.combineWith=function(){var e,t;return e=arguments[0],t=2<=arguments.length?xe.call(arguments,1):[],ge.apply(null,[n,"combineWith",e].concat(xe.call(t),[n.combineAsArray(t).map(function(t){return e.apply(null,t)})]))},n.combineTemplate=function(e){var t,r,i,o,a,s,u,c,l,f;return u=[],f=[],s=function(e){return e[e.length-1]},l=function(e,t,n){return s(e)[t]=n},t=function(e,t){return function(n,r){return l(n,e,r[t])}},a=function(e,t){return function(n){return l(n,e,t)}},c=function(e){return H(e)?[]:{}},i=function(e,n){var r,i;return Y(n)?(f.push(n),u.push(t(e,f.length-1))):n!==Object(n)||"function"==typeof n||n instanceof RegExp||n instanceof Date?u.push(a(e,n)):(i=function(e){return function(t){var r;return r=c(n),l(t,e,r),t.push(r)}},r=function(e){return e.pop()},u.push(i(e)),o(n),u.push(r))},o=function(e){return E.each(e,i)},o(e),r=function(t){var n,r,i,o,a;for(a=c(e),n=[a],i=0,o=u.length;o>i;i++)(r=u[i])(n,t);return a},ge(n,"combineTemplate",e,n.combineAsArray(f).map(r))},n.Observable.prototype.combine=function(e,t){var r;return r=ce(t),ge(this,"combine",e,t,n.combineAsArray(this,e).map(function(e){return r(e[0],e[1])}))},n.Observable.prototype.decode=function(e){return ge(this,"decode",e,this.combine(n.combineTemplate(e),function(e,t){return t[e]}))},n.Observable.prototype.withStateMachine=function(e,t){var r;return r=e,ge(this,"withStateMachine",e,t,this.withHandler(function(e){var i,o,a,s,u,c,l;for(i=t(r,e),s=i[0],c=i[1],r=s,l=n.more,o=0,a=c.length;a>o;o++)if(u=c[o],l=this.push(u),l===n.noMore)return l;return l}))},n.Observable.prototype.skipDuplicates=function(e){return null==e&&(e=function(e,t){return e===t}),ge(this,"skipDuplicates",this.withStateMachine(g,function(t,n){return n.hasValue()?n.isInitial()||t===g||!e(t.get(),n.value())?[new x(n.value()),[n]]:[t,[]]:[t,[n]]}))},n.Observable.prototype.awaiting=function(e){return ge(this,"awaiting",e,n.groupSimultaneous(this,e).map(function(e){var t,n;return t=e[0],n=e[1],0===n.length}).toProperty(!1).skipDuplicates())},n.Observable.prototype.not=function(){return ge(this,"not",this.map(function(e){return!e}))},n.Property.prototype.and=function(e){return ge(this,"and",e,this.combine(e,function(e,t){return e&&t}))},n.Property.prototype.or=function(e){return ge(this,"or",e,this.combine(e,function(e,t){return e||t}))},n.scheduler={setTimeout:function(e,t){return setTimeout(e,t)},setInterval:function(e,t){return setInterval(e,t)},clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)},now:function(){return(new Date).getTime()}},n.EventStream.prototype.bufferWithTime=function(e){return ge(this,"bufferWithTime",e,this.bufferWithTimeOrCount(e,Number.MAX_VALUE))},n.EventStream.prototype.bufferWithCount=function(e){return ge(this,"bufferWithCount",e,this.bufferWithTimeOrCount(void 0,e))},n.EventStream.prototype.bufferWithTimeOrCount=function(e,t){var n;return n=function(n){return n.values.length===t?n.flush():void 0!==e?n.schedule():void 0},ge(this,"bufferWithTimeOrCount",e,t,this.buffer(e,n,n))},n.EventStream.prototype.buffer=function(e,t,r){var i,o,a;return null==t&&(t=re),null==r&&(r=re),i={scheduled:null,end:void 0,values:[],flush:function(){var e;if(this.scheduled&&(n.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){if(e=this.push(ne(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(e!==n.noMore)return r(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:this.scheduled=e(function(e){return function(){return e.flush()}}(this))}},a=n.more,E.isFunction(e)||(o=e,e=function(e){return n.scheduler.setTimeout(e,o)}),ge(this,"buffer",this.withHandler(function(e){return i.push=function(e){return function(t){return e.push(t)}}(this),e.isError()?a=this.push(e):e.isEnd()?(i.end=e,i.scheduled||i.flush()):(i.values.push(e.value()),t(i)),a}))},n.Observable.prototype.filter=function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],C(this,t,e,function(e){return ge(this,"filter",e,this.withHandler(function(t){return t.filter(e)?this.push(t):n.more}))})},n.once=function(e){return new m(z(n,"once",e),function(t){return t(le(e)),t(P()),re})},n.EventStream.prototype.concat=function(e){var t;return t=this,new m(z(t,"concat",e),function(n){var r,i;return i=re,r=t.dispatcher.subscribe(function(t){return t.isEnd()?i=e.dispatcher.subscribe(n):n(t)}),function(){return r(),i()}})},n.Observable.prototype.flatMap=function(){return B(this,te(arguments))},n.Observable.prototype.flatMapFirst=function(){return B(this,te(arguments),!0)},B=function(e,t,r,i){var a,s,u;return u=[e],a=[],s=new m(z(e,"flatMap"+(r?"First":""),t),function(s){var u,c,l,f,m;return l=new o,f=[],m=function(e){var r;return r=ee(t(e.value())),a.push(r),l.add(function(e,t){return r.dispatcher.subscribe(function(i){var o;return i.isEnd()?(E.remove(r,a),c(),u(t),n.noMore):(i instanceof d&&(i=i.toNext()),o=s(i),o===n.noMore&&e(),o)})})},c=function(){var e;return e=f.shift(),e?m(e):void 0},u=function(e){return e(),l.empty()?s(P()):void 0},l.add(function(t,o){return e.dispatcher.subscribe(function(e){return e.isEnd()?u(o):e.isError()?s(e):r&&l.count()>1?n.more:l.unsubscribed?n.noMore:i&&l.count()>i?f.push(e):m(e)})}),l.unsubscribe}),s.internalDeps=function(){return a.length?u.concat(a):u},s},te=function(e){return 1===e.length&&Y(e[0])?E.always(e[0]):Z(e)},ee=function(e){return Y(e)?e:n.once(e)},n.Observable.prototype.flatMapWithConcurrencyLimit=function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],ge.apply(null,[this,"flatMapWithConcurrencyLimit",t].concat(xe.call(e),[B(this,te(e),!1,t)]))},n.Observable.prototype.flatMapConcat=function(){return ge.apply(null,[this,"flatMapConcat"].concat(xe.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(xe.call(arguments)))]))},T=function(e,t){var r;return r=new m(z(e,"justInitValue"),function(t){var i,o;return o=void 0,i=e.dispatcher.subscribe(function(e){return e.isEnd()||(o=e),n.noMore}),j.whenDoneWith(r,function(){return null!=o&&t(o),t(P())}),i}),r.concat(t).toProperty()},n.Observable.prototype.mapEnd=function(){var e;return e=Z(arguments),ge(this,"mapEnd",e,this.withHandler(function(t){return t.isEnd()?(this.push(ne(e(t))),this.push(P()),n.noMore):this.push(t)}))},n.Observable.prototype.skipErrors=function(){return ge(this,"skipErrors",this.withHandler(function(e){return e.isError()?n.more:this.push(e)}))},n.EventStream.prototype.takeUntil=function(e){var t;return t={},ge(this,"takeUntil",e,n.groupSimultaneous(this.mapEnd(t),e.skipErrors()).withHandler(function(r){var i,o,a,s,u,c;if(r.hasValue()){if(s=r.value(),i=s[0],e=s[1],e.length)return this.push(P());for(u=n.more,o=0,a=i.length;a>o;o++)c=i[o],u=this.push(c===t?P():ne(c));return u}return this.push(r)}))},n.Property.prototype.takeUntil=function(e){var t;return t=this.changes().takeUntil(e),ge(this,"takeUntil",e,T(this,t))},n.Observable.prototype.flatMapLatest=function(){var e,t;return e=te(arguments),t=this.toEventStream(),ge(this,"flatMapLatest",e,t.flatMap(function(n){return ee(e(n)).takeUntil(t)}))},n.fromPoll=function(e,t){return ge(n,"fromPoll",e,t,n.fromBinder(function(t){var r;return r=n.scheduler.setInterval(t,e),function(){return n.scheduler.clearInterval(r)}},t))},n.later=function(e,t){return ge(n,"later",e,t,n.fromBinder(function(r){var i,o;return o=function(){return r([t,P()])},i=n.scheduler.setTimeout(o,e),function(){return n.scheduler.clearTimeout(i)}}))},n.sequentially=function(e,t){var r;return r=0,ge(n,"sequentially",e,t,n.fromPoll(e,function(){var e;return e=t[r++],r<t.length?e:r===t.length?[e,P()]:P()}))},n.repeatedly=function(e,t){var r;return r=0,ge(n,"repeatedly",e,t,n.fromPoll(e,function(){return t[r++%t.length]}))},n.interval=function(e,t){return null==t&&(t={}),ge(n,"interval",e,t,n.fromPoll(e,function(){return ne(t)}))},n.EventStream.prototype.delay=function(e){return ge(this,"delay",e,this.flatMap(function(t){return n.later(e,t)}))},n.Property.prototype.delay=function(e){return this.delayChanges("delay",e,function(t){return t.delay(e)})},n.Property.prototype.delayChanges=function(){var e,t,n;return e=2<=arguments.length?xe.call(arguments,0,n=arguments.length-1):(n=0,[]),t=arguments[n++],ge.apply(null,[this].concat(xe.call(e),[T(this,t(this.changes()))]))},n.Observable.prototype.bufferingThrottle=function(e){return ge(this,"bufferingThrottle",e,this.flatMapConcat(function(t){return n.once(t).concat(n.later(e).filter(!1))}))},n.Property.prototype.bufferingThrottle=function(){return n.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},i=function(e){function t(){this.guardedSink=we(this.guardedSink,this),this.subscribeAll=we(this.subscribeAll,this),this.unsubAll=we(this.unsubAll,this),this.sink=void 0,this.subscriptions=[],this.ended=!1,t.__super__.constructor.call(this,z(n,"Bus"),this.subscribeAll)}return ye(t,e),t.prototype.unsubAll=function(){var e,t,n,r;for(n=this.subscriptions,e=0,t=n.length;t>e;e++)r=n[e],"function"==typeof r.unsub&&r.unsub();return void 0},t.prototype.subscribeAll=function(e){var t,n,r,i;for(this.sink=e,r=L(this.subscriptions),t=0,n=r.length;n>t;t++)i=r[t],this.subscribeInput(i);return this.unsubAll},t.prototype.guardedSink=function(e){return function(t){return function(r){return r.isEnd()?(t.unsubscribeInput(e),n.noMore):t.sink(r)}}(this)},t.prototype.subscribeInput=function(e){return e.unsub=e.input.dispatcher.subscribe(this.guardedSink(e.input))},t.prototype.unsubscribeInput=function(e){var t,n,r,i,o;for(i=this.subscriptions,t=n=0,r=i.length;r>n;t=++n)if(o=i[t],o.input===e)return"function"==typeof o.unsub&&o.unsub(),void this.subscriptions.splice(t,1)},t.prototype.plug=function(e){var t;return D(e),this.ended?void 0:(t={input:e},this.subscriptions.push(t),null!=this.sink&&this.subscribeInput(t),function(t){return function(){return t.unsubscribeInput(e)}}(this))},t.prototype.end=function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(P()):void 0},t.prototype.push=function(e){return"function"==typeof this.sink?this.sink(ne(e)):void 0},t.prototype.error=function(e){return"function"==typeof this.sink?this.sink(new l(e)):void 0},t}(m),n.Bus=i,K=function(e,t){return be(function(){var r,i,o;return i=arguments[0],r=2<=arguments.length?xe.call(arguments,1):[],o=ie(t,[function(e,t){return i.apply(null,xe.call(e).concat([t]))}]),ge.apply(null,[n,e,i].concat(xe.call(r),[n.combineAsArray(r).flatMap(o)]))})},n.fromCallback=K("fromCallback",function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],n.fromBinder(function(n){return Q(t,e)(n),re},function(e){return[e,P()]})}),n.fromNodeCallback=K("fromNodeCallback",function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],n.fromBinder(function(n){return Q(t,e)(n),re},function(e,t){return e?[new l(e),P()]:[t,P()]})}),n.EventStream.prototype.debounce=function(e){return ge(this,"debounce",e,this.flatMapLatest(function(t){return n.later(e,t)}))},n.Property.prototype.debounce=function(e){return this.delayChanges("debounce",e,function(t){return t.debounce(e)})},n.EventStream.prototype.debounceImmediate=function(e){return ge(this,"debounceImmediate",e,this.flatMapFirst(function(t){return n.once(t).concat(n.later(e).filter(!1))}))},n.Observable.prototype.scan=function(e,t){var r,i,o;return t=ce(t),r=pe(e),o=function(e){return function(o){var a,s,u,c;return a=!1,c=re,s=n.more,u=function(){return a?void 0:r.forEach(function(e){return a=!0,s=o(new d(function(){return e})),s===n.noMore?(c(),c=re):void 0})},c=e.dispatcher.subscribe(function(e){var i,c;return e.hasValue()?a&&e.isInitial()?n.more:(e.isInitial()||u(),a=!0,c=r.getOrElse(void 0),i=t(c,e.value()),r=new x(i),o(e.apply(function(){return i}))):(e.isEnd()&&(s=u()),s!==n.noMore?o(e):void 0)}),j.whenDoneWith(i,u),c}}(this),i=new v(z(this,"scan",e,t),o)},n.Observable.prototype.diff=function(e,t){return t=ce(t),ge(this,"diff",e,t,this.scan([e],function(e,n){return[n,t(e[0],n)]}).filter(function(e){return 2===e.length}).map(function(e){return e[1]}))},n.Observable.prototype.doAction=function(){var e;return e=Z(arguments),ge(this,"doAction",e,this.withHandler(function(t){return t.hasValue()&&e(t.value()),this.push(t)}))},n.Observable.prototype.endOnError=function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],null==t&&(t=!0),C(this,t,e,function(e){return ge(this,"endOnError",this.withHandler(function(t){return t.isError()&&e(t.error)?(this.push(t),this.push(P())):this.push(t)}))})},b.prototype.errors=function(){return ge(this,"errors",this.filter(function(){return!1}))},he=function(e){return[e,P()]},n.fromPromise=function(e,t){return ge(n,"fromPromise",e,n.fromBinder(function(n){var r;return null!=(r=e.then(n,function(e){return n(new l(e))}))&&"function"==typeof r.done&&r.done(),function(){return t&&"function"==typeof e.abort?e.abort():void 0}},he))},n.Observable.prototype.mapError=function(){var e;return e=Z(arguments),ge(this,"mapError",e,this.withHandler(function(t){return this.push(t.isError()?ne(e(t.error)):t)}))},n.Observable.prototype.flatMapError=function(e){return ge(this,"flatMapError",e,this.mapError(function(e){return new l(e)}).flatMap(function(t){return t instanceof l?e(t.error):n.once(t)}))},n.EventStream.prototype.sampledBy=function(e,t){return ge(this,"sampledBy",e,t,this.toProperty().sampledBy(e,t))},n.Property.prototype.sampledBy=function(e,t){var r,i,o,a,s;return null!=t?t=ce(t):(r=!0,t=function(e){return e.value()}),s=new w(this,!1,r),o=new w(e,!0,r),a=n.when([s,o],t),i=e instanceof v?a.toProperty():a,ge(this,"sampledBy",e,t,i)},n.Property.prototype.sample=function(e){return ge(this,"sample",e,this.sampledBy(n.interval(e,{})))},n.Observable.prototype.map=function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],t instanceof v?t.sampledBy(this,G):C(this,t,e,function(e){return ge(this,"map",e,this.withHandler(function(t){return this.push(t.fmap(e))}))})},n.Observable.prototype.fold=function(e,t){return ge(this,"fold",e,t,this.scan(e,t).sampledBy(this.filter(!1).mapEnd().toProperty()))},b.prototype.reduce=b.prototype.fold,n.EventStream.prototype.merge=function(e){var t;return M(e),t=this,ge(t,"merge",e,n.mergeAll(this,e))},n.mergeAll=function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[],H(e[0])&&(e=e[0]),e.length?new m(z.apply(null,[n,"mergeAll"].concat(xe.call(e))),function(t){var r,i,o;return r=0,o=function(i){
return function(o){return i.dispatcher.subscribe(function(i){var a;return i.isEnd()?(r++,r===e.length?t(P()):n.more):(a=t(i),a===n.noMore&&o(),a)})}},i=E.map(o,e),new n.CompositeUnsubscribe(i).unsubscribe}):n.never()},n.Observable.prototype.take=function(e){return 0>=e?n.never():ge(this,"take",e,this.withHandler(function(t){return t.hasValue()?(e--,e>0?this.push(t):(0===e&&this.push(t),this.push(P()),n.noMore)):this.push(t)}))},n.fromArray=function(e){var t;return A(e),e.length?(t=0,new m(z(n,"fromArray",e),function(r){var i,o,a;return a=!1,o=n.more,i=function(){var s;return o===n.noMore||a||(s=e[t++],o=r(le(s)),o===n.noMore)?void 0:t===e.length?r(P()):j.afterTransaction(i)},i(),function(){return a=!0}})):ge(n,"fromArray",e,n.never())},n.EventStream.prototype.holdWhen=function(e){var t,r,i;return i=e.startWith(!1),r=i.filter(function(e){return!e}),t=i.filter(E.id),ge(this,"holdWhen",e,this.filter(!1).merge(i.flatMapConcat(function(e){return function(i){return i?e.scan([],function(e,t){return e.concat([t])}).sampledBy(r).take(1).flatMap(n.fromArray):e.takeUntil(t)}}(this))))},n.$={},n.$.asEventStream=function(e,t,r){var i;return E.isFunction(t)&&(i=[t,void 0],r=i[0],t=i[1]),ge(this.selector||this,"asEventStream",e,n.fromBinder(function(n){return function(r){return n.on(e,t,r),function(){return n.off(e,t,r)}}}(this),r))},null!=(ae="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:void 0)&&(ae.fn.asEventStream=n.$.asEventStream),n.Observable.prototype.log=function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[],this.subscribe(function(t){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log.apply(console,xe.call(e).concat([t.log()])):void 0}),this},n.repeat=function(e){var t;return t=0,n.fromBinder(function(r){var i,o,a,s,u;return i=!1,a=n.more,u=function(){},o=function(e){return e.isEnd()?i?s():i=!0:a=r(e)},s=function(){var s;for(i=!0;i&&a!==n.noMore;)s=e(t++),i=!1,s?u=s.subscribeInternal(o):r(P());return i=!0},s(),function(){return u()}})},n.retry=function(e){var t,r,i,o,a,s,u;if(!E.isFunction(e.source))throw new p("'source' option has to be a function");return u=e.source,s=e.retries||0,a=e.maxRetries||s,t=e.delay||function(){return 0},o=e.isRetryable||function(){return!0},i=!1,r=null,ge(n,"retry",e,n.repeat(function(){var e,c,l;return i?null:(l=function(){return u().endOnError().withHandler(function(e){return e.isError()?(r=e,o(r.error)&&s>0?void 0:(i=!0,this.push(e))):(e.hasValue()&&(r=null,i=!0),this.push(e))})},r?(e={error:r.error,retriesDone:a-s},c=n.later(t(e)).filter(!1),s-=1,c.concat(n.once().flatMap(l))):l())}))},n.Observable.prototype.skip=function(e){return ge(this,"skip",e,this.withHandler(function(t){return t.hasValue()&&e>0?(e--,n.more):this.push(t)}))},n.EventStream.prototype.skipUntil=function(e){var t;return t=e.take(1).map(!0).toProperty(!1),ge(this,"skipUntil",e,this.filter(t))},n.EventStream.prototype.skipWhile=function(){var e,t,r;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],r=!1,C(this,t,e,function(e){return ge(this,"skipWhile",e,this.withHandler(function(t){return!r&&t.hasValue()&&e(t.value())?n.more:(t.hasValue()&&(r=!0),this.push(t))}))})},n.Observable.prototype.slidingWindow=function(e,t){return null==t&&(t=0),ge(this,"slidingWindow",e,t,this.scan([],function(t,n){return t.concat([n]).slice(-e)}).filter(function(e){return e.length>=t}))},n.spy=function(e){return ue.push(e)},ue=[],se=function(e){var t,n,r;if(ue.length&&!se.running)try{for(se.running=!0,t=0,n=ue.length;n>t;t++)(r=ue[t])(e)}finally{delete se.running}return void 0},n.Property.prototype.startWith=function(e){return ge(this,"startWith",e,this.scan(e,function(e,t){return t}))},n.EventStream.prototype.startWith=function(e){return ge(this,"startWith",e,n.once(e).concat(this))},n.Observable.prototype.takeWhile=function(){var e,t;return t=arguments[0],e=2<=arguments.length?xe.call(arguments,1):[],C(this,t,e,function(e){return ge(this,"takeWhile",e,this.withHandler(function(t){return t.filter(e)?this.push(t):(this.push(P()),n.noMore)}))})},n.update=function(){var e,t,r,i;for(t=arguments[0],i=2<=arguments.length?xe.call(arguments,1):[],r=function(e){return function(){var t;return t=1<=arguments.length?xe.call(arguments,0):[],function(n){return e.apply(null,[n].concat(t))}}},e=i.length-1;e>0;)i[e]instanceof Function||(i[e]=function(e){return function(){return e}}(i[e])),i[e]=r(i[e]),e-=2;return ge.apply(null,[n,"update",t].concat(xe.call(i),[n.when.apply(n,i).scan(t,function(e,t){return t(e)})]))},n.zipAsArray=function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[],H(e[0])&&(e=e[0]),ge.apply(null,[n,"zipAsArray"].concat(xe.call(e),[n.zipWith(e,function(){var e;return e=1<=arguments.length?xe.call(arguments,0):[]})]))},n.zipWith=function(){var e,t,r;return e=arguments[0],r=2<=arguments.length?xe.call(arguments,1):[],E.isFunction(e)||(t=[e,r[0]],r=t[0],e=t[1]),r=E.map(function(e){return e.toEventStream()},r),ge.apply(null,[n,"zipWith",e].concat(xe.call(r),[n.when(r,e)]))},n.Observable.prototype.zip=function(e,t){return null==t&&(t=Array),ge(this,"zip",e,n.zipWith([this,e],t))},n.Observable.prototype.first=function(){return ge(this,"first",this.take(1))},n.Observable.prototype.last=function(){var e;return ge(this,"last",this.withHandler(function(t){return t.isEnd()?(e&&this.push(e),this.push(P()),n.noMore):void(e=t)}))},n.EventStream.prototype.throttle=function(e){return ge(this,"throttle",e,this.bufferWithTime(e).map(function(e){return e[e.length-1]}))},n.Property.prototype.throttle=function(e){return this.delayChanges("throttle",e,function(t){return t.throttle(e)})},b.prototype.firstToPromise=function(e){var t=this;if("function"!=typeof e){if("function"!=typeof Promise)throw new p("There isn't default Promise, use shim or parameter");e=Promise}return new e(function(e,r){return t.subscribe(function(t){return t.hasValue()&&e(t.value()),t.isError()&&r(t.error),n.noMore})})},b.prototype.toPromise=function(e){return this.last().firstToPromise(e)},"undefined"!=typeof t&&null!==t&&null!=t.amd?(e.register("github:baconjs/bacon.js@0.7.53/dist/Bacon",[],!1,function(e,t,r){return function(){return n}.call(this)}),this.Bacon=n):"undefined"!=typeof module&&null!==module&&null!=module.exports?(module.exports=n,n.Bacon=n):this.Bacon=n}.call(this)}(),e.register("npm:core-js@0.8.2/library/modules/$",["npm:core-js@0.8.2/library/modules/$.fw"],!0,function(require,t,n){function r(e){return isNaN(e=+e)?0:(e>0?g:h)(e)}function i(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function o(e,t,n){return e[t]=n,e}function a(e){return y?function(t,n,r){return w.setDesc(t,n,i(e,r))}:o}function s(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function u(e){return"function"==typeof e}function c(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}var l=e.global,f=l.define;l.define=void 0;var l="undefined"!=typeof self?self:Function("return this")(),m={},p=Object.defineProperty,d={}.hasOwnProperty,h=Math.ceil,g=Math.floor,b=Math.max,v=Math.min,y=!!function(){try{return 2==p({},"a",{get:function(){return 2}}).a}catch(e){}}(),x=a(1),w=n.exports=require("npm:core-js@0.8.2/library/modules/$.fw")({g:l,core:m,html:l.document&&document.documentElement,isObject:s,isFunction:u,it:function(e){return e},that:function(){return this},toInteger:r,toLength:function(e){return e>0?v(r(e),9007199254740991):0},toIndex:function(e,t){return e=r(e),0>e?b(e+t,0):v(e,t)},has:function(e,t){return d.call(e,t)},create:Object.create,getProto:Object.getPrototypeOf,DESC:y,desc:i,getDesc:Object.getOwnPropertyDescriptor,setDesc:p,getKeys:Object.keys,getNames:Object.getOwnPropertyNames,getSymbols:Object.getOwnPropertySymbols,assertDefined:c,ES5Object:Object,toObject:function(e){return w.ES5Object(c(e))},hide:x,def:a(0),set:l.Symbol?o:x,mix:function(e,t){for(var n in t)x(e,n,t[n]);return e},each:[].forEach});return"undefined"!=typeof __e&&(__e=m),"undefined"!=typeof __g&&(__g=l),l.define=f,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.ctx",["npm:core-js@0.8.2/library/modules/$.assert"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.assert").fn;return n.exports=function(e,t,n){if(o(e),~n&&void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.cof",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){function r(e){return u.call(e).slice(8,-1)}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.8.2/library/modules/$"),s=require("npm:core-js@0.8.2/library/modules/$.wks")("toStringTag"),u={}.toString;return r.classof=function(e){var t,n;return void 0==e?void 0===e?"Undefined":"Null":"string"==typeof(n=(t=Object(e))[s])?n:r(t)},r.set=function(e,t,n){e&&!a.has(e=n?e:e.prototype,s)&&a.hide(e,s,t)},n.exports=r,i.define=o,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.array.iterator",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.unscope","npm:core-js@0.8.2/library/modules/$.uid","npm:core-js@0.8.2/library/modules/$.iter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.unscope"),s=require("npm:core-js@0.8.2/library/modules/$.uid").safe("iter"),u=require("npm:core-js@0.8.2/library/modules/$.iter"),c=u.step,l=u.Iterators;return u.std(Array,"Array",function(e,t){o.set(this,s,{o:o.toObject(e),i:0,k:t})},function(){var e=this[s],t=e.o,n=e.k,r=e.i++;return!t||r>=t.length?(e.o=void 0,c(1)):"key"==n?c(0,r):"value"==n?c(0,t[r]):c(0,[r,t[r]])},"value"),l.Arguments=l.Array,a("keys"),a("values"),a("entries"),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.collection-weak",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.uid","npm:core-js@0.8.2/library/modules/$.assert","npm:core-js@0.8.2/library/modules/$.iter","npm:core-js@0.8.2/library/modules/$.array-methods"],!0,function(require,t,n){function r(e,t){return x.call(e.array,function(e){return e[0]===t})}function i(e){return e[v]||p(e,v,{array:[],get:function(e){var t=r(this,e);return t?t[1]:void 0},has:function(e){return!!r(this,e)},set:function(e,t){var n=r(this,e);n?n[1]=t:this.array.push([e,t])},"delete":function(e){var t=w.call(this.array,function(t){return t[0]===e});return~t&&this.array.splice(t,1),!!~t}})[v]}var o=e.global,a=o.define;o.define=void 0;var s=require("npm:core-js@0.8.2/library/modules/$"),u=require("npm:core-js@0.8.2/library/modules/$.uid").safe,c=require("npm:core-js@0.8.2/library/modules/$.assert"),l=require("npm:core-js@0.8.2/library/modules/$.iter").forOf,f=s.has,m=s.isObject,p=s.hide,d=Object.isFrozen||s.core.Object.isFrozen,h=0,g=u("id"),b=u("weak"),v=u("leak"),y=require("npm:core-js@0.8.2/library/modules/$.array-methods"),x=y(5),w=y(6);return n.exports={getConstructor:function(e,t,n){function r(i){s.set(c.inst(this,r,e),g,h++),void 0!=i&&l(i,t,this[n],this)}return s.mix(r.prototype,{"delete":function(e){return m(e)?d(e)?i(this)["delete"](e):f(e,b)&&f(e[b],this[g])&&delete e[b][this[g]]:!1},has:function(e){return m(e)?d(e)?i(this).has(e):f(e,b)&&f(e[b],this[g]):!1}}),r},def:function(e,t,n){return d(c.obj(t))?i(e).set(t,n):(f(t,b)||p(t,b,{}),t[b][e[g]]=n),e},leakStore:i,WEAK:b,ID:g},o.define=a,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.collection",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.iter","npm:core-js@0.8.2/library/modules/$.assert","npm:core-js@0.8.2/library/modules/$.iter-detect","npm:core-js@0.8.2/library/modules/$.cof","npm:core-js@0.8.2/library/modules/$.species"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.def"),s=require("npm:core-js@0.8.2/library/modules/$.iter"),u=require("npm:core-js@0.8.2/library/modules/$.assert").inst;return n.exports=function(e,t,n,r,i){function c(e,t){var n=p[e];o.FW&&(p[e]=function(e,r){var i=n.call(this,0===e?0:e,r);return t?this:i})}var l=o.g[e],f=l,m=r?"set":"add",p=f&&f.prototype,d={};if(o.isFunction(f)&&(i||!s.BUGGY&&p.forEach&&p.entries)){var h,g=new f,b=g[m](i?{}:-0,1);require("npm:core-js@0.8.2/library/modules/$.iter-detect")(function(e){new f(e)})||(f=function(t){u(this,f,e);var n=new l;return void 0!=t&&s.forOf(t,r,n[m],n),n},f.prototype=p,o.FW&&(p.constructor=f)),i||g.forEach(function(e,t){h=1/t===-(1/0)}),h&&(c("delete"),c("has"),r&&c("get")),(h||b!==g)&&c(m,!0)}else f=n.getConstructor(e,r,m),o.mix(f.prototype,t);return require("npm:core-js@0.8.2/library/modules/$.cof").set(f,e),require("npm:core-js@0.8.2/library/modules/$.species")(f),d[e]=f,a(a.G+a.W+a.F*(f!=l),d),i||s.std(f,e,n.getIterConstructor(),n.next,r?"key+value":"value",!r,!0),f},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/weak-set",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/es6.weak-set","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),require("npm:core-js@0.8.2/library/modules/es6.weak-set"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.WeakSet,r.define=i,n.exports}),e.register("npm:process@0.10.1",["npm:process@0.10.1/browser"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:process@0.10.1/browser"),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/get-iterator",["npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/core.iter-helpers","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/core.iter-helpers"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.getIterator,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/object/keys",["npm:core-js@0.8.2/library/modules/es6.object.statics-accept-primitives","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.object.statics-accept-primitives"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Object.keys,r.define=i,n.exports}),e.register("github:mrdoob/stats.js@master",["github:mrdoob/stats.js@master/src/Stats"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("github:mrdoob/stats.js@master/src/Stats"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/symbol/iterator",["npm:core-js@0.8.2/library/fn/symbol/iterator"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/symbol/iterator"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.symbol",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.cof","npm:core-js@0.8.2/library/modules/$.uid","npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.keyof","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){function r(e){var t=x[e]=a.set(a.create(h.prototype),v,e);return a.DESC&&b&&a.setDesc(Object.prototype,e,{configurable:!0,set:function(t){m(this,e,t)}}),t}var i=e.global,o=i.define;i.define=void 0;var a=require("npm:core-js@0.8.2/library/modules/$"),s=require("npm:core-js@0.8.2/library/modules/$.cof").set,u=require("npm:core-js@0.8.2/library/modules/$.uid"),c=require("npm:core-js@0.8.2/library/modules/$.def"),l=require("npm:core-js@0.8.2/library/modules/$.keyof"),f=a.has,m=a.hide,p=a.getNames,d=a.toObject,h=a.g.Symbol,g=h,b=!1,v=u.safe("tag"),y={},x={};a.isFunction(h)||(h=function j(e){if(this instanceof j)throw TypeError("Symbol is not a constructor");return r(u(e))},m(h.prototype,"toString",function(){return this[v]})),c(c.G+c.W,{Symbol:h});var w={"for":function(e){return f(y,e+="")?y[e]:y[e]=h(e)},keyFor:function(e){return l(y,e)},pure:u.safe,set:a.set,useSetter:function(){b=!0},useSimple:function(){b=!1}};return a.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=require("npm:core-js@0.8.2/library/modules/$.wks")(e);w[e]=h===g?t:r(t)}),b=!0,c(c.S,"Symbol",w),c(c.S+c.F*(h!=g),"Object",{getOwnPropertyNames:function(e){for(var t,n=p(d(e)),r=[],i=0;n.length>i;)f(x,t=n[i++])||r.push(t);return r},getOwnPropertySymbols:function(e){for(var t,n=p(d(e)),r=[],i=0;n.length>i;)f(x,t=n[i++])&&r.push(x[t]);return r}}),s(h,"Symbol"),s(Math,"Math",!0),s(a.g.JSON,"JSON",!0),i.define=o,n.exports}),function(){function t(){}t.amd={},e.register("github:toji/gl-matrix@2.2.1",["github:toji/gl-matrix@2.2.1/dist/gl-matrix"],!1,function(e,t,n){return function(e){return e}.call(this,e("github:toji/gl-matrix@2.2.1/dist/gl-matrix"))})}(),e.register("npm:core-js@0.8.2/library/modules/es6.map",["npm:core-js@0.8.2/library/modules/$.collection-strong","npm:core-js@0.8.2/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.collection-strong");return require("npm:core-js@0.8.2/library/modules/$.collection")("Map",{get:function(e){var t=o.getEntry(this,e);return t&&t.v},set:function(e,t){return o.def(this,0===e?0:e,t)}},o,!0),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/set",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/es6.set","npm:core-js@0.8.2/library/modules/es7.set.to-json","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),require("npm:core-js@0.8.2/library/modules/es6.set"),require("npm:core-js@0.8.2/library/modules/es7.set.to-json"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Set,r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/math/sign/index",["npm:es5-ext@0.10.6/math/sign/is-implemented","npm:es5-ext@0.10.6/math/sign/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/math/sign/is-implemented")()?Math.sign:require("npm:es5-ext@0.10.6/math/sign/shim"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/_iterate",["npm:es5-ext@0.10.6/object/is-callable","npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/is-callable"),a=require("npm:es5-ext@0.10.6/object/valid-callable"),s=require("npm:es5-ext@0.10.6/object/valid-value"),u=Function.prototype.call,c=Object.keys,l=Object.prototype.propertyIsEnumerable;return n.exports=function(e,t){return function(n,r){var i,f=arguments[2],m=arguments[3];return n=Object(s(n)),a(r),i=c(n),m&&i.sort(o(m)?m.bind(n):void 0),i[e](function(e,i){return l.call(n,e)?u.call(r,f,n[e],e,n,i):t})}},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/keys/index",["npm:es5-ext@0.10.6/object/keys/is-implemented","npm:es5-ext@0.10.6/object/keys/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/keys/is-implemented")()?Object.keys:require("npm:es5-ext@0.10.6/object/keys/shim"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/function/_define-length",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:es5-ext@0.10.6/object/mixin"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a,s,u,c=require("npm:es5-ext@0.10.6/number/to-pos-integer"),l=function(e,t){};try{Object.defineProperty(l,"length",{configurable:!0,writable:!1,enumerable:!1,value:1})}catch(f){}return 1===l.length?(o={configurable:!0,writable:!1,enumerable:!1},a=Object.defineProperty,n.exports=function(e,t){return t=c(t),e.length===t?e:(o.value=t,a(e,"length",o))}):(u=require("npm:es5-ext@0.10.6/object/mixin"),s=function(){var e=[];return function(t){var n,r=0;if(e[t])return e[t];for(n=[];t--;)n.push("a"+(++r).toString(36));return new Function("fn","return function ("+n.join(", ")+") { return fn.apply(this, arguments); };")}}(),n.exports=function(e,t){var n;if(t=c(t),e.length===t)return e;n=s(t)(e);try{u(n,e)}catch(r){}return n}),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/string/#/contains/index",["npm:es5-ext@0.10.6/string/#/contains/is-implemented","npm:es5-ext@0.10.6/string/#/contains/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/string/#/contains/is-implemented")()?String.prototype.contains:require("npm:es5-ext@0.10.6/string/#/contains/shim"),r.define=i,n.exports}),e.register("npm:event-emitter@0.3.3",["npm:event-emitter@0.3.3/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:event-emitter@0.3.3/index"),r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/validate-symbol",["npm:es6-symbol@2.0.1/is-symbol"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es6-symbol@2.0.1/is-symbol");return n.exports=function(e){if(!o(e))throw new TypeError(e+" is not a symbol");return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/function/is-function",["npm:es5-ext@0.10.6/function/noop"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=Object.prototype.toString,a=o.call(require("npm:es5-ext@0.10.6/function/noop"));return n.exports=function(e){return"function"==typeof e&&o.call(e)===a},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/normalizers/get",["npm:es5-ext@0.10.6/array/#/e-index-of"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/#/e-index-of"),a=Object.create;return n.exports=function(){var e=0,t=[],n=a(null);return{get:function(e){var n,r=0,i=t,a=e.length;if(0===a)return i[a]||null;if(i=i[a]){for(;a-1>r;){if(n=o.call(i[0],e[r]),-1===n)return null;i=i[1][n],++r}return n=o.call(i[0],e[r]),-1===n?null:i[1][n]||null}return null},set:function(r){var i,a=0,s=t,u=r.length;if(0===u)s[u]=++e;else{for(s[u]||(s[u]=[[],[]]),s=s[u];u-1>a;)i=o.call(s[0],r[a]),-1===i&&(i=s[0].push(r[a])-1,s[1].push([[],[]])),s=s[1][i],++a;i=o.call(s[0],r[a]),-1===i&&(i=s[0].push(r[a])-1),s[1][i]=++e}return n[e]=r,e},"delete":function(e){var r,i=0,a=t,s=n[e],u=s.length,c=[];if(0===u)delete a[u];else if(a=a[u]){for(;u-1>i;){if(r=o.call(a[0],s[i]),-1===r)return;c.push(a,r),a=a[1][r],++i}if(r=o.call(a[0],s[i]),-1===r)return;for(e=a[1][r],a[0].splice(r,1),a[1].splice(r,1);!a[0].length&&c.length;)r=c.pop(),a=c.pop(),a[0].splice(r,1),a[1].splice(r,1)}delete n[e]},clear:function(){t=[],n=a(null)}}},r.define=i,n.exports}),e.register("npm:next-tick@0.2.2",["npm:next-tick@0.2.2/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:next-tick@0.2.2/index"),r.define=i,n.exports}),e.register("npm:timers-ext@0.1.0/valid-timeout",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:timers-ext@0.1.0/max-timeout"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=require("npm:timers-ext@0.1.0/max-timeout");return n.exports=function(e){if(e=o(e),e>a)throw new TypeError(e+" exceeds maximum possible timeout");return e},r.define=i,n.exports}),e.register("npm:lru-queue@0.1.0",["npm:lru-queue@0.1.0/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:lru-queue@0.1.0/index"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/object/freeze",["npm:core-js@0.8.2/library/fn/object/freeze"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/object/freeze"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/array/from",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/es6.array.from","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/es6.array.from"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Array.from,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.object.assign",["npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.assign"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$.def");return o(o.S,"Object",{assign:require("npm:core-js@0.8.2/library/modules/$.assign")}),r.define=i,n.exports}),function(){function t(){}t.amd={},e.register("github:baconjs/bacon.js@0.7.53",["github:baconjs/bacon.js@0.7.53/dist/Bacon"],!1,function(e,t,n){return function(e){return e}.call(this,e("github:baconjs/bacon.js@0.7.53/dist/Bacon"))})}(),e.register("npm:core-js@0.8.2/library/modules/$.iter",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.ctx","npm:core-js@0.8.2/library/modules/$.cof","npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.assert","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){function r(e,t){l.hide(e,h,t),g in[]&&l.hide(e,g,t)}function i(e,t,n,i){var o=e.prototype,a=o[h]||o[g]||i&&o[i]||n;if(l.FW&&r(o,a),a!==n){var s=l.getProto(a.call(new e));m.set(s,t+" Iterator",!0),l.FW&&l.has(o,g)&&r(s,l.that)}return b[t]=a,b[t+" Iterator"]=l.that,a}function o(e){var t=l.g.Symbol,n=e[t&&t.iterator||g],r=n||e[h]||b[m.classof(e)];return d(r.call(e))}function a(e){var t=e["return"];void 0!==t&&d(t.call(e))}function s(e,t,n,r){try{return r?t(d(n)[0],n[1]):t(n)}catch(i){throw a(e),i}}var u=e.global,c=u.define;u.define=void 0;var l=require("npm:core-js@0.8.2/library/modules/$"),f=require("npm:core-js@0.8.2/library/modules/$.ctx"),m=require("npm:core-js@0.8.2/library/modules/$.cof"),p=require("npm:core-js@0.8.2/library/modules/$.def"),d=require("npm:core-js@0.8.2/library/modules/$.assert").obj,h=require("npm:core-js@0.8.2/library/modules/$.wks")("iterator"),g="@@iterator",b={},v={},y="keys"in[]&&!("next"in[].keys());r(v,l.that);var x=n.exports={BUGGY:y,Iterators:b,prototype:v,step:function(e,t){return{value:t,done:!!e}},stepCall:s,close:a,is:function(e){var t=Object(e),n=l.g.Symbol,r=n&&n.iterator||g;return r in t||h in t||l.has(b,m.classof(t))},get:o,set:r,create:function(e,t,n,r){e.prototype=l.create(r||x.prototype,{next:l.desc(1,n)}),m.set(e,t+" Iterator")},define:i,std:function(e,t,n,r,o,a,s){function u(e){return function(){return new n(this,e)}}x.create(n,t,r);var c,f,m=u("key+value"),d=u("value"),h=e.prototype;if("value"==o?d=i(e,t,d,"values"):m=i(e,t,m,"entries"),o&&(c={entries:m,keys:a?d:u("key"),values:d},p(p.P+p.F*y,t,c),s))for(f in c)f in h||l.hide(h,f,c[f])},forOf:function(e,t,n,r){for(var i,u=o(e),c=f(n,r,t?2:1);!(i=u.next()).done;)if(s(u,c,i.value,t)===!1)return a(u)}};return u.define=c,n.exports}),e.register("npm:core-js@0.8.2/library/modules/web.dom.iterable",["npm:core-js@0.8.2/library/modules/es6.array.iterator","npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.iter","npm:core-js@0.8.2/library/modules/$.wks"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.array.iterator");var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.iter").Iterators,s=require("npm:core-js@0.8.2/library/modules/$.wks")("iterator"),u=o.g.NodeList;return!o.FW||!u||s in u.prototype||o.hide(u.prototype,s,a.Array),a.NodeList=a.Array,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.weak-map",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.collection-weak","npm:core-js@0.8.2/library/modules/$.collection"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$"),a=require("npm:core-js@0.8.2/library/modules/$.collection-weak"),s=a.leakStore,u=a.ID,c=a.WEAK,l=o.has,f=o.isObject,m=Object.isFrozen||o.core.Object.isFrozen,p={},d=require("npm:core-js@0.8.2/library/modules/$.collection")("WeakMap",{get:function(e){if(f(e)){if(m(e))return s(this).get(e);if(l(e,c))return e[c][this[u]]}},set:function(e,t){return a.def(this,e,t)}},a,!0,!0);return o.FW&&7!=(new d).set((Object.freeze||Object)(p),7).get(p)&&o.each.call(["delete","has","get","set"],function(e){var t=d.prototype[e];d.prototype[e]=function(n,r){if(f(n)&&m(n)){var i=s(this)[e](n,r);return"set"==e?this:i}return t.call(this,n,r)}}),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/weak-set",["npm:core-js@0.8.2/library/fn/weak-set"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/weak-set"),__esModule:!0},r.define=i,n.exports}),e.register("github:jspm/nodelibs-process@0.1.1/index",["npm:process@0.10.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=e._nodeRequire?process:require("npm:process@0.10.1"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/get-iterator",["npm:core-js@0.8.2/library/fn/get-iterator"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/get-iterator"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/object/keys",["npm:core-js@0.8.2/library/fn/object/keys"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/object/keys"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/symbol/index",["npm:core-js@0.8.2/library/modules/es6.symbol","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.symbol"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Symbol,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/map",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/es6.map","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),require("npm:core-js@0.8.2/library/modules/es6.map"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Map,r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/set",["npm:core-js@0.8.2/library/fn/set"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/set"),
__esModule:!0},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/number/to-integer",["npm:es5-ext@0.10.6/math/sign/index"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/math/sign/index"),a=Math.abs,s=Math.floor;return n.exports=function(e){return isNaN(e)?0:(e=Number(e),0!==e&&isFinite(e)?o(e)*s(a(e)):e)},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/for-each",["npm:es5-ext@0.10.6/object/_iterate"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/_iterate")("forEach"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/assign/shim",["npm:es5-ext@0.10.6/object/keys/index","npm:es5-ext@0.10.6/object/valid-value"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/keys/index"),a=require("npm:es5-ext@0.10.6/object/valid-value"),s=Math.max;return n.exports=function(e,t){var n,r,i,u=s(arguments.length,2);for(e=Object(a(e)),i=function(r){try{e[r]=t[r]}catch(i){n||(n=i)}},r=1;u>r;++r)t=arguments[r],o(t).forEach(i);if(void 0!==n)throw n;return e},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/string/#/contains",["npm:es5-ext@0.10.6/string/#/contains/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/string/#/contains/index"),r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/polyfill",["npm:d@0.1.1","npm:es6-symbol@2.0.1/validate-symbol"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a,s=require("npm:d@0.1.1"),u=require("npm:es6-symbol@2.0.1/validate-symbol"),c=Object.create,l=Object.defineProperties,f=Object.defineProperty,m=Object.prototype,p=c(null),d=function(){var e=c(null);return function(t){for(var n,r=0;e[t+(r||"")];)++r;return t+=r||"",e[t]=!0,n="@@"+t,f(m,n,s.gs(null,function(e){f(this,n,s(e))})),n}}();return a=function h(e){if(this instanceof a)throw new TypeError("TypeError: Symbol is not a constructor");return h(e)},n.exports=o=function g(e){var t;if(this instanceof g)throw new TypeError("TypeError: Symbol is not a constructor");return t=c(a.prototype),e=void 0===e?"":String(e),l(t,{__description__:s("",e),__name__:s("",d(e))})},l(o,{"for":s(function(e){return p[e]?p[e]:p[e]=o(String(e))}),keyFor:s(function(e){var t;u(e);for(t in p)if(p[t]===e)return t}),hasInstance:s("",o("hasInstance")),isConcatSpreadable:s("",o("isConcatSpreadable")),iterator:s("",o("iterator")),match:s("",o("match")),replace:s("",o("replace")),search:s("",o("search")),species:s("",o("species")),split:s("",o("split")),toPrimitive:s("",o("toPrimitive")),toStringTag:s("",o("toStringTag")),unscopables:s("",o("unscopables"))}),l(a.prototype,{constructor:s(o),toString:s("",function(){return this.__name__})}),l(o.prototype,{toString:s(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:s(function(){return u(this)})}),f(o.prototype,o.toPrimitive,s("",function(){return u(this)})),f(o.prototype,o.toStringTag,s("c","Symbol")),f(a.prototype,o.toPrimitive,s("c",o.prototype[o.toPrimitive])),f(a.prototype,o.toStringTag,s("c",o.prototype[o.toStringTag])),r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/async",["npm:es5-ext@0.10.6/array/from","npm:es5-ext@0.10.6/object/mixin","npm:es5-ext@0.10.6/function/_define-length","npm:next-tick@0.2.2","npm:memoizee@0.3.8/lib/registered-extensions","github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";var t=require("npm:es5-ext@0.10.6/array/from"),n=require("npm:es5-ext@0.10.6/object/mixin"),r=require("npm:es5-ext@0.10.6/function/_define-length"),i=require("npm:next-tick@0.2.2"),o=Array.prototype.slice,a=Function.prototype.apply,s=Object.create,u=Object.prototype.hasOwnProperty;require("npm:memoizee@0.3.8/lib/registered-extensions").async=function(e,c){var l,f,m,p=s(null),d=s(null),h=c.memoized,g=c.original;c.memoized=r(function(e){var t=arguments,n=t[t.length-1];return"function"==typeof n&&(l=n,t=o.call(t,0,-1)),h.apply(f=this,m=t)},h);try{n(c.memoized,h)}catch(b){}c.on("get",function(e){var t,n,r;if(l){if(p[e])return"function"==typeof p[e]?p[e]=[p[e],l]:p[e].push(l),void(l=null);t=l,n=f,r=m,l=f=m=null,i(function(){var i;u.call(d,e)?(i=d[e],c.emit("getasync",e,r,n),a.call(t,i.context,i.args)):(l=t,f=n,m=r,h.apply(n,r))})}}),c.original=function(){var e,n,r,o;return l?(e=t(arguments),n=function s(e){var n,r,u=s.id;return null==u?void i(a.bind(s,this,arguments)):(delete s.id,n=p[u],delete p[u],n?(r=t(arguments),c.has(u)&&(e?c["delete"](u):(d[u]={context:this,args:r},c.emit("setasync",u,"function"==typeof n?1:n.length))),"function"==typeof n?o=a.call(n,this,r):n.forEach(function(e){o=a.call(e,this,r)},this),o):void 0)},r=l,l=f=m=null,e.push(n),o=a.call(g,this,e),n.cb=r,l=n,o):a.call(g,this,arguments)},c.on("set",function(e){return l?(p[e]?"function"==typeof p[e]?p[e]=[p[e],l.cb]:p[e].push(l.cb):p[e]=l.cb,delete l.cb,l.id=e,void(l=null)):void c["delete"](e)}),c.on("delete",function(e){var t;u.call(p,e)||d[e]&&(t=d[e],delete d[e],c.emit("deleteasync",e,t))}),c.on("clear",function(){var e=d;d=s(null),c.emit("clearasync",e)})}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/max-age",["npm:es5-ext@0.10.6/array/from","npm:es5-ext@0.10.6/function/noop","npm:es5-ext@0.10.6/object/for-each","npm:timers-ext@0.1.0/valid-timeout","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/from"),a=require("npm:es5-ext@0.10.6/function/noop"),s=require("npm:es5-ext@0.10.6/object/for-each"),u=require("npm:timers-ext@0.1.0/valid-timeout"),c=require("npm:memoizee@0.3.8/lib/registered-extensions"),l=Math.max,f=Math.min,m=Object.create;return c.maxAge=function(e,t,n){var r,i,p,d;e=u(e),e&&(r=m(null),i=n.async&&c.async?"async":"",t.on("set"+i,function(n){r[n]=setTimeout(function(){t["delete"](n)},e),d&&(d[n]&&clearTimeout(d[n]),d[n]=setTimeout(function(){delete d[n]},p))}),t.on("delete"+i,function(e){clearTimeout(r[e]),delete r[e],d&&(clearTimeout(d[e]),delete d[e])}),n.preFetch&&(p=n.preFetch===!0||isNaN(n.preFetch)?.333:l(f(Number(n.preFetch),1),0),p&&(d={},p=(1-p)*e,t.on("get"+i,function(e,r,i){d[e]||(d[e]=setTimeout(function(){delete d[e],t["delete"](e),n.async&&(r=o(r),r.push(a)),t.memoized.apply(i,r)},0))}))),t.on("clear"+i,function(){s(r,function(e){clearTimeout(e)}),r={},d&&(s(d,function(e){clearTimeout(e)}),d={})}))},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/ext/max",["npm:es5-ext@0.10.6/number/to-pos-integer","npm:lru-queue@0.1.0","npm:memoizee@0.3.8/lib/registered-extensions"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer"),a=require("npm:lru-queue@0.1.0"),s=require("npm:memoizee@0.3.8/lib/registered-extensions");return s.max=function(e,t,n){var r,i,u;e=o(e),e&&(i=a(e),r=n.async&&s.async?"async":"",t.on("set"+r,u=function(e){e=i.hit(e),void 0!==e&&t["delete"](e)}),t.on("get"+r,u),t.on("delete"+r,i["delete"]),t.on("clear"+r,i.clear))},r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/array/from",["npm:core-js@0.8.2/library/fn/array/from"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/array/from"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/object/assign",["npm:core-js@0.8.2/library/modules/es6.object.assign","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.object.assign"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Object.assign,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.string.iterator",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.string-at","npm:core-js@0.8.2/library/modules/$.uid","npm:core-js@0.8.2/library/modules/$.iter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:core-js@0.8.2/library/modules/$").set,a=require("npm:core-js@0.8.2/library/modules/$.string-at")(!0),s=require("npm:core-js@0.8.2/library/modules/$.uid").safe("iter"),u=require("npm:core-js@0.8.2/library/modules/$.iter"),c=u.step;return u.std(String,"String",function(e){o(this,s,{o:String(e),i:0})},function(){var e,t=this[s],n=t.o,r=t.i;return r>=n.length?c(1):(e=a.call(n,r),t.i+=e.length,c(0,e))}),r.define=i,n.exports}),e.register("github:jspm/nodelibs-process@0.1.1",["github:jspm/nodelibs-process@0.1.1/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("github:jspm/nodelibs-process@0.1.1/index"),r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/symbol",["npm:core-js@0.8.2/library/fn/symbol/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:core-js@0.8.2/library/fn/symbol/index"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/map",["npm:core-js@0.8.2/library/fn/map"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/map"),__esModule:!0},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/number/to-pos-integer",["npm:es5-ext@0.10.6/number/to-integer"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-integer"),a=Math.max;return n.exports=function(e){return a(0,o(e))},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/object/assign/index",["npm:es5-ext@0.10.6/object/assign/is-implemented","npm:es5-ext@0.10.6/object/assign/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/object/assign/is-implemented")()?Object.assign:require("npm:es5-ext@0.10.6/object/assign/shim"),r.define=i,n.exports}),e.register("npm:d@0.1.1/index",["npm:es5-ext@0.10.6/object/assign","npm:es5-ext@0.10.6/object/normalize-options","npm:es5-ext@0.10.6/object/is-callable","npm:es5-ext@0.10.6/string/#/contains"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a=require("npm:es5-ext@0.10.6/object/assign"),s=require("npm:es5-ext@0.10.6/object/normalize-options"),u=require("npm:es5-ext@0.10.6/object/is-callable"),c=require("npm:es5-ext@0.10.6/string/#/contains");return o=n.exports=function(e,t){var n,r,i,o,u;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],null==e?(n=i=!0,r=!1):(n=c.call(e,"c"),r=c.call(e,"e"),i=c.call(e,"w")),u={value:t,configurable:n,enumerable:r,writable:i},o?a(s(o),u):u},o.gs=function(e,t,n){var r,i,o,l;return"string"!=typeof e?(o=n,n=t,t=e,e=null):o=arguments[3],null==t?t=void 0:u(t)?null==n?n=void 0:u(n)||(o=n,n=void 0):(o=t,t=n=void 0),null==e?(r=!0,i=!1):(r=c.call(e,"c"),i=c.call(e,"e")),l={get:t,set:n,configurable:r,enumerable:i},o?a(s(o),l):l},r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1/index",["npm:es6-symbol@2.0.1/is-implemented","npm:es6-symbol@2.0.1/polyfill"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es6-symbol@2.0.1/is-implemented")()?Symbol:require("npm:es6-symbol@2.0.1/polyfill"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/object/assign",["npm:core-js@0.8.2/library/fn/object/assign"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/object/assign"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/weak-map",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/es6.weak-map","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),require("npm:core-js@0.8.2/library/modules/es6.weak-map"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.WeakMap,r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/$.task",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.ctx","npm:core-js@0.8.2/library/modules/$.cof","npm:core-js@0.8.2/library/modules/$.invoke","github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";function t(){var e=+this;if(s.has(w,e)){var t=w[e];delete w[e],t()}}function r(e){t.call(e.data)}var i,o,a,s=require("npm:core-js@0.8.2/library/modules/$"),u=require("npm:core-js@0.8.2/library/modules/$.ctx"),c=require("npm:core-js@0.8.2/library/modules/$.cof"),l=require("npm:core-js@0.8.2/library/modules/$.invoke"),f=s.g,m=s.isFunction,p=s.html,d=f.document,e=f.process,h=f.setImmediate,g=f.clearImmediate,b=f.postMessage,v=f.addEventListener,y=f.MessageChannel,x=0,w={},j="onreadystatechange";m(h)&&m(g)||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return w[++x]=function(){l(m(e)?e:Function(e),t)},i(x),x},g=function(e){delete w[e]},"process"==c(e)?i=function(n){e.nextTick(u(t,n,1))}:v&&m(b)&&!f.importScripts?(i=function(e){b(e,"*")},v("message",r,!1)):m(y)?(o=new y,a=o.port2,o.port1.onmessage=r,i=u(a.postMessage,a,1)):i=d&&j in d.createElement("script")?function(e){p.appendChild(d.createElement("script"))[j]=function(){p.removeChild(this),t.call(e)}}:function(e){setTimeout(u(t,e,1),0)}),n.exports={set:h,clear:g}}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/symbol",["npm:core-js@0.8.2/library/fn/symbol"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/symbol"),__esModule:!0},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/resolve-length",["npm:es5-ext@0.10.6/number/to-pos-integer"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/number/to-pos-integer");return n.exports=function(e,t,n){var r;return isNaN(e)?(r=t,r>=0?n&&r?r-1:r:1):e===!1?!1:o(e)},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/error/custom",["npm:es5-ext@0.10.6/object/assign/index"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/assign/index"),a=Error.captureStackTrace;return t=n.exports=function(e){var n=new Error,r=arguments[1],i=arguments[2];return null==i&&r&&"object"==typeof r&&(i=r,r=null),null!=i&&o(n,i),n.message=String(e),null!=r&&(n.code=String(r)),a&&a(n,t),n},r.define=i,n.exports}),e.register("npm:d@0.1.1",["npm:d@0.1.1/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:d@0.1.1/index"),r.define=i,n.exports}),e.register("npm:es6-symbol@2.0.1",["npm:es6-symbol@2.0.1/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es6-symbol@2.0.1/index"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/weak-map",["npm:core-js@0.8.2/library/fn/weak-map"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/weak-map"),__esModule:!0},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/modules/es6.promise",["npm:core-js@0.8.2/library/modules/$","npm:core-js@0.8.2/library/modules/$.ctx","npm:core-js@0.8.2/library/modules/$.cof","npm:core-js@0.8.2/library/modules/$.def","npm:core-js@0.8.2/library/modules/$.assert","npm:core-js@0.8.2/library/modules/$.iter","npm:core-js@0.8.2/library/modules/$.wks","npm:core-js@0.8.2/library/modules/$.uid","npm:core-js@0.8.2/library/modules/$.task","npm:core-js@0.8.2/library/modules/$.species","npm:core-js@0.8.2/library/modules/$.iter-detect","github:jspm/nodelibs-process@0.1.1"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,function(e){"use strict";function t(e){var t=_(e)[d];return void 0!=t?t:e}function n(e){var t;return E(e)&&(t=e.then),j(t)?t:!1}function r(e){var t,n=e[h],i=n.c,o=0;if(n.h)return!1;for(;i.length>o;)if(t=i[o++],t.fail||!r(t.P))return!1;return!0}function i(t,i){var o=t.c;(i||o.length)&&y(function(){var a=t.p,s=t.v,u=1==t.s,c=0;if(i&&r(a))setTimeout(function(){r(a)&&("process"==l(e)?e.emit("unhandledRejection",s,a):v.console&&j(console.error)&&console.error("Unhandled promise rejection",s))},1e3);else for(;o.length>c;)!function(e){var r,i,o=u?e.ok:e.fail;try{o?(u||(t.h=!0),r=o===!0?s:o(s),r===e.P?e.rej(TypeError(b+"-chain cycle")):(i=n(r))?i.call(r,e.res,e.rej):e.res(r)):e.rej(s)}catch(a){e.rej(a)}}(o[c++]);o.length=0})}function o(e){var t=this;t.d||(t.d=!0,t=t.r||t,t.v=e,t.s=2,i(t,!0))}function a(e){var t,r,s=this;if(!s.d){s.d=!0,s=s.r||s;try{(t=n(e))?(r={r:s,d:!1},t.call(e,c(a,r,1),c(o,r,1))):(s.v=e,s.s=1,i(s))}catch(u){o.call(r||{r:s,d:!1},u)}}}var s,u=require("npm:core-js@0.8.2/library/modules/$"),c=require("npm:core-js@0.8.2/library/modules/$.ctx"),l=require("npm:core-js@0.8.2/library/modules/$.cof"),f=require("npm:core-js@0.8.2/library/modules/$.def"),m=require("npm:core-js@0.8.2/library/modules/$.assert"),p=require("npm:core-js@0.8.2/library/modules/$.iter"),d=require("npm:core-js@0.8.2/library/modules/$.wks")("species"),h=require("npm:core-js@0.8.2/library/modules/$.uid").safe("record"),g=p.forOf,b="Promise",v=u.g,e=v.process,y=e&&e.nextTick||require("npm:core-js@0.8.2/library/modules/$.task").set,x=v[b],w=x,j=u.isFunction,E=u.isObject,T=m.fn,_=m.obj;j(x)&&j(x.resolve)&&x.resolve(s=new x(function(){}))==s||(x=function(e){T(e);var t={p:m.inst(this,x,b),c:[],s:0,d:!1,v:void 0,h:!1};u.hide(this,h,t);try{e(c(a,t,1),c(o,t,1))}catch(n){o.call(t,n)}},u.mix(x.prototype,{then:function(e,t){var n=_(_(this).constructor)[d],r={ok:j(e)?e:!0,fail:j(t)?t:!1},o=r.P=new(void 0!=n?n:x)(function(e,t){r.res=T(e),r.rej=T(t)}),a=this[h];return a.c.push(r),a.s&&i(a),o},"catch":function(e){return this.then(void 0,e)}})),f(f.G+f.W+f.F*(x!=w),{Promise:x}),l.set(x,b),require("npm:core-js@0.8.2/library/modules/$.species")(x),f(f.S,b,{reject:function(e){return new(t(this))(function(t,n){n(e)})},resolve:function(e){return E(e)&&h in e&&u.getProto(e)===this.prototype?e:new(t(this))(function(t){t(e)})}}),f(f.S+f.F*!require("npm:core-js@0.8.2/library/modules/$.iter-detect")(function(e){x.all(e)["catch"](function(){})}),b,{all:function(e){var n=t(this),r=[];return new n(function(t,i){g(e,!1,r.push,r);var o=r.length,a=Array(o);o?u.each.call(r,function(e,r){n.resolve(e).then(function(e){a[r]=e,--o||t(a)},i)}):t(a)})},race:function(e){var n=t(this);return new n(function(t,r){g(e,!1,function(e){n.resolve(e).then(t,r)})})}})}(require("github:jspm/nodelibs-process@0.1.1")),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/regenerator/runtime",["npm:babel-runtime@5.1.2/core-js/symbol","npm:babel-runtime@5.1.2/core-js/symbol/iterator","npm:babel-runtime@5.1.2/core-js/promise"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:babel-runtime@5.1.2/core-js/symbol")["default"],a=require("npm:babel-runtime@5.1.2/core-js/symbol/iterator")["default"],s=require("npm:babel-runtime@5.1.2/core-js/promise")["default"];return!function(e){"use strict";function t(e,t,n,r){return new c(e,t,n||null,r||[])}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function i(){}function u(){}function c(e,t,n,i){function o(t,i){if(u===j)throw new Error("Generator is already running");if(u===E)return d();for(;;){var o=s.delegate;if(o){var a=r(o.iterator[t],o.iterator,i);if("throw"===a.type){s.delegate=null,t="throw",i=a.arg;continue}t="next",i=h;var c=a.arg;if(!c.done)return u=w,c;s[o.resultName]=c.value,s.next=o.nextLoc,s.delegate=null}if("next"===t){if(u===x&&"undefined"!=typeof i)throw new TypeError("attempt to send "+JSON.stringify(i)+" to newborn generator");u===w?s.sent=i:delete s.sent}else if("throw"===t){if(u===x)throw u=E,i;s.dispatchException(i)&&(t="next",i=h)}else"return"===t&&s.abrupt("return",i);u=j;var a=r(e,n,s);if("normal"===a.type){u=s.done?E:w;var c={value:a.arg,done:s.done};if(a.arg!==T)return c;s.delegate&&"next"===t&&(i=h)}else"throw"===a.type&&(u=E,"next"===t?s.dispatchException(a.arg):i=a.arg)}}var a=t?Object.create(t.prototype):this,s=new m(i),u=x;return a.next=o.bind(a,"next"),a["throw"]=o.bind(a,"throw"),a["return"]=o.bind(a,"return"),a}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function f(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function m(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset()}function p(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function i(){for(;++n<e.length;)if(g.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=h,i.done=!0,i};return r.next=r}}return{next:d}}function d(){return{value:h,done:!0}}var h,g=Object.prototype.hasOwnProperty,b="function"==typeof o&&a||"@@iterator",v="object"==typeof n,y=e.regeneratorRuntime;if(y)return void(v&&(n.exports=y));y=e.regeneratorRuntime=v?n.exports:{},y.wrap=t;var x="suspendedStart",w="suspendedYield",j="executing",E="completed",T={},_=u.prototype=c.prototype;i.prototype=_.constructor=u,u.constructor=i,i.displayName="GeneratorFunction",y.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===i||"GeneratorFunction"===(t.displayName||t.name):!1},y.mark=function(e){return e.__proto__=u,e.prototype=Object.create(_),e},y.async=function(e,n,i,o){return new s(function(a,s){function u(e){var t=r(this,null,e);if("throw"===t.type)return void s(t.arg);var n=t.arg;n.done?a(n.value):Promise.resolve(n.value).then(l,f)}var c=t(e,n,i,o),l=u.bind(c.next),f=u.bind(c["throw"]);l()})},_[b]=function(){return this},_.toString=function(){return"[object Generator]"},y.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},y.values=p,m.prototype={constructor:m,reset:function(){this.prev=0,this.next=0,this.sent=h,this.done=!1,this.delegate=null,this.tryEntries.forEach(f);for(var e,t=0;g.call(this,e="t"+t)||20>t;++t)this[e]=null},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=g.call(i,"catchLoc"),s=g.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?this.next=i.finallyLoc:this.complete(o),T},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t),T},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc)}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;f(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:p(e),resultName:t,nextLoc:n},T}}}("object"==typeof r?r:"object"==typeof window?window:void 0),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/array/from/shim",["npm:es6-symbol@2.0.1","npm:es5-ext@0.10.6/function/is-arguments","npm:es5-ext@0.10.6/function/is-function","npm:es5-ext@0.10.6/number/to-pos-integer","npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/valid-value","npm:es5-ext@0.10.6/string/is-string"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es6-symbol@2.0.1").iterator,a=require("npm:es5-ext@0.10.6/function/is-arguments"),s=require("npm:es5-ext@0.10.6/function/is-function"),u=require("npm:es5-ext@0.10.6/number/to-pos-integer"),c=require("npm:es5-ext@0.10.6/object/valid-callable"),l=require("npm:es5-ext@0.10.6/object/valid-value"),f=require("npm:es5-ext@0.10.6/string/is-string"),m=Array.isArray,p=Function.prototype.call,d={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;return n.exports=function(e){var t,n,r,i,g,b,v,y,x,w,j=arguments[1],E=arguments[2];if(e=Object(l(e)),null!=j&&c(j),this&&this!==Array&&s(this))t=this;else{if(!j){if(a(e))return g=e.length,1!==g?Array.apply(null,e):(i=new Array(1),i[0]=e[0],i);if(m(e)){for(i=new Array(g=e.length),n=0;g>n;++n)i[n]=e[n];return i}}i=[]}if(!m(e))if(void 0!==(x=e[o])){for(v=c(x).call(e),t&&(i=new t),y=v.next(),n=0;!y.done;)w=j?p.call(j,E,y.value,n):y.value,t?(d.value=w,h(i,n,d)):i[n]=w,y=v.next(),++n;g=n}else if(f(e)){for(g=e.length,t&&(i=new t),n=0,r=0;g>n;++n)w=e[n],g>n+1&&(b=w.charCodeAt(0),b>=55296&&56319>=b&&(w+=e[++n])),w=j?p.call(j,E,w,r):w,t?(d.value=w,h(i,r,d)):i[r]=w,++r;g=r}if(void 0===g)for(g=u(e.length),t&&(i=new t(g)),n=0;g>n;++n)w=j?p.call(j,E,e[n],n):e[n],t?(d.value=w,h(i,n,d)):i[n]=w;return t&&(d.value=null,i.length=g),i},r.define=i,n.exports}),e.register("npm:core-js@0.8.2/library/fn/promise",["npm:core-js@0.8.2/library/modules/es6.string.iterator","npm:core-js@0.8.2/library/modules/web.dom.iterable","npm:core-js@0.8.2/library/modules/es6.promise","npm:core-js@0.8.2/library/modules/$"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,require("npm:core-js@0.8.2/library/modules/es6.string.iterator"),require("npm:core-js@0.8.2/library/modules/web.dom.iterable"),require("npm:core-js@0.8.2/library/modules/es6.promise"),n.exports=require("npm:core-js@0.8.2/library/modules/$").core.Promise,r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/regenerator/index",["npm:babel-runtime@5.1.2/regenerator/runtime"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o="object"==typeof r?r:"object"==typeof window?window:this,a=Object.prototype.hasOwnProperty,s=a.call(o,"regeneratorRuntime"),u=s&&o.regeneratorRuntime;return delete o.regeneratorRuntime,n.exports=require("npm:babel-runtime@5.1.2/regenerator/runtime"),s?o.regeneratorRuntime=u:delete o.regeneratorRuntime,n.exports={"default":n.exports,__esModule:!0},r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/array/from/index",["npm:es5-ext@0.10.6/array/from/is-implemented","npm:es5-ext@0.10.6/array/from/shim"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:es5-ext@0.10.6/array/from/is-implemented")()?Array.from:require("npm:es5-ext@0.10.6/array/from/shim"),r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/core-js/promise",["npm:core-js@0.8.2/library/fn/promise"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports={"default":require("npm:core-js@0.8.2/library/fn/promise"),__esModule:!0},r.define=i,n.exports}),e.register("npm:babel-runtime@5.1.2/regenerator",["npm:babel-runtime@5.1.2/regenerator/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:babel-runtime@5.1.2/regenerator/index"),r.define=i,n.exports}),e.register("npm:es5-ext@0.10.6/array/to-array",["npm:es5-ext@0.10.6/array/from/index"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/array/from/index"),a=Array.isArray;return n.exports=function(e){return a(e)?e:o(e)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/resolve-resolve",["npm:es5-ext@0.10.6/array/to-array","npm:es5-ext@0.10.6/object/valid-callable"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o,a=require("npm:es5-ext@0.10.6/array/to-array"),s=require("npm:es5-ext@0.10.6/object/valid-callable"),u=Array.prototype.slice;return o=function(e){return this.map(function(t,n){return t?t(e[n]):e[n]}).concat(u.call(e,this.length))},n.exports=function(e){return e=a(e),e.forEach(function(e){null!=e&&s(e)}),o.bind(e)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/lib/configure-map",["npm:es5-ext@0.10.6/error/custom","npm:es5-ext@0.10.6/function/_define-length","npm:d@0.1.1","npm:event-emitter@0.3.3","npm:memoizee@0.3.8/lib/resolve-resolve","npm:memoizee@0.3.8/lib/resolve-normalize"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/error/custom"),a=require("npm:es5-ext@0.10.6/function/_define-length"),s=require("npm:d@0.1.1"),u=require("npm:event-emitter@0.3.3").methods,c=require("npm:memoizee@0.3.8/lib/resolve-resolve"),l=require("npm:memoizee@0.3.8/lib/resolve-normalize"),f=Function.prototype.apply,m=Function.prototype.call,p=Object.create,d=Object.prototype.hasOwnProperty,h=Object.defineProperties,g=u.on,b=u.emit;return n.exports=function(e,t,n){var r,i,u,v,y,x,w,j,E,T,_,A,M,S=p(null);return i=t!==!1?t:isNaN(e.length)?1:e.length,n.normalizer&&(j=l(n.normalizer),u=j.get,v=j.set,y=j["delete"],x=j.clear),null!=n.resolvers&&(M=c(n.resolvers)),A=u?a(function(t){var n,i,a=arguments;if(M&&(a=M(a)),n=u(a),null!==n&&d.call(S,n))return E&&r.emit("get",n,a,this),S[n];if(i=1===a.length?m.call(e,this,t):f.call(e,this,a),null===n){if(n=u(a),null!==n)throw o("Circular invocation","CIRCULAR_INVOCATION");n=v(a)}else if(d.call(S,n))throw o("Circular invocation","CIRCULAR_INVOCATION");return S[n]=i,T&&r.emit("set",n),i},i):0===t?function(){var t;if(d.call(S,"data"))return E&&r.emit("get","data",arguments,this),S.data;if(t=arguments.length?f.call(e,this,arguments):m.call(e,this),d.call(S,"data"))throw o("Circular invocation","CIRCULAR_INVOCATION");return S.data=t,T&&r.emit("set","data"),t}:function(t){var n,i,a=arguments;if(M&&(a=M(arguments)),i=String(a[0]),d.call(S,i))return E&&r.emit("get",i,a,this),S[i];if(n=1===a.length?m.call(e,this,a[0]):f.call(e,this,a),d.call(S,i))throw o("Circular invocation","CIRCULAR_INVOCATION");return S[i]=n,T&&r.emit("set",i),n},r={original:e,memoized:A,get:function(e){return M&&(e=M(e)),u?u(e):String(e[0])},has:function(e){return d.call(S,e)},"delete":function(e){var t;d.call(S,e)&&(y&&y(e),t=S[e],delete S[e],_&&r.emit("delete",e,t))},clear:function(){var e=S;x&&x(),S=p(null),r.emit("clear",e)},on:function(e,t){return"get"===e?E=!0:"set"===e?T=!0:"delete"===e&&(_=!0),g.call(this,e,t)},emit:b,updateEnv:function(){e=r.original}},w=u?a(function(e){var t,n=arguments;M&&(n=M(n)),t=u(n),null!==t&&r["delete"](t)},i):0===t?function(){return r["delete"]("data")}:function(e){return M&&(e=M(arguments)[0]),r["delete"](e)},h(A,{__memoized__:s(!0),"delete":s(w),clear:s(r.clear)}),r},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/plain",["npm:es5-ext@0.10.6/object/valid-callable","npm:es5-ext@0.10.6/object/for-each","npm:memoizee@0.3.8/lib/registered-extensions","npm:memoizee@0.3.8/lib/configure-map","npm:memoizee@0.3.8/lib/resolve-length"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/valid-callable"),a=require("npm:es5-ext@0.10.6/object/for-each"),s=require("npm:memoizee@0.3.8/lib/registered-extensions"),u=require("npm:memoizee@0.3.8/lib/configure-map"),c=require("npm:memoizee@0.3.8/lib/resolve-length"),l=Object.prototype.hasOwnProperty;

return n.exports=function f(e){var t,n,r;return o(e),t=Object(arguments[1]),l.call(e,"__memoized__")&&!t.force?e:(n=c(t.length,e.length,t.async&&s.async),r=u(e,n,t),a(s,function(e,n){t[n]&&e(t[n],r,t)}),f.__profiler__&&f.__profiler__(r),r.updateEnv(),r.memoized)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8/index",["npm:es5-ext@0.10.6/object/normalize-options","npm:memoizee@0.3.8/lib/resolve-length","npm:memoizee@0.3.8/plain","npm:memoizee@0.3.8/normalizers/primitive","npm:memoizee@0.3.8/normalizers/get-primitive-fixed","npm:memoizee@0.3.8/normalizers/get","npm:memoizee@0.3.8/normalizers/get-1","npm:memoizee@0.3.8/normalizers/get-fixed","npm:memoizee@0.3.8/ext/async","npm:memoizee@0.3.8/ext/dispose","npm:memoizee@0.3.8/ext/max-age","npm:memoizee@0.3.8/ext/max","npm:memoizee@0.3.8/ext/ref-counter"],!0,function(require,t,n){var r=e.global,i=r.define;r.define=void 0;var o=require("npm:es5-ext@0.10.6/object/normalize-options"),a=require("npm:memoizee@0.3.8/lib/resolve-length"),s=require("npm:memoizee@0.3.8/plain");return n.exports=function(e){var t,n=o(arguments[1]);return n.normalizer||(t=n.length=a(n.length,e.length,n.async),0!==t&&(n.primitive?t===!1?n.normalizer=require("npm:memoizee@0.3.8/normalizers/primitive"):t>1&&(n.normalizer=require("npm:memoizee@0.3.8/normalizers/get-primitive-fixed")(t)):n.normalizer=t===!1?require("npm:memoizee@0.3.8/normalizers/get")():1===t?require("npm:memoizee@0.3.8/normalizers/get-1")():require("npm:memoizee@0.3.8/normalizers/get-fixed")(t))),n.async&&require("npm:memoizee@0.3.8/ext/async"),n.dispose&&require("npm:memoizee@0.3.8/ext/dispose"),n.maxAge&&require("npm:memoizee@0.3.8/ext/max-age"),n.max&&require("npm:memoizee@0.3.8/ext/max"),n.refCounter&&require("npm:memoizee@0.3.8/ext/ref-counter"),s(e,n)},r.define=i,n.exports}),e.register("npm:memoizee@0.3.8",["npm:memoizee@0.3.8/index"],!0,function(require,t,n){var r=e.global,i=r.define;return r.define=void 0,n.exports=require("npm:memoizee@0.3.8/index"),r.define=i,n.exports}),e.register("github:maxdavidson/tribus@master/webgl/buffer",["npm:babel-runtime@5.1.2/helpers/class-call-check"],function(e){var t,n,r;return{setters:[function(e){t=e["default"]}],execute:function(){"use strict";n=WebGLRenderingContext,r=function(){function e(r,i,o){var a=void 0===arguments[3]?{}:arguments[3],s=a.mode,u=void 0===s?n.STATIC_DRAW:s,c=a.size,l=void 0===c?3:c,f=a.bufferType,m=void 0===f?n.ARRAY_BUFFER:f,p=a.dataType,d=void 0===p?n.FLOAT:p;if(t(this,e),this.gl=r,this.vaoExtension=r.getExtension("OES_vertex_array_object"),void 0===this.vaoExtension)throw"Your browser's implementation of WebGL does not support Vertex Array Objects! Too bad!";this.vao=o,this.size=l,this.mode=u,this.bufferType=m,this.dataType=d,this.vbo=r.createBuffer(),this.data=null,this.updateData(i)}return e.prototype._executeBound=function(e){this.vaoExtension.bindVertexArrayOES(this.vao),this.gl.bindBuffer(this.bufferType,this.vbo),e(),this.vaoExtension.bindVertexArrayOES(null)},e.prototype.updateData=function(e){var t=this;this.data=e,this._executeBound(function(){t.gl.bufferData(t.bufferType,t.data,t.mode)})},e.prototype.updateSubData=function(e,t){var n=this;this.data.set(e,t),this._executeBound(function(){n.gl.bufferSubData(n.bufferType,e,n.mode)})},e.prototype.setAttribLocation=function(e,t){var n=this;t.gl!==this.gl&&console.error("Couldn't set attribute location: the program's WebGL context is not the same as the buffer's!");var r=t.getAttribLocation(e);-1===r&&console.error("Couldn't bind buffer to location: \""+e+'"'),this._executeBound(function(){n.gl.vertexAttribPointer(r,n.size,n.dataType,!1,0,0),n.gl.enableVertexAttribArray(r)})},e.prototype.destroy=function(){var e=this;this._executeBound(function(){e.gl.deleteBuffer(e.vbo)})},e}(),e("default",r)}}}),e.register("github:maxdavidson/tribus@master/extra/ajax",["npm:babel-runtime@5.1.2/core-js/promise"],function(e){function t(e){return i(e)}function n(e){return i(e,{responseType:"json"})}function r(e){return i(e,{responseType:"arraybuffer"})}function i(e){var t=void 0===arguments[1]?{}:arguments[1],n=t.responseType,r=void 0===n?"text":n,i=new XMLHttpRequest;return new o(function(t,n){i.open("GET",e),i.responseType=r,i.onload=function(){200==i.status?t(i.response):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()})}var o;return{setters:[function(e){o=e["default"]}],execute:function(){"use strict";e("getString",t),e("getJson",n),e("getArrayBuffer",r),e("ajax",i)}}}),e.register("github:maxdavidson/tribus@master/extra/functional",["npm:babel-runtime@5.1.2/helpers/bind"],function(e){var t,n,r;return{setters:[function(e){t=e["default"]}],execute:function(){"use strict";n=function(e){return function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];return new(t.apply(e,[null].concat(r)))}},e("construct",n),r=function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return e.apply(void 0,n).apply(void 0,n)}},e("delegate",r)}}}),e.register("github:maxdavidson/tribus@master/workers/worker-pool",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/map","npm:babel-runtime@5.1.2/core-js/promise","npm:babel-runtime@5.1.2/core-js/get-iterator","npm:babel-runtime@5.1.2/core-js/object/keys"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]}],execute:function(){"use strict";a=0,s=0,u=function(){function e(r){var i=void 0===arguments[1]?{}:arguments[1],o=i.poolSize,a=void 0===o?2:o,s=i.spawnLazily,u=void 0===s?!0:s,c=i.timeout,l=void 0===c?5:c;if(t(this,e),this._workerState=new n,this._timeout=l,this._sourceURL=r,this.poolSize=a,this._completers=new n,this._taskQueue=[],!u)for(var f=0;a>f;++f)this.spawnWorker()}return e.prototype._grabWork=function(e){var t=this._workerState.get(e);window.clearTimeout(t.timeout),t.ready=!1;var n=this._taskQueue.shift(),r=n.id,i=n.message,o=n.transfers;e.postMessage({id:r,message:i},o)},e.prototype.spawnWorker=function(){var e=this;if(this._workerState.size<this.poolSize){var t=function(){var t=new Worker(e._sourceURL),n=e,r=function(e){{var r=e.data,o=r.id,a=r.message,s=n._workerState.get(t),u=n._completers.get(o),c=u.resolve;u.reject}c(a),n._completers["delete"](o),s.ready=!0,s.timeout=i(),0!==n._taskQueue.length&&n._grabWork(t)},i=function(){return window.setTimeout(function(){n._workerState["delete"](t),t.removeEventListener("message",r,!1),t.terminate()},1e3*n._timeout)};return t.addEventListener("message",r,!1),e._workerState.set(t,{ready:!0,timeout:i(),id:++a}),{v:t}}();if("object"==typeof t)return t.v}},e.prototype.run=function(e){var t=this,n=void 0===arguments[1]?{}:arguments[1],o=n.transfers,a=++s;return new r(function(n,r){t._completers.set(a,{resolve:n,reject:r}),t._taskQueue.push({id:a,message:e,transfers:o});for(var s=void 0,u=t._workerState.entries(),c=Array.isArray(u),l=0,u=c?u:i(u);;){var f;if(c){if(l>=u.length)break;f=u[l++]}else{if(l=u.next(),l.done)break;f=l.value}var m=f[0],p=f[1];if(p.ready){s=m;break}}void 0===s&&(s=t.spawnWorker()),void 0!==s&&t._grabWork(s)})},e.fromFunction=function(t){for(var n=void 0===arguments[1]?[]:arguments[1],r=void 0===arguments[2]?{}:arguments[2],a={location:window.location},s=0;s<n.length;++s)switch(typeof n[s]){case"function":n[s]=n[s].toString();break;case"object":for(var u=o(n[s]),c=Array.isArray(u),l=0,u=c?u:i(u);;){var f;if(c){if(l>=u.length)break;f=u[l++]}else{if(l=u.next(),l.done)break;f=l.value}var m=f;a[m]=n[s][m]}}var p=o(a).map(function(e){return"var "+e+" = "+JSON.stringify(a[e])+";"}),d="self.onmessage = function(event) {\n                ("+t.toString()+")(event.data.message, function resolve(message, transfers) {\n                    self.postMessage({ id: event.data.id, message: message }, transfers);\n                });\n            };",h=new Blob([[].concat(p,n,[d]).join(";\n")],{type:"application/javascript"}),g=window.URL.createObjectURL(h);return new e(g,r)},e}(),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/extra/errors",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check"],function(e){var t,n,r,i;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=function(e){function i(){var t=void 0===arguments[0]?"Method not implemented!":arguments[0];r(this,i),e.call(this,t)}return t(i,e),n(i,[{key:"name",get:function(){return"UnimplementedMethod"}}]),i}(Error),e("UnimplementedMethodError",i)}}}),e.register("github:maxdavidson/tribus@master/light/base",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/weak-map","github:maxdavidson/tribus@master/scene/base","npm:memoizee@0.3.8","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a,s,u,c;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]}],execute:function(){"use strict";s=function(e){function r(t,i){var s=this,u=void 0===arguments[2]?{}:arguments[2];n(this,r),e.call(this,t,u);var c=u.diffuse,l=void 0===c?a.vec3.fromValues(1,1,1):c,f=u.specular,m=void 0===f?l:f;this.diffuse=l,this.specular=m,this.getRenderer=o(function(e){return new i(s,e)})}return t(r,e),r}(i),e("Light",s),u=new r,c=function(){function e(t,r){n(this,e),this.light=t,this.gl=r,this.id=e.allocateLight(t.constructor),this.getLocations=o(this.getLocations.bind(this))}return e.allocateLight=function(e){var t=u.get(e)||0;return u.set(e,t+1),t},e.prototype.getLocations=function(e){},e.prototype.render=function(){},e}(),e("LightRenderer",c)}}}),e.register("github:maxdavidson/tribus@master/scene/group",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/helpers/bind","npm:babel-runtime@5.1.2/core-js/get-iterator","npm:babel-runtime@5.1.2/core-js/symbol/iterator","npm:babel-runtime@5.1.2/regenerator","github:maxdavidson/tribus@master/scene/base"],function(e){function t(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(o.apply(l,[null].concat(t)))}var n,r,i,o,a,s,u,c,l;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]}],execute:function(){"use strict";e("group",t),l=function(e){function t(n){var r=void 0===arguments[1]?{}:arguments[1],o=void 0===arguments[2]?[]:arguments[2];i(this,t),e.call(this,n,r),this.__initializeProperties();for(var s=o,u=Array.isArray(s),c=0,s=u?s:a(s);;){var l;if(u){if(c>=s.length)break;l=s[c++]}else{if(c=s.next(),c.done)break;l=c.value}var f=l;this.add(f)}}return n(t,e),t.prototype.forEach=function(e){e(this);for(var t=this.children,n=0,r=t.length;r>n;++n)t[n].forEach(e)},t.prototype.recalculate=function(t){e.prototype.recalculate.call(this,t);for(var n=this.children,r=0,i=n.length;i>r;++r)n[r].recalculate(t)},t.prototype.add=function(e){e.parent=this,this.children.push(e),this.trigger("didAddNode",{bubble:!0},e)},t.prototype.remove=function(e){e.parent=null,this.trigger("didRemoveNode",{bubble:!0},e)},t.prototype.__initializeProperties=function(){this.children=[]},r(t,[{key:"children",value:void 0,enumerable:!0}]),t}(c),e("default",l),l.prototype[s]=u.mark(function o(){var e,t,n,r,i;return u.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this;case 2:e=this.children,t=Array.isArray(e),n=0,e=t?e:a(e);case 3:if(!t){o.next=9;break}if(!(n>=e.length)){o.next=6;break}return o.abrupt("break",17);case 6:r=e[n++],o.next=13;break;case 9:if(n=e.next(),!n.done){o.next=12;break}return o.abrupt("break",17);case 12:r=n.value;case 13:return i=r,o.delegateYield(i,"t3",15);case 15:o.next=3;break;case 17:case"end":return o.stop()}},o,this)})}}}),e.register("github:maxdavidson/tribus@master/camera/base",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/scene/base"],function(e){var t,n,r,i,o,a,s;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]}],execute:function(){"use strict";a=i.mat4,s=function(e){function i(){var t=void 0===arguments[0]?{}:arguments[0];r(this,i),e.call(this,"camera",t),this.mvpMatrix=a.create(),this.projectionMatrix=a.create(),this.viewMatrix=a.create(),this.cameraMatrix=a.create()}return t(i,e),i.prototype.recalculate=function(){e.prototype.recalculate.call(this),a.invert(this.viewMatrix,this.worldTransform),a.multiply(this.cameraMatrix,this.projectionMatrix,this.viewMatrix)},i.prototype.calculateMvpMatrix=function(e){return a.multiply(this.mvpMatrix,this.cameraMatrix,e.worldTransform)},i.prototype.canSee=function(e){return!0},n(i,[{key:"mvpMatrix",value:void 0,enumerable:!0},{key:"projectionMatrix",value:void 0,enumerable:!0},{key:"viewMatrix",value:void 0,enumerable:!0},{key:"cameraMatrix",value:void 0,enumerable:!0}]),i}(o),e("default",s)}}}),e.register("github:maxdavidson/tribus@master/texture/cubemap",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/helpers/bind","npm:babel-runtime@5.1.2/core-js/promise","github:maxdavidson/tribus@master/texture/common"],function(e){var t,n,r,i,o;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e.getImage}],execute:function(){"use strict";o=function(){function e(n,r,i,o,a,s){t(this,e),this.right=n,this.left=r,this.top=i,this.bottom=o,this.front=a,this.back=s}return e.fromFiles=function(t,r,o,a,s,u,c){return Promise.all([t,r,o,a,s,u].map(function(e){return i(e,c)})).then(function(t){return new(n.apply(e,[null].concat(t)))})},e}(),e("default",o)}}}),e.register("github:maxdavidson/tribus@master/geometry/shapes",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/helpers/create-class","github:maxdavidson/tribus@master/geometry/geometry","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a,s,u,c,l,f;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]}],execute:function(){"use strict";a=o.vec3,s=o.mat4,u=a.create(),c=s.create(),l=function(e){function r(){n(this,r);var t=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,-1];e.call(this,{vertices:t.map(function(e){return.5*e}),normals:t.map(function(e){return Math.sqrt(3)/3*e}),texcoords:[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,0,0,1,1,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,1,9,8,9,10,11,12,13,11,13,14,15,16,2,15,2,17,15,18,19,15,19,10]})}return t(r,e),r}(i),e("Cube",l),f=function(e){function i(){var t=void 0===arguments[0]?{}:arguments[0],r=t.size,o=void 0===r?8:r,a=t.heightmap,s=void 0===a?null:a;n(this,i);var u=null,c=void 0,l=void 0;null===s?(c=o,l=o):(c=s.width,l=s.height,u=s.imageData.data);var f=c*l,m=(c-1)*l*2,p=new Float32Array(3*f),d=new Float32Array(2*f),h=new Uint16Array(3*m),g=void 0,b=void 0,v=void 0;for(g=0;c>g;++g)for(b=0;l>b;++b)v=g+b*c,p[3*v+0]=g/(c-1)-.5,p[3*v+1]=null!==u?u[4*v]/255:0,p[3*v+2]=b/(l-1)-.5,d[2*v+0]=g/c,d[2*v+1]=1-b/l;for(g=0;c-1>g;++g)for(b=0;l-1>b;++b)v=6*(g+b*(c-1)),h[v+0]=g+b*c,h[v+1]=g+(b+1)*c,h[v+2]=g+1+b*c,h[v+3]=g+1+b*c,h[v+4]=g+(b+1)*c,h[v+5]=g+1+(b+1)*c;e.call(this,{vertices:p,texcoords:d,indices:h}),this.heightmap=s}return t(i,e),i.prototype.getHeightAtWorldPosition=function(e,t){var n=this,r=a.transformMat4(u,e.worldPosition,s.invert(c,t.worldTransform));null===this.heightmap?r[1]=0:!function(){var e=function(e,t,n){return Math.min(Math.max(e,t),n)},t=n.heightmap.imageData.width,i=n.heightmap.imageData.height,o=e(t*(r[0]+.5),0,t-1),a=e(i*(r[2]+.5),0,i-1),s=Math.floor(o),u=Math.ceil(o),c=Math.floor(a),l=(Math.ceil(a),function(e,r){return n.heightmap.imageData.data[4*(e+r*t)]/256}),f=function(e,t,n){return e+n*(t-e)};r[1]=f(l(s,c),l(u,c),o%1)}();var i=a.transformMat4(u,r,t.worldTransform);return i[1]},r(i,[{key:"heightmap",enumerable:!0}]),i}(i),e("Plane",f)}}}),e.register("github:maxdavidson/tribus@master/light/directional-light",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/object/freeze","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base"],function(e){var t,n,r,i,o,a,s,u,c,l,f;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.construct},function(e){s=e.Light,u=e.LightRenderer}],execute:function(){"use strict";c=function(e){return"number"==typeof e?i.vec3.fromValues(e,e,e):i.vec3.clone(e)},l=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,"directional-light",f,t)}return t(r,e),r}(s),e("default",l),f=function(e){function i(t,r){n(this,i),e.call(this,t,r)}return t(i,e),i.prototype.getLocations=function(e){return r({enabled:e.getUniformLocation("directionalLights["+this.id+"].enabled"),direction:e.getUniformLocation("directionalLights["+this.id+"].direction"),diffuse:e.getUniformLocation("directionalLights["+this.id+"].diffuse"),specular:e.getUniformLocation("directionalLights["+this.id+"].specular")})},i.prototype.render=function(e){var t=this.gl,n=this.light,r=this.getLocations(e);t.uniform1i(r.enabled,!0),t.uniform3fv(r.direction,n.direction),t.uniform3fv(r.diffuse,c(n.diffuse)),t.uniform3fv(r.specular,c(n.specular))},i}(u)}}}),e.register("github:maxdavidson/tribus@master/light/pointlight",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/object/freeze","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e.construct},function(e){o=e.Light,a=e.LightRenderer},function(e){s=e["default"]},function(e){u=e["default"]}],execute:function(){"use strict";c=s.vec3,l=c.create(),f=function(e){return"number"==typeof e?c.set(l,e,e,e):c.copy(l,e)},m=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,"pointlight",p,t);var i=t.constant,o=void 0===i?1:i,a=t.linear,s=void 0===a?.7:a,u=t.quadratic,c=void 0===u?1.8:u;this.constant=o,this.linear=s,this.quadratic=c}return t(r,e),r}(o),e("default",m),p=function(e){function i(t,r){n(this,i),e.call(this,t,r)}return t(i,e),i.prototype.getLocations=function(e){return r({enabled:e.getUniformLocation("pointLights["+this.id+"].enabled"),position:e.getUniformLocation("pointLights["+this.id+"].position"),diffuse:e.getUniformLocation("pointLights["+this.id+"].diffuse"),specular:e.getUniformLocation("pointLights["+this.id+"].specular"),constant:e.getUniformLocation("pointLights["+this.id+"].constant"),linear:e.getUniformLocation("pointLights["+this.id+"].linear"),quadratic:e.getUniformLocation("pointLights["+this.id+"].quadratic")})},i.prototype.render=function(e){var t=this.gl,n=this.light,r=this.getLocations(e);t.uniform1i(r.enabled,!0),t.uniform3fv(r.position,n.worldPosition),t.uniform3fv(r.diffuse,f(n.diffuse)),t.uniform3fv(r.specular,f(n.specular)),t.uniform1f(r.constant,n.constant),t.uniform1f(r.linear,n.linear),t.uniform1f(r.quadratic,n.quadratic)},i}(a)}}}),e.register("github:maxdavidson/tribus@master/light/spotlight",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/object/freeze","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/light/base","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e.construct},function(e){o=e.Light,a=e.LightRenderer},function(e){s=e["default"]},function(e){u=e["default"]}],execute:function(){"use strict";c=s.vec3,l=function(e){return"number"==typeof e?c.fromValues(e,e,e):c.clone(e)},f=Math.PI/180,m=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,"spotlight",p,t);var i=t.constant,o=void 0===i?1:i,a=t.linear,s=void 0===a?.7:a,u=t.quadratic,c=void 0===u?1.8:u,l=t.cutoff,f=void 0===l?40:l,m=t.outerCutoff,d=void 0===m?35:m;this.constant=o,this.linear=s,this.quadratic=c,this.cutoff=f,this.outerCutoff=d}return t(r,e),r}(o),e("default",m),p=function(e){function i(t,r){n(this,i),e.call(this,t,r)}return t(i,e),i.prototype.getLocations=function(e){return r({enabled:e.getUniformLocation("spotLights["+this.id+"].enabled"),position:e.getUniformLocation("spotLights["+this.id+"].position"),direction:e.getUniformLocation("spotLights["+this.id+"].direction"),diffuse:e.getUniformLocation("spotLights["+this.id+"].diffuse"),specular:e.getUniformLocation("spotLights["+this.id+"].specular"),constant:e.getUniformLocation("spotLights["+this.id+"].constant"),linear:e.getUniformLocation("spotLights["+this.id+"].linear"),quadratic:e.getUniformLocation("spotLights["+this.id+"].quadratic"),cutoff:e.getUniformLocation("spotLights["+this.id+"].cutoff"),outerCutoff:e.getUniformLocation("spotLights["+this.id+"].outerCutoff")})},i.prototype.render=function(e){var t=this.gl,n=this.light,r=this.getLocations(e);t.uniform1i(r.enabled,!0),t.uniform3fv(r.position,n.worldPosition),t.uniform3fv(r.direction,n.worldDirection),t.uniform3fv(r.diffuse,l(n.diffuse)),t.uniform3fv(r.specular,l(n.specular)),t.uniform1f(r.constant,n.constant),t.uniform1f(r.linear,n.linear),t.uniform1f(r.quadratic,n.quadratic),t.uniform1f(r.cutoff,n.cutoff*f),t.uniform1f(r.outerCutoff,n.outerCutoff*f)},i}(a)}}}),e.register("github:maxdavidson/tribus@master/camera/orthographic-camera",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","github:maxdavidson/tribus@master/camera/base","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]}],execute:function(){"use strict";o=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,t);var i=t.left,o=void 0===i?-1:i,a=t.right,s=void 0===a?1:a,u=t.bottom,c=void 0===u?-1:u,l=t.top,f=void 0===l?1:l,m=t.near,p=void 0===m?.1:m,d=t.far,h=void 0===d?1e3:d;this.left=o,this.right=s,this.bottom=c,this.top=f,this.near=p,this.far=h}return t(r,e),r.prototype.recalculate=function(){i.mat4.ortho(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far),e.prototype.recalculate.call(this)},r}(r),e("default",o)}}}),e.register("github:maxdavidson/tribus@master/webgl/shader",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/promise","github:maxdavidson/tribus@master/extra/ajax"],function(e){var t,n,r,i,o;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e.getString}],execute:function(){"use strict";i=WebGLRenderingContext,o=function(){function e(n,r,i){t(this,e),this.gl=n,this.type=i,this.handle=n.createShader(i),n.shaderSource(this.handle,r),n.compileShader(this.handle);var o=this.getInfoLog();""!==o&&console.error(o)}return e.prototype.getInfoLog=function(){return this.gl.getShaderInfoLog(this.handle)},e.prototype.getSource=function(){return this.gl.getShaderSource(this.handle)},e.prototype.getTranslatedSource=function(){return this.gl.getExtension("WEBGL_debug_shaders").getTranslatedShaderSource(this.handle)},e.fromFile=function(t,n){var o={vert:i.VERTEX_SHADER,frag:i.FRAGMENT_SHADER}[n.split(".").pop()];return r(n).then(function(n){return new e(t,n,o)})},e}(),e("default",o)}}}),e.register("github:maxdavidson/tribus@master/workers/wavefront",["github:maxdavidson/tribus@master/workers/worker-pool"],function(e){function t(e,t){var n="Parsing OBJ file";console.time(n);for(var r,i,o,a,s,u={v:[],vt:[],vn:[],i:[]},c=new Uint8Array(e),l=[],f=c.length,m=0;f>m;){switch(i=c[m++],i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r=i;break;case 12:case 13:o=c[m++],r=(31&i)<<6|63&o;break;case 14:o=c[m++],a=c[m++],r=(15&i)<<12|(63&o)<<6|(63&a)<<0}if(10===r){var p=String.fromCharCode.apply(void 0,l).trim().split(/\s+/),d=p[0],h=p.slice(1);switch(d){case"v":case"vn":case"vt":Array.prototype.push.apply(u[d],h.map(parseFloat));break;case"f":var g=h.map(function(e){return e.split("/").map(function(e,t){return e=parseInt(e),0>e?e+u[["v","vt","vn"][t]].length:e-1})});if(g.length<3)for(var b=g.length;3>=b;++b)g[b]=g[g.length-1];for(var b=1,v=g.length;v-1>b;++b)u.i.push(g[0],g[b],g[b+1])}l=[]}else l.push(r)}var y={},x=0,w=[],j=[],E=[],T=[];for(m=0,f=u.i.length;f>m;m+=3)for(var b=0;3>b;++b){var _=u.i[m+b],A=_[0],M=_[1],S=_[2],k=_.join(":"),D=y[k];void 0===D&&(D=y[k]=x++,j.push(A),void 0!==M&&E.push(M),void 0!==S&&T.push(S)),w.push(D)}var g=new Uint16Array(w),O=new Float32Array(3*j.length),L=new Float32Array(3*T.length),R=new Float32Array(2*E.length);for(m=0,f=j.length;f>m;++m){s=3*m;var I=3*j[m];O[s]=u.v[I],O[s+1]=u.v[I+1],O[s+2]=u.v[I+2]}for(m=0,f=T.length;f>m;++m){s=3*m;var C=3*T[m];L[s]=u.vn[C],L[s+1]=u.vn[C+1],L[s+2]=u.vn[C+2]}for(m=0,f=E.length;f>m;++m){s=2*m;var z=2*E[m];R[s]=u.vt[z],R[s+1]=u.vt[z+1]}console.timeEnd(n),t({indices:g,vertices:O,normals:L,texcoords:R},[g.buffer,O.buffer,L.buffer,R.buffer])}var n,r;return{setters:[function(e){n=e["default"]}],execute:function(){"use strict";r=n.fromFunction(t),e("workerpool",r)}}}),e.register("github:maxdavidson/tribus@master/workers/normal-vectors",["github:maxdavidson/tribus@master/workers/worker-pool","github:toji/gl-matrix@2.2.1/src/gl-matrix/vec3.js!github:systemjs/plugin-text@0.0.2"],function(e){function t(e,t){console.time("Calculating normals");for(var n=e.vertices,r=e.indices,i=new Float32Array(n.length),o=new Array(n.length/3),a=new Float32Array(r.length),s=0,u=o.length;u>s;++s)o[s]=[];for(var c=0,u=r.length;u>c;c+=3){var l=r[c],f=r[c+1],m=r[c+2],p=3*l,d=3*f,h=3*m,g=vec3.set(tmp0,n[p],n[p+1],n[p+2]),b=vec3.set(tmp1,n[d],n[d+1],n[d+2]),v=vec3.set(tmp2,n[h],n[h+1],n[h+2]);o[l].push(c),o[f].push(c),o[m].push(c);var y=vec3.cross(tmp0,vec3.subtract(tmp1,b,g),vec3.subtract(tmp2,v,g));a[c]=y[0],a[c+1]=y[1],a[c+2]=y[2]}for(var x=0,w=o.length;w>x;++x){for(var j=vec3.set(tmp0,0,0,0),E=o[x],T=0,_=E.length;_>T;++T){var A=E[T];j[0]+=a[A],j[1]+=a[A+1],j[2]+=a[A+2]}vec3.normalize(j,j);var c=3*x;i[c]=j[0],i[c+1]=j[1],i[c+2]=j[2]}console.timeEnd("Calculating normals"),t({indices:r,vertices:n,normals:i},[r.buffer,n.buffer,i.buffer])}var n,r,i;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=n.fromFunction(t,["var GLMAT_ARRAY_TYPE = Float32Array;",r,"var tmp0 = vec3.create(), tmp1 = vec3.create(), tmp2 = vec3.create();"]),e("workerpool",i)}}}),e.register("github:maxdavidson/tribus@master/material/base",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/map","github:maxdavidson/tribus@master/extra/errors"],function(e){var t,n,r,i,o,a,s;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e.UnimplementedMethodError}],execute:function(){"use strict";i=WebGLRenderingContext,o=new n,a=function(){function e(){var n=void 0===arguments[0]?1:arguments[0];t(this,e),this.priority=n}return e.prototype.getRenderer=function(e){throw new r},e}(),e("Material",a),s=function(){function e(n,r){t(this,e),this.material=n,this.program=r}return e.allocateTextureUnit=function(e){var t=o.get(e)||0;return o.set(e,t+1),t},e.prototype.didInitGeometry=function(e){},e.prototype.willDraw=function(e,t){},e.prototype.draw=function(e,t){},e.prototype.didDraw=function(){},e}(),e("MaterialRenderer",s)}}}),e.register("github:maxdavidson/tribus@master/workers/tga",["github:maxdavidson/tribus@master/workers/worker-pool","github:maxdavidson/jsTGALoader@master/tga.js!github:systemjs/plugin-text@0.0.2"],function(e){function t(e,t){var n=new TGA;n.load(new Uint8Array(e));var r=n.getImageData(),i=r.data.buffer;t({buffer:i,height:r.height,width:r.width},[i])}var n,r,i;return{setters:[function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=n.fromFunction(t,[r]),e("workerpool",i)}}}),e.register("github:maxdavidson/tribus@master/camera/perspective-camera",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","github:maxdavidson/tribus@master/camera/base","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]}],execute:function(){"use strict";o=Math.PI/180,a=function(e){function r(){var t=void 0===arguments[0]?{}:arguments[0];n(this,r),e.call(this,t);var i=t.fov,o=void 0===i?60:i,a=t.aspect,s=void 0===a?4/3:a,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?100:l;this.fov=o,this.aspect=s,this.near=c,this.far=f}return t(r,e),r.prototype.recalculate=function(){i.mat4.perspective(this.projectionMatrix,this.fov*o,this.aspect,this.near,this.far),e.prototype.recalculate.call(this)},r}(r),e("default",a)}}}),e.register("github:maxdavidson/tribus@master/material/skybox",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/helpers/create-class","npm:memoizee@0.3.8","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/material/shaders/skybox.vert!github:systemjs/plugin-text@0.0.2","github:maxdavidson/tribus@master/material/shaders/skybox.frag!github:systemjs/plugin-text@0.0.2"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h,g,b;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.Material,s=e.MaterialRenderer},function(e){u=e["default"]},function(e){c=e.construct},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e["default"]},function(e){p=e["default"]}],execute:function(){"use strict";d=o.mat4,h=WebGLRenderingContext,g=function(e){function r(t){n(this,r),e.call(this,1/0),this.cubemap=t}return t(r,e),r.prototype.getRenderer=function(e){return b.create(this,e)},r}(a),e("default",g),b=function(e){function o(t,r){n(this,o),e.call(this,t,o.createProgram(r)),this.locations={},this.cameraMatrix=d.create(),this.unit=s.allocateTextureUnit(r),this.handle=r.createTexture(),r.activeTexture(h.TEXTURE0+this.unit),r.bindTexture(h.TEXTURE_CUBE_MAP,this.handle),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MAG_FILTER,h.LINEAR),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),r.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),r.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,t.cubemap.right),r.texImage2D(h.TEXTURE_CUBE_MAP_NEGATIVE_X,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,t.cubemap.left),
r.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_Y,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,t.cubemap.top),r.texImage2D(h.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,t.cubemap.bottom),r.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_Z,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,t.cubemap.back),r.texImage2D(h.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,t.cubemap.front),r.generateMipmap(h.TEXTURE_CUBE_MAP),r.bindTexture(h.TEXTURE_CUBE_MAP,null)}return t(o,e),o.prototype.didInitGeometry=function(e){var t=this.program,n=this.locations;n.sampler=t.getUniformLocation("skybox"),n.cameraMatrix=t.getUniformLocation("cameraMatrix"),e.vertexBuffer.setAttribLocation("vertex",t)},o.prototype.willDraw=function(e,t){var n=this.program.gl;n.depthMask(!1),n.disable(h.CULL_FACE),n.uniform1i(this.locations.sampler,this.unit),n.activeTexture(h.TEXTURE0+this.unit),n.bindTexture(h.TEXTURE_CUBE_MAP,this.handle)},o.prototype.draw=function(e,t){var n=this.program.gl,r=this.cameraMatrix;d.copy(r,e.viewMatrix),r[12]=0,r[13]=0,r[14]=0,d.multiply(r,e.projectionMatrix,r),n.uniformMatrix4fv(this.locations.cameraMatrix,!1,r)},o.prototype.didDraw=function(){var e=this.program.gl;e.depthMask(!0),e.enable(h.CULL_FACE)},r(o,[{key:"locations",value:void 0,enumerable:!0},{key:"cameraMatrix",value:void 0,enumerable:!0}],[{key:"create",value:i(c(o),{length:2}),enumerable:!0},{key:"createProgram",value:i(function(e){return new l(e,new f(e,m,h.VERTEX_SHADER),new f(e,p,h.FRAGMENT_SHADER))}),enumerable:!0}]),o}(s)}}}),e.register("github:maxdavidson/tribus@master/webgl/program",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/helpers/bind","npm:babel-runtime@5.1.2/core-js/map","npm:babel-runtime@5.1.2/core-js/promise","github:maxdavidson/tribus@master/webgl/shader"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]}],execute:function(){"use strict";a=WebGLRenderingContext,s={35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT"},u=function(){function e(n){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;i>s;s++)o[s-1]=arguments[s];if(t(this,e),this.gl=n,this.handle=n.createProgram(),this.vertexShader=o.filter(function(e){return e.type===a.VERTEX_SHADER})[0]||null,this.fragmentShader=o.filter(function(e){return e.type===a.FRAGMENT_SHADER})[0]||null,this._attribLocationCache=new r,this._uniformLocationCache=new r,[this.vertexShader,this.fragmentShader].some(function(e){return null===e}))throw"You need to supply both a vertex and a fragment shader!";n.attachShader(this.handle,this.vertexShader.handle),n.attachShader(this.handle,this.fragmentShader.handle),n.linkProgram(this.handle);var u=this.getInfoLog();""!==u&&console.error(u)}return e.prototype.use=function(){this.gl.useProgram(this.handle)},e.prototype.getUniformLocation=function(e){var t=this._uniformLocationCache.get(e);return void 0===t&&(t=this.gl.getUniformLocation(this.handle,e),null===t&&console.error("Couldn't get uniform location: "+e),this._uniformLocationCache.set(e,t)),t},e.prototype.getAttribLocation=function(e){var t=this._attribLocationCache.get(e);return void 0===t&&(t=this.gl.getAttribLocation(this.handle,e),null===t&&console.error("Couldn't get attribute location: "+e),this._attribLocationCache.set(e,t)),t},e.prototype.getInfoLog=function(){return this.gl.getProgramInfoLog(this.handle)},e.prototype.getActiveUniforms=function(){for(var e=[],t=0;t<this.gl.getProgramParameter(this.handle,a.ACTIVE_UNIFORMS);++t){var n=this.gl.getActiveUniform(this.handle,t);n.typeName=s[n.type],n.value=this.gl.getUniform(this.handle,this.gl.getUniformLocation(this.handle,n.name)),e.push(n)}return e},e.prototype.getActiveAttributes=function(){for(var e=[],t=0;t<this.gl.getProgramParameter(this.handle,a.ACTIVE_ATTRIBUTES);++t){var n=this.gl.getActiveAttrib(this.handle,t);n.typeName=s[n.type],e.push(n)}return e},e.fromShaderPromises=function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;r>o;o++)i[o-1]=arguments[o];return Promise.all(i).then(function(r){return new(n.apply(e,[null].concat([t],r)))})},e.fromShaderFiles=function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;n>i;i++)r[i-1]=arguments[i];return e.fromShaderPromises(t,r.map(function(e){return o.fromFile(t,e)}))},e.prototype.setUniform=function(e,t){this.gl.uniform1f(this.getUniformLocation(e),t)},e.prototype.setUniformInt=function(e,t){this.gl.uniform1i(this.getUniformLocation(e),t)},e.prototype.setUniformVector=function(e,t){var n=this.getUniformLocation(e);switch(t.length){case 1:this.gl.uniform1fv(n,t);break;case 2:this.gl.uniform2fv(n,t);break;case 3:this.gl.uniform3fv(n,t);break;case 4:this.gl.uniform4fv(n,t)}},e.prototype.setUniformIntVector=function(e,t){var n=this.getUniformLocation(e);switch(t.length){case 1:this.gl.uniform1iv(n,t);break;case 2:this.gl.uniform2iv(n,t);break;case 3:this.gl.uniform3iv(n,t);break;case 4:this.gl.uniform4iv(n,t)}},e.prototype.setUniformMatrix=function(e,t){var n=void 0===arguments[2]?!1:arguments[2],r=this.getUniformLocation(e);switch(t.length){case 4:this.gl.uniformMatrix2fv(r,n,t);break;case 9:this.gl.uniformMatrix3fv(r,n,t);break;case 16:this.gl.uniformMatrix4fv(r,n,t)}},e}(),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/texture/common",["npm:babel-runtime@5.1.2/core-js/promise","github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/workers/tga"],function(e){function t(e){var t=void 0===arguments[1]?e.split(".").pop():arguments[1];return function(){return function(){switch(t){case"tga":return r(e);default:return n(e)}}().then(function(e){var t=e.width,n=e.height;if(t!==n||t>1024||!s(t)||!s(n)){var r=document.createElement("canvas");r.width=t,r.height=n,r.getContext("2d").putImageData(e,0,0);var i=document.createElement("canvas"),o=Math.pow(2,Math.min(10,Math.ceil(Math.log(Math.max(t,n))/Math.log(2))));i.width=o,i.height=o;var a=i.getContext("2d");a.drawImage(r,0,0,o,o),e=a.getImageData(0,0,o,o)}return e})}()}function n(e){return new i(function(t,n){var r=document.createElement("img"),i=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height;var n=e.getContext("2d");n.drawImage(r,0,0);var i=n.getImageData(0,0,r.width,r.height);a(),t(i)},o=function(e){n(e),a()},a=function(){r.removeEventListener("load",i),r.removeEventListener("error",o)};r.addEventListener("error",o,!1),r.addEventListener("load",i,!1),r.src=e})}function r(e){return o(e).then(function(e){return a.run(e,{transfers:[e]})}).then(function(e){var t=e.buffer,n=e.width,r=e.height,i=new Uint8ClampedArray(t),o=void 0;try{o=new ImageData(i,n,r)}catch(a){var s=document.createElement("canvas");s.height=r,s.width=n,o=s.getContext("2d").createImageData(n,r),o.data=i}return o})}var i,o,a,s;return{setters:[function(e){i=e["default"]},function(e){o=e.getArrayBuffer},function(e){a=e.workerpool}],execute:function(){"use strict";e("getImage",t),s=function(e){return 0!=e&&!(e&e-1)}}}}),e.register("github:maxdavidson/tribus@master/control/mouseview",["npm:babel-runtime@5.1.2/helpers/class-call-check","github:baconjs/bacon.js@0.7.53","github:toji/gl-matrix@2.2.1"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]}],execute:function(){"use strict";i=r.vec3,o=r.mat4,a=r.quat,s=function(e){return function(t){return e===t}},u=function(){function e(r,i){function o(e){var t=void 0!==e.movementX?e.movementX:e.mozMovementX,n=void 0!==e.movementY?e.movementY:e.mozMovementY;A.pitch=Math.max(-90,Math.min(90,A.pitch+_*n)),A.yaw+=_*t,A.yaw=A.yaw%360}function a(){document.pointerLockElement===i||document.mozPointerLockElement===i?(console.log("The pointer lock status is now locked"),document.addEventListener("mousemove",o,!1)):(console.log("The pointer lock status is now unlocked"),document.removeEventListener("mousemove",o,!1))}var u=this,c=void 0===arguments[2]?function(){return 0}:arguments[2];t(this,e),this.target=r,this.yaw=0,this.pitch=0,this.roll=0,this.forward=0,this.sideways=0,this.turn=0,this.getHeight=c;var l=["keydown","keyup"].map(function(e){return n.fromEventTarget(document.body,e).map(function(e){return e.keyCode})}),f=l[0],m=l[1],p=function(e){return n.mergeAll(f.filter(s(e)).map(function(){return!0}),m.filter(s(e)).map(function(){return!1})).skipDuplicates().toProperty(!1)},d="WASDQE".split("").map(function(e){return e.charCodeAt(0)}).map(p),h=d[0],g=d[1],b=d[2],v=d[3],y=d[4],x=d[5],w=[[v,g],[b,h],[y,x]].map(function(e){var t=e[0],r=e[1];return n.combineWith(function(e,t){return e+t},t.map(function(e){return+e}),r.map(function(e){return-e}))}),j=w[0],E=w[1],T=w[2];j.onValue(function(e){u.sideways=e}),E.onValue(function(e){u.forward=e}),T.onValue(function(e){u.turn=e}),f.filter(s("F".charCodeAt(0))).onValue(function(e){i.requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}),i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock,i.addEventListener("click",function(){i.requestPointerLock()},!1);var _=.1,A=this;document.addEventListener("pointerlockchange",a,!1),document.addEventListener("mozpointerlockchange",a,!1),r.on("tick",this.tick.bind(this))}return e.prototype.tick=function(e){var t=this.target;t.lookForward(),t.rotateY(-this.yaw),t.translateRelatively(i.fromValues(e/200*this.sideways,0,e/200*this.forward)),t.rotateX(-this.pitch),t.rotateZ(-this.roll)},e}(),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/extra/webgl-debug",["npm:babel-runtime@5.1.2/core-js/object/keys"],function(e){function t(e){if(null==h){h={},g={};for(var t in e)"number"==typeof e[t]&&(h[e[t]]=t,g[t]=e[t])}}function n(){if(null==h)throw"WebGLDebugUtils.init(ctx) not called"}function r(e){return n(),void 0!==h[e]}function i(e){n();var t=h[e];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+e.toString(16)}function o(e,t,n,r){var o=d[e];if(void 0!==o){var o=o[t];if(void 0!==o&&o[n]){if("object"==typeof o[n]&&void 0!==o[n].enumBitwiseOr){for(var a=o[n].enumBitwiseOr,s=0,u=[],c=0;c<a.length;++c){var l=g[a[c]];0!==(r&l)&&(s|=l,u.push(i(l)))}return s===r?u.join(" | "):i(r)}return i(r)}}return null===r?"null":void 0===r?"undefined":r.toString()}function a(e,t){for(var n="",r=t.length,i=0;r>i;++i)n+=(0==i?"":", ")+o(e,r,i,t[i]);return n}function s(e,t,n){e.__defineGetter__(n,function(){return t[n]}),e.__defineSetter__(n,function(e){t[n]=e})}function u(e,n,r,a){function c(e,t){return function(){r&&r(t,arguments);var i=e[t].apply(e,arguments),o=a.getError();return 0!=o&&(l[o]=!0,n(o,t,arguments)),i}}a=a||e,t(e),n=n||function(e,t,n){for(var r="",a=n.length,s=0;a>s;++s)r+=(0==s?"":", ")+o(t,a,s,n[s]);p("WebGL error "+i(e)+" in "+t+"("+r+")")};var l={},f={};for(var m in e)if("function"==typeof e[m])if("getExtension"!=m)f[m]=c(e,m);else{var d=c(e,m);f[m]=function(){var t=d.apply(e,arguments);return u(t,n,r,a)}}else s(f,e,m);return f.getError=function(){for(var t in l)if(l.hasOwnProperty(t)&&l[t])return l[t]=!1,t;return e.NO_ERROR},f}function c(e){var t=e.getParameter(e.MAX_VERTEX_ATTRIBS),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);for(var r=0;t>r;++r)e.disableVertexAttribArray(r),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(r,0);e.deleteBuffer(n);for(var i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),r=0;i>r;++r)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);for(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);e.getError(););}function l(e){function t(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}function n(e){var t=e.addEventListener;e.addEventListener=function(n,r,i){switch(n){case"webglcontextlost":T(r);break;case"webglcontextrestored":_(r);break;default:t.apply(e,arguments)}}}function r(){for(var e=f(E),t=0;t<e.length;++t)delete E[e]}function i(){++x,b||y==x&&e.loseContext()}function o(e,t){var n=e[t];return function(){if(i(),!b){var t=n.apply(e,arguments);return t}}}function a(){for(var e=0;e<v.length;++e){var t=v[e];t instanceof WebGLBuffer?m.deleteBuffer(t):t instanceof WebGLFramebuffer?m.deleteFramebuffer(t):t instanceof WebGLProgram?m.deleteProgram(t):t instanceof WebGLRenderbuffer?m.deleteRenderbuffer(t):t instanceof WebGLShader?m.deleteShader(t):t instanceof WebGLTexture&&m.deleteTexture(t)}}function u(e){return{statusMessage:e,preventDefault:function(){w=!0}}}function l(e){for(var t in e)"function"==typeof e[t]?p[t]=o(e,t):s(p,e,t);p.getError=function(){if(i(),!b)for(var e;e=m.getError();)E[e]=!0;for(var e in E)if(E[e])return delete E[e],e;return p.NO_ERROR};for(var n=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],r=0;r<n.length;++r){var a=n[r];p[a]=function(t){return function(){if(i(),b)return null;var n=t.apply(e,arguments);return n.__webglDebugContextLostId__=g,v.push(n),n}}(e[a])}for(var u=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],r=0;r<u.length;++r){var a=u[r];p[a]=function(t){return function(){return i(),b?null:t.apply(e,arguments)}}(p[a])}for(var c=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],r=0;r<c.length;++r){var a=c[r];p[a]=function(t){return function(){return i(),b?!1:t.apply(e,arguments)}}(p[a])}return p.checkFramebufferStatus=function(t){return function(){return i(),b?p.FRAMEBUFFER_UNSUPPORTED:t.apply(e,arguments)}}(p.checkFramebufferStatus),p.getAttribLocation=function(t){return function(){return i(),b?-1:t.apply(e,arguments)}}(p.getAttribLocation),p.getVertexAttribOffset=function(t){return function(){return i(),b?0:t.apply(e,arguments)}}(p.getVertexAttribOffset),p.isContextLost=function(){return b},p}var m,p,d=[],h=[],p={},g=1,b=!1,v=[],y=0,x=0,w=!1,j=0,E={};e.getContext=function(t){return function(){var n=t.apply(e,arguments);if(n instanceof WebGLRenderingContext){if(n!=m){if(m)throw"got different context";m=n,p=l(m)}return p}return n}}(e.getContext);var T=function(e){d.push(t(e))},_=function(e){h.push(t(e))};return n(e),e.loseContext=function(){if(!b){for(b=!0,y=0,++g;m.getError(););r(),E[m.CONTEXT_LOST_WEBGL]=!0;var t=u("context lost"),n=d.slice();setTimeout(function(){for(var r=0;r<n.length;++r)n[r](t);j>=0&&setTimeout(function(){e.restoreContext()},j)},0)}},e.restoreContext=function(){b&&h.length&&setTimeout(function(){if(!w)throw"can not restore. webglcontestlost listener did not call event.preventDefault";a(),c(m),b=!1,x=0,w=!1;for(var e=h.slice(),t=u("context restored"),n=0;n<e.length;++n)e[n](t)},0)},e.loseContextInNCalls=function(e){if(b)throw"You can not ask a lost contet to be lost";y=x+e},e.getNumCalls=function(){return x},e.setRestoreTimeout=function(e){j=e},e}var f,m,p,d,h,g;return{setters:[function(e){f=e["default"]}],execute:function(){"use strict";m=function(e){window.console&&window.console.log&&window.console.log(e)},p=function(e){window.console&&window.console.error?window.console.error(e):m(e)},d={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},h=null,g=null,e("default",{init:t,mightBeEnum:r,glEnumToString:i,glFunctionArgToString:o,glFunctionArgsToString:a,makeDebugContext:u,makeLostContextSimulatingCanvas:l,resetToInitialState:c})}}}),e.register("github:maxdavidson/tribus@master/texture/texture2d",["npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/promise","github:maxdavidson/tribus@master/texture/common"],function(e){var t,n,r,i,o;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e.getImage}],execute:function(){"use strict";o=function(){function e(t){n(this,e),this.imageData=t}return e.fromFile=function(t,n){return i(t,n).then(function(t){return new e(t)})},t(e,[{key:"width",get:function(){return this.imageData.width}},{key:"height",get:function(){return this.imageData.height}}]),e}(),e("default",o)}}}),e.register("github:maxdavidson/tribus@master/extra/event-aggregator",["npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/map","npm:babel-runtime@5.1.2/core-js/set","npm:babel-runtime@5.1.2/core-js/get-iterator","npm:babel-runtime@5.1.2/core-js/weak-map"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]}],execute:function(){"use strict";s=!1,u=function(){function e(){var t=void 0===arguments[0]?null:arguments[0];n(this,e),e.privates.set(this,{callbacks:new r,buffers:new r,bubbleTarget:t})}return e.prototype.on=function(e){var t=void 0===arguments[1]?null:arguments[1];this._callbacks.has(e)||this._callbacks.set(e,new i),s&&console.log(""+this.constructor.name+" bound handler to: "+e),this._callbacks.get(e).add(t);var n=this._buffers.get(e);if(void 0!==n){for(var r=n,a=Array.isArray(r),u=0,r=a?r:o(r);;){var c;if(a){if(u>=r.length)break;c=r[u++]}else{if(u=r.next(),u.done)break;c=u.value}var l=c.args,f=c.options;this.trigger.apply(this,[e,optinos].concat(l)),s&&console.log(""+this.constructor.name+" ("+f.target.constructor.name+") released: "+e)}this._buffers["delete"](e)}},e.prototype.off=function(e){var t=void 0===arguments[1]?null:arguments[1];this._callbacks.has(e)&&(null===t&&this._callbacks["delete"](e),this._callbacks.get(e)["delete"](t),0===this._callbacks.get(e).size&&this._callbacks["delete"](e))},e.prototype.once=function(e,t){var n=this,r=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){for(var i=arguments.length,o=Array(i),a=0;i>a;a++)o[a]=arguments[a];t.apply(void 0,o),n.off(e,r)});this.on(e,r)},e.prototype.trigger=function(t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;n>i;i++)r[i-2]=arguments[i];var a=void 0===arguments[1]?{}:arguments[1],s=a.bubble,u=void 0===s?!1:s,c=a.buffer,l=void 0===c?!1:c,f=a.sync,m=void 0===f?!1:f,p=a.target,d=void 0===p?this:p,h=a.delay,g=void 0===h?0:h;if(this._callbacks.has(t))if(m)for(var b=this._callbacks.get(t),v=Array.isArray(b),y=0,b=v?b:o(b);;){var x;if(v){if(y>=b.length)break;x=b[y++]}else{if(y=b.next(),y.done)break;x=y.value}var w=x;w.apply(void 0,r.concat([d]))}else for(var j=function(){if(T){if(_>=E.length)return"break";A=E[_++]}else{if(_=E.next(),_.done)return"break";A=_.value}var e=A;window.setTimeout(function(){return e.apply(void 0,r.concat([d]))},g)},E=this._callbacks.get(t),T=Array.isArray(E),_=0,E=T?E:o(E);;){var A,M=j();if("break"===M)break}else if(u&&null!==e.privates.get(this).bubbleTarget){var S;(S=e.privates.get(this).bubbleTarget).trigger.apply(S,[t,a].concat(r))}else l&&(this._buffers.has(t)||this._buffers.set(t,[]),this._buffers.get(t).push({args:r,options:a}))},t(e,[{key:"_callbacks",get:function(){return e.privates.get(this).callbacks||(e.privates.get(this).callbacks=new r)}},{key:"_buffers",get:function(){return e.privates.get(this).buffers||(e.privates.get(this).buffers=new r)}}]),e}(),e("default",u),u.privates=new a}}}),e.register("github:maxdavidson/tribus@master/material/phong",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/object/freeze","npm:babel-runtime@5.1.2/core-js/map","npm:babel-runtime@5.1.2/core-js/get-iterator","npm:babel-runtime@5.1.2/core-js/set","npm:babel-runtime@5.1.2/core-js/array/from","npm:babel-runtime@5.1.2/core-js/symbol/iterator","npm:babel-runtime@5.1.2/regenerator","github:toji/gl-matrix@2.2.1","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/material/shaders/phong.vert.dot!github:maxdavidson/tribus@master/plugins/dot","github:maxdavidson/tribus@master/material/shaders/phong.frag.dot!github:maxdavidson/tribus@master/plugins/dot"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h,g,b,v,y,x,w,j,E,T,_,A,M,S,k,D,O,L,R;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e["default"]},function(e){p=e.Material,d=e.MaterialRenderer},function(e){h=e["default"]},function(e){g=e.construct,b=e.delegate},function(e){v=e["default"]},function(e){y=e["default"]},function(e){x=e["default"]},function(e){w=e["default"]}],execute:function(){"use strict";j=f.vec3,E=f.vec4,T=f.mat3,_=f.mat4,A=WebGLRenderingContext,M=function(e){function i(){var t=void 0===arguments[0]?{}:arguments[0],n=t.shininess,o=void 0===n?40:n,a=t.ambient,s=void 0===a?0:a,u=t.diffuse,c=void 0===u?.5:u,l=t.specular,f=void 0===l?c:l;r(this,i),e.call(this),this.shininess=o,this.ambient=s,this.diffuse=c,this.specular=f}return t(i,e),i.prototype.getRenderer=function(e){return S.create(this,e)},i.getSourceType=function(e){switch(e.constructor){case Number:case Array:case Float32Array:return"static";case h:return"texture";default:console.error("Incompatible material source color type")}},n(i,[{key:"config",get:function(){return{ambient:i.getSourceType(this.ambient),diffuse:i.getSourceType(this.diffuse),specular:i.getSourceType(this.specular)}}}]),i}(p),e("default",M),S=function(e){function o(t,n){r(this,o),e.call(this,t,o.createProgram(n,JSON.stringify(t.config),t.config)),this.locations=null,this.ambientStrategy=k.select("ambient",t.ambient,this.program),this.diffuseStrategy=k.select("diffuse",t.diffuse,this.program),this.specularStrategy=k.select("specular",t.specular,this.program)}return t(o,e),o.prototype.didInitGeometry=function(e){var t=e.vertexBuffer,n=e.normalBuffer,r=e.texcoordBuffer;t.setAttribLocation("vertex",this.program),n.setAttribLocation("normal",this.program),this.locations=i({mvpMatrix:this.program.getUniformLocation("mvpMatrix"),modelMatrix:this.program.getUniformLocation("modelMatrix"),normalMatrix:this.program.getUniformLocation("normalMatrix"),viewPos:this.program.getUniformLocation("viewPos"),shininess:this.program.getUniformLocation("material.shininess")}),this.ambientStrategy.init(r),this.diffuseStrategy.init(r),this.specularStrategy.init(r)},o.prototype.willDraw=function(e,t){for(var n=this.program.gl,r=this.locations,i=0,o=t.length;o>i;++i)t[i].render(this.program);n.uniform3fv(r.viewPos,e.worldPosition),n.uniform1f(r.shininess,this.material.shininess),this.ambientStrategy.update(),this.diffuseStrategy.update(),this.specularStrategy.update()},o.prototype.draw=function(e,t){var n=this.program.gl,r=this.locations;n.uniformMatrix4fv(r.mvpMatrix,!1,e.calculateMvpMatrix(t)),n.uniformMatrix4fv(r.modelMatrix,!1,t.worldTransform),n.uniformMatrix3fv(r.normalMatrix,!1,t.normalMatrix)},n(o,null,[{key:"create",value:m(g(o),{length:2}),enumerable:!0},{key:"createProgram",value:m(function(e,t,n){return new v(e,new y(e,x(n),A.VERTEX_SHADER),new y(e,w(n),A.FRAGMENT_SHADER))},{length:2}),enumerable:!0}]),o}(d),k=function(){function e(t,n,i){r(this,e),this.locations={},this.target=t,this.source=n,this.program=i}return e.prototype.init=function(e){},e.prototype.update=function(){},n(e,[{key:"locations",value:void 0,enumerable:!0}],[{key:"select",value:b(function(e,t){switch(M.getSourceType(t)){case"static":return D.create;case"texture":return O.create}}),enumerable:!0}]),e}(),D=function(e){function i(t,n,o){r(this,i),e.call(this,t,n,o),this.color="number"==typeof n?j.fromValues(n,n,n):j.clone(n)}return t(i,e),i.prototype.init=function(e){this.locations.target=this.program.getUniformLocation("material."+this.target)},i.prototype.update=function(){this.program.gl.uniform3fv(this.locations.target,this.color)},n(i,null,[{key:"create",value:m(g(i),{length:3}),enumerable:!0}]),i}(k),O=function(e){function i(t,n,o){r(this,i),e.call(this,t,n,o);var a=i.getConfig(o.gl),s=a.unit,u=a.handle,c=a.insert;this.unit=s,this.handle=u,c(this)}return t(i,e),i.prototype.init=function(e){e.setAttribLocation("texcoord",this.program),this.locations.sampler=this.program.getUniformLocation(""+this.target+"Sampler"),this.locations.bounds=this.program.getUniformLocation(""+this.target+"TexcoordBounds")},i.prototype.update=function(){var e=this.program.gl;e.uniform1i(this.locations.sampler,this.unit),e.uniform4fv(this.locations.bounds,this.texcoordBounds),e.activeTexture(A.TEXTURE0+this.unit),e.bindTexture(A.TEXTURE_2D,this.handle)},n(i,null,[{key:"getConfig",value:m(function(e){var t=new L,n=new o,r=d.allocateTextureUnit(e),i=e.createTexture(),u=void 0,c=function(){var e=document.createElement("canvas"),n=Math.pow(2,t.size);e.height=n,e.width=n,u=e.getContext("2d")};c();var l=function(e){for(var r=Math.pow(2,t.size),i=E.fromValues(e.left/r,(e.top+e.innerHeight)/r,e.innerWidth/r,-(e.innerHeight/r)),o=n.get(e.image),s=Array.isArray(o),u=0,o=s?o:a(o);;){var c;if(s){if(u>=o.length)break;c=o[u++]}else{if(u=o.next(),u.done)break;c=u.value}var l=c;l.texcoordBounds=i}};return{unit:r,handle:i,insert:function(o){var f=o.source,m=n.get(f.imageData);void 0===m&&(m=new s,n.set(f.imageData,m)),m.add(o),e.activeTexture(A.TEXTURE0+r),e.bindTexture(A.TEXTURE_2D,i);var p=t.insert(f.imageData);if(1===p.length&&p[0].outerWidth<Math.pow(2,t.size)){var d=p[0];l(d),u.putImageData(d.image,d.left,d.top),e.texSubImage2D(A.TEXTURE_2D,0,d.left,d.top,A.RGBA,A.UNSIGNED_BYTE,d.image),e.generateMipmap(A.TEXTURE_2D)}else{c();for(var h=p,g=Array.isArray(h),b=0,h=g?h:a(h);;){var v;if(g){if(b>=h.length)break;v=h[b++]}else{if(b=h.next(),b.done)break;v=b.value}var y=v;l(y),u.putImageData(y.image,y.left,y.top)}e.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,u.canvas),e.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),e.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),e.generateMipmap(A.TEXTURE_2D)}}}}),enumerable:!0},{key:"create",value:m(g(i),{length:3}),enumerable:!0}]),i}(k),L=function(){function e(){r(this,e),this.size=0,this.region=null,this.reset()}return e.prototype.reset=function(){var e=void 0===arguments[0]?this.size:arguments[0];this.size=e;var t=Math.pow(2,this.size);this.region=new R(0,0,t,t)},e.prototype.insert=function(e){var t=function(e){return Math.max(e.height,e.width)},n=this.region.insert(e);if(void 0!==n)return[n];var r=function(e){return function(t,n){return e(t)-e(n)}},i=function(e){return function(t,n){return e(n,t)}},o=new s(this.region.images());o.add(e);var c=u(o).sort(i(r(t)));this.reset();var l=void 0,f=void 0;do{l=!0,f=[];for(var m=c,p=Array.isArray(m),d=0,m=p?m:a(m);;){var h;if(p){if(d>=m.length)break;h=m[d++]}else{if(d=m.next(),d.done)break;h=d.value}var g=h,b=this.region.insert(g);if(void 0===b){this.reset(this.size+1),l=!1;break}f.push(b)}}while(!l);return f},n(e,[{key:"size",value:void 0,enumerable:!0},{key:"region",value:void 0,enumerable:!0}]),e}(),R=function(){function e(){var t=void 0===arguments[0]?0:arguments[0],n=void 0===arguments[1]?0:arguments[1],i=void 0===arguments[2]?0:arguments[2],o=void 0===arguments[3]?0:arguments[3];r(this,e),this.left=t,this.top=n,this.right=i,this.bottom=o,this.image=null,this.downRegion=null,this.rightRegion=null}return e.prototype.toString=function(){return""+this.constructor.name+"("+this.left+", "+this.top+", "+this.right+", "+this.bottom+")"},e.prototype.images=l.mark(function t(){var e,n,r,i,o;return l.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this,n=Array.isArray(e),r=0,e=n?e:a(e);case 1:if(!n){t.next=7;break}if(!(r>=e.length)){t.next=4;break}return t.abrupt("break",16);case 4:i=e[r++],t.next=11;break;case 7:if(r=e.next(),!r.done){t.next=10;break}return t.abrupt("break",16);case 10:i=r.value;case 11:return o=i,t.next=14,o.image;case 14:t.next=1;break;case 16:case"end":return t.stop()}},t,this)}),e.prototype.insert=function(t){if(this.isFilled)return this.downRegion.insert(t)||this.rightRegion.insert(t);if(t.height>this.outerHeight||t.width>this.outerWidth)return void 0;this.image=t;var n=this.outerWidth-this.innerWidth,r=this.outerHeight-this.innerHeight;return n>r?(this.downRegion=new e(this.left,this.top+this.innerHeight,this.right,this.bottom),this.rightRegion=new e(this.left+this.innerWidth,this.top,this.right,this.top+this.innerHeight)):(this.downRegion=new e(this.left,this.top+this.innerHeight,this.left+this.innerWidth,this.bottom),
this.rightRegion=new e(this.left+this.innerWidth,this.top,this.right,this.bottom)),this},n(e,[{key:"outerWidth",get:function(){return this.right-this.left}},{key:"outerHeight",get:function(){return this.bottom-this.top}},{key:"innerWidth",get:function(){return this.image.width}},{key:"innerHeight",get:function(){return this.image.height}},{key:"isFilled",get:function(){return null!==this.image}}]),e}(),R.prototype[c]=l.mark(function I(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isFilled){e.next=5;break}return e.next=3,this;case 3:return e.delegateYield(this.downRegion,"t4",4);case 4:return e.delegateYield(this.rightRegion,"t5",5);case 5:case"end":return e.stop()}},I,this)})}}}),e.register("github:maxdavidson/tribus@master/extra/helpers",["npm:babel-runtime@5.1.2/helpers/bind","npm:babel-runtime@5.1.2/core-js/promise","npm:babel-runtime@5.1.2/core-js/object/keys","npm:babel-runtime@5.1.2/core-js/object/assign","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/scene/group","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/phong","github:maxdavidson/tribus@master/material/skybox","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/geometry/shapes"],function(e){function t(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var i=_.fromFiles.apply(_,t).then(function(e){return new E(e)});return m("skybox",{},r(),i)}function n(e){return T.fromFile(e).then(function(e){return new A({heightmap:e})}).then(function(e){return e.generateNormals()})}function r(){return new M}function i(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(d.apply(A,[null].concat(t)))}function o(){var e=void 0===arguments[0]?{}:arguments[0];return new x(e)}function a(){var e=void 0===arguments[0]?{}:arguments[0];return new PointLight(e)}function s(){var e=void 0===arguments[0]?{}:arguments[0];return new SpotLight(e)}function u(e){return w.fromFile(e)}function c(e){return T.fromFile(e)}function l(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return _.fromFiles.apply(_,t)}function f(){var e=void 0===arguments[0]?{}:arguments[0];return Promise.all(g(e).map(function(t){return Promise.resolve(e[t]).then(function(e){var n;return n={},n[t]=e,n})})).then(function(e){return b.apply(Object,[{}].concat(e))}).then(function(e){return new j(e)})}function m(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(d.apply(v,[null].concat(t)))}function p(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return new(d.apply(y,[null].concat(t)))}var d,h,g,b,v,y,x,w,j,E,T,_,A,M;return{setters:[function(e){d=e["default"]},function(e){h=e["default"]},function(e){g=e["default"]},function(e){b=e["default"]},function(e){v=e["default"]},function(e){y=e["default"]},function(e){x=e["default"]},function(e){w=e["default"]},function(e){j=e["default"]},function(e){E=e["default"]},function(e){T=e["default"]},function(e){_=e["default"]},function(e){A=e.Plane,M=e.Cube}],execute:function(){"use strict";e("skybox",t),e("terrain",n),e("cube",r),e("plane",i),e("camera",o),e("pointlight",a),e("spotlight",s),e("geometry",u),e("texture2d",c),e("cubemap",l),e("phong",f),e("model",m),e("group",p)}}}),e.register("github:maxdavidson/tribus@master/scene/base",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/get-iterator","npm:babel-runtime@5.1.2/core-js/symbol/iterator","npm:babel-runtime@5.1.2/regenerator","github:toji/gl-matrix@2.2.1","github:maxdavidson/tribus@master/extra/event-aggregator"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p,d,h;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]}],execute:function(){"use strict";u=a.vec3,c=a.mat3,l=a.mat4,f=a.quat,m=Math.PI/180,p=u.fromValues(0,0,-1),d=u.create(),h=function(e){function i(t){var r=void 0===arguments[1]?{}:arguments[1],o=r.parent,a=void 0===o?null:o,s=r.position,m=void 0===s?[0,0,0]:s,p=r.rotateX,d=void 0===p?0:p,h=r.rotateY,g=void 0===h?0:h,b=r.rotateZ,v=void 0===b?0:b,y=r.scale,x=void 0===y?1:y;n(this,i),e.call(this,a),this.name=t,this.parent=a,this.orientation=f.create(),this.position=u.create(),this.scale=u.fromValues(1,1,1),this.localTransform=l.create(),this.worldTransform=l.create(),this.direction=u.create(),this.normalMatrix=c.create(),this.worldDirection=u.create(),this.worldPosition=u.create(),this.resize(x),this.rotateX(d),this.rotateZ(v),this.rotateY(g),this.translate(m)}return t(i,e),i.prototype.toString=function(){return""+this.constructor.name+"@"+this.name},i.prototype.query=function(e){for(var t=this,n=Array.isArray(t),i=0,t=n?t:r(t);;){var o;if(n){if(i>=t.length)break;o=t[i++]}else{if(i=t.next(),i.done)break;o=i.value}var a=o;if(a.name===e)return a}},i.prototype.forEach=function(e){e(this)},i.prototype.recalculate=function(){u.transformQuat(this.direction,p,this.orientation),l.fromRotationTranslation(this.localTransform,this.orientation,this.position),l.scale(this.localTransform,this.localTransform,this.scale),null!==this.parent?(l.multiply(this.worldTransform,this.parent.worldTransform,this.localTransform),u.transformMat3(this.worldDirection,this.direction,this.parent.normalMatrix),u.transformMat4(this.worldPosition,this.position,this.parent.worldTransform)):(l.copy(this.worldTransform,this.localTransform),u.copy(this.worldDirection,this.direction),u.copy(this.worldPosition,this.position)),c.normalFromMat4(this.normalMatrix,this.worldTransform)},i.prototype.resize=function(e){"number"==typeof e?u.scale(this.scale,this.scale,e):u.multiply(this.scale,this.scale,e)},i.prototype.rotateX=function(e){f.rotateX(this.orientation,this.orientation,e*m)},i.prototype.rotateY=function(e){f.rotateY(this.orientation,this.orientation,e*m)},i.prototype.rotateZ=function(e){f.rotateZ(this.orientation,this.orientation,e*m)},i.prototype.lookForward=function(){f.identity(this.orientation)},i.prototype.translate=function(e){u.add(this.position,this.position,e)},i.prototype.translateRelatively=function(e){u.add(this.position,this.position,u.transformQuat(d,e,this.orientation))},i.prototype.getEulerAngles=function(){var e=this.orientation,t=Math.atan2(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2])),n=Math.asin(2*(e[0]*e[2]-e[3]*e[1])),r=Math.atan2(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]));return{roll:t,pitch:n,yaw:r}},i}(s),e("default",h),h.prototype[i]=o.mark(function g(){return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this;case 2:case"end":return e.stop()}},g,this)})}}}),e.register("github:maxdavidson/tribus@master/geometry/geometry",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/core-js/promise","npm:memoizee@0.3.8","github:maxdavidson/tribus@master/webgl/buffer","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/extra/functional","github:maxdavidson/tribus@master/extra/ajax","github:maxdavidson/tribus@master/workers/wavefront","github:maxdavidson/tribus@master/workers/normal-vectors"],function(e){var t,n,r,i,o,a,s,u,c,l,f,m,p;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e.construct},function(e){u=e.getArrayBuffer},function(e){c=e.workerpool},function(e){l=e.workerpool}],execute:function(){"use strict";f=WebGLRenderingContext,m=function(){function e(){var n=void 0===arguments[0]?{}:arguments[0],r=n.vertices,i=n.indices,o=n.texcoords,a=n.normals,s=void 0===a?new Float32Array(r.length):a;t(this,e);var u=function(e,t){return e instanceof t?e:new t(e)};this.vertices=u(r,Float32Array),this.indices=u(i,Uint16Array),this.normals=u(s,Float32Array),this.texcoords=u(o,Float32Array)}return e.fromFile=function(t){var n=t.split(".").pop();switch(n){case"obj":return u(t).then(function(e){return c.run(e,{transfers:[e]})}).then(function(t){return new e(t)}).then(function(e){return 0===e.normals.length?e.generateNormals():e});default:throw new Error('Unsupported geometry file extension: ".'+n+'"')}},e.prototype.generateNormals=function(){var e=this;return l.run({vertices:this.vertices,indices:this.indices},{transfers:[this.vertices.buffer,this.indices.buffer]}).then(function(t){var n=t.vertices,r=t.indices,i=t.normals;return e.vertices=n,e.indices=r,e.normals=i,e})},e.prototype.getRenderer=function(e){return p.create(this,e)},e}(),e("default",m),p=function(){function e(n,r){t(this,e),this.gl=r,this.geometry=n,this.vaoExtension=r.getExtension("OES_vertex_array_object"),this.vao=this.vaoExtension.createVertexArrayOES(),this.vertexBuffer=new o(r,n.vertices,this.vao),this.normalBuffer=new o(r,n.normals,this.vao),this.texcoordBuffer=new o(r,n.texcoords,this.vao,{size:2}),this.indexBuffer=new o(r,n.indices,this.vao,{bufferType:f.ELEMENT_ARRAY_BUFFER})}return e.prototype.draw=function(){var e=this.vaoExtension;e.bindVertexArrayOES(this.vao),this.gl.drawElements(f.TRIANGLES,this.indexBuffer.data.length,f.UNSIGNED_SHORT,0),e.bindVertexArrayOES(null)},n(e,null,[{key:"create",value:i(s(e),{length:2}),enumerable:!0}]),e}(),e("GeometryRenderer",p)}}}),e.register("github:maxdavidson/tribus@master/scene/model",["npm:babel-runtime@5.1.2/helpers/inherits","npm:babel-runtime@5.1.2/helpers/create-class","npm:babel-runtime@5.1.2/helpers/class-call-check","github:maxdavidson/tribus@master/scene/base","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/material/base","github:maxdavidson/tribus@master/material/phong"],function(e){var t,n,r,i,o,a,s,u;return{setters:[function(e){t=e["default"]},function(e){n=e["default"]},function(e){r=e["default"]},function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e.Material},function(e){s=e["default"]}],execute:function(){"use strict";u=function(e){function i(t,n,u){var c=this,l=void 0===arguments[3]?new s:arguments[3];r(this,i),e.call(this,t,n),this.__initializeProperties(),u instanceof o&&(this.geometry=u),l instanceof a&&(this.material=l),this.onGeometryLoaded=Promise.resolve(u).then(function(e){return c.geometry=e}),this.onMaterialLoaded=Promise.resolve(l).then(function(e){return c.material=e})}return t(i,e),i.prototype.__initializeProperties=function(){this.geometry=null,this.material=null},n(i,[{key:"geometry",value:void 0,enumerable:!0},{key:"material",value:void 0,enumerable:!0}]),i}(i),e("default",u)}}}),e.register("github:maxdavidson/tribus@master/renderer",["npm:babel-runtime@5.1.2/helpers/class-call-check","npm:babel-runtime@5.1.2/core-js/weak-map","npm:babel-runtime@5.1.2/core-js/weak-set","npm:babel-runtime@5.1.2/core-js/promise","npm:babel-runtime@5.1.2/core-js/get-iterator","github:maxdavidson/tribus@master/extra/webgl-debug","github:mrdoob/stats.js@master","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/light/base"],function(e){function t(e,t,n,r,i){for(var o=!0;o;){f=void 0,o=!1;var a=e,s=t,u=n,c=r,l=i;c=c||0,l=l||s.length;var f=Math.floor(c+(l-c)/2);if(s[f]===a)return f;if(1>=l-c)return s[f]>a?f-1:f;u(s[f],a)<0?(e=a,t=s,n=u,r=f,i=l,o=!0):(e=a,t=s,n=u,r=c,i=f,o=!0)}}function n(e,n,r){return n.splice(t(e,n,r)+1,0,e),n}function r(e){return c.makeDebugContext(e,function(e,t){console.error(""+c.glEnumToString(e)+" was caused by call to: "+t)},function(e,t){console.log("gl."+e+"("+c.glFunctionArgsToString(e,t)+")");for(var n=t,r=Array.isArray(n),i=0,n=r?n:u(n);;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if(i=n.next(),i.done)break;o=i.value}var a=o;void 0===a&&console.error("undefined passed to gl."+e+"("+c.glFunctionArgsToString(e,t)+")")}})}var i,o,a,s,u,c,l,f,m,p,d;return{setters:[function(e){i=e["default"]},function(e){o=e["default"]},function(e){a=e["default"]},function(e){s=e["default"]},function(e){u=e["default"]},function(e){c=e["default"]},function(e){l=e["default"]},function(e){f=e["default"]},function(e){m=e.Light}],execute:function(){"use strict";p=WebGLRenderingContext,d=function(){function e(t,n,a){var s=this,u=void 0===arguments[3]?{}:arguments[3],c=u.debug,f=void 0===c?!1:c,m=u.showFPS,d=void 0===m?!1:m;i(this,e),this.scene=t,this.camera=n,this._activeModels=[],this._modelsBeingProcessed=new o,this._materialsUsingGeometry=new o,this._geometryRenderers=new o,this._materialRenderers=new o,this._lightRenderers=[],a.width=a.clientWidth,a.height=a.clientHeight;var h=a.getContext("webgl")||a.getContext("experimental-webgl");if(void 0===h)throw"Your browser does not seem to support WebGL! Too bad!";if(f&&(h=r(h)),d){var g=new l;g.setMode(0),g.domElement.style.position="absolute",g.domElement.style.left="0px",g.domElement.style.top="0px",document.body.appendChild(g.domElement),this._stats=g}n.aspect=a.clientWidth/a.clientHeight,window.addEventListener("resize",function(){a.width=a.clientWidth,a.height=a.clientHeight,h.viewport(0,0,a.clientWidth,a.clientHeight),n.aspect=a.clientWidth/a.clientHeight}),this.gl=h;var b=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return e.thenBy=function(t){return b(function(n,r){return e(n,r)||t(n,r)})},e}),v=function(e){var t=void 0===arguments[1]?function(e,t){return t-e}:arguments[1];return function(n,r){return t(e(n),e(r))}},y=function(e,t){return e===t?0:-1};this._modelComparator=b(v(function(e){return s._materialRenderers.get(e).material.priority}),function(e,t){return e-t}).thenBy(v(function(e){return s._materialRenderers.get(e).program},y)).thenBy(v(function(e){return e.material},y));var x=this._processNode.bind(this);this.scene.forEach(x),t.on("didAddNode",x),h.clearColor(0,0,0,1),h.enable(p.DEPTH_TEST),h.enable(p.CULL_FACE),h.cullFace(p.BACK)}return e.prototype.start=function(){var e=this,t=void 0===arguments[0]?0:arguments[0];this.isRunning=!0,window.requestAnimationFrame(function(n){e.isRunning&&(e.render(n-t,n),e.start(n))})},e.prototype.stop=function(){this.isRunning=!1},e.prototype._processNode=function(e){e instanceof f?this._processModel(e):e instanceof m&&this._lightRenderers.push(e.getRenderer(this.gl))},e.prototype._processModel=function(e){var t=this,r=this._modelsBeingProcessed.get(e);return void 0===r&&(r=Promise.all([e.onGeometryLoaded,e.onMaterialLoaded]).then(function(r){var i=r[0],o=r[1],s=i.getRenderer(t.gl),u=o.getRenderer(t.gl);return t._geometryRenderers.set(e,s),t._materialRenderers.set(e,u),t._materialsUsingGeometry.has(i)||t._materialsUsingGeometry.set(i,new a),t._materialsUsingGeometry.get(i).has(o)||(u.didInitGeometry(s),t._materialsUsingGeometry.get(i).add(o)),-1===t._activeModels.indexOf(e)&&n(e,t._activeModels,t._modelComparator),e})),r},e.prototype.render=function(e,t){this._stats&&this._stats.begin(),this.gl.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT);var n=this.scene,r=this.camera,i=this._lightRenderers,o=this._geometryRenderers,a=this._materialRenderers,s=this._activeModels;n.recalculate(),n.forEach(function(n){n.trigger("tick",{sync:!0},e,t)});for(var u=null,c=null,l=0,f=s.length;f>l;++l){var m=s[l],d=o.get(m),h=a.get(m),g=h.program;g!==u&&g.use(),h!==c&&h.willDraw(r,i),h.draw(r,m),d.draw(),h!==c&&h.didDraw(),u=g,c=h}this._stats&&this._stats.end()},e}(),e("default",d)}}}),e.register("github:maxdavidson/tribus@master/tribus",["github:maxdavidson/tribus@master/renderer","github:maxdavidson/tribus@master/extra/helpers","github:maxdavidson/tribus@master/scene/base","github:maxdavidson/tribus@master/scene/group","github:maxdavidson/tribus@master/scene/model","github:maxdavidson/tribus@master/control/mouseview","github:maxdavidson/tribus@master/light/directional-light","github:maxdavidson/tribus@master/light/pointlight","github:maxdavidson/tribus@master/light/spotlight","github:maxdavidson/tribus@master/camera/perspective-camera","github:maxdavidson/tribus@master/camera/orthographic-camera","github:maxdavidson/tribus@master/geometry/geometry","github:maxdavidson/tribus@master/geometry/shapes","github:maxdavidson/tribus@master/texture/common","github:maxdavidson/tribus@master/texture/texture2d","github:maxdavidson/tribus@master/texture/cubemap","github:maxdavidson/tribus@master/material/phong","github:maxdavidson/tribus@master/material/skybox","github:maxdavidson/tribus@master/webgl/program","github:maxdavidson/tribus@master/webgl/shader","github:maxdavidson/tribus@master/webgl/buffer"],function(e){return{setters:[function(t){e("Renderer",t["default"])},function(t){e("skybox",t.skybox),e("terrain",t.terrain),e("cube",t.cube),e("plane",t.plane),e("camera",t.camera),e("pointlight",t.pointlight),e("spotlight",t.spotlight),e("geometry",t.geometry),e("texture2d",t.texture2d),e("cubemap",t.cubemap),e("phong",t.phong),e("model",t.model),e("group",t.group)},function(t){e("Scene",t["default"])},function(t){e("Group",t["default"])},function(t){e("Model",t["default"])},function(t){e("MouseViewController",t["default"])},function(t){e("DirectionalLight",t["default"])},function(t){e("PointLight",t["default"])},function(t){e("SpotLight",t["default"])},function(t){e("PerspectiveCamera",t["default"])},function(t){e("OrthographicCamera",t["default"])},function(t){e("Geometry",t["default"])},function(t){e("Cube",t.Cube),e("Plane",t.Plane)},function(t){e("getImage",t.getImage)},function(t){e("Texture2D",t["default"])},function(t){e("CubeMap",t["default"])},function(t){e("PhongMaterial",t["default"])},function(t){e("SkyboxMaterial",t["default"])},function(t){e("GLProgram",t["default"])},function(t){e("GLShader",t["default"])},function(t){e("GLBuffer",t["default"])}],execute:function(){"use strict"}}}),e.register("github:maxdavidson/tribus@master",["github:maxdavidson/tribus@master/tribus"],function(e){return{setters:[function(t){for(var n in t)e(n,t[n])}],execute:function(){"use strict"}}}),e.register("main",["github:maxdavidson/tribus@master"],function(e){function t(){document.body.appendChild(h);var e=new n(d,m,h,{showFPS:!0});e.start()}var n,r,i,o,a,s,u,c,l,f,m,p,d,h;return{setters:[function(e){n=e.Renderer,r=e.Group,i=e.Model,o=e.Geometry,a=e.PhongMaterial,s=e.PerspectiveCamera,u=e.PointLight}],execute:function(){"use strict";c=o.fromFile("bunny.obj"),l=new a({diffuse:[.5,.5,.5],specular:[0,0,1]}),f=new i("bunny",{position:[0,0,0],rotateY:45,rotateX:15},c,l),f.on("tick",function(e){f.rotateY(45*e/1e3)}),m=new s({position:[0,0,2]}),p=new u({position:[0,2,2],diffuse:[0,1,1]}),d=new r("world",{},[m,f,p]),h=document.createElement("canvas"),document.body?t():window.addEventListener("DOMContentLoaded",t)}}})});